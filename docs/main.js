(()=>{"use strict";var t,e={905:(t,e,i)=>{var s=i(128);const n=i.p+"ce7496ad1af705d6ccee.png",o=i.p+"5de335bc34b557ac0a77.png",r=i.p+"084f6b4bd78bf012dc1c.png",h=i.p+"41010e10d36c02c09f7e.png",a=i.p+"fe80bbd024bed2d313e0.png",c=i.p+"317f0b8d7d7127116e52.png",l=i.p+"70ee555527104bb6766c.png",d=i.p+"48fff0201b6ff88f6844.png",p=i.p+"8b541599a7ea78270c3a.png",g=i.p+"5a2e7bc780c15f39858a.png",u=i.p+"27e85399b3457c32315e.png",w=i.p+"cab8e5db452eb5cddbab.png",m=i.p+"7317fe13d3b7079227bb.png",f=i.p+"f1fecf680904d2a3d503.png",y=i.p+"6aaa2bfde529973c90c3.png",I=i.p+"baebf4fddc780da41f69.png",T=i.p+"6adca5ff387053b536c6.png",P=new class{constructor(){this.Load={Sword:new s.bEs(n),Magor:new s.bEs(o),VeverkaRun:new s.bEs(h),VeverkaIdle:new s.bEs(a),ItemsImg:new s.bEs(w),Logo:new s.bEs(c),Lever:new s.bEs(l),PlatformSmall:new s.bEs(d),PlatformMedium:new s.bEs(p),PlatformWheel:new s.bEs(g),ResourceStation:new s.bEs(T),Wheel:new s.bEs(u),Button:new s.bEs(r),Machines:new s.bEs(m),LevelTable:new s.bEs(f),StarGold:new s.bEs(y),StarGrey:new s.bEs(I)},this.Items=b((()=>s.FLG.fromImageSource({image:this.Load.ItemsImg,grid:{columns:8,rows:8,spriteHeight:16,spriteWidth:16}}))),this.Machines=b((()=>s.FLG.fromImageSource({image:this.Load.Machines,grid:{columns:8,rows:5,spriteWidth:48,spriteHeight:70}})))}};function b(t){let e;return()=>(e=t(),e)}class v extends s.Agj{constructor(t,e,i,n,o=0,r=s.Bpo.Passive){super({pos:s.t6s(t,e),width:i,height:n,color:s.Q1f.DarkGray,collisionType:r}),this.rotation=o,25==i&&this.graphics.use(P.Load.PlatformWheel.toSprite()),30==i?this.graphics.use(P.Load.PlatformSmall.toSprite()):60==i&&this.graphics.use(P.Load.PlatformMedium.toSprite())}}class S extends v{onCollisionStart(t,e,i,n){const o=e.owner.get(s.Yfw);o.owner instanceof E&&(o.owner.isOnSolidPlatform=!0,o.owner.isOnGround=!0)}onCollisionEnd(t,e,i,n){const o=e.owner.get(s.Yfw);o.owner instanceof E&&(o.owner.isOnSolidPlatform=!1)}}class x extends v{constructor(){super(...arguments),this.isOnPlayform=!1,this.direction=0}onPostUpdate(t,e){this.playerReference&&this.playerReference.isOnGround&&(this.direction=this.playerReference.runningDirection)}onCollisionStart(t,e,i,n){const o=e.owner.get(s.Yfw);o.owner instanceof E&&(this.isOnPlayform=!0,this.playerReference=o.owner)}onCollisionEnd(t,e,i,n){e.owner.get(s.Yfw).owner instanceof E&&(this.isOnPlayform=!1,this.playerReference=void 0,this.direction=0)}}class E extends s.Agj{constructor(t,e){super({pos:(0,s.t6s)(t,e),z:1,width:25,height:25,color:new s.Q1f(255,255,255),collisionType:s.Bpo.Passive,collider:s.ypk.Box(32,32)}),this.GRAVITY=3e3,this.JUMP_GRAVITY=.5*this.GRAVITY,this.MAX_VELOCITY=300,this.ACCELERATION=700,this.TURN_ACCELERATION=4*this.ACCELERATION,this.AIR_MOVEMENT_PENALITY=.75,this.JUMP_FORCE=430,this.isOnWheel=!1,this.runningDirection=0,this.isOnGround=!1,this.isPressingDown=!1,this.isOnSolidPlatform=!1,this.carryingItem=null,this.animations={run:s.X55.fromSpriteSheet(s.FLG.fromImageSource({image:P.Load.VeverkaRun,grid:{columns:1,rows:7,spriteWidth:128,spriteHeight:25}}),[0,1,2,3,4,5,6],50),flying:s.X55.fromSpriteSheet(s.FLG.fromImageSource({image:P.Load.VeverkaRun,grid:{columns:1,rows:7,spriteWidth:128,spriteHeight:25}}),[2,3],100),idle:s.X55.fromSpriteSheet(s.FLG.fromImageSource({image:P.Load.VeverkaIdle,grid:{columns:3,rows:1,spriteWidth:32,spriteHeight:32}}),[0,1,2,1],200)}}onInitialize(t){t.input.keyboard.on("press",this.onKeyPress.bind(this))}onPostUpdate(t,e){const i=t.input.keyboard.wasPressed(s.D$R.W)||t.input.keyboard.isHeld(s.D$R.Up),n=t.input.keyboard.isHeld(s.D$R.W)||t.input.keyboard.isHeld(s.D$R.Up),o=t.input.keyboard.isHeld(s.D$R.A)||t.input.keyboard.isHeld(s.D$R.Left),r=t.input.keyboard.isHeld(s.D$R.D)||t.input.keyboard.isHeld(s.D$R.Right);let h=Math.sign(this.vel.x);if(this.isPressingDown=t.input.keyboard.isHeld(s.D$R.S)||t.input.keyboard.isHeld(s.D$R.Down),o||r){let t=0;o&&(t-=1),r&&(t+=1);let e=(t!=h?this.TURN_ACCELERATION:this.ACCELERATION)*t;this.isOnGround||(e*=this.AIR_MOVEMENT_PENALITY),this.acc.x=e,this.runningDirection=t}else this.acc.x=0,this.vel.x*=.75,this.runningDirection=0;-1==this.runningDirection?this.graphics.flipHorizontal=!0:1==this.runningDirection&&(this.graphics.flipHorizontal=!1),this.vel.x=(0,s.qE8)(this.vel.x,-this.MAX_VELOCITY,this.MAX_VELOCITY),i&&this.isOnGround&&(this.vel.y=-this.JUMP_FORCE,this.isOnGround=!1,this.isOnWheel=!1),this.isPressingDown&&!this.isOnSolidPlatform&&(this.isOnGround=!1,this.isOnWheel=!1),n&&Math.sign(this.vel.y)<0?this.acc.y=this.JUMP_GRAVITY:this.acc.y=this.GRAVITY,this.isOnGround?this.isOnWheel?0==this.runningDirection?(this.graphics.use(this.animations.idle),this.updateItemPosition("hand")):(this.graphics.use(this.animations.run),this.updateItemPosition("back")):Math.abs(this.vel.x)<50?(this.graphics.use(this.animations.idle),this.updateItemPosition("hand")):(this.graphics.use(this.animations.run),this.updateItemPosition("back")):(this.graphics.use(this.animations.flying),this.updateItemPosition("back")),this.isOnGround&&(this.acc.y=0,this.vel.y=0),this.isOnWheel&&(this.acc.x=0,this.vel.x=0)}onCollisionStart(t,e,i,n){const o=e.owner.get(s.Yfw);(null==o?void 0:o.collisionType)!==s.Bpo.Fixed&&(null==o?void 0:o.collisionType)!==s.Bpo.Passive||(i===s.mnM.Bottom&&!this.isPressingDown&&o.owner instanceof v||o.owner instanceof S)&&(this.isOnGround=!0,o.owner instanceof x&&(this.isOnWheel=!0,this.pos.x=e.center.x),this.pos.y=e.getFurthestPoint((0,s.t6s)(0,-1)).y-t.bounds.height/2+.1)}onCollisionEnd(t,e,i,n){super.onCollisionEnd(t,e,i,n);const o=e.owner.get(s.Yfw);(null==o?void 0:o.owner)instanceof v&&o.pos.y>this.pos.y&&(this.isOnGround=!1)}onKeyPress(t){t.key===s.pde.Keys.Space&&this.dropItem()}isCarryingItem(){return null!=this.carryingItem}pickUpItem(t){this.carryingItem=t,t.body.collisionType=s.Bpo.Passive,this.addChild(this.carryingItem)}dropItem(){var t;this.carryingItem&&(this.removeChild(this.carryingItem),this.carryingItem.pos=this.pos.clone(),this.carryingItem.vel=s.t6s(this.vel.x,this.vel.y/10),this.carryingItem.body.collisionType=s.Bpo.Active,this.carryingItem.offset=(0,s.t6s)(0,0),null===(t=this.scene)||void 0===t||t.add(this.carryingItem),this.carryingItem=null)}updateItemPosition(t){let e=this.graphics.flipHorizontal,i=this.graphics.current._currentFrame,n=Math.sin(i),o=(0,s.t6s)(e?-10:10,3+n),r=(0,s.t6s)(e?-20:20,2+n);null!=this.carryingItem&&(this.carryingItem.graphics.flipHorizontal=e,this.carryingItem.offset="hand"==t?o:r)}}class O extends s.Agj{constructor(){super({pos:s.t6s(200,500),width:32,height:32,color:s.Q1f.Gray,collisionType:s.Bpo.Active}),this.carryingItem=null}onInitialize(t){}update(t,e){super.update(t,e)}}class C extends s.Agj{constructor(t,e,i,n){super({pos:s.t6s(t,e)}),this.linkedMachine=n,this.wheel=new s.Agj({radius:i,color:s.Q1f.Gray,scale:(0,s.t6s)(1.1,1.1)}),this.wheel.graphics.use(P.Load.Wheel.toSprite());this.platform=new x(0,i+5,25,10),this.addChild(this.wheel),this.addChild(this.platform)}onPostUpdate(t,e){0!=this.platform.direction&&(this.wheel.actions.rotateBy(this.platform.direction/20,100),null!=this.linkedMachine&&(this.linkedMachine.remainingProcessingTime=Math.max(this.linkedMachine.remainingProcessingTime-e/1e3,0)))}}class L extends s.Agj{constructor(t,e,i){super({pos:s.t6s(t,e),width:8,height:32,offset:(0,s.t6s)(0,-16),collisionType:s.Bpo.Passive,collider:s.ypk.Circle(4)}),this.graphics.use(P.Load.Lever.toSprite()),i&&(this.linkedMachine=i)}onPostUpdate(t,e){if(this.playerReference&&this.actions.getQueue().isComplete()){let t=Math.sign(this.playerReference.vel.x);t&&(this.actions.clearActions(),this.actions.rotateTo(t/2,5))}}onCollisionStart(t,e,i,n){const o=e.owner.get(s.Yfw);o.owner instanceof E&&(this.playerReference=o.owner)}onCollisionEnd(t,e,i,n){e.owner.get(s.Yfw).owner instanceof E&&(this.playerReference=null)}onInitialize(t){}}class R extends s.Agj{constructor(t,e){super({radius:6,collisionType:s.Bpo.Active}),this.item=t,this.allocatedToCustomer=!1,e&&(this.pos=e.clone()),this.graphics.use(t.getSprite())}onPostUpdate(t,e){this.angularVelocity=this.vel.x/10}}class A extends s.Agj{constructor(t,e=!1){super({color:s.Q1f.Gray,collisionType:s.Bpo.Fixed,...t}),this.isOn=!0,this.itemQueue=[],this.blacklistedItemQueue=[],this.isProcessing=!1,this.remainingProcessingTime=0,this.maxProcessingTime=1.5,this.manual=e,this.tooltip=new s.JU7({text:"",pos:(0,s.t6s)(0,0),font:new s.KQV({textAlign:s.nOB.Center,baseAlign:s.vhs.Middle,shadow:{blur:5,offset:(0,s.t6s)(0,0),color:s.Q1f.Black},family:"Silkscreen",size:15,unit:s.yRQ.Px,color:s.Q1f.White})}),this.tooltip.z=10;let[i,n]=this.getIntake();this.intakeActor=new s.Agj({pos:i.add(n).scale(.5),width:n.x-i.x,height:n.y-i.y,collisionType:s.Bpo.Fixed,color:s.Q1f.Green}),this.intakeActor.on("collisionstart",(t=>{if(this.isOn&&t.other instanceof R){const e=t.other;this.itemQueue.includes(e)||this.blacklistedItemQueue.includes(e)||this.itemQueue.push(e)}})),this.addChild(this.intakeActor),this.addChild(this.tooltip)}onPostUpdate(t,e){var i;if(this.isProcessing)if(this.remainingProcessingTime<=0){const t=this.itemQueue.shift();t.kill(),this.isProcessing=!1,this.remainingProcessingTime=0,this.tooltip.text="";const e=this.processItem(t.item);if(e){const t=new R(e);t.pos=this.getOutlet().add(this.pos),this.blacklistedItemQueue.push(t),null===(i=this.scene)||void 0===i||i.add(t)}}else this.manual||(this.remainingProcessingTime=Math.max(this.remainingProcessingTime-e/1e3,0)),this.tooltip.text=`${this.remainingProcessingTime.toFixed(1)}`;else 0!=this.itemQueue.length&&(this.isProcessing=!0,this.remainingProcessingTime=this.maxProcessingTime,this.tooltip.text=`${this.remainingProcessingTime.toFixed(1)}`)}}class k extends s.Agj{constructor(t,e,i=0){super({pos:t,rotation:i/180*Math.PI,width:e.x,height:e.y,collisionType:s.Bpo.Fixed})}}class M extends A{constructor(t,e){super({pos:(0,s.t6s)(t,e),z:1},!0),this.graphics.add(P.Machines().getSprite(0,0)),this.collider.set(new s.VQc({radius:16,offset:(0,s.t6s)(0,6)})),this.crank=new s.Agj({pos:(0,s.t6s)(.5,5),z:this.z+1});const i=P.Machines().getSprite(1,0);this.crank.graphics.add(i),this.addChild(this.crank),this.addChild(new k((0,s.t6s)(-11,-18),(0,s.t6s)(27,2),75)),this.addChild(new k((0,s.t6s)(12,-18),(0,s.t6s)(27,2),-75))}onPostUpdate(t,e){super.onPostUpdate(t,e),this.isOn&&(this.crank.rotation=-this.remainingProcessingTime/this.maxProcessingTime*Math.PI*2)}processItem(t){return t.grind?t.grind():null}getIntake(){return[(0,s.t6s)(-5,-10),(0,s.t6s)(5,-5)]}getOutlet(){return(0,s.t6s)(.5,10)}}class D extends A{constructor(t,e){super({pos:(0,s.t6s)(t,e)}),this.graphics.use(P.Machines().getSprite(2,0)),this.collider.set(new s.ElT([s.ypk.Box(45,16,void 0,(0,s.t6s)(0,-6)),s.ypk.Polygon([(0,s.t6s)(10,1),(0,s.t6s)(14,21),(0,s.t6s)(15,21),(0,s.t6s)(11,0)],(0,s.t6s)(-24,-35)),s.ypk.Polygon([(0,s.t6s)(43,1),(0,s.t6s)(42,0),(0,s.t6s)(39,21),(0,s.t6s)(40,21)],(0,s.t6s)(-24,-35))]))}processItem(t){return t.brew?t.brew():null}getIntake(){return[(0,s.t6s)(-8,-16),(0,s.t6s)(8,-4)]}getOutlet(){return(0,s.t6s)(0,10)}}var G,W,B;!function(t){t[t.Acorn=0]="Acorn",t[t.Leaf=1]="Leaf",t[t.Almond=2]="Almond"}(G||(G={})),function(t){t[t.BREWER=0]="BREWER",t[t.GRINDER=1]="GRINDER"}(W||(W={})),function(t){t[t.COFFEE=0]="COFFEE"}(B||(B={}));class H{getSprite(){return P.Items().getSprite(0,0)}grind(){return new F}roast(){return new U}}class F{getSprite(){return P.Items().getSprite(1,0)}brew(){return new Q}roast(){return new _}}class Q{getSprite(){return P.Items().getSprite(2,0)}getProductType(){return B.COFFEE}}class U{getSprite(){return P.Items().getSprite(0,1)}}class _{getSprite(){return P.Items().getSprite(0,2)}}class Y extends s.Agj{constructor(t,e,i,n){super({x:t,y:e,width:i,height:i,color:s.Q1f.Gray,collisionType:s.Bpo.Passive}),this.cooldownTimer=0,this.isOnCooldown=!1,this.COOLDOWN=5,this.item=n,this.tooltip=new s.JU7({text:"Space",pos:(0,s.t6s)(0,-i/2-6),font:new s.KQV({textAlign:s.nOB.Center,baseAlign:s.vhs.Bottom,shadow:{blur:5,offset:(0,s.t6s)(0,0),color:s.Q1f.Black},family:"Silkscreen",size:15,unit:s.yRQ.Px,color:s.Q1f.White})}),this.tooltip.scale=(0,s.t6s)(0,0);let o=new R(n);o.body.collisionType=s.Bpo.PreventCollision,this.addChild(this.tooltip),this.addChild(o),this.graphics.use(P.Load.ResourceStation.toSprite())}onPostUpdate(t,e){const i=t.input.keyboard.wasPressed(s.D$R.Space);this.isOnCooldown?(this.cooldownTimer-=e/1e3,this.cooldownTimer<=0?(this.isOnCooldown=!1,this.tooltip.text="Space"):(this.tooltip.text=`${this.cooldownTimer.toFixed(1)}`,this.tooltip.graphics.opacity=.5)):this.playerReference&&(this.playerReference.isCarryingItem()?this.tooltip.graphics.opacity=.5:this.tooltip.graphics.opacity=1,!i||this.playerReference.isCarryingItem()||this.isOnCooldown||(this.playerReference.pickUpItem(new R(this.item)),this.isOnCooldown=!0,this.cooldownTimer=this.COOLDOWN,this.tooltip.text=`${this.COOLDOWN.toFixed(1)}`,this.actions.delay(1e3*this.COOLDOWN).callMethod((()=>{null==this.playerReference&&this.tooltip.actions.scaleTo((0,s.t6s)(0,0),(0,s.t6s)(10,20)).callMethod((()=>{this.tooltip.text="Space"}))}))))}onCollisionStart(t,e,i,n){const o=e.owner.get(s.Yfw);o.owner instanceof E&&(this.playerReference=o.owner,this.tooltip.actions.scaleTo((0,s.t6s)(1,1),(0,s.t6s)(10,20)))}onCollisionEnd(t,e,i,n){e.owner.get(s.Yfw).owner instanceof E&&(this.playerReference=void 0,this.isOnCooldown||this.tooltip.actions.scaleTo((0,s.t6s)(0,0),(0,s.t6s)(10,20)))}}const $=Y;class j extends s.Agj{constructor(t,e){super({pos:s.t6s(t,0),width:32,height:32,color:s.Q1f.Yellow,collisionType:s.Bpo.Passive}),this.animations={run:s.X55.fromSpriteSheet(s.FLG.fromImageSource({image:P.Load.VeverkaRun,grid:{columns:1,rows:7,spriteWidth:128,spriteHeight:25}}),[0,1,2,3,4,5,6],100),flying:s.X55.fromSpriteSheet(s.FLG.fromImageSource({image:P.Load.VeverkaRun,grid:{columns:1,rows:7,spriteWidth:128,spriteHeight:25}}),[2,3],100),idle:s.X55.fromSpriteSheet(s.FLG.fromImageSource({image:P.Load.VeverkaIdle,grid:{columns:3,rows:1,spriteWidth:32,spriteHeight:32}}),[0,1,2],200)},this.satisfied=!1,this.assignedItem=null,this.runningDirection=null,this.runningTarget=null,this.desiredProductType=e}onInitialize(t){this.pos=s.t6s(this.pos.x,t.drawHeight-this.height/2)}onPostUpdate(t,e){null!==this.runningTarget?(this.runningDirection=Math.sign(this.runningTarget-this.pos.x),Math.abs(this.runningTarget-this.pos.x)<j.PICK_UP_THRESHOLD&&(this.runningTarget=null,this.assignedItem&&(this.satisfied=!0,this.runningDirection=1,this.assignedItem.kill()))):this.satisfied||(this.runningDirection=null),this.satisfied&&this.pos.x>t.drawWidth+this.width&&(console.log("Killing customer"),this.kill()),null!==this.runningDirection?this.acc.x=j.ACCELERATION*this.runningDirection:(this.acc.x=0,this.vel.x*=.75),-1==this.runningDirection?this.graphics.flipHorizontal=!0:1==this.runningDirection&&(this.graphics.flipHorizontal=!1),this.vel.x=(0,s.qE8)(this.vel.x,-j.MAX_VELOCITY,j.MAX_VELOCITY)}goFetchItem(t){console.log("Fetching item"),this.runningTarget=t.pos.x,this.assignedItem=t,t.allocatedToCustomer=!0}goTo(t){this.runningTarget=t}productAssigned(){return null!=this.assignedItem}}j.MAX_VELOCITY=300,j.ACCELERATION=700,j.PICK_UP_THRESHOLD=50;class N extends s.Agj{constructor(){super({pos:(0,s.t6s)(0,0),width:0,height:0,color:s.Q1f.Transparent,collisionType:s.Bpo.Passive}),this.customers=[],this.pendingProducts=[]}onInitialize(t){this.pos=(0,s.t6s)(t.halfDrawWidth,t.drawHeight-N.HEIGHT+this.width/2),this.collider.set(s.ypk.Box(t.drawWidth,N.HEIGHT)),this.scheduleCustomersRefresh(t)}scheduleCustomersRefresh(t){const e=Math.random()*N.MAX_TIMEOUT,i=this.scene;null!==i&&setTimeout((()=>{this.customers=this.customers.filter((t=>!t.isKilled()));const e=this.customers.filter((t=>!t.productAssigned()));if(e.length<N.MAX_WAITING_CUSTOMERS){console.log("Adding customer.");const s=B.COFFEE,n=t.drawWidth-16,o=new j(n,s);for(let i=0;i<e.length;i++)e[i].goTo(t.drawWidth-64*(e.length-i));this.customers.push(o),i.add(o),this.pendingProducts.length>0&&o.goFetchItem(this.pendingProducts.pop())}this.scheduleCustomersRefresh(t)}),e)}onCollisionStart(t,e,i,s){const n=e.owner;if(!(n instanceof R))return;if(n.allocatedToCustomer)return;if(!n.item.getProductType)return;const o=n.item.getProductType(),r=this.customers.find((t=>!t.satisfied&&!t.productAssigned()&&t.desiredProductType==o));r?r.goFetchItem(n):(this.pendingProducts.push(n),setTimeout((()=>{this.pendingProducts.includes(n)&&!n.allocatedToCustomer&&(n.kill(),this.pendingProducts=this.pendingProducts.filter((t=>t!=n)))}),N.ITEM_TIMEOUT))}}N.HEIGHT=100,N.MAX_TIMEOUT=3e3,N.MAX_WAITING_CUSTOMERS=3,N.ITEM_TIMEOUT=5e3;class z{constructor(t,e){this.sizeInPixels=t,this.scene=e,this.handler=this.onScenePreDraw.bind(this),e.on("predraw",this.handler)}deactivate(){this.scene.off("predraw",this.handler)}onScenePreDraw(t){this.scene.camera.pos=this.sizeInPixels.scale(.5);const e=Math.min(window.innerWidth/this.sizeInPixels.x,window.innerHeight/this.sizeInPixels.y);this.scene.camera.zoom=e}}const V=3e5;class X extends s.Z58{constructor(t,e){super(),this.game=t,this.level=e,this.entityCounter=new s.JU7({text:""}),this.timeLabel=new s.JU7({text:"",pos:(0,s.t6s)(10,10)}),this.timePlayed=0,this.statistics={customersServed:0,customerLongestWait:0,pointsMax:0,pointsGained:0,recipesMade:0}}onInitialize(t){this.add(this.entityCounter),this.add(this.timeLabel);const e=new L(100,190);this.add(e),[new v(270,100,60,10),new v(400,120,60,10),new v(330,160,30,10),new v(200,150,30,10),new v(240,370,30,10,-Math.PI/5,s.Bpo.Fixed),new S(240,200,600,20)].forEach((t=>this.add(t))),[new $(270,80,30,new H),new $(400,100,30,new H)].forEach((t=>this.add(t)));const i=new O;this.add(i);const n=new E(240,180);this.add(n);const o=new M(240,300);this.add(o);const r=new D(480,350);this.add(r);const h=new C(100,80,50,o);this.add(h);const a=new N;this.add(a);const c=t.drawWidth,l=t.drawHeight,d=new s.Agj({pos:s.t6s(-10,l/2),width:20,height:l,collisionType:s.Bpo.Fixed,color:s.Q1f.Transparent}),p=new s.Agj({pos:s.t6s(c+10,l/2),width:20,height:l,collisionType:s.Bpo.Fixed,color:s.Q1f.Transparent}),g=new s.Agj({pos:s.t6s(c/2,-10),width:c,height:20,collisionType:s.Bpo.Fixed,color:s.Q1f.Transparent}),u=new s.Agj({pos:s.t6s(c/2,l+10),width:c,height:20,collisionType:s.Bpo.Fixed,color:s.Q1f.Transparent});this.add(d),this.add(p),this.add(g),this.add(u);let w=t.input.pointers.primary;w.on("down",(t=>{console.log("spawn");let e=new R(new H);e.pos=w.lastWorldPos.clone(),this.add(e)})),this.physics.config.gravity=(0,s.t6s)(0,250),new z((0,s.t6s)(480,480),this)}onPreDraw(t,e){this.entityCounter.text=`Entities: ${this.entities.length}`,this.timeLabel.text=`${Math.floor((V-this.timePlayed)/1e3)} s`}onPreUpdate(t,e){this.timePlayed+=e,this.timePlayed>=V&&(this.statistics.pointsMax=200,this.statistics.pointsGained=130,this.game.endLevel(this.statistics))}}class K{constructor(t,e,i,n,o=K.GREY,r=s.nOB.Center){const h=new s.EYj({text:n,font:new s.KQV({textAlign:r,baseAlign:s.vhs.Bottom,family:"Pixelify Sans",size:i,unit:s.yRQ.Px,color:o,smoothing:!1})});h.scale=(0,s.t6s)(1,1).scale(.1),this._actor=new s.Agj,this._actor.graphics.use(h),this.actor.pos=(0,s.t6s)(t+h.width/2,e)}get actor(){return this._actor}}K.WHITE=new s.Q1f(255,255,255),K.GREY=new s.Q1f(46,46,46),K.ORANGE=new s.Q1f(242,157,79);class J extends s.Z58{constructor(t,e,i){super(),this.game=t,this.level=e,this.levelId=i,this.height=180,this.width=180,this.scaler=new z((0,s.t6s)(this.width,this.height),this)}onInitialize(t){this.backgroundColor=new s.Q1f(216,185,157);const e=new s.Agj({x:this.width/2,y:this.height/4});e.graphics.add(P.Load.LevelTable.toSprite()),this.add(e),this.add(new K(this.width/2+2,58,56,`Level  ${this.levelId+1}`,K.WHITE).actor),this.add(new K(this.width/2,this.height/2+60,40,"Press [SPACE] to play",K.GREY).actor)}onPreUpdate(t,e){t.input.keyboard.wasPressed(s.D$R.Space)&&this.game.play()}onDeactivate(t){this.scaler.deactivate()}}class Z extends s.Z58{constructor(t){super(),this.game=t,this.height=180,this.width=180,this.scaler=new z((0,s.t6s)(this.width,this.height),this)}onInitialize(t){this.backgroundColor=new s.Q1f(216,185,157);const e=new s.Agj({x:this.width/2,y:this.height/4});e.graphics.add(P.Load.Logo.toSprite()),this.add(e),this.add(new K(this.width/2,this.height/2+20,56,"Your forest cafe awaits...\n Brew, Bake, Delight!").actor),this.add(new K(this.width/2,this.height/2+60,40,"Press [SPACE] to play").actor)}onPreUpdate(t,e){t.input.keyboard.wasPressed(s.D$R.Space)&&this.game.firstLevel()}onDeactivate(t){this.scaler.deactivate()}}class q extends s.Z58{constructor(t,e,i){super(),this.game=t,this.levelId=e,this.statistics=i;const n=i.pointsGained/i.pointsMax;this.starsGained=n<.33?1:n<.66?2:3,this.height=180,this.width=180,this.scaler=new z((0,s.t6s)(this.width,this.height),this)}onInitialize(t){this.backgroundColor=new s.Q1f(216,185,157);const e=new s.Agj({x:this.width/2,y:this.height/4});e.graphics.add(P.Load.LevelTable.toSprite()),this.add(e),this.add(new K(this.width/2+2,58,56,`Level  ${this.levelId+1}`,K.WHITE).actor);const i=1==this.starsGained?"Good start!":2==this.starsGained?"Well done!":"Barista Master <3";this.add(new K(this.width/2+2,78,56,i,K.GREY).actor);for(let t=1;t<=3;t++){const e=t<=this.starsGained?P.Load.StarGold:P.Load.StarGrey,i=new s.Agj({x:this.width/2+25*(t-2),y:this.height/2});i.graphics.add(e.toSprite()),this.add(i)}this.add(new K(this.width/2-17,115,35,`- Points: ${this.statistics.pointsGained}`,K.WHITE,s.nOB.Left).actor),this.add(new K(this.width/2-17,120,35,`- Customers served: ${this.statistics.customersServed}`,K.WHITE,s.nOB.Left).actor),this.add(new K(this.width/2-17,125,35,`- Longest wait: ${this.statistics.customerLongestWait} s`,K.WHITE,s.nOB.Left).actor),this.add(new K(this.width/2,150,40,"Press [T] to TRY AGAIN",K.GREY).actor),this.add(new K(this.width/2,160,40,"Press [N] to play NEXT LEVEL",K.GREY).actor)}onPreUpdate(t,e){t.input.keyboard.wasPressed(s.D$R.T)&&this.game.newLevel(!1),t.input.keyboard.wasPressed(s.D$R.N)&&this.game.newLevel(!0)}onDeactivate(t){this.scaler.deactivate()}}class tt extends s.N$8{constructor(){super({displayMode:s.q5Z.FillScreen,antialiasing:!1}),this.isShowDebug=!1,this.levels=[],this.curLevelId=0,this.debug.collider.boundsColor=s.Q1f.Red,this.debug.collider.showAll=!0}start(){this.debug.collider.showBounds=!0;const t=new s.aHM(Object.values(P.Load));return super.start(t)}restart(){this.goToScene("idle").then((()=>{this.removeScene(this.mainScene),this.play()}))}onStart(){this.addScene("start",new Z(this)),this.goToScene("start")}firstLevel(){this.curLevelId=0,this.addScene("intro",new J(this,this.levels[this.curLevelId],this.curLevelId)),this.goToScene("intro")}newLevel(t){t&&this.curLevelId++,this.curLevelId>=this.levels.length&&this.restart(),this.removeScene("intro"),this.addScene("intro",new J(this,this.levels[this.curLevelId],this.curLevelId)),this.goToScene("intro")}endLevel(t){this.addScene("outro",new q(this,this.curLevelId,t)),this.goToScene("outro")}play(){this.mainScene=new X(this,{maxPoints:100}),this.addScene("idle",new s.Z58),this.addScene("main",this.mainScene),this.goToScene("main")}onPreUpdate(t,e){t.input.keyboard.wasPressed(s.D$R.R)&&this.restart(),t.input.keyboard.wasPressed(s.D$R.F4)&&(this.isShowDebug=!this.isShowDebug,this.showDebug(this.isShowDebug))}}const et=new tt;et.start().then((()=>{et.onStart()}))}},i={};function s(t){var n=i[t];if(void 0!==n)return n.exports;var o=i[t]={exports:{}};return e[t](o,o.exports,s),o.exports}s.m=e,t=[],s.O=(e,i,n,o)=>{if(!i){var r=1/0;for(l=0;l<t.length;l++){for(var[i,n,o]=t[l],h=!0,a=0;a<i.length;a++)(!1&o||r>=o)&&Object.keys(s.O).every((t=>s.O[t](i[a])))?i.splice(a--,1):(h=!1,o<r&&(r=o));if(h){t.splice(l--,1);var c=n();void 0!==c&&(e=c)}}return e}o=o||0;for(var l=t.length;l>0&&t[l-1][2]>o;l--)t[l]=t[l-1];t[l]=[i,n,o]},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=i[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{var t={792:0};s.O.j=e=>0===t[e];var e=(e,i)=>{var n,o,[r,h,a]=i,c=0;if(r.some((e=>0!==t[e]))){for(n in h)s.o(h,n)&&(s.m[n]=h[n]);if(a)var l=a(s)}for(e&&e(i);c<r.length;c++)o=r[c],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(l)},i=self.webpackChunkexcalibur_webpack=self.webpackChunkexcalibur_webpack||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var n=s.O(void 0,[128],(()=>s(905)));n=s.O(n)})();
//# sourceMappingURL=main.js.map