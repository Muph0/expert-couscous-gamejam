{"version":3,"file":"128.js","mappings":"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AK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,GAAI,IAAM,GACVC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,GAAI,IAAM,EACVC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,GAAI,IAAM,GACVC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IA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","sources":["webpack://excalibur-webpack/./node_modules/excalibur/build/esm/excalibur.js"],"sourcesContent":["/*!\n * excalibur - 0.29.3 - 2024-5-5\n * https://github.com/excaliburjs/Excalibur\n * Copyright (c) 2024 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>\n * Licensed BSD-2-Clause\n * @preserve\n */\n/******/ var __webpack_modules__ = ({\n\n/***/ 8851:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2001);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(935);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./Director/Loader.css\"],\"names\":[],\"mappings\":\"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF\",\"sourcesContent\":[\"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 4296:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2001);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(935);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\r\n#ex-toast-container {\r\n  position: absolute;\r\n  height: 0;\r\n  min-width: 50%;\r\n  left: 50%;\r\n  top: 0;\r\n}\r\n\r\n.ex-toast-message {\r\n  left: -50%;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n\r\n  padding: 10px;\r\n  margin-top: 5px;\r\n  font-size: 18px;\r\n  font-family: sans-serif;\r\n  border-radius: 6px;\r\n  border: 3px solid #b7b779;\r\n  background-color: rgb(253, 253, 192);\r\n}\r\n\r\n\r\n.ex-toast-message button {\r\n  align-self: flex-start;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./Util/Toaster.css\"],\"names\":[],\"mappings\":\";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB\",\"sourcesContent\":[\"\\r\\n#ex-toast-container {\\r\\n  position: absolute;\\r\\n  height: 0;\\r\\n  min-width: 50%;\\r\\n  left: 50%;\\r\\n  top: 0;\\r\\n}\\r\\n\\r\\n.ex-toast-message {\\r\\n  left: -50%;\\r\\n  position: relative;\\r\\n  display: flex;\\r\\n  justify-content: space-between;\\r\\n\\r\\n\\r\\n  padding: 10px;\\r\\n  margin-top: 5px;\\r\\n  font-size: 18px;\\r\\n  font-family: sans-serif;\\r\\n  border-radius: 6px;\\r\\n  border: 3px solid #b7b779;\\r\\n  background-color: rgb(253, 253, 192);\\r\\n}\\r\\n\\r\\n\\r\\n.ex-toast-message button {\\r\\n  align-self: flex-start;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 935:\n/***/ ((module) => {\n\n\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};\n\n/***/ }),\n\n/***/ 2001:\n/***/ ((module) => {\n\n\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};\n\n/***/ }),\n\n/***/ 9493:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n__webpack_require__(3975);\nvar entryUnbind = __webpack_require__(2564);\n\nmodule.exports = entryUnbind('Array', 'sort');\n\n\n/***/ }),\n\n/***/ 311:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n__webpack_require__(8291);\nvar path = __webpack_require__(9120);\n\nmodule.exports = path.Object.keys;\n\n\n/***/ }),\n\n/***/ 4977:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isCallable = __webpack_require__(4188);\nvar tryToString = __webpack_require__(3174);\n\nvar $TypeError = TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw new $TypeError(tryToString(argument) + ' is not a function');\n};\n\n\n/***/ }),\n\n/***/ 3770:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isObject = __webpack_require__(831);\n\nvar $String = String;\nvar $TypeError = TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw new $TypeError($String(argument) + ' is not an object');\n};\n\n\n/***/ }),\n\n/***/ 1458:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toIndexedObject = __webpack_require__(380);\nvar toAbsoluteIndex = __webpack_require__(675);\nvar lengthOfArrayLike = __webpack_require__(9389);\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    if (length === 0) return !IS_INCLUDES && -1;\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el !== el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value !== value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n\n\n/***/ }),\n\n/***/ 5397:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(5234);\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call -- required for testing\n    method.call(null, argument || function () { return 1; }, 1);\n  });\n};\n\n\n/***/ }),\n\n/***/ 7825:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\n\nmodule.exports = uncurryThis([].slice);\n\n\n/***/ }),\n\n/***/ 9295:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar arraySlice = __webpack_require__(7825);\n\nvar floor = Math.floor;\n\nvar sort = function (array, comparefn) {\n  var length = array.length;\n\n  if (length < 8) {\n    // insertion sort\n    var i = 1;\n    var element, j;\n\n    while (i < length) {\n      j = i;\n      element = array[i];\n      while (j && comparefn(array[j - 1], element) > 0) {\n        array[j] = array[--j];\n      }\n      if (j !== i++) array[j] = element;\n    }\n  } else {\n    // merge sort\n    var middle = floor(length / 2);\n    var left = sort(arraySlice(array, 0, middle), comparefn);\n    var right = sort(arraySlice(array, middle), comparefn);\n    var llength = left.length;\n    var rlength = right.length;\n    var lindex = 0;\n    var rindex = 0;\n\n    while (lindex < llength || rindex < rlength) {\n      array[lindex + rindex] = (lindex < llength && rindex < rlength)\n        ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n        : lindex < llength ? left[lindex++] : right[rindex++];\n    }\n  }\n\n  return array;\n};\n\nmodule.exports = sort;\n\n\n/***/ }),\n\n/***/ 8689:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n\n\n/***/ }),\n\n/***/ 5438:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar TO_STRING_TAG_SUPPORT = __webpack_require__(9345);\nvar isCallable = __webpack_require__(4188);\nvar classofRaw = __webpack_require__(8689);\nvar wellKnownSymbol = __webpack_require__(4282);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar $Object = Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) === 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = $Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) === 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n\n\n/***/ }),\n\n/***/ 8657:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar hasOwn = __webpack_require__(4418);\nvar ownKeys = __webpack_require__(3168);\nvar getOwnPropertyDescriptorModule = __webpack_require__(9304);\nvar definePropertyModule = __webpack_require__(4466);\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n\n\n/***/ }),\n\n/***/ 8088:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(6893);\nvar definePropertyModule = __webpack_require__(4466);\nvar createPropertyDescriptor = __webpack_require__(9123);\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n/***/ }),\n\n/***/ 9123:\n/***/ ((module) => {\n\n\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n/***/ }),\n\n/***/ 7509:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isCallable = __webpack_require__(4188);\nvar definePropertyModule = __webpack_require__(4466);\nvar makeBuiltIn = __webpack_require__(4530);\nvar defineGlobalProperty = __webpack_require__(4798);\n\nmodule.exports = function (O, key, value, options) {\n  if (!options) options = {};\n  var simple = options.enumerable;\n  var name = options.name !== undefined ? options.name : key;\n  if (isCallable(value)) makeBuiltIn(value, name, options);\n  if (options.global) {\n    if (simple) O[key] = value;\n    else defineGlobalProperty(key, value);\n  } else {\n    try {\n      if (!options.unsafe) delete O[key];\n      else if (O[key]) simple = true;\n    } catch (error) { /* empty */ }\n    if (simple) O[key] = value;\n    else definePropertyModule.f(O, key, {\n      value: value,\n      enumerable: false,\n      configurable: !options.nonConfigurable,\n      writable: !options.nonWritable\n    });\n  } return O;\n};\n\n\n/***/ }),\n\n/***/ 4798:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n\n\n/***/ }),\n\n/***/ 1305:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar tryToString = __webpack_require__(3174);\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (O, P) {\n  if (!delete O[P]) throw new $TypeError('Cannot delete property ' + tryToString(P) + ' of ' + tryToString(O));\n};\n\n\n/***/ }),\n\n/***/ 6893:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(5234);\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] !== 7;\n});\n\n\n/***/ }),\n\n/***/ 5926:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\nvar isObject = __webpack_require__(831);\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n\n\n/***/ }),\n\n/***/ 8807:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar userAgent = __webpack_require__(4109);\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n\n\n/***/ }),\n\n/***/ 5661:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar UA = __webpack_require__(4109);\n\nmodule.exports = /MSIE|Trident/.test(UA);\n\n\n/***/ }),\n\n/***/ 4109:\n/***/ ((module) => {\n\n\nmodule.exports = typeof navigator != 'undefined' && String(navigator.userAgent) || '';\n\n\n/***/ }),\n\n/***/ 3749:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\nvar userAgent = __webpack_require__(4109);\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n\n\n/***/ }),\n\n/***/ 3589:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar userAgent = __webpack_require__(4109);\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n\n\n/***/ }),\n\n/***/ 2564:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\nvar uncurryThis = __webpack_require__(6881);\n\nmodule.exports = function (CONSTRUCTOR, METHOD) {\n  return uncurryThis(global[CONSTRUCTOR].prototype[METHOD]);\n};\n\n\n/***/ }),\n\n/***/ 1274:\n/***/ ((module) => {\n\n\n// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n\n\n/***/ }),\n\n/***/ 5613:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\nvar getOwnPropertyDescriptor = (__webpack_require__(9304).f);\nvar createNonEnumerableProperty = __webpack_require__(8088);\nvar defineBuiltIn = __webpack_require__(7509);\nvar defineGlobalProperty = __webpack_require__(4798);\nvar copyConstructorProperties = __webpack_require__(8657);\nvar isForced = __webpack_require__(8489);\n\n/*\n  options.target         - name of the target object\n  options.global         - target is the global object\n  options.stat           - export as static methods of target\n  options.proto          - export as prototype methods of target\n  options.real           - real prototype method for the `pure` version\n  options.forced         - export even if the native feature is available\n  options.bind           - bind methods to the target, required for the `pure` version\n  options.wrap           - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe         - use the simple assignment of property instead of delete + defineProperty\n  options.sham           - add a flag to not completely full polyfills\n  options.enumerable     - export as enumerable property\n  options.dontCallGetSet - prevent calling a getter on target\n  options.name           - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || defineGlobalProperty(TARGET, {});\n  } else {\n    target = global[TARGET] && global[TARGET].prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.dontCallGetSet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    defineBuiltIn(target, key, sourceProperty, options);\n  }\n};\n\n\n/***/ }),\n\n/***/ 5234:\n/***/ ((module) => {\n\n\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n\n\n/***/ }),\n\n/***/ 9055:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(5234);\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-function-prototype-bind -- safe\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n\n\n/***/ }),\n\n/***/ 9944:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar NATIVE_BIND = __webpack_require__(9055);\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n\n\n/***/ }),\n\n/***/ 2735:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(6893);\nvar hasOwn = __webpack_require__(4418);\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n\n\n/***/ }),\n\n/***/ 6881:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar NATIVE_BIND = __webpack_require__(9055);\n\nvar FunctionPrototype = Function.prototype;\nvar call = FunctionPrototype.call;\nvar uncurryThisWithBind = NATIVE_BIND && FunctionPrototype.bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? uncurryThisWithBind : function (fn) {\n  return function () {\n    return call.apply(fn, arguments);\n  };\n};\n\n\n/***/ }),\n\n/***/ 5604:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\nvar isCallable = __webpack_require__(4188);\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n\n\n/***/ }),\n\n/***/ 2913:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar aCallable = __webpack_require__(4977);\nvar isNullOrUndefined = __webpack_require__(4318);\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return isNullOrUndefined(func) ? undefined : aCallable(func);\n};\n\n\n/***/ }),\n\n/***/ 1488:\n/***/ (function(module, __unused_webpack_exports, __webpack_require__) {\n\n\nvar check = function (it) {\n  return it && it.Math === Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof __webpack_require__.g == 'object' && __webpack_require__.g) ||\n  check(typeof this == 'object' && this) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n\n\n/***/ }),\n\n/***/ 4418:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\nvar toObject = __webpack_require__(3628);\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\n// eslint-disable-next-line es/no-object-hasown -- safe\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n\n\n/***/ }),\n\n/***/ 7588:\n/***/ ((module) => {\n\n\nmodule.exports = {};\n\n\n/***/ }),\n\n/***/ 9622:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(6893);\nvar fails = __webpack_require__(5234);\nvar createElement = __webpack_require__(5926);\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a !== 7;\n});\n\n\n/***/ }),\n\n/***/ 7568:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\nvar fails = __webpack_require__(5234);\nvar classof = __webpack_require__(8689);\n\nvar $Object = Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !$Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) === 'String' ? split(it, '') : $Object(it);\n} : $Object;\n\n\n/***/ }),\n\n/***/ 3029:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\nvar isCallable = __webpack_require__(4188);\nvar store = __webpack_require__(2694);\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n\n\n/***/ }),\n\n/***/ 3086:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar NATIVE_WEAK_MAP = __webpack_require__(5945);\nvar global = __webpack_require__(1488);\nvar isObject = __webpack_require__(831);\nvar createNonEnumerableProperty = __webpack_require__(8088);\nvar hasOwn = __webpack_require__(4418);\nvar shared = __webpack_require__(2694);\nvar sharedKey = __webpack_require__(168);\nvar hiddenKeys = __webpack_require__(7588);\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw new TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  /* eslint-disable no-self-assign -- prototype methods protection */\n  store.get = store.get;\n  store.has = store.has;\n  store.set = store.set;\n  /* eslint-enable no-self-assign -- prototype methods protection */\n  set = function (it, metadata) {\n    if (store.has(it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    store.set(it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return store.get(it) || {};\n  };\n  has = function (it) {\n    return store.has(it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n\n\n/***/ }),\n\n/***/ 4188:\n/***/ ((module) => {\n\n\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot\nvar documentAll = typeof document == 'object' && document.all;\n\n// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\n// eslint-disable-next-line unicorn/no-typeof-undefined -- required for testing\nmodule.exports = typeof documentAll == 'undefined' && documentAll !== undefined ? function (argument) {\n  return typeof argument == 'function' || argument === documentAll;\n} : function (argument) {\n  return typeof argument == 'function';\n};\n\n\n/***/ }),\n\n/***/ 8489:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(5234);\nvar isCallable = __webpack_require__(4188);\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value === POLYFILL ? true\n    : value === NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n\n\n/***/ }),\n\n/***/ 4318:\n/***/ ((module) => {\n\n\n// we can't use just `it == null` since of `document.all` special case\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot-aec\nmodule.exports = function (it) {\n  return it === null || it === undefined;\n};\n\n\n/***/ }),\n\n/***/ 831:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isCallable = __webpack_require__(4188);\n\nmodule.exports = function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n\n\n/***/ }),\n\n/***/ 1942:\n/***/ ((module) => {\n\n\nmodule.exports = false;\n\n\n/***/ }),\n\n/***/ 6032:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar getBuiltIn = __webpack_require__(5604);\nvar isCallable = __webpack_require__(4188);\nvar isPrototypeOf = __webpack_require__(4578);\nvar USE_SYMBOL_AS_UID = __webpack_require__(9809);\n\nvar $Object = Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, $Object(it));\n};\n\n\n/***/ }),\n\n/***/ 9389:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toLength = __webpack_require__(7611);\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n\n\n/***/ }),\n\n/***/ 4530:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\nvar fails = __webpack_require__(5234);\nvar isCallable = __webpack_require__(4188);\nvar hasOwn = __webpack_require__(4418);\nvar DESCRIPTORS = __webpack_require__(6893);\nvar CONFIGURABLE_FUNCTION_NAME = (__webpack_require__(2735).CONFIGURABLE);\nvar inspectSource = __webpack_require__(3029);\nvar InternalStateModule = __webpack_require__(3086);\n\nvar enforceInternalState = InternalStateModule.enforce;\nvar getInternalState = InternalStateModule.get;\nvar $String = String;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\nvar stringSlice = uncurryThis(''.slice);\nvar replace = uncurryThis(''.replace);\nvar join = uncurryThis([].join);\n\nvar CONFIGURABLE_LENGTH = DESCRIPTORS && !fails(function () {\n  return defineProperty(function () { /* empty */ }, 'length', { value: 8 }).length !== 8;\n});\n\nvar TEMPLATE = String(String).split('String');\n\nvar makeBuiltIn = module.exports = function (value, name, options) {\n  if (stringSlice($String(name), 0, 7) === 'Symbol(') {\n    name = '[' + replace($String(name), /^Symbol\\(([^)]*)\\).*$/, '$1') + ']';\n  }\n  if (options && options.getter) name = 'get ' + name;\n  if (options && options.setter) name = 'set ' + name;\n  if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n    if (DESCRIPTORS) defineProperty(value, 'name', { value: name, configurable: true });\n    else value.name = name;\n  }\n  if (CONFIGURABLE_LENGTH && options && hasOwn(options, 'arity') && value.length !== options.arity) {\n    defineProperty(value, 'length', { value: options.arity });\n  }\n  try {\n    if (options && hasOwn(options, 'constructor') && options.constructor) {\n      if (DESCRIPTORS) defineProperty(value, 'prototype', { writable: false });\n    // in V8 ~ Chrome 53, prototypes of some methods, like `Array.prototype.values`, are non-writable\n    } else if (value.prototype) value.prototype = undefined;\n  } catch (error) { /* empty */ }\n  var state = enforceInternalState(value);\n  if (!hasOwn(state, 'source')) {\n    state.source = join(TEMPLATE, typeof name == 'string' ? name : '');\n  } return value;\n};\n\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n// eslint-disable-next-line no-extend-native -- required\nFunction.prototype.toString = makeBuiltIn(function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n}, 'toString');\n\n\n/***/ }),\n\n/***/ 142:\n/***/ ((module) => {\n\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n// eslint-disable-next-line es/no-math-trunc -- safe\nmodule.exports = Math.trunc || function trunc(x) {\n  var n = +x;\n  return (n > 0 ? floor : ceil)(n);\n};\n\n\n/***/ }),\n\n/***/ 4466:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(6893);\nvar IE8_DOM_DEFINE = __webpack_require__(9622);\nvar V8_PROTOTYPE_DEFINE_BUG = __webpack_require__(3315);\nvar anObject = __webpack_require__(3770);\nvar toPropertyKey = __webpack_require__(2344);\n\nvar $TypeError = TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw new $TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n/***/ }),\n\n/***/ 9304:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(6893);\nvar call = __webpack_require__(9944);\nvar propertyIsEnumerableModule = __webpack_require__(4416);\nvar createPropertyDescriptor = __webpack_require__(9123);\nvar toIndexedObject = __webpack_require__(380);\nvar toPropertyKey = __webpack_require__(2344);\nvar hasOwn = __webpack_require__(4418);\nvar IE8_DOM_DEFINE = __webpack_require__(9622);\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n\n\n/***/ }),\n\n/***/ 5629:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\n\nvar internalObjectKeys = __webpack_require__(1843);\nvar enumBugKeys = __webpack_require__(1274);\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n\n\n/***/ }),\n\n/***/ 156:\n/***/ ((__unused_webpack_module, exports) => {\n\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n\n\n/***/ }),\n\n/***/ 4578:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n\n\n/***/ }),\n\n/***/ 1843:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\nvar hasOwn = __webpack_require__(4418);\nvar toIndexedObject = __webpack_require__(380);\nvar indexOf = (__webpack_require__(1458).indexOf);\nvar hiddenKeys = __webpack_require__(7588);\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 7137:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar internalObjectKeys = __webpack_require__(1843);\nvar enumBugKeys = __webpack_require__(1274);\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n\n\n/***/ }),\n\n/***/ 4416:\n/***/ ((__unused_webpack_module, exports) => {\n\n\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n\n\n/***/ }),\n\n/***/ 2287:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar call = __webpack_require__(9944);\nvar isCallable = __webpack_require__(4188);\nvar isObject = __webpack_require__(831);\n\nvar $TypeError = TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw new $TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/***/ }),\n\n/***/ 3168:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar getBuiltIn = __webpack_require__(5604);\nvar uncurryThis = __webpack_require__(6881);\nvar getOwnPropertyNamesModule = __webpack_require__(5629);\nvar getOwnPropertySymbolsModule = __webpack_require__(156);\nvar anObject = __webpack_require__(3770);\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n\n\n/***/ }),\n\n/***/ 9120:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\n\nmodule.exports = global;\n\n\n/***/ }),\n\n/***/ 9509:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isNullOrUndefined = __webpack_require__(4318);\n\nvar $TypeError = TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (isNullOrUndefined(it)) throw new $TypeError(\"Can't call method on \" + it);\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 168:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar shared = __webpack_require__(746);\nvar uid = __webpack_require__(6209);\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n\n\n/***/ }),\n\n/***/ 2694:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar IS_PURE = __webpack_require__(1942);\nvar globalThis = __webpack_require__(1488);\nvar defineGlobalProperty = __webpack_require__(4798);\n\nvar SHARED = '__core-js_shared__';\nvar store = module.exports = globalThis[SHARED] || defineGlobalProperty(SHARED, {});\n\n(store.versions || (store.versions = [])).push({\n  version: '3.36.1',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2014-2024 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n\n\n/***/ }),\n\n/***/ 746:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar store = __webpack_require__(2694);\n\nmodule.exports = function (key, value) {\n  return store[key] || (store[key] = value || {});\n};\n\n\n/***/ }),\n\n/***/ 8944:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = __webpack_require__(3749);\nvar fails = __webpack_require__(5234);\nvar global = __webpack_require__(1488);\n\nvar $String = global.String;\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol('symbol detection');\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  // nb: Do not call `String` directly to avoid this being optimized out to `symbol+''` which will,\n  // of course, fail.\n  return !$String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n\n\n/***/ }),\n\n/***/ 675:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toIntegerOrInfinity = __webpack_require__(6744);\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n\n\n/***/ }),\n\n/***/ 380:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = __webpack_require__(7568);\nvar requireObjectCoercible = __webpack_require__(9509);\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n\n\n/***/ }),\n\n/***/ 6744:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar trunc = __webpack_require__(142);\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return number !== number || number === 0 ? 0 : trunc(number);\n};\n\n\n/***/ }),\n\n/***/ 7611:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toIntegerOrInfinity = __webpack_require__(6744);\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  var len = toIntegerOrInfinity(argument);\n  return len > 0 ? min(len, 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n\n\n/***/ }),\n\n/***/ 3628:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar requireObjectCoercible = __webpack_require__(9509);\n\nvar $Object = Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return $Object(requireObjectCoercible(argument));\n};\n\n\n/***/ }),\n\n/***/ 290:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar call = __webpack_require__(9944);\nvar isObject = __webpack_require__(831);\nvar isSymbol = __webpack_require__(6032);\nvar getMethod = __webpack_require__(2913);\nvar ordinaryToPrimitive = __webpack_require__(2287);\nvar wellKnownSymbol = __webpack_require__(4282);\n\nvar $TypeError = TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw new $TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n\n\n/***/ }),\n\n/***/ 2344:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toPrimitive = __webpack_require__(290);\nvar isSymbol = __webpack_require__(6032);\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n\n\n/***/ }),\n\n/***/ 9345:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar wellKnownSymbol = __webpack_require__(4282);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n\n\n/***/ }),\n\n/***/ 2618:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar classof = __webpack_require__(5438);\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw new TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n\n\n/***/ }),\n\n/***/ 3174:\n/***/ ((module) => {\n\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  try {\n    return $String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n\n\n/***/ }),\n\n/***/ 6209:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(6881);\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n\n\n/***/ }),\n\n/***/ 9809:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = __webpack_require__(8944);\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n\n\n/***/ }),\n\n/***/ 3315:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(6893);\nvar fails = __webpack_require__(5234);\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype !== 42;\n});\n\n\n/***/ }),\n\n/***/ 5945:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\nvar isCallable = __webpack_require__(4188);\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(String(WeakMap));\n\n\n/***/ }),\n\n/***/ 4282:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(1488);\nvar shared = __webpack_require__(746);\nvar hasOwn = __webpack_require__(4418);\nvar uid = __webpack_require__(6209);\nvar NATIVE_SYMBOL = __webpack_require__(8944);\nvar USE_SYMBOL_AS_UID = __webpack_require__(9809);\n\nvar Symbol = global.Symbol;\nvar WellKnownSymbolsStore = shared('wks');\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol['for'] || Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name)) {\n    WellKnownSymbolsStore[name] = NATIVE_SYMBOL && hasOwn(Symbol, name)\n      ? Symbol[name]\n      : createWellKnownSymbol('Symbol.' + name);\n  } return WellKnownSymbolsStore[name];\n};\n\n\n/***/ }),\n\n/***/ 3975:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $ = __webpack_require__(5613);\nvar uncurryThis = __webpack_require__(6881);\nvar aCallable = __webpack_require__(4977);\nvar toObject = __webpack_require__(3628);\nvar lengthOfArrayLike = __webpack_require__(9389);\nvar deletePropertyOrThrow = __webpack_require__(1305);\nvar toString = __webpack_require__(2618);\nvar fails = __webpack_require__(5234);\nvar internalSort = __webpack_require__(9295);\nvar arrayMethodIsStrict = __webpack_require__(5397);\nvar FF = __webpack_require__(8807);\nvar IE_OR_EDGE = __webpack_require__(5661);\nvar V8 = __webpack_require__(3749);\nvar WEBKIT = __webpack_require__(3589);\n\nvar test = [];\nvar nativeSort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort(array) : nativeSort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = lengthOfArrayLike(items);\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) deletePropertyOrThrow(array, index++);\n\n    return array;\n  }\n});\n\n\n/***/ }),\n\n/***/ 8291:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $ = __webpack_require__(5613);\nvar toObject = __webpack_require__(3628);\nvar nativeKeys = __webpack_require__(7137);\nvar fails = __webpack_require__(5234);\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n\n\n/***/ })\n\n/******/ });\n/************************************************************************/\n/******/ // The module cache\n/******/ var __webpack_module_cache__ = {};\n/******/ \n/******/ // The require function\n/******/ function __webpack_require__(moduleId) {\n/******/ \t// Check if module is in cache\n/******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \tif (cachedModule !== undefined) {\n/******/ \t\treturn cachedModule.exports;\n/******/ \t}\n/******/ \t// Create a new module (and put it into the cache)\n/******/ \tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\tid: moduleId,\n/******/ \t\t// no module.loaded needed\n/******/ \t\texports: {}\n/******/ \t};\n/******/ \n/******/ \t// Execute the module function\n/******/ \t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/ \n/******/ \t// Return the exports of the module\n/******/ \treturn module.exports;\n/******/ }\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/compat get default export */\n/******/ (() => {\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = (module) => {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\t() => (module['default']) :\n/******/ \t\t\t() => (module);\n/******/ \t\t__webpack_require__.d(getter, { a: getter });\n/******/ \t\treturn getter;\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/global */\n/******/ (() => {\n/******/ \t__webpack_require__.g = (function() {\n/******/ \t\tif (typeof globalThis === 'object') return globalThis;\n/******/ \t\ttry {\n/******/ \t\t\treturn this || new Function('return this')();\n/******/ \t\t} catch (e) {\n/******/ \t\t\tif (typeof window === 'object') return window;\n/******/ \t\t}\n/******/ \t})();\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/make namespace object */\n/******/ (() => {\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = (exports) => {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/ })();\n/******/ \n/************************************************************************/\nvar __webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n(() => {\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  eKr: () => (/* reexport */ ActionCompleteEvent),\n  yVm: () => (/* reexport */ ActionContext),\n  a7j: () => (/* reexport */ ActionQueue),\n  U_w: () => (/* reexport */ ActionSequence),\n  JF2: () => (/* reexport */ ActionStartEvent),\n  htg: () => (/* reexport */ ActionsComponent),\n  HXL: () => (/* reexport */ ActionsSystem),\n  mcg: () => (/* reexport */ ActivateEvent),\n  Agj: () => (/* reexport */ Actor),\n  u6S: () => (/* reexport */ AddedComponent),\n  x7M: () => (/* reexport */ AffineMatrix),\n  X55: () => (/* reexport */ Animation),\n  m3M: () => (/* reexport */ AnimationDirection),\n  aE5: () => (/* reexport */ AnimationEvents),\n  YJU: () => (/* reexport */ AnimationStrategy),\n  eZi: () => (/* reexport */ ArcadeSolver),\n  GNv: () => (/* reexport */ AudioContextFactory),\n  Y56: () => (/* reexport */ Axes),\n  _0v: () => (/* reexport */ Axis),\n  vhs: () => (/* reexport */ BaseAlign),\n  Z8b: () => (/* reexport */ Blink),\n  Yfw: () => (/* reexport */ BodyComponent),\n  IcQ: () => (/* reexport */ BoundingBox),\n  Rl2: () => (/* reexport */ BroadphaseStrategy),\n  kgJ: () => (/* reexport */ BrowserComponent),\n  GTT: () => (/* reexport */ BrowserEvents),\n  ypY: () => (/* reexport */ Buttons),\n  i7d: () => (/* reexport */ Camera),\n  fQ3: () => (/* reexport */ CameraEvents),\n  HlI: () => (/* reexport */ Canvas),\n  jlt: () => (/* reexport */ Circle),\n  VQc: () => (/* reexport */ CircleCollider),\n  zD7: () => (/* reexport */ Clock),\n  I0I: () => (/* reexport */ ClosestLine),\n  AUF: () => (/* reexport */ ClosestLineJumpTable),\n  JoF: () => (/* reexport */ Collider),\n  MlA: () => (/* reexport */ ColliderComponent),\n  PZh: () => (/* reexport */ CollisionContact),\n  qA: () => (/* reexport */ CollisionEndEvent),\n  CrD: () => (/* reexport */ CollisionGroup),\n  dQK: () => (/* reexport */ CollisionGroupManager),\n  D3r: () => (/* reexport */ CollisionJumpTable),\n  Qpo: () => (/* reexport */ CollisionPostSolveEvent),\n  D9n: () => (/* reexport */ CollisionPreSolveEvent),\n  b6v: () => (/* reexport */ CollisionStartEvent),\n  mvh: () => (/* reexport */ CollisionSystem),\n  Bpo: () => (/* reexport */ CollisionType),\n  Q1f: () => (/* reexport */ Color),\n  IKv: () => (/* reexport */ ColorBlindFlags),\n  fcV: () => (/* reexport */ ColorBlindnessMode),\n  Glf: () => (/* reexport */ ColorBlindnessPostProcessor),\n  uAl: () => (/* reexport */ Component),\n  ElT: () => (/* reexport */ CompositeCollider),\n  MPu: () => (/* reexport */ Configurable),\n  Z8r: () => (/* reexport */ ConsoleAppender),\n  QSL: () => (/* reexport */ ContactConstraintPoint),\n  sPV: () => (/* reexport */ ContactEndEvent),\n  nAn: () => (/* reexport */ ContactSolveBias),\n  zCU: () => (/* reexport */ ContactStartEvent),\n  QrV: () => (/* reexport */ CoordPlane),\n  fF9: () => (/* reexport */ CrossFade),\n  xI8: () => (/* reexport */ DeactivateEvent),\n  yar: () => (/* reexport */ Debug),\n  SP7: () => (/* reexport */ DebugConfig),\n  oRy: () => (/* reexport */ DebugGraphicsComponent),\n  f5X: () => (/* reexport */ DebugSystem),\n  V1c: () => (/* reexport */ DebugText),\n  Mlx: () => (/* reexport */ DefaultAntialiasOptions),\n  ZCo: () => (/* reexport */ DefaultLoader),\n  Vy3: () => (/* reexport */ DefaultPhysicsConfig),\n  J5p: () => (/* reexport */ DefaultPixelArtOptions),\n  mL_: () => (/* reexport */ DegreeOfFreedom),\n  Guw: () => (/* reexport */ Delay),\n  VKx: () => (/* reexport */ DeprecatedStaticToConfig),\n  N5j: () => (/* reexport */ Detector),\n  pgY: () => (/* reexport */ Die),\n  OP3: () => (/* reexport */ Direction),\n  rl5: () => (/* reexport */ Director),\n  eod: () => (/* reexport */ DirectorEvents),\n  q5Z: () => (/* reexport */ DisplayMode),\n  YUC: () => (/* reexport */ DynamicTree),\n  saR: () => (/* reexport */ DynamicTreeCollisionProcessor),\n  hvr: () => (/* binding */ EX_VERSION),\n  Qol: () => (/* reexport */ EaseBy),\n  Wf4: () => (/* reexport */ EaseTo),\n  JCs: () => (/* reexport */ EasingFunctions),\n  gJV: () => (/* reexport */ EdgeCollider),\n  fWD: () => (/* reexport */ ElasticToActorStrategy),\n  Va_: () => (/* reexport */ EmitterType),\n  N$8: () => (/* reexport */ Engine),\n  _jQ: () => (/* reexport */ EngineEvents),\n  rxj: () => (/* reexport */ EnterTriggerEvent),\n  rhv: () => (/* reexport */ EnterViewPortEvent),\n  wCu: () => (/* reexport */ Entity),\n  HAp: () => (/* reexport */ EntityEvents),\n  Zy1: () => (/* reexport */ EntityManager),\n  Qev: () => (/* reexport */ EventDispatcher),\n  bkB: () => (/* reexport */ EventEmitter),\n  wfL: () => (/* reexport */ EventTypes),\n  sVA: () => (/* reexport */ Events_namespaceObject),\n  $Gs: () => (/* reexport */ ExResponse),\n  CJ0: () => (/* reexport */ ExcaliburGraphicsContext2DCanvas),\n  NWh: () => (/* reexport */ ExcaliburGraphicsContextWebGL),\n  tWi: () => (/* reexport */ ExitTriggerEvent),\n  xAj: () => (/* reexport */ ExitViewPortEvent),\n  zWh: () => (/* reexport */ Fade),\n  i_4: () => (/* reexport */ FadeInOut),\n  iIx: () => (/* reexport */ Flags),\n  c9e: () => (/* reexport */ Follow),\n  KQV: () => (/* reexport */ Font),\n  weH: () => (/* reexport */ FontCache),\n  jXp: () => (/* reexport */ FontSource),\n  zzY: () => (/* reexport */ FontStyle),\n  yRQ: () => (/* reexport */ FontUnit),\n  MtE: () => (/* reexport */ FpsSampler),\n  rPj: () => (/* reexport */ FrameStats),\n  KLc: () => (/* reexport */ Future),\n  Fir: () => (/* reexport */ GameEvent),\n  V5f: () => (/* reexport */ GameStartEvent),\n  Xj7: () => (/* reexport */ GameStopEvent),\n  Wud: () => (/* reexport */ Gamepad),\n  FVg: () => (/* reexport */ GamepadAxisEvent),\n  g5Y: () => (/* reexport */ GamepadButtonEvent),\n  YQB: () => (/* reexport */ GamepadConnectEvent),\n  KPb: () => (/* reexport */ GamepadDisconnectEvent),\n  nHK: () => (/* reexport */ Gamepads),\n  TX_: () => (/* reexport */ Gif),\n  r3n: () => (/* reexport */ GlobalCoordinates),\n  vYh: () => (/* reexport */ Graphic),\n  hnk: () => (/* reexport */ GraphicsComponent),\n  D2R: () => (/* reexport */ GraphicsGroup),\n  n1o: () => (/* reexport */ GraphicsSystem),\n  RLG: () => (/* reexport */ HiddenEvent),\n  fBU: () => (/* reexport */ HorizontalFirst),\n  Adb: () => (/* reexport */ ImageFiltering),\n  bEs: () => (/* reexport */ ImageSource),\n  wCy: () => (/* reexport */ ImageSourceAttributeConstants),\n  CbD: () => (/* reexport */ ImageWrapping),\n  x_C: () => (/* reexport */ InitializeEvent),\n  pde: () => (/* reexport */ Input_Index_namespaceObject),\n  pGf: () => (/* reexport */ InputHost),\n  ibQ: () => (/* reexport */ InputMapper),\n  QlN: () => (/* reexport */ Integrator),\n  shR: () => (/* reexport */ IsometricEntityComponent),\n  Yjk: () => (/* reexport */ IsometricEntitySystem),\n  _u1: () => (/* reexport */ IsometricMap),\n  OBI: () => (/* reexport */ IsometricTile),\n  klh: () => (/* reexport */ KeyEvent),\n  s3S: () => (/* reexport */ Keyboard),\n  D$R: () => (/* reexport */ Keys),\n  xth: () => (/* reexport */ KillEvent),\n  JU7: () => (/* reexport */ Label),\n  h9x: () => (/* reexport */ LimitCameraBoundsStrategy),\n  N1A: () => (/* reexport */ Line),\n  e_k: () => (/* reexport */ LineSegment),\n  aHM: () => (/* reexport */ Loader),\n  tlv: () => (/* reexport */ LoaderEvents),\n  Vi9: () => (/* reexport */ LockCameraToActorAxisStrategy),\n  ieR: () => (/* reexport */ LockCameraToActorStrategy),\n  $bb: () => (/* reexport */ LogLevel),\n  VyI: () => (/* reexport */ Logger),\n  imn: () => (/* reexport */ Material),\n  uqu: () => (/* reexport */ Matrix),\n  QnL: () => (/* reexport */ MatrixLocations),\n  vnc: () => (/* reexport */ MediaEvent),\n  wk_: () => (/* reexport */ Meet),\n  GH0: () => (/* reexport */ MotionComponent),\n  _1r: () => (/* reexport */ MotionSystem),\n  l0X: () => (/* reexport */ MoveBy),\n  HHX: () => (/* reexport */ MoveTo),\n  tjk: () => (/* reexport */ NativePointerButton),\n  rWe: () => (/* reexport */ NativeSoundEvent),\n  j9l: () => (/* reexport */ NativeSoundProcessedEvent),\n  NVp: () => (/* reexport */ None),\n  cPK: () => (/* reexport */ Observable),\n  XoL: () => (/* reexport */ OffscreenSystem),\n  RmF: () => (/* reexport */ Pair),\n  DXI: () => (/* reexport */ ParallaxComponent),\n  tCD: () => (/* reexport */ ParallelActions),\n  oGn: () => (/* reexport */ ParseGif),\n  J3D: () => (/* reexport */ Particle),\n  vCJ: () => (/* reexport */ ParticleEmitter),\n  f9l: () => (/* reexport */ ParticleTransform),\n  AQx: () => (/* reexport */ Physics),\n  v9m: () => (/* reexport */ PhysicsStats),\n  yRJ: () => (/* reexport */ PhysicsWorld),\n  EU6: () => (/* reexport */ PointerAbstraction),\n  m3O: () => (/* reexport */ PointerButton),\n  Ryz: () => (/* reexport */ PointerComponent),\n  OxP: () => (/* reexport */ PointerEvent),\n  LEs: () => (/* reexport */ PointerEventReceiver),\n  Ec: () => (/* reexport */ PointerScope),\n  Pi5: () => (/* reexport */ PointerSystem),\n  gmH: () => (/* reexport */ PointerType),\n  tS: () => (/* reexport */ Polygon),\n  XxX: () => (/* reexport */ PolygonCollider),\n  bCz: () => (/* reexport */ Pool),\n  nYS: () => (/* reexport */ PostCollisionEvent),\n  yiT: () => (/* reexport */ PostDebugDrawEvent),\n  NHl: () => (/* reexport */ PostDrawEvent),\n  mO8: () => (/* reexport */ PostFrameEvent),\n  PXI: () => (/* reexport */ PostKillEvent),\n  bn5: () => (/* reexport */ PostTransformDrawEvent),\n  Ywr: () => (/* reexport */ PostUpdateEvent),\n  cMd: () => (/* reexport */ PreCollisionEvent),\n  Bs6: () => (/* reexport */ PreDebugDrawEvent),\n  G0k: () => (/* reexport */ PreDrawEvent),\n  pyn: () => (/* reexport */ PreFrameEvent),\n  QeM: () => (/* reexport */ PreKillEvent),\n  aPX: () => (/* reexport */ PreLoadEvent),\n  ITP: () => (/* reexport */ PreTransformDrawEvent),\n  BY0: () => (/* reexport */ PreUpdateEvent),\n  MFw: () => (/* reexport */ Projection),\n  sBn: () => (/* reexport */ QuadIndexBuffer),\n  S3L: () => (/* reexport */ QuadTree),\n  XKQ: () => (/* reexport */ Query),\n  ESI: () => (/* reexport */ QueryManager),\n  uxz: () => (/* reexport */ RadiusAroundActorStrategy),\n  o8N: () => (/* reexport */ Random),\n  u_r: () => (/* reexport */ Raster),\n  RlV: () => (/* reexport */ Ray),\n  gVA: () => (/* reexport */ RealisticSolver),\n  M_G: () => (/* reexport */ Rectangle),\n  GRB: () => (/* reexport */ RemovedComponent),\n  kM6: () => (/* reexport */ Repeat),\n  dO8: () => (/* reexport */ RepeatForever),\n  jgM: () => (/* reexport */ Resolution),\n  FWq: () => (/* reexport */ Resource),\n  s3j: () => (/* reexport */ ResourceEvents),\n  hlw: () => (/* reexport */ RotateBy),\n  B7e: () => (/* reexport */ RotateTo),\n  H_X: () => (/* reexport */ RotationType),\n  S_d: () => (/* reexport */ ScaleBy),\n  U7E: () => (/* reexport */ ScaleTo),\n  Z58: () => (/* reexport */ Scene),\n  yh2: () => (/* reexport */ SceneEvents),\n  ff$: () => (/* reexport */ Screen),\n  cWi: () => (/* reexport */ ScreenAppender),\n  NBt: () => (/* reexport */ ScreenElement),\n  oNz: () => (/* reexport */ ScreenEvents),\n  QlU: () => (/* reexport */ ScreenShader),\n  Xey: () => (/* reexport */ ScrollPreventionMode),\n  jft: () => (/* reexport */ Semaphore),\n  Mtr: () => (/* reexport */ Shader),\n  ypk: () => (/* reexport */ Shape),\n  mnM: () => (/* reexport */ Side),\n  bAZ: () => (/* reexport */ SolverStrategy),\n  ABN: () => (/* reexport */ Sound),\n  VK6: () => (/* reexport */ SoundEvents),\n  kxk: () => (/* reexport */ Sprite),\n  DT1: () => (/* reexport */ SpriteFont),\n  FLG: () => (/* reexport */ SpriteSheet),\n  qN_: () => (/* reexport */ StandardClock),\n  Z37: () => (/* reexport */ StateMachine),\n  FtL: () => (/* reexport */ StrategyContainer),\n  Z6X: () => (/* reexport */ Stream),\n  iQT: () => (/* reexport */ System),\n  ziO: () => (/* reexport */ SystemManager),\n  OEF: () => (/* reexport */ SystemPriority),\n  uuE: () => (/* reexport */ SystemType),\n  tiv: () => (/* reexport */ TagQuery),\n  T$Y: () => (/* reexport */ TestClock),\n  EYj: () => (/* reexport */ Text),\n  nOB: () => (/* reexport */ TextAlign),\n  Tap: () => (/* reexport */ TextureLoader),\n  FAs: () => (/* reexport */ Tile),\n  B_P: () => (/* reexport */ TileMap),\n  aA5: () => (/* reexport */ TileMapEvents),\n  M4G: () => (/* reexport */ Timer),\n  l$l: () => (/* reexport */ Toaster),\n  dLy: () => (/* reexport */ transform_Transform),\n  WZP: () => (/* reexport */ TransformComponent),\n  eB6: () => (/* reexport */ Transition),\n  nFK: () => (/* reexport */ TreeNode),\n  l9z: () => (/* reexport */ Trigger),\n  YOF: () => (/* reexport */ TriggerEvents),\n  yhB: () => (/* reexport */ TwoPI),\n  J0N: () => (/* reexport */ Util_Index_namespaceObject),\n  Miz: () => (/* reexport */ Vector),\n  Bj4: () => (/* reexport */ VectorView),\n  Rcs: () => (/* reexport */ VertexBuffer),\n  vJ4: () => (/* reexport */ VertexLayout),\n  TqC: () => (/* reexport */ VerticalFirst),\n  nM0: () => (/* reexport */ VisibleEvent),\n  X1u: () => (/* reexport */ WebAudio),\n  SpZ: () => (/* reexport */ WebAudioInstance),\n  DX8: () => (/* reexport */ WheelDeltaMode),\n  Yx$: () => (/* reexport */ WheelEvent),\n  HK4: () => (/* reexport */ World),\n  SE$: () => (/* reexport */ canonicalizeAngle),\n  qE8: () => (/* reexport */ clamp),\n  Pz7: () => (/* reexport */ coroutine),\n  sX_: () => (/* reexport */ createId),\n  JuI: () => (/* reexport */ frac),\n  Nl$: () => (/* reexport */ hasGraphicsTick),\n  OwT: () => (/* reexport */ hasOnInitialize),\n  P$G: () => (/* reexport */ hasOnPostUpdate),\n  mHV: () => (/* reexport */ hasOnPreUpdate),\n  Fx_: () => (/* reexport */ hasPostDraw),\n  WFC: () => (/* reexport */ hasPreDraw),\n  aDq: () => (/* reexport */ has_initialize),\n  jIg: () => (/* reexport */ has_postupdate),\n  UH3: () => (/* reexport */ has_preupdate),\n  K6X: () => (/* reexport */ isAddedComponent),\n  C1Y: () => (/* reexport */ isComponentCtor),\n  Aw1: () => (/* reexport */ isLoaderConstructor),\n  A8$: () => (/* reexport */ isRemovedComponent),\n  hsx: () => (/* reexport */ isSceneConstructor),\n  l9E: () => (/* reexport */ isScreenElement),\n  aSf: () => (/* reexport */ isSystemConstructor),\n  Zex: () => (/* reexport */ maxMessages),\n  mXP: () => (/* reexport */ obsolete),\n  vt$: () => (/* reexport */ parseImageFiltering),\n  hCA: () => (/* reexport */ parseImageWrapping),\n  pjR: () => (/* reexport */ pixelSnapEpsilon),\n  U43: () => (/* reexport */ randomInRange),\n  pSZ: () => (/* reexport */ randomIntInRange),\n  y17: () => (/* reexport */ range),\n  jVr: () => (/* reexport */ resetObsoleteCounter),\n  _SZ: () => (/* reexport */ sign),\n  xWn: () => (/* reexport */ toDegrees),\n  ehJ: () => (/* reexport */ toRadians),\n  t6s: () => (/* reexport */ vec),\n  Eyn: () => (/* reexport */ webgl_util_namespaceObject)\n});\n\n// NAMESPACE OBJECT: ./Graphics/Context/webgl-util.ts\nvar webgl_util_namespaceObject = {};\n__webpack_require__.r(webgl_util_namespaceObject);\n__webpack_require__.d(webgl_util_namespaceObject, {\n  getAttributeComponentSize: () => (getAttributeComponentSize),\n  getAttributePointerType: () => (getAttributePointerType),\n  getGLTypeFromSource: () => (getGLTypeFromSource),\n  getGlTypeSizeBytes: () => (getGlTypeSizeBytes),\n  isAttributeInSource: () => (isAttributeInSource)\n});\n\n// NAMESPACE OBJECT: ./Events.ts\nvar Events_namespaceObject = {};\n__webpack_require__.r(Events_namespaceObject);\n__webpack_require__.d(Events_namespaceObject, {\n  ActionCompleteEvent: () => (ActionCompleteEvent),\n  ActionStartEvent: () => (ActionStartEvent),\n  ActivateEvent: () => (ActivateEvent),\n  CollisionEndEvent: () => (CollisionEndEvent),\n  CollisionPostSolveEvent: () => (CollisionPostSolveEvent),\n  CollisionPreSolveEvent: () => (CollisionPreSolveEvent),\n  CollisionStartEvent: () => (CollisionStartEvent),\n  ContactEndEvent: () => (ContactEndEvent),\n  ContactStartEvent: () => (ContactStartEvent),\n  DeactivateEvent: () => (DeactivateEvent),\n  EnterTriggerEvent: () => (EnterTriggerEvent),\n  EnterViewPortEvent: () => (EnterViewPortEvent),\n  EventTypes: () => (EventTypes),\n  ExitTriggerEvent: () => (ExitTriggerEvent),\n  ExitViewPortEvent: () => (ExitViewPortEvent),\n  GameEvent: () => (GameEvent),\n  GameStartEvent: () => (GameStartEvent),\n  GameStopEvent: () => (GameStopEvent),\n  GamepadAxisEvent: () => (GamepadAxisEvent),\n  GamepadButtonEvent: () => (GamepadButtonEvent),\n  GamepadConnectEvent: () => (GamepadConnectEvent),\n  GamepadDisconnectEvent: () => (GamepadDisconnectEvent),\n  HiddenEvent: () => (HiddenEvent),\n  InitializeEvent: () => (InitializeEvent),\n  KillEvent: () => (KillEvent),\n  PostCollisionEvent: () => (PostCollisionEvent),\n  PostDebugDrawEvent: () => (PostDebugDrawEvent),\n  PostDrawEvent: () => (PostDrawEvent),\n  PostFrameEvent: () => (PostFrameEvent),\n  PostKillEvent: () => (PostKillEvent),\n  PostTransformDrawEvent: () => (PostTransformDrawEvent),\n  PostUpdateEvent: () => (PostUpdateEvent),\n  PreCollisionEvent: () => (PreCollisionEvent),\n  PreDebugDrawEvent: () => (PreDebugDrawEvent),\n  PreDrawEvent: () => (PreDrawEvent),\n  PreFrameEvent: () => (PreFrameEvent),\n  PreKillEvent: () => (PreKillEvent),\n  PreTransformDrawEvent: () => (PreTransformDrawEvent),\n  PreUpdateEvent: () => (PreUpdateEvent),\n  VisibleEvent: () => (VisibleEvent)\n});\n\n// NAMESPACE OBJECT: ./Util/DrawUtil.ts\nvar DrawUtil_namespaceObject = {};\n__webpack_require__.r(DrawUtil_namespaceObject);\n__webpack_require__.d(DrawUtil_namespaceObject, {\n  circle: () => (circle),\n  line: () => (line),\n  point: () => (point),\n  roundRect: () => (roundRect),\n  vector: () => (vector)\n});\n\n// NAMESPACE OBJECT: ./Input/Index.ts\nvar Input_Index_namespaceObject = {};\n__webpack_require__.r(Input_Index_namespaceObject);\n__webpack_require__.d(Input_Index_namespaceObject, {\n  Axes: () => (Axes),\n  Buttons: () => (Buttons),\n  Gamepad: () => (Gamepad),\n  Gamepads: () => (Gamepads),\n  KeyEvent: () => (KeyEvent),\n  Keyboard: () => (Keyboard),\n  Keys: () => (Keys),\n  NativePointerButton: () => (NativePointerButton),\n  PointerButton: () => (PointerButton),\n  PointerComponent: () => (PointerComponent),\n  PointerEvent: () => (PointerEvent),\n  PointerEventReceiver: () => (PointerEventReceiver),\n  PointerScope: () => (PointerScope),\n  PointerSystem: () => (PointerSystem),\n  PointerType: () => (PointerType),\n  WheelDeltaMode: () => (WheelDeltaMode),\n  WheelEvent: () => (WheelEvent)\n});\n\n// NAMESPACE OBJECT: ./Util/Index.ts\nvar Util_Index_namespaceObject = {};\n__webpack_require__.r(Util_Index_namespaceObject);\n__webpack_require__.d(Util_Index_namespaceObject, {\n  ConsoleAppender: () => (ConsoleAppender),\n  DrawUtil: () => (DrawUtil_namespaceObject),\n  EasingFunctions: () => (EasingFunctions),\n  LogLevel: () => (LogLevel),\n  Logger: () => (Logger),\n  Observable: () => (Observable),\n  ScreenAppender: () => (ScreenAppender),\n  addItemToArray: () => (addItemToArray),\n  contains: () => (contains),\n  delay: () => (delay),\n  fail: () => (fail),\n  getPosition: () => (getPosition),\n  omit: () => (omit),\n  removeItemFromArray: () => (removeItemFromArray)\n});\n\n// EXTERNAL MODULE: ../../node_modules/core-js/es/array/sort.js\nvar sort = __webpack_require__(9493);\n// EXTERNAL MODULE: ../../node_modules/core-js/es/object/keys.js\nvar keys = __webpack_require__(311);\n;// CONCATENATED MODULE: ./Polyfill.ts\n\n\n/**\n * Polyfill adding function\n */\nfunction polyfill() {\n    /* istanbul ignore next */\n    if (typeof window === 'undefined') {\n        window = {\n            audioContext: function () {\n                return;\n            }\n        };\n    }\n    /* istanbul ignore next */\n    if (typeof window !== 'undefined' && !window.requestAnimationFrame) {\n        window.requestAnimationFrame =\n            window.webkitRequestAnimationFrame ||\n                window.mozRequestAnimationFrame ||\n                function (callback) {\n                    window.setInterval(callback, 1000 / 60);\n                };\n    }\n    /* istanbul ignore next */\n    if (typeof window !== 'undefined' && !window.cancelAnimationFrame) {\n        window.cancelAnimationFrame =\n            window.webkitCancelAnimationFrame ||\n                window.mozCancelAnimationFrame ||\n                function () {\n                    return;\n                };\n    }\n    /* istanbul ignore next */\n    if (typeof window !== 'undefined' && !window.AudioContext) {\n        if (window.webkitAudioContext) {\n            const ctx = window.webkitAudioContext;\n            const replaceMe = ctx.prototype.decodeAudioData;\n            window.webkitAudioContext.prototype.decodeAudioData = function (arrayBuffer) {\n                return new Promise((resolve, reject) => {\n                    replaceMe.call(this, arrayBuffer, resolve, reject);\n                });\n            };\n        }\n        window.AudioContext =\n            window.AudioContext ||\n                window.webkitAudioContext ||\n                window.mozAudioContext ||\n                window.msAudioContext ||\n                window.oAudioContext;\n    }\n    /* istanbul ignore next */\n    if (typeof window !== 'undefined' && !window.devicePixelRatio) {\n        window.devicePixelRatio = window.devicePixelRatio || 1;\n    }\n}\n\n;// CONCATENATED MODULE: ./Flags.ts\n/**\n * Flags is a feature flag implementation for Excalibur. They can only be operated **before [[Engine]] construction**\n * after which they are frozen and are read-only.\n *\n * Flags are used to enable experimental or preview features in Excalibur.\n */\nclass Flags {\n    /**\n     * Force excalibur to load the Canvas 2D graphics context fallback\n     * @warning not all features of excalibur are supported in the Canvas 2D fallback\n     */\n    static useCanvasGraphicsContext() {\n        Flags.enable('use-canvas-context');\n    }\n    /**\n     * Freeze all flag modifications making them readonly\n     */\n    static freeze() {\n        Flags._FROZEN = true;\n    }\n    /**\n     * Resets internal flag state, not meant to be called by users. Only used for testing.\n     *\n     * Calling this in your game is UNSUPPORTED\n     * @internal\n     */\n    static _reset() {\n        Flags._FROZEN = false;\n        Flags._FLAGS = {};\n    }\n    /**\n     * Enable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\n     * @param flagName\n     */\n    static enable(flagName) {\n        if (this._FROZEN) {\n            throw Error('Feature flags can only be enabled before Engine constructor time');\n        }\n        Flags._FLAGS[flagName] = true;\n    }\n    /**\n     * Disable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\n     * @param flagName\n     */\n    static disable(flagName) {\n        if (this._FROZEN) {\n            throw Error('Feature flags can only be disabled before Engine constructor time');\n        }\n        Flags._FLAGS[flagName] = false;\n    }\n    /**\n     * Check if a flag is enabled. If the flag is disabled or does not exist `false` is returned\n     * @param flagName\n     */\n    static isEnabled(flagName) {\n        return !!Flags._FLAGS[flagName];\n    }\n    /**\n     * Show a list of currently known flags\n     */\n    static show() {\n        return Object.keys(Flags._FLAGS);\n    }\n}\nFlags._FROZEN = false;\nFlags._FLAGS = {};\n\n;// CONCATENATED MODULE: ./Id.ts\n/**\n * Create a branded ID type from a number\n */\nfunction createId(type, value) {\n    return { type, value };\n}\n;\n\n;// CONCATENATED MODULE: ./Util/Future.ts\n/**\n * Future is a wrapper around a native browser Promise to allow resolving/rejecting at any time\n */\nclass Future {\n    constructor() {\n        this._isCompleted = false;\n        this.promise = new Promise((resolve, reject) => {\n            this._resolver = resolve;\n            this._rejecter = reject;\n        });\n    }\n    get isCompleted() {\n        return this._isCompleted;\n    }\n    resolve(value) {\n        if (this._isCompleted) {\n            return;\n        }\n        this._isCompleted = true;\n        this._resolver(value);\n    }\n    reject(error) {\n        if (this._isCompleted) {\n            return;\n        }\n        this._isCompleted = true;\n        this._rejecter(error);\n    }\n}\n\n;// CONCATENATED MODULE: ./EventEmitter.ts\n/**\n * Excalibur's typed event emitter, this allows events to be sent with any string to Type mapping\n */\nclass EventEmitter {\n    constructor() {\n        this._paused = false;\n        this._listeners = {};\n        this._listenersOnce = {};\n        this._pipes = [];\n    }\n    clear() {\n        this._listeners = {};\n        this._listenersOnce = {};\n        this._pipes.length = 0;\n    }\n    on(eventName, handler) {\n        var _a;\n        this._listeners[eventName] = (_a = this._listeners[eventName]) !== null && _a !== void 0 ? _a : [];\n        this._listeners[eventName].push(handler);\n        return {\n            close: () => this.off(eventName, handler)\n        };\n    }\n    once(eventName, handler) {\n        var _a;\n        this._listenersOnce[eventName] = (_a = this._listenersOnce[eventName]) !== null && _a !== void 0 ? _a : [];\n        this._listenersOnce[eventName].push(handler);\n        return {\n            close: () => this.off(eventName, handler)\n        };\n    }\n    off(eventName, handler) {\n        var _a, _b;\n        if (handler) {\n            const newListeners = (_a = this._listeners[eventName]) === null || _a === void 0 ? void 0 : _a.filter(h => h !== handler);\n            this._listeners[eventName] = newListeners;\n            const newOnceListeners = (_b = this._listenersOnce[eventName]) === null || _b === void 0 ? void 0 : _b.filter(h => h !== handler);\n            this._listenersOnce[eventName] = newOnceListeners;\n        }\n        else {\n            delete this._listeners[eventName];\n        }\n    }\n    emit(eventName, event) {\n        var _a;\n        if (this._paused) {\n            return;\n        }\n        (_a = this._listeners[eventName]) === null || _a === void 0 ? void 0 : _a.forEach((fn) => fn(event));\n        const onces = this._listenersOnce[eventName];\n        this._listenersOnce[eventName] = [];\n        if (onces) {\n            onces.forEach((fn) => fn(event));\n        }\n        this._pipes.forEach((pipe) => {\n            pipe.emit(eventName, event);\n        });\n    }\n    pipe(emitter) {\n        if (this === emitter) {\n            throw Error('Cannot pipe to self');\n        }\n        this._pipes.push(emitter);\n        return {\n            close: () => {\n                const i = this._pipes.indexOf(emitter);\n                if (i > -1) {\n                    this._pipes.splice(i, 1);\n                }\n            }\n        };\n    }\n    unpipe(emitter) {\n        const i = this._pipes.indexOf(emitter);\n        if (i > -1) {\n            this._pipes.splice(i, 1);\n        }\n    }\n    pause() {\n        this._paused = true;\n    }\n    unpause() {\n        this._paused = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/PointerScope.ts\n/**\n * Determines the scope of handling mouse/touch events.\n */\nvar PointerScope;\n(function (PointerScope) {\n    /**\n     * Handle events on the `canvas` element only. Events originating outside the\n     * `canvas` will not be handled.\n     */\n    PointerScope[\"Canvas\"] = \"Canvas\";\n    /**\n     * Handles events on the entire document. All events will be handled by Excalibur.\n     */\n    PointerScope[\"Document\"] = \"Document\";\n})(PointerScope || (PointerScope = {}));\n\n;// CONCATENATED MODULE: ./Math/Random.ts\n/**\n * @module\n * Pseudo-Random Utility\n *\n * A pseudo-random utility to add seeded random support for help in\n * generating things like terrain or reproducible randomness. Uses the\n * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.\n */\n/**\n * 32-bit mask\n */\nconst BITMASK32 = 0xffffffff;\n/**\n * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence\n * of numbers each time it is called.\n * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.\n * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html\n *\n * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs\n */\nclass Random {\n    /**\n     * If no seed is specified, the Date.now() is used\n     */\n    constructor(seed) {\n        this.seed = seed;\n        // Separation point of one one word, the number of bits in the lower bitmask 0 <= r <= w-1\n        this._lowerMask = 0x7fffffff; // 31 bits same as _r\n        this._upperMask = 0x80000000; // 34 high bits\n        // Word size, 64 bits\n        this._w = 32;\n        // Degree of recurrence\n        this._n = 624;\n        // Middle word, an offset used in the recurrence defining the series x, 1<=m<n\n        this._m = 397;\n        // coefficients of teh rational normal form twist matrix\n        this._a = 0x9908b0df;\n        // tempering bit shifts and masks\n        this._u = 11;\n        this._s = 7;\n        this._b = 0x9d2c5680;\n        this._t = 15;\n        this._c = 0xefc60000;\n        this._l = 18;\n        this._f = 1812433253;\n        this._mt = new Array(this._n);\n        // need to mask to support higher bit machines\n        this._mt[0] = (seed || Date.now()) >>> 0;\n        for (let i = 1; i < this._n; i++) {\n            const s = this._mt[i - 1] ^ (this._mt[i - 1] >>> (this._w - 2));\n            // numbers are bigger than the JS max safe int, add in 16-bit chunks to prevent IEEE rounding errors on high bits\n            this._mt[i] = (((this._f * ((s & 0xffff0000) >>> 16)) << 16) + this._f * (s & 0xffff) + i) >>> 0;\n        }\n        this._index = this._n;\n    }\n    /**\n     * Apply the twist\n     */\n    _twist() {\n        const mag01 = [0x0, this._a];\n        let y = 0, i = 0;\n        for (; i < this._n - this._m; i++) {\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\n            this._mt[i] = this._mt[i + this._m] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n        }\n        for (; i < this._n - 1; i++) {\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\n            this._mt[i] = this._mt[i + (this._m - this._n)] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n        }\n        y = (this._mt[this._n - 1] & this._upperMask) | (this._mt[0] & this._lowerMask);\n        this._mt[this._n - 1] = this._mt[this._m - 1] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n        this._index = 0;\n    }\n    /**\n     * Return next 32 bit integer number in sequence\n     */\n    nextInt() {\n        if (this._index >= this._n) {\n            this._twist();\n        }\n        let y = this._mt[this._index++];\n        y ^= y >>> this._u;\n        y ^= (y << this._s) & this._b;\n        y ^= (y << this._t) & this._c;\n        y ^= y >>> this._l;\n        return y >>> 0;\n    }\n    /**\n     * Return a random floating point number between [0, 1)\n     */\n    next() {\n        return this.nextInt() * (1.0 / 4294967296.0); // divided by 2^32\n    }\n    /**\n     * Return a random floating point in range [min, max) min is included, max is not included\n     */\n    floating(min, max) {\n        return (max - min) * this.next() + min;\n    }\n    /**\n     * Return a random integer in range [min, max] min is included, max is included.\n     * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a\n     */\n    integer(min, max) {\n        return Math.floor((max - min + 1) * this.next() + min);\n    }\n    /**\n     * Returns true or false randomly with 50/50 odds by default.\n     * By default the likelihood of returning a true is .5 (50%).\n     * @param likelihood takes values between [0, 1]\n     */\n    bool(likelihood = 0.5) {\n        return this.next() <= likelihood;\n    }\n    /**\n     * Returns one element from an array at random\n     */\n    pickOne(array) {\n        return array[this.integer(0, array.length - 1)];\n    }\n    /**\n     * Returns a new array random picking elements from the original\n     * @param array Original array to pick from\n     * @param numPicks can be any positive number\n     * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates\n     * just that it is possible)\n     */\n    pickSet(array, numPicks, allowDuplicates = false) {\n        if (allowDuplicates) {\n            return this._pickSetWithDuplicates(array, numPicks);\n        }\n        else {\n            return this._pickSetWithoutDuplicates(array, numPicks);\n        }\n    }\n    /**\n     * Returns a new array randomly picking elements in the original (not reused)\n     * @param array Array to pick elements out of\n     * @param numPicks must be less than or equal to the number of elements in the array.\n     */\n    _pickSetWithoutDuplicates(array, numPicks) {\n        if (numPicks > array.length || numPicks < 0) {\n            throw new Error('Invalid number of elements to pick, must pick a value 0 < n <= length');\n        }\n        if (numPicks === array.length) {\n            return array;\n        }\n        const result = new Array(numPicks);\n        let currentPick = 0;\n        const tempArray = array.slice(0);\n        while (currentPick < numPicks) {\n            const index = this.integer(0, tempArray.length - 1);\n            result[currentPick++] = tempArray[index];\n            tempArray.splice(index, 1);\n        }\n        return result;\n    }\n    /**\n     * Returns a new array random picking elements from the original allowing duplicates\n     * @param array Array to pick elements out of\n     * @param numPicks can be any positive number\n     */\n    _pickSetWithDuplicates(array, numPicks) {\n        // Typescript numbers are all floating point, so do we add check for int? (or floor the input?)\n        if (numPicks < 0) {\n            throw new Error('Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT');\n        }\n        const result = new Array(numPicks);\n        for (let i = 0; i < numPicks; i++) {\n            result[i] = this.pickOne(array);\n        }\n        return result;\n    }\n    /**\n     * Returns a new array that has its elements shuffled. Using the Fisher/Yates method\n     * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\n     */\n    shuffle(array) {\n        const tempArray = array.slice(0);\n        let swap = null;\n        for (let i = 0; i < tempArray.length - 2; i++) {\n            const randomIndex = this.integer(i, tempArray.length - 1);\n            swap = tempArray[i];\n            tempArray[i] = tempArray[randomIndex];\n            tempArray[randomIndex] = swap;\n        }\n        return tempArray;\n    }\n    /**\n     * Generate a list of random integer numbers\n     * @param length the length of the final array\n     * @param min the minimum integer number to generate inclusive\n     * @param max the maximum integer number to generate inclusive\n     */\n    range(length, min, max) {\n        const result = new Array(length);\n        for (let i = 0; i < length; i++) {\n            result[i] = this.integer(min, max);\n        }\n        return result;\n    }\n    /**\n     * Returns the result of a d4 dice roll\n     */\n    d4() {\n        return this.integer(1, 4);\n    }\n    /**\n     * Returns the result of a d6 dice roll\n     */\n    d6() {\n        return this.integer(1, 6);\n    }\n    /**\n     * Returns the result of a d8 dice roll\n     */\n    d8() {\n        return this.integer(1, 8);\n    }\n    /**\n     * Returns the result of a d10 dice roll\n     */\n    d10() {\n        return this.integer(1, 10);\n    }\n    /**\n     * Returns the result of a d12 dice roll\n     */\n    d12() {\n        return this.integer(1, 12);\n    }\n    /**\n     * Returns the result of a d20 dice roll\n     */\n    d20() {\n        return this.integer(1, 20);\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/util.ts\n\n/**\n * Two PI constant\n */\nconst TwoPI = Math.PI * 2;\n/**\n * Returns the fractional part of a number\n * @param x\n */\nfunction frac(x) {\n    if (x >= 0) {\n        return x - Math.floor(x);\n    }\n    else {\n        return x - Math.ceil(x);\n    }\n}\n/**\n * Returns the sign of a number, if 0 returns 0\n */\nfunction sign(val) {\n    if (val === 0) {\n        return 0;\n    }\n    return val < 0 ? -1 : 1;\n}\n;\n/**\n * Clamps a value between a min and max inclusive\n */\nfunction clamp(val, min, max) {\n    return Math.min(Math.max(min, val), max);\n}\n/**\n * Convert an angle to be the equivalent in the range [0, 2PI]\n */\nfunction canonicalizeAngle(angle) {\n    let tmpAngle = angle;\n    if (angle > TwoPI) {\n        while (tmpAngle > TwoPI) {\n            tmpAngle -= TwoPI;\n        }\n    }\n    if (angle < 0) {\n        while (tmpAngle < 0) {\n            tmpAngle += TwoPI;\n        }\n    }\n    return tmpAngle;\n}\n/**\n * Convert radians to degrees\n */\nfunction toDegrees(radians) {\n    return (180 / Math.PI) * radians;\n}\n/**\n * Convert degrees to radians\n */\nfunction toRadians(degrees) {\n    return (degrees / 180) * Math.PI;\n}\n/**\n * Generate a range of numbers\n * For example: range(0, 5) -> [0, 1, 2, 3, 4, 5]\n * @param from inclusive\n * @param to inclusive\n */\nconst range = (from, to) => Array.from(new Array(to - from + 1), (_x, i) => i + from);\n/**\n * Find a random floating point number in range\n */\nfunction randomInRange(min, max, random = new Random()) {\n    return random ? random.floating(min, max) : min + Math.random() * (max - min);\n}\n/**\n * Find a random integer in a range\n */\nfunction randomIntInRange(min, max, random = new Random()) {\n    return random ? random.integer(min, max) : Math.round(randomInRange(min, max));\n}\n\n;// CONCATENATED MODULE: ./Math/vector.ts\n\n/**\n * A 2D vector on a plane.\n */\nclass Vector {\n    /**\n     * A (0, 0) vector\n     */\n    static get Zero() {\n        return new Vector(0, 0);\n    }\n    /**\n     * A (1, 1) vector\n     */\n    static get One() {\n        return new Vector(1, 1);\n    }\n    /**\n     * A (0.5, 0.5) vector\n     */\n    static get Half() {\n        return new Vector(0.5, 0.5);\n    }\n    /**\n     * A unit vector pointing up (0, -1)\n     */\n    static get Up() {\n        return new Vector(0, -1);\n    }\n    /**\n     * A unit vector pointing down (0, 1)\n     */\n    static get Down() {\n        return new Vector(0, 1);\n    }\n    /**\n     * A unit vector pointing left (-1, 0)\n     */\n    static get Left() {\n        return new Vector(-1, 0);\n    }\n    /**\n     * A unit vector pointing right (1, 0)\n     */\n    static get Right() {\n        return new Vector(1, 0);\n    }\n    /**\n     * Returns a vector of unit length in the direction of the specified angle in Radians.\n     * @param angle The angle to generate the vector\n     */\n    static fromAngle(angle) {\n        return new Vector(Math.cos(angle), Math.sin(angle));\n    }\n    /**\n     * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.\n     */\n    static isValid(vec) {\n        if (vec === null || vec === undefined) {\n            return false;\n        }\n        if (isNaN(vec.x) || isNaN(vec.y)) {\n            return false;\n        }\n        if (vec.x === Infinity || vec.y === Infinity || vec.x === -Infinity || vec.y === -Infinity) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Calculates distance between two Vectors\n     * @param vec1\n     * @param vec2\n     */\n    static distance(vec1, vec2) {\n        return Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\n    }\n    static min(vec1, vec2) {\n        return new Vector(Math.min(vec1.x, vec2.x), Math.min(vec1.y, vec2.y));\n    }\n    static max(vec1, vec2) {\n        return new Vector(Math.max(vec1.x, vec2.x), Math.max(vec1.y, vec2.y));\n    }\n    /**\n     * @param x  X component of the Vector\n     * @param y  Y component of the Vector\n     */\n    constructor(x, y) {\n        this._x = 0;\n        this._y = 0;\n        this._x = x;\n        this._y = y;\n    }\n    /**\n     * Get the x component of the vector\n     */\n    get x() {\n        return this._x;\n    }\n    /**\n     * Set the x component, THIS MUTATES the current vector. It is usually better to create a new vector.\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\n     */\n    set x(val) {\n        this._x = val;\n    }\n    /**\n     * Get the y component of the vector\n     */\n    get y() {\n        return this._y;\n    }\n    /**\n     * Set the y component, THIS MUTATES the current vector. It is usually better to create a new vector.\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\n     */\n    set y(val) {\n        this._y = val;\n    }\n    /**\n     * Sets the x and y components at once, THIS MUTATES the current vector. It is usually better to create a new vector.\n     * @warning **Be very careful using this, mutating vectors can cause hard to find bugs**\n     */\n    setTo(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    /**\n     * Compares this point against another and tests for equality\n     * @param vector The other point to compare to\n     * @param tolerance Amount of euclidean distance off we are willing to tolerate\n     */\n    equals(vector, tolerance = Vector.EQUALS_EPSILON) {\n        return Math.abs(this.x - vector.x) <= tolerance && Math.abs(this.y - vector.y) <= tolerance;\n    }\n    /**\n     * The distance to another vector. If no other Vector is specified, this will return the [[magnitude]].\n     * @param v  The other vector. Leave blank to use origin vector.\n     */\n    distance(v) {\n        if (!v) {\n            return Math.sqrt(this.x * this.x + this.y * this.y);\n        }\n        const deltaX = this.x - v.x;\n        const deltaY = this.y - v.y;\n        return Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n    }\n    squareDistance(v) {\n        if (!v) {\n            v = Vector.Zero;\n        }\n        const deltaX = this.x - v.x;\n        const deltaY = this.y - v.y;\n        return deltaX * deltaX + deltaY * deltaY;\n    }\n    /**\n     * Clamps the current vector's magnitude mutating it\n     * @param magnitude\n     */\n    clampMagnitude(magnitude) {\n        const size = this.size;\n        const newSize = clamp(size, 0, magnitude);\n        this.size = newSize;\n        return this;\n    }\n    /**\n     * The size (magnitude) of the Vector\n     */\n    get size() {\n        return this.distance();\n    }\n    /**\n     * Setting the size mutates the current vector\n     * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**\n     */\n    set size(newLength) {\n        const v = this.normalize().scale(newLength);\n        this.setTo(v.x, v.y);\n    }\n    /**\n     * Normalizes a vector to have a magnitude of 1.\n     */\n    normalize() {\n        const d = this.distance();\n        if (d > 0) {\n            return new Vector(this.x / d, this.y / d);\n        }\n        else {\n            return new Vector(0, 1);\n        }\n    }\n    /**\n     * Returns the average (midpoint) between the current point and the specified\n     */\n    average(vec) {\n        return this.add(vec).scale(0.5);\n    }\n    scale(sizeOrScale, dest) {\n        const result = dest || new Vector(0, 0);\n        if (sizeOrScale instanceof Vector) {\n            result.x = this.x * sizeOrScale.x;\n            result.y = this.y * sizeOrScale.y;\n        }\n        else {\n            result.x = this.x * sizeOrScale;\n            result.y = this.y * sizeOrScale;\n        }\n        return result;\n    }\n    /**\n     * Adds one vector to another\n     * @param v The vector to add\n     * @param dest Optionally copy the result into a provided vector\n     */\n    add(v, dest) {\n        if (dest) {\n            dest.x = this.x + v.x;\n            dest.y = this.y + v.y;\n            return dest;\n        }\n        return new Vector(this.x + v.x, this.y + v.y);\n    }\n    /**\n     * Subtracts a vector from another, if you subtract vector `B.sub(A)` the resulting vector points from A -> B\n     * @param v The vector to subtract\n     */\n    sub(v) {\n        return new Vector(this.x - v.x, this.y - v.y);\n    }\n    /**\n     * Adds one vector to this one modifying the original\n     * @param v The vector to add\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\n     */\n    addEqual(v) {\n        this.setTo(this.x + v.x, this.y + v.y);\n        return this;\n    }\n    /**\n     * Subtracts a vector from this one modifying the original\n     * @param v The vector to subtract\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\n     */\n    subEqual(v) {\n        this.setTo(this.x - v.x, this.y - v.y);\n        return this;\n    }\n    /**\n     * Scales this vector by a factor of size and modifies the original\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\n     */\n    scaleEqual(size) {\n        this.setTo(this.x * size, this.y * size);\n        return this;\n    }\n    /**\n     * Performs a dot product with another vector\n     * @param v  The vector to dot\n     */\n    dot(v) {\n        return this.x * v.x + this.y * v.y;\n    }\n    cross(v) {\n        if (v instanceof Vector) {\n            return this.x * v.y - this.y * v.x;\n        }\n        else if (typeof v === 'number') {\n            return new Vector(v * this.y, -v * this.x);\n        }\n    }\n    static cross(num, vec) {\n        return new Vector(-num * vec.y, num * vec.x);\n    }\n    /**\n     * Returns the perpendicular vector to this one\n     */\n    perpendicular() {\n        return new Vector(this.y, -this.x);\n    }\n    /**\n     * Returns the normal vector to this one, same as the perpendicular of length 1\n     */\n    normal() {\n        return this.perpendicular().normalize();\n    }\n    /**\n     * Negate the current vector\n     */\n    negate() {\n        return this.scale(-1);\n    }\n    /**\n     * Returns the angle of this vector.\n     */\n    toAngle() {\n        return canonicalizeAngle(Math.atan2(this.y, this.x));\n    }\n    /**\n     * Rotates the current vector around a point by a certain angle in radians.\n     */\n    rotate(angle, anchor) {\n        if (!anchor) {\n            anchor = new Vector(0, 0);\n        }\n        const sinAngle = Math.sin(angle);\n        const cosAngle = Math.cos(angle);\n        const x = cosAngle * (this.x - anchor.x) - sinAngle * (this.y - anchor.y) + anchor.x;\n        const y = sinAngle * (this.x - anchor.x) + cosAngle * (this.y - anchor.y) + anchor.y;\n        return new Vector(x, y);\n    }\n    /**\n     * Creates new vector that has the same values as the previous.\n     */\n    clone(dest) {\n        const v = dest !== null && dest !== void 0 ? dest : new Vector(0, 0);\n        v.x = this.x;\n        v.y = this.y;\n        return v;\n    }\n    /**\n     * Returns a string representation of the vector.\n     */\n    toString(fixed) {\n        if (fixed) {\n            return `(${this.x.toFixed(fixed)}, ${this.y.toFixed(fixed)})`;\n        }\n        return `(${this.x}, ${this.y})`;\n    }\n}\n/**\n * Get or set the vector equals epsilon, by default 0.001 meaning vectors within that tolerance on x or y will be considered equal.\n */\nVector.EQUALS_EPSILON = .001;\n/**\n * Shorthand for creating new Vectors - returns a new Vector instance with the\n * provided X and Y components.\n * @param x  X component of the Vector\n * @param y  Y component of the Vector\n */\nfunction vec(x, y) {\n    return new Vector(x, y);\n}\n\n;// CONCATENATED MODULE: ./Color.ts\n/**\n * Provides standard colors (e.g. [[Color.Black]])\n * but you can also create custom colors using RGB, HSL, or Hex. Also provides\n * useful color operations like [[Color.lighten]], [[Color.darken]], and more.\n */\nclass Color {\n    /**\n     * Creates a new instance of Color from an r, g, b, a\n     * @param r  The red component of color (0-255)\n     * @param g  The green component of color (0-255)\n     * @param b  The blue component of color (0-255)\n     * @param a  The alpha component of color (0-1.0)\n     */\n    constructor(r, g, b, a) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n        this.a = a != null ? a : 1;\n    }\n    /**\n     * Creates a new instance of Color from an r, g, b, a\n     * @param r  The red component of color (0-255)\n     * @param g  The green component of color (0-255)\n     * @param b  The blue component of color (0-255)\n     * @param a  The alpha component of color (0-1.0)\n     */\n    static fromRGB(r, g, b, a) {\n        return new Color(r, g, b, a);\n    }\n    /**\n     * Creates a new instance of Color from a rgb string\n     * @param string  CSS color string of the form rgba(255, 255, 255, 1) or rgb(255, 255, 255)\n     */\n    static fromRGBString(string) {\n        const rgbaRegEx = /^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)/i;\n        let match = null;\n        if ((match = string.match(rgbaRegEx))) {\n            const r = parseInt(match[1], 10);\n            const g = parseInt(match[2], 10);\n            const b = parseInt(match[3], 10);\n            let a = 1;\n            if (match[4]) {\n                a = parseFloat(match[4]);\n            }\n            return new Color(r, g, b, a);\n        }\n        else {\n            throw new Error('Invalid rgb/a string: ' + string);\n        }\n    }\n    /**\n     * Creates a new instance of Color from a hex string\n     * @param hex  CSS color string of the form #ffffff, the alpha component is optional\n     */\n    static fromHex(hex) {\n        const hexRegEx = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;\n        let match = null;\n        if ((match = hex.match(hexRegEx))) {\n            const r = parseInt(match[1], 16);\n            const g = parseInt(match[2], 16);\n            const b = parseInt(match[3], 16);\n            let a = 1;\n            if (match[4]) {\n                a = parseInt(match[4], 16) / 255;\n            }\n            return new Color(r, g, b, a);\n        }\n        else {\n            throw new Error('Invalid hex string: ' + hex);\n        }\n    }\n    /**\n     * Creates a new instance of Color from hsla values\n     * @param h  Hue is represented [0-1]\n     * @param s  Saturation is represented [0-1]\n     * @param l  Luminance is represented [0-1]\n     * @param a  Alpha is represented [0-1]\n     */\n    static fromHSL(h, s, l, a = 1.0) {\n        const temp = new HSLColor(h, s, l, a);\n        return temp.toRGBA();\n    }\n    /**\n     * Lightens the current color by a specified amount\n     * @param factor  The amount to lighten by [0-1]\n     */\n    lighten(factor = 0.1) {\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n        temp.l += (1 - temp.l) * factor;\n        return temp.toRGBA();\n    }\n    /**\n     * Darkens the current color by a specified amount\n     * @param factor  The amount to darken by [0-1]\n     */\n    darken(factor = 0.1) {\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n        temp.l -= temp.l * factor;\n        return temp.toRGBA();\n    }\n    /**\n     * Saturates the current color by a specified amount\n     * @param factor  The amount to saturate by [0-1]\n     */\n    saturate(factor = 0.1) {\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n        temp.s += temp.s * factor;\n        return temp.toRGBA();\n    }\n    /**\n     * Desaturates the current color by a specified amount\n     * @param factor  The amount to desaturate by [0-1]\n     */\n    desaturate(factor = 0.1) {\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n        temp.s -= temp.s * factor;\n        return temp.toRGBA();\n    }\n    /**\n     * Multiplies a color by another, results in a darker color\n     * @param color  The other color\n     */\n    multiply(color) {\n        const newR = (((color.r / 255) * this.r) / 255) * 255;\n        const newG = (((color.g / 255) * this.g) / 255) * 255;\n        const newB = (((color.b / 255) * this.b) / 255) * 255;\n        const newA = color.a * this.a;\n        return new Color(newR, newG, newB, newA);\n    }\n    /**\n     * Screens a color by another, results in a lighter color\n     * @param color  The other color\n     */\n    screen(color) {\n        const color1 = color.invert();\n        const color2 = color.invert();\n        return color1.multiply(color2).invert();\n    }\n    /**\n     * Inverts the current color\n     */\n    invert() {\n        return new Color(255 - this.r, 255 - this.g, 255 - this.b, 1.0 - this.a);\n    }\n    /**\n     * Averages the current color with another\n     * @param color  The other color\n     */\n    average(color) {\n        const newR = (color.r + this.r) / 2;\n        const newG = (color.g + this.g) / 2;\n        const newB = (color.b + this.b) / 2;\n        const newA = (color.a + this.a) / 2;\n        return new Color(newR, newG, newB, newA);\n    }\n    equal(color) {\n        return this.toString() === color.toString();\n    }\n    /**\n     * Returns a CSS string representation of a color.\n     * @param format Color representation, accepts: rgb, hsl, or hex\n     */\n    toString(format = 'rgb') {\n        switch (format) {\n            case 'rgb':\n                return this.toRGBA();\n            case 'hsl':\n                return this.toHSLA();\n            case 'hex':\n                return this.toHex();\n            default:\n                throw new Error('Invalid Color format');\n        }\n    }\n    /**\n     * Returns Hex Value of a color component\n     * @param c color component\n     * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n     */\n    _componentToHex(c) {\n        // Handle negative and fractional numbers\n        const hex = Math.max(Math.round(c), 0).toString(16);\n        return hex.length === 1 ? '0' + hex : hex;\n    }\n    /**\n     * Return Hex representation of a color.\n     */\n    toHex() {\n        let hexRepresentation = '#' + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b);\n        if (this.a !== 1) {\n            hexRepresentation += this._componentToHex(this.a * 255);\n        }\n        return hexRepresentation;\n    }\n    /**\n     * Return RGBA representation of a color.\n     */\n    toRGBA() {\n        const result = String(this.r.toFixed(0)) + ', ' + String(this.g.toFixed(0)) + ', ' + String(this.b.toFixed(0));\n        if (this.a !== undefined || this.a !== null) {\n            return 'rgba(' + result + ', ' + String(this.a) + ')';\n        }\n        return 'rgb(' + result + ')';\n    }\n    /**\n     * Return HSLA representation of a color.\n     */\n    toHSLA() {\n        return HSLColor.fromRGBA(this.r, this.g, this.b, this.a).toString();\n    }\n    /**\n     * Returns a CSS string representation of a color.\n     */\n    fillStyle() {\n        return this.toString();\n    }\n    /**\n     * Returns a clone of the current color.\n     */\n    clone() {\n        return new Color(this.r, this.g, this.b, this.a);\n    }\n    /**\n     * Black (#000000)\n     */\n    static get Black() {\n        return Color.fromHex('#000000');\n    }\n    /**\n     * White (#FFFFFF)\n     */\n    static get White() {\n        return Color.fromHex('#FFFFFF');\n    }\n    /**\n     * Gray (#808080)\n     */\n    static get Gray() {\n        return Color.fromHex('#808080');\n    }\n    /**\n     * Light gray (#D3D3D3)\n     */\n    static get LightGray() {\n        return Color.fromHex('#D3D3D3');\n    }\n    /**\n     * Dark gray (#A9A9A9)\n     */\n    static get DarkGray() {\n        return Color.fromHex('#A9A9A9');\n    }\n    /**\n     * Yellow (#FFFF00)\n     */\n    static get Yellow() {\n        return Color.fromHex('#FFFF00');\n    }\n    /**\n     * Orange (#FFA500)\n     */\n    static get Orange() {\n        return Color.fromHex('#FFA500');\n    }\n    /**\n     * Red (#FF0000)\n     */\n    static get Red() {\n        return Color.fromHex('#FF0000');\n    }\n    /**\n     * Vermilion (#FF5B31)\n     */\n    static get Vermilion() {\n        return Color.fromHex('#FF5B31');\n    }\n    /**\n     * Rose (#FF007F)\n     */\n    static get Rose() {\n        return Color.fromHex('#FF007F');\n    }\n    /**\n     * Magenta (#FF00FF)\n     */\n    static get Magenta() {\n        return Color.fromHex('#FF00FF');\n    }\n    /**\n     * Violet (#7F00FF)\n     */\n    static get Violet() {\n        return Color.fromHex('#7F00FF');\n    }\n    /**\n     * Blue (#0000FF)\n     */\n    static get Blue() {\n        return Color.fromHex('#0000FF');\n    }\n    /**\n     * Azure (#007FFF)\n     */\n    static get Azure() {\n        return Color.fromHex('#007FFF');\n    }\n    /**\n     * Cyan (#00FFFF)\n     */\n    static get Cyan() {\n        return Color.fromHex('#00FFFF');\n    }\n    /**\n     * Viridian (#59978F)\n     */\n    static get Viridian() {\n        return Color.fromHex('#59978F');\n    }\n    /**\n     * Green (#00FF00)\n     */\n    static get Green() {\n        return Color.fromHex('#00FF00');\n    }\n    /**\n     * Chartreuse (#7FFF00)\n     */\n    static get Chartreuse() {\n        return Color.fromHex('#7FFF00');\n    }\n    /**\n     * Transparent (#FFFFFF00)\n     */\n    static get Transparent() {\n        return Color.fromHex('#FFFFFF00');\n    }\n    /**\n     * ExcaliburBlue (#176BAA)\n     */\n    static get ExcaliburBlue() {\n        return Color.fromHex('#176BAA');\n    }\n}\n/**\n * Internal HSL Color representation\n *\n * http://en.wikipedia.org/wiki/HSL_and_HSV\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n */\nclass HSLColor {\n    constructor(h, s, l, a) {\n        this.h = h;\n        this.s = s;\n        this.l = l;\n        this.a = a;\n    }\n    static hue2rgb(p, q, t) {\n        if (t < 0) {\n            t += 1;\n        }\n        if (t > 1) {\n            t -= 1;\n        }\n        if (t < 1 / 6) {\n            return p + (q - p) * 6 * t;\n        }\n        if (t < 1 / 2) {\n            return q;\n        }\n        if (t < 2 / 3) {\n            return p + (q - p) * (2 / 3 - t) * 6;\n        }\n        return p;\n    }\n    static fromRGBA(r, g, b, a) {\n        r /= 255;\n        g /= 255;\n        b /= 255;\n        const max = Math.max(r, g, b), min = Math.min(r, g, b);\n        let h, s;\n        const l = (max + min) / 2;\n        if (max === min) {\n            h = s = 0; // achromatic\n        }\n        else {\n            const d = max - min;\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n            switch (max) {\n                case r:\n                    h = (g - b) / d + (g < b ? 6 : 0);\n                    break;\n                case g:\n                    h = (b - r) / d + 2;\n                    break;\n                case b:\n                    h = (r - g) / d + 4;\n                    break;\n            }\n            h /= 6;\n        }\n        return new HSLColor(h, s, l, a);\n    }\n    toRGBA() {\n        let r, g, b;\n        if (this.s === 0) {\n            r = g = b = this.l; // achromatic\n        }\n        else {\n            const q = this.l < 0.5 ? this.l * (1 + this.s) : this.l + this.s - this.l * this.s;\n            const p = 2 * this.l - q;\n            r = HSLColor.hue2rgb(p, q, this.h + 1 / 3);\n            g = HSLColor.hue2rgb(p, q, this.h);\n            b = HSLColor.hue2rgb(p, q, this.h - 1 / 3);\n        }\n        return new Color(r * 255, g * 255, b * 255, this.a);\n    }\n    toString() {\n        const h = this.h.toFixed(0), s = this.s.toFixed(0), l = this.l.toFixed(0), a = this.a.toFixed(0);\n        return `hsla(${h}, ${s}, ${l}, ${a})`;\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Log.ts\n/* eslint-disable no-console */\n\n\n/**\n * Logging level that Excalibur will tag\n */\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"Debug\"] = 0] = \"Debug\";\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\n    LogLevel[LogLevel[\"Fatal\"] = 4] = \"Fatal\";\n})(LogLevel || (LogLevel = {}));\n/**\n * Static singleton that represents the logging facility for Excalibur.\n * Excalibur comes built-in with a [[ConsoleAppender]] and [[ScreenAppender]].\n * Derive from [[Appender]] to create your own logging appenders.\n */\nclass Logger {\n    constructor() {\n        this._appenders = [];\n        /**\n         * Gets or sets the default logging level. Excalibur will only log\n         * messages if equal to or above this level. Default: [[LogLevel.Info]]\n         */\n        this.defaultLevel = LogLevel.Info;\n        this._logOnceSet = new Set();\n        if (Logger._INSTANCE) {\n            throw new Error('Logger is a singleton');\n        }\n        Logger._INSTANCE = this;\n        // Default console appender\n        Logger._INSTANCE.addAppender(new ConsoleAppender());\n        return Logger._INSTANCE;\n    }\n    /**\n     * Gets the current static instance of Logger\n     */\n    static getInstance() {\n        if (Logger._INSTANCE == null) {\n            Logger._INSTANCE = new Logger();\n        }\n        return Logger._INSTANCE;\n    }\n    /**\n     * Adds a new [[Appender]] to the list of appenders to write to\n     */\n    addAppender(appender) {\n        this._appenders.push(appender);\n    }\n    /**\n     * Clears all appenders from the logger\n     */\n    clearAppenders() {\n        this._appenders.length = 0;\n    }\n    /**\n     * Logs a message at a given LogLevel\n     * @param level  The LogLevel`to log the message at\n     * @param args   An array of arguments to write to an appender\n     */\n    _log(level, args) {\n        if (level == null) {\n            level = this.defaultLevel;\n        }\n        const len = this._appenders.length;\n        for (let i = 0; i < len; i++) {\n            if (level >= this.defaultLevel) {\n                this._appenders[i].log(level, args);\n            }\n        }\n    }\n    _logOnce(level, args) {\n        const serialized = level + args.join('+');\n        if (this._logOnceSet.has(serialized)) {\n            return;\n        }\n        else {\n            this._logOnceSet.add(serialized);\n            this._log(level, args);\n        }\n    }\n    /**\n     * Writes a log message at the [[LogLevel.Debug]] level\n     * @param args  Accepts any number of arguments\n     */\n    debug(...args) {\n        this._log(LogLevel.Debug, args);\n    }\n    /**\n     * Writes a log message once at the [[LogLevel.Fatal]] level, if it sees the same args again it wont log\n     * @param args  Accepts any number of arguments\n     */\n    debugOnce(...args) {\n        this._logOnce(LogLevel.Debug, args);\n    }\n    /**\n     * Writes a log message at the [[LogLevel.Info]] level\n     * @param args  Accepts any number of arguments\n     */\n    info(...args) {\n        this._log(LogLevel.Info, args);\n    }\n    /**\n     * Writes a log message once at the [[LogLevel.Info]] level, if it sees the same args again it wont log\n     * @param args  Accepts any number of arguments\n     */\n    infoOnce(...args) {\n        this._logOnce(LogLevel.Info, args);\n    }\n    /**\n     * Writes a log message at the [[LogLevel.Warn]] level\n     * @param args  Accepts any number of arguments\n     */\n    warn(...args) {\n        this._log(LogLevel.Warn, args);\n    }\n    /**\n     * Writes a log message once at the [[LogLevel.Warn]] level, if it sees the same args again it won't log\n     * @param args  Accepts any number of arguments\n     */\n    warnOnce(...args) {\n        this._logOnce(LogLevel.Warn, args);\n    }\n    /**\n     * Writes a log message at the [[LogLevel.Error]] level\n     * @param args  Accepts any number of arguments\n     */\n    error(...args) {\n        this._log(LogLevel.Error, args);\n    }\n    /**\n     * Writes a log message once at the [[LogLevel.Error]] level, if it sees the same args again it won't log\n     * @param args  Accepts any number of arguments\n     */\n    errorOnce(...args) {\n        this._logOnce(LogLevel.Error, args);\n    }\n    /**\n     * Writes a log message at the [[LogLevel.Fatal]] level\n     * @param args  Accepts any number of arguments\n     */\n    fatal(...args) {\n        this._log(LogLevel.Fatal, args);\n    }\n    /**\n     * Writes a log message once at the [[LogLevel.Fatal]] level, if it sees the same args again it won't log\n     * @param args  Accepts any number of arguments\n     */\n    fatalOnce(...args) {\n        this._logOnce(LogLevel.Fatal, args);\n    }\n}\nLogger._INSTANCE = null;\n/**\n * Console appender for browsers (i.e. `console.log`)\n */\nclass ConsoleAppender {\n    /**\n     * Logs a message at the given [[LogLevel]]\n     * @param level  Level to log at\n     * @param args   Arguments to log\n     */\n    log(level, args) {\n        // Check for console support\n        if (!console && !console.log && console.warn && console.error) {\n            // todo maybe do something better than nothing\n            return;\n        }\n        // Create a new console args array\n        const consoleArgs = [];\n        consoleArgs.unshift.apply(consoleArgs, args);\n        consoleArgs.unshift('[' + LogLevel[level] + '] : ');\n        if (level < LogLevel.Warn) {\n            // Call .log for Debug/Info\n            if (console.log.apply) {\n                // this is required on some older browsers that don't support apply on console.log :(\n                console.log.apply(console, consoleArgs);\n            }\n            else {\n                console.log(consoleArgs.join(' '));\n            }\n        }\n        else if (level < LogLevel.Error) {\n            // Call .warn for Warn\n            if (console.warn.apply) {\n                console.warn.apply(console, consoleArgs);\n            }\n            else {\n                console.warn(consoleArgs.join(' '));\n            }\n        }\n        else {\n            // Call .error for Error/Fatal\n            if (console.error.apply) {\n                console.error.apply(console, consoleArgs);\n            }\n            else {\n                console.error(consoleArgs.join(' '));\n            }\n        }\n    }\n}\n/**\n * On-screen (canvas) appender\n */\nclass ScreenAppender {\n    constructor(options) {\n        var _a, _b;\n        this._messages = [];\n        this._pos = 10;\n        this._color = Color.Black;\n        this._options = options;\n        this.canvas = document.createElement('canvas');\n        this._ctx = this.canvas.getContext('2d');\n        this.canvas.style.position = 'absolute';\n        this.canvas.style.zIndex = (_b = (_a = options.zIndex) === null || _a === void 0 ? void 0 : _a.toString()) !== null && _b !== void 0 ? _b : '99';\n        document.body.appendChild(this.canvas);\n        this._positionScreenAppenderCanvas();\n        options.engine.screen.events.on('resize', () => {\n            this._positionScreenAppenderCanvas();\n        });\n    }\n    _positionScreenAppenderCanvas() {\n        var _a, _b, _c, _d;\n        const options = this._options;\n        this.canvas.width = (_a = options.width) !== null && _a !== void 0 ? _a : options.engine.screen.resolution.width;\n        this.canvas.height = (_b = options.height) !== null && _b !== void 0 ? _b : options.engine.screen.resolution.height;\n        this.canvas.style.position = 'absolute';\n        const pagePos = options.engine.screen.screenToPageCoordinates(vec(0, 0));\n        this.canvas.style.left = pagePos.x + 'px';\n        this.canvas.style.top = pagePos.y + 'px';\n        this._pos = (_c = options.xPos) !== null && _c !== void 0 ? _c : this._pos;\n        this._color = (_d = options.color) !== null && _d !== void 0 ? _d : this._color;\n    }\n    /**\n     * Logs a message at the given [[LogLevel]]\n     * @param level  Level to log at\n     * @param args   Arguments to log\n     */\n    log(level, args) {\n        const message = args.join(',');\n        this._ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this._messages.unshift('[' + LogLevel[level] + '] : ' + message);\n        let pos = 10;\n        this._messages = this._messages.slice(0, 1000);\n        for (let i = 0; i < this._messages.length; i++) {\n            this._ctx.fillStyle = this._color.toRGBA();\n            this._ctx.fillText(this._messages[i], this._pos, pos);\n            pos += 10;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Side.ts\n\n/**\n * An enum that describes the sides of an axis aligned box for collision\n */\nvar Side;\n(function (Side) {\n    Side[\"None\"] = \"None\";\n    Side[\"Top\"] = \"Top\";\n    Side[\"Bottom\"] = \"Bottom\";\n    Side[\"Left\"] = \"Left\";\n    Side[\"Right\"] = \"Right\";\n})(Side || (Side = {}));\n(function (Side) {\n    /**\n     * Returns the opposite side from the current\n     */\n    function getOpposite(side) {\n        if (side === Side.Top) {\n            return Side.Bottom;\n        }\n        if (side === Side.Bottom) {\n            return Side.Top;\n        }\n        if (side === Side.Left) {\n            return Side.Right;\n        }\n        if (side === Side.Right) {\n            return Side.Left;\n        }\n        return Side.None;\n    }\n    Side.getOpposite = getOpposite;\n    /**\n     * Given a vector, return the Side most in that direction (via dot product)\n     */\n    function fromDirection(direction) {\n        const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\n        const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\n        let max = -Number.MAX_VALUE;\n        let maxIndex = -1;\n        for (let i = 0; i < directions.length; i++) {\n            if (directions[i].dot(direction) > max) {\n                max = directions[i].dot(direction);\n                maxIndex = i;\n            }\n        }\n        return directionEnum[maxIndex];\n    }\n    Side.fromDirection = fromDirection;\n})(Side || (Side = {}));\n\n;// CONCATENATED MODULE: ./Collision/BoundingBox.ts\n\n\n\n/**\n * Axis Aligned collision primitive for Excalibur.\n */\nclass BoundingBox {\n    /**\n     * Constructor allows passing of either an object with all coordinate components,\n     * or the coordinate components passed separately.\n     * @param leftOrOptions    Either x coordinate of the left edge or an options object\n     * containing the four coordinate components.\n     * @param top     y coordinate of the top edge\n     * @param right   x coordinate of the right edge\n     * @param bottom  y coordinate of the bottom edge\n     */\n    constructor(leftOrOptions = 0, top = 0, right = 0, bottom = 0) {\n        // Cache bounding box point returns\n        this._points = [];\n        if (typeof leftOrOptions === 'object') {\n            this.left = leftOrOptions.left;\n            this.top = leftOrOptions.top;\n            this.right = leftOrOptions.right;\n            this.bottom = leftOrOptions.bottom;\n        }\n        else if (typeof leftOrOptions === 'number') {\n            this.left = leftOrOptions;\n            this.top = top;\n            this.right = right;\n            this.bottom = bottom;\n        }\n    }\n    /**\n     * Returns a new instance of [[BoundingBox]] that is a copy of the current instance\n     */\n    clone() {\n        return new BoundingBox(this.left, this.top, this.right, this.bottom);\n    }\n    /**\n     * Given bounding box A & B, returns the side relative to A when intersection is performed.\n     * @param intersection Intersection vector between 2 bounding boxes\n     */\n    static getSideFromIntersection(intersection) {\n        if (!intersection) {\n            return Side.None;\n        }\n        if (intersection) {\n            if (Math.abs(intersection.x) > Math.abs(intersection.y)) {\n                if (intersection.x < 0) {\n                    return Side.Right;\n                }\n                return Side.Left;\n            }\n            else {\n                if (intersection.y < 0) {\n                    return Side.Bottom;\n                }\n                return Side.Top;\n            }\n        }\n        return Side.None;\n    }\n    static fromPoints(points) {\n        let minX = Infinity;\n        let minY = Infinity;\n        let maxX = -Infinity;\n        let maxY = -Infinity;\n        for (let i = 0; i < points.length; i++) {\n            if (points[i].x < minX) {\n                minX = points[i].x;\n            }\n            if (points[i].x > maxX) {\n                maxX = points[i].x;\n            }\n            if (points[i].y < minY) {\n                minY = points[i].y;\n            }\n            if (points[i].y > maxY) {\n                maxY = points[i].y;\n            }\n        }\n        return new BoundingBox(minX, minY, maxX, maxY);\n    }\n    /**\n     * Creates a bounding box from a width and height\n     * @param width\n     * @param height\n     * @param anchor Default Vector.Half\n     * @param pos Default Vector.Zero\n     */\n    static fromDimension(width, height, anchor = Vector.Half, pos = Vector.Zero) {\n        return new BoundingBox(-width * anchor.x + pos.x, -height * anchor.y + pos.y, width - width * anchor.x + pos.x, height - height * anchor.y + pos.y);\n    }\n    /**\n     * Returns the calculated width of the bounding box\n     */\n    get width() {\n        return this.right - this.left;\n    }\n    /**\n     * Returns the calculated height of the bounding box\n     */\n    get height() {\n        return this.bottom - this.top;\n    }\n    /**\n     * Return whether the bounding box has zero dimensions in height,width or both\n     */\n    hasZeroDimensions() {\n        return this.width === 0 || this.height === 0;\n    }\n    /**\n     * Returns the center of the bounding box\n     */\n    get center() {\n        return new Vector((this.left + this.right) / 2, (this.top + this.bottom) / 2);\n    }\n    get topLeft() {\n        return new Vector(this.left, this.top);\n    }\n    get bottomRight() {\n        return new Vector(this.right, this.bottom);\n    }\n    get topRight() {\n        return new Vector(this.right, this.top);\n    }\n    get bottomLeft() {\n        return new Vector(this.left, this.bottom);\n    }\n    translate(pos) {\n        return new BoundingBox(this.left + pos.x, this.top + pos.y, this.right + pos.x, this.bottom + pos.y);\n    }\n    /**\n     * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding\n     * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.\n     */\n    rotate(angle, point = Vector.Zero) {\n        const points = this.getPoints().map((p) => p.rotate(angle, point));\n        return BoundingBox.fromPoints(points);\n    }\n    /**\n     * Scale a bounding box by a scale factor, optionally provide a point\n     * @param scale\n     * @param point\n     */\n    scale(scale, point = Vector.Zero) {\n        const shifted = this.translate(point);\n        return new BoundingBox(shifted.left * scale.x, shifted.top * scale.y, shifted.right * scale.x, shifted.bottom * scale.y);\n    }\n    /**\n     * Transform the axis aligned bounding box by a [[Matrix]], producing a new axis aligned bounding box\n     * @param matrix\n     */\n    transform(matrix) {\n        // inlined these calculations to not use vectors would speed it up slightly\n        // const matFirstColumn = vec(matrix.data[0], matrix.data[1]);\n        // const xa = matFirstColumn.scale(this.left);\n        const xa1 = matrix.data[0] * this.left;\n        const xa2 = matrix.data[1] * this.left;\n        // const xb = matFirstColumn.scale(this.right);\n        const xb1 = matrix.data[0] * this.right;\n        const xb2 = matrix.data[1] * this.right;\n        // const matSecondColumn = vec(matrix.data[2], matrix.data[3]);\n        // const ya = matSecondColumn.scale(this.top);\n        const ya1 = matrix.data[2] * this.top;\n        const ya2 = matrix.data[3] * this.top;\n        // const yb = matSecondColumn.scale(this.bottom);\n        const yb1 = matrix.data[2] * this.bottom;\n        const yb2 = matrix.data[3] * this.bottom;\n        const matrixPos = matrix.getPosition();\n        // const topLeft = Vector.min(xa, xb).add(Vector.min(ya, yb)).add(matrixPos);\n        // const bottomRight = Vector.max(xa, xb).add(Vector.max(ya, yb)).add(matrixPos);\n        const left = Math.min(xa1, xb1) + Math.min(ya1, yb1) + matrixPos.x;\n        const top = Math.min(xa2, xb2) + Math.min(ya2, yb2) + matrixPos.y;\n        const right = Math.max(xa1, xb1) + Math.max(ya1, yb1) + matrixPos.x;\n        const bottom = Math.max(xa2, xb2) + Math.max(ya2, yb2) + matrixPos.y;\n        return new BoundingBox({\n            left, //: topLeft.x,\n            top, //: topLeft.y,\n            right, //: bottomRight.x,\n            bottom //: bottomRight.y\n        });\n    }\n    /**\n     * Returns the perimeter of the bounding box\n     */\n    getPerimeter() {\n        const wx = this.width;\n        const wy = this.height;\n        return 2 * (wx + wy);\n    }\n    /**\n     * Returns the world space points that make up the corners of the bounding box as a polygon\n     */\n    getPoints() {\n        if (this._left !== this.left ||\n            this._right !== this.right ||\n            this._top !== this.top ||\n            this._bottom !== this.bottom) {\n            this._points.length = 0;\n            this._points.push(new Vector(this.left, this.top));\n            this._points.push(new Vector(this.right, this.top));\n            this._points.push(new Vector(this.right, this.bottom));\n            this._points.push(new Vector(this.left, this.bottom));\n            this._left = this.left;\n            this._right = this.right;\n            this._top = this.top;\n            this._bottom = this.bottom;\n        }\n        return this._points;\n    }\n    /**\n     * Determines whether a ray intersects with a bounding box\n     */\n    rayCast(ray, farClipDistance = Infinity) {\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\n        let tmin = -Infinity;\n        let tmax = +Infinity;\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\n        const tx1 = (this.left - ray.pos.x) * xinv;\n        const tx2 = (this.right - ray.pos.x) * xinv;\n        tmin = Math.min(tx1, tx2);\n        tmax = Math.max(tx1, tx2);\n        const ty1 = (this.top - ray.pos.y) * yinv;\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\n        return tmax >= Math.max(0, tmin) && tmin < farClipDistance;\n    }\n    rayCastTime(ray, farClipDistance = Infinity) {\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\n        let tmin = -Infinity;\n        let tmax = +Infinity;\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\n        const tx1 = (this.left - ray.pos.x) * xinv;\n        const tx2 = (this.right - ray.pos.x) * xinv;\n        tmin = Math.min(tx1, tx2);\n        tmax = Math.max(tx1, tx2);\n        const ty1 = (this.top - ray.pos.y) * yinv;\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\n        if (tmax >= Math.max(0, tmin) && tmin < farClipDistance) {\n            return tmin;\n        }\n        return -1;\n    }\n    contains(val) {\n        if (val instanceof Vector) {\n            return this.left <= val.x && this.top <= val.y && this.bottom >= val.y && this.right >= val.x;\n        }\n        else if (val instanceof BoundingBox) {\n            if (this.left <= val.left && this.top <= val.top && val.bottom <= this.bottom && val.right <= this.right) {\n                return true;\n            }\n            return false;\n        }\n        return false;\n    }\n    /**\n     * Combines this bounding box and another together returning a new bounding box\n     * @param other  The bounding box to combine\n     */\n    combine(other) {\n        const compositeBB = new BoundingBox(Math.min(this.left, other.left), Math.min(this.top, other.top), Math.max(this.right, other.right), Math.max(this.bottom, other.bottom));\n        return compositeBB;\n    }\n    get dimensions() {\n        return new Vector(this.width, this.height);\n    }\n    /**\n     * Returns true if the bounding boxes overlap.\n     * @param other\n     * @param epsilon Optionally specify a small epsilon (default 0) as amount of overlap to ignore as overlap.\n     * This epsilon is useful in stable collision simulations.\n     */\n    overlaps(other, epsilon) {\n        const e = epsilon || 0;\n        if (other.hasZeroDimensions()) {\n            return this.contains(other);\n        }\n        if (this.hasZeroDimensions()) {\n            return other.contains(this);\n        }\n        const totalBoundingBox = this.combine(other);\n        return totalBoundingBox.width + e < other.width + this.width &&\n            totalBoundingBox.height + e < other.height + this.height;\n    }\n    /**\n     * Test wether this bounding box intersects with another returning\n     * the intersection vector that can be used to resolve the collision. If there\n     * is no intersection null is returned.\n     * @param other  Other [[BoundingBox]] to test intersection with\n     * @returns A Vector in the direction of the current BoundingBox, this <- other\n     */\n    intersect(other) {\n        const totalBoundingBox = this.combine(other);\n        // If the total bounding box is less than or equal the sum of the 2 bounds then there is collision\n        if (totalBoundingBox.width < other.width + this.width &&\n            totalBoundingBox.height < other.height + this.height &&\n            !totalBoundingBox.dimensions.equals(other.dimensions) &&\n            !totalBoundingBox.dimensions.equals(this.dimensions)) {\n            // collision\n            let overlapX = 0;\n            // right edge is between the other's left and right edge\n            /**\n             *     +-this-+\n             *     |      |\n             *     |    +-other-+\n             *     +----|-+     |\n             *          |       |\n             *          +-------+\n             *         <---\n             *          ^ overlap\n             */\n            if (this.right >= other.left && this.right <= other.right) {\n                overlapX = other.left - this.right;\n                // right edge is past the other's right edge\n                /**\n                 *     +-other-+\n                 *     |       |\n                 *     |    +-this-+\n                 *     +----|--+   |\n                 *          |      |\n                 *          +------+\n                 *          --->\n                 *          ^ overlap\n                 */\n            }\n            else {\n                overlapX = other.right - this.left;\n            }\n            let overlapY = 0;\n            // top edge is between the other's top and bottom edge\n            /**\n             *     +-other-+\n             *     |       |\n             *     |    +-this-+   | <- overlap\n             *     +----|--+   |   |\n             *          |      |  \\ /\n             *          +------+   '\n             */\n            if (this.top <= other.bottom && this.top >= other.top) {\n                overlapY = other.bottom - this.top;\n                // top edge is above the other top edge\n                /**\n                 *     +-this-+         .\n                 *     |      |        / \\\n                 *     |    +-other-+   | <- overlap\n                 *     +----|-+     |   |\n                 *          |       |\n                 *          +-------+\n                 */\n            }\n            else {\n                overlapY = other.top - this.bottom;\n            }\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\n                return new Vector(overlapX, 0);\n            }\n            else {\n                return new Vector(0, overlapY);\n            }\n            // Case of total containment of one bounding box by another\n        }\n        else if (totalBoundingBox.dimensions.equals(other.dimensions) || totalBoundingBox.dimensions.equals(this.dimensions)) {\n            let overlapX = 0;\n            // this is wider than the other\n            if (this.width - other.width >= 0) {\n                // This right edge is closest to the others right edge\n                if (this.right - other.right <= other.left - this.left) {\n                    overlapX = other.left - this.right;\n                    // This left edge is closest to the others left edge\n                }\n                else {\n                    overlapX = other.right - this.left;\n                }\n                // other is wider than this\n            }\n            else {\n                // This right edge is closest to the others right edge\n                if (other.right - this.right <= this.left - other.left) {\n                    overlapX = this.left - other.right;\n                    // This left edge is closest to the others left edge\n                }\n                else {\n                    overlapX = this.right - other.left;\n                }\n            }\n            let overlapY = 0;\n            // this is taller than other\n            if (this.height - other.height >= 0) {\n                // The bottom edge is closest to the others bottom edge\n                if (this.bottom - other.bottom <= other.top - this.top) {\n                    overlapY = other.top - this.bottom;\n                }\n                else {\n                    overlapY = other.bottom - this.top;\n                }\n                // other is taller than this\n            }\n            else {\n                // The bottom edge is closest to the others bottom edge\n                if (other.bottom - this.bottom <= this.top - other.top) {\n                    overlapY = this.top - other.bottom;\n                }\n                else {\n                    overlapY = this.bottom - other.top;\n                }\n            }\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\n                return new Vector(overlapX, 0);\n            }\n            else {\n                return new Vector(0, overlapY);\n            }\n        }\n        else {\n            return null;\n        }\n    }\n    /**\n     * Test whether the bounding box has intersected with another bounding box, returns the side of the current bb that intersected.\n     * @param bb The other actor to test\n     */\n    intersectWithSide(bb) {\n        const intersect = this.intersect(bb);\n        return BoundingBox.getSideFromIntersection(intersect);\n    }\n    /**\n     * Draw a debug bounding box\n     * @param ex\n     * @param color\n     */\n    draw(ex, color = Color.Yellow) {\n        ex.debug.drawRect(this.left, this.top, this.width, this.height, { color });\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Util.ts\n\n\n/**\n * Find the screen position of an HTML element\n */\nfunction getPosition(el) {\n    // do we need the scroll too? technically the offset method before did that\n    if (el) {\n        const rect = el.getBoundingClientRect();\n        return vec(rect.x + window.scrollX, rect.y + window.scrollY);\n    }\n    return Vector.Zero;\n}\n/**\n * Add an item to an array list if it doesn't already exist. Returns true if added, false if not and already exists in the array.\n * @deprecated Will be removed in v0.26.0\n */\nfunction addItemToArray(item, array) {\n    if (array.indexOf(item) === -1) {\n        array.push(item);\n        return true;\n    }\n    return false;\n}\n/**\n * Remove an item from an list\n * @deprecated Will be removed in v0.26.0\n */\nfunction removeItemFromArray(item, array) {\n    let index = -1;\n    if ((index = array.indexOf(item)) > -1) {\n        array.splice(index, 1);\n        return true;\n    }\n    return false;\n}\n/**\n * See if an array contains something\n */\nfunction contains(array, obj) {\n    for (let i = 0; i < array.length; i++) {\n        if (array[i] === obj) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Used for exhaustive checks at compile time\n */\nfunction fail(message) {\n    throw new Error(message);\n}\n/**\n * Create a promise that resolves after a certain number of milliseconds\n *\n * It is strongly recommended you pass the excalibur clock so delays are bound to the\n * excalibur clock which would be unaffected by stop/pause.\n * @param milliseconds\n * @param clock\n */\nfunction delay(milliseconds, clock) {\n    var _a;\n    const future = new Future();\n    const schedule = (_a = clock === null || clock === void 0 ? void 0 : clock.schedule.bind(clock)) !== null && _a !== void 0 ? _a : setTimeout;\n    schedule(() => {\n        future.resolve();\n    }, milliseconds);\n    return future.promise;\n}\n/**\n * Remove keys from object literals\n * @param object\n * @param keys\n */\nfunction omit(object, keys) {\n    const newObj = {};\n    for (const key in object) {\n        if (!keys.includes(key)) {\n            newObj[key] = object[key];\n        }\n    }\n    return newObj;\n}\n\n;// CONCATENATED MODULE: ./Math/matrix.ts\n\n\n\nvar MatrixLocations;\n(function (MatrixLocations) {\n    MatrixLocations[MatrixLocations[\"X\"] = 12] = \"X\";\n    MatrixLocations[MatrixLocations[\"Y\"] = 13] = \"Y\";\n})(MatrixLocations || (MatrixLocations = {}));\n/**\n * Excalibur Matrix helper for 4x4 matrices\n *\n * Useful for webgl 4x4 matrices\n */\nclass Matrix {\n    constructor() {\n        /**\n         *  4x4 matrix in column major order\n         *\n         * |         |         |          |          |\n         * | ------- | ------- | -------- | -------- |\n         * | data[0] | data[4] | data[8]  | data[12] |\n         * | data[1] | data[5] | data[9]  | data[13] |\n         * | data[2] | data[6] | data[10] | data[14] |\n         * | data[3] | data[7] | data[11] | data[15] |\n         *\n         */\n        this.data = new Float32Array(16);\n        this._scaleX = 1;\n        this._scaleSignX = 1;\n        this._scaleY = 1;\n        this._scaleSignY = 1;\n    }\n    /**\n     * Creates an orthographic (flat non-perspective) projection\n     * https://en.wikipedia.org/wiki/Orthographic_projection\n     * @param left\n     * @param right\n     * @param bottom\n     * @param top\n     * @param near\n     * @param far\n     */\n    static ortho(left, right, bottom, top, near, far) {\n        const mat = new Matrix();\n        mat.data[0] = 2 / (right - left);\n        mat.data[1] = 0;\n        mat.data[2] = 0;\n        mat.data[3] = 0;\n        mat.data[4] = 0;\n        mat.data[5] = 2 / (top - bottom);\n        mat.data[6] = 0;\n        mat.data[7] = 0;\n        mat.data[8] = 0;\n        mat.data[9] = 0;\n        mat.data[10] = -2 / (far - near);\n        mat.data[11] = 0;\n        mat.data[12] = -(right + left) / (right - left);\n        mat.data[13] = -(top + bottom) / (top - bottom);\n        mat.data[14] = -(far + near) / (far - near);\n        mat.data[15] = 1;\n        return mat;\n    }\n    /**\n     * Creates a new Matrix with the same data as the current 4x4\n     */\n    clone(dest) {\n        const mat = dest || new Matrix();\n        mat.data[0] = this.data[0];\n        mat.data[1] = this.data[1];\n        mat.data[2] = this.data[2];\n        mat.data[3] = this.data[3];\n        mat.data[4] = this.data[4];\n        mat.data[5] = this.data[5];\n        mat.data[6] = this.data[6];\n        mat.data[7] = this.data[7];\n        mat.data[8] = this.data[8];\n        mat.data[9] = this.data[9];\n        mat.data[10] = this.data[10];\n        mat.data[11] = this.data[11];\n        mat.data[12] = this.data[12];\n        mat.data[13] = this.data[13];\n        mat.data[14] = this.data[14];\n        mat.data[15] = this.data[15];\n        return mat;\n    }\n    /**\n     * Converts the current matrix into a DOMMatrix\n     *\n     * This is useful when working with the browser Canvas context\n     * @returns {DOMMatrix} DOMMatrix\n     */\n    toDOMMatrix() {\n        return new DOMMatrix([...this.data]);\n    }\n    static fromFloat32Array(data) {\n        const matrix = new Matrix();\n        matrix.data = data;\n        return matrix;\n    }\n    /**\n     * Creates a new identity matrix (a matrix that when applied does nothing)\n     */\n    static identity() {\n        const mat = new Matrix();\n        mat.data[0] = 1;\n        mat.data[1] = 0;\n        mat.data[2] = 0;\n        mat.data[3] = 0;\n        mat.data[4] = 0;\n        mat.data[5] = 1;\n        mat.data[6] = 0;\n        mat.data[7] = 0;\n        mat.data[8] = 0;\n        mat.data[9] = 0;\n        mat.data[10] = 1;\n        mat.data[11] = 0;\n        mat.data[12] = 0;\n        mat.data[13] = 0;\n        mat.data[14] = 0;\n        mat.data[15] = 1;\n        return mat;\n    }\n    /**\n     * Resets the current matrix to the identity matrix, mutating it\n     * @returns {Matrix} Current matrix as identity\n     */\n    reset() {\n        const mat = this;\n        mat.data[0] = 1;\n        mat.data[1] = 0;\n        mat.data[2] = 0;\n        mat.data[3] = 0;\n        mat.data[4] = 0;\n        mat.data[5] = 1;\n        mat.data[6] = 0;\n        mat.data[7] = 0;\n        mat.data[8] = 0;\n        mat.data[9] = 0;\n        mat.data[10] = 1;\n        mat.data[11] = 0;\n        mat.data[12] = 0;\n        mat.data[13] = 0;\n        mat.data[14] = 0;\n        mat.data[15] = 1;\n        return mat;\n    }\n    /**\n     * Creates a brand new translation matrix at the specified 3d point\n     * @param x\n     * @param y\n     */\n    static translation(x, y) {\n        const mat = Matrix.identity();\n        mat.data[12] = x;\n        mat.data[13] = y;\n        return mat;\n    }\n    /**\n     * Creates a brand new scaling matrix with the specified scaling factor\n     * @param sx\n     * @param sy\n     */\n    static scale(sx, sy) {\n        const mat = Matrix.identity();\n        mat.data[0] = sx;\n        mat.data[5] = sy;\n        mat.data[10] = 1;\n        mat.data[15] = 1;\n        return mat;\n    }\n    /**\n     * Creates a brand new rotation matrix with the specified angle\n     * @param angleRadians\n     */\n    static rotation(angleRadians) {\n        const mat = Matrix.identity();\n        mat.data[0] = Math.cos(angleRadians);\n        mat.data[4] = -Math.sin(angleRadians);\n        mat.data[1] = Math.sin(angleRadians);\n        mat.data[5] = Math.cos(angleRadians);\n        return mat;\n    }\n    multiply(vectorOrMatrix, dest) {\n        if (vectorOrMatrix instanceof Vector) {\n            const result = dest || new Vector(0, 0);\n            const vector = vectorOrMatrix;\n            // these shenanigans are to allow dest and vector to be the same instance\n            const resultX = vector.x * this.data[0] + vector.y * this.data[4] + this.data[12];\n            const resultY = vector.x * this.data[1] + vector.y * this.data[5] + this.data[13];\n            result.x = resultX;\n            result.y = resultY;\n            return result;\n        }\n        else {\n            const result = dest || new Matrix();\n            const other = vectorOrMatrix;\n            const a11 = this.data[0];\n            const a21 = this.data[1];\n            const a31 = this.data[2];\n            const a41 = this.data[3];\n            const a12 = this.data[4];\n            const a22 = this.data[5];\n            const a32 = this.data[6];\n            const a42 = this.data[7];\n            const a13 = this.data[8];\n            const a23 = this.data[9];\n            const a33 = this.data[10];\n            const a43 = this.data[11];\n            const a14 = this.data[12];\n            const a24 = this.data[13];\n            const a34 = this.data[14];\n            const a44 = this.data[15];\n            const b11 = other.data[0];\n            const b21 = other.data[1];\n            const b31 = other.data[2];\n            const b41 = other.data[3];\n            const b12 = other.data[4];\n            const b22 = other.data[5];\n            const b32 = other.data[6];\n            const b42 = other.data[7];\n            const b13 = other.data[8];\n            const b23 = other.data[9];\n            const b33 = other.data[10];\n            const b43 = other.data[11];\n            const b14 = other.data[12];\n            const b24 = other.data[13];\n            const b34 = other.data[14];\n            const b44 = other.data[15];\n            result.data[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n            result.data[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n            result.data[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n            result.data[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n            result.data[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n            result.data[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n            result.data[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n            result.data[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n            result.data[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n            result.data[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n            result.data[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n            result.data[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n            result.data[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n            result.data[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n            result.data[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n            result.data[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n            const s = this.getScale();\n            result._scaleSignX = sign(s.x) * sign(result._scaleSignX);\n            result._scaleSignY = sign(s.y) * sign(result._scaleSignY);\n            return result;\n        }\n    }\n    /**\n     * Applies translation to the current matrix mutating it\n     * @param x\n     * @param y\n     */\n    translate(x, y) {\n        const a11 = this.data[0];\n        const a21 = this.data[1];\n        const a31 = this.data[2];\n        const a41 = this.data[3];\n        const a12 = this.data[4];\n        const a22 = this.data[5];\n        const a32 = this.data[6];\n        const a42 = this.data[7];\n        const a13 = this.data[8];\n        const a23 = this.data[9];\n        const a33 = this.data[10];\n        const a43 = this.data[11];\n        const a14 = this.data[12];\n        const a24 = this.data[13];\n        const a34 = this.data[14];\n        const a44 = this.data[15];\n        // Doesn't change z\n        const z = 0;\n        const w = 1;\n        this.data[12] = a11 * x + a12 * y + a13 * z + a14 * w;\n        this.data[13] = a21 * x + a22 * y + a23 * z + a24 * w;\n        this.data[14] = a31 * x + a32 * y + a33 * z + a34 * w;\n        this.data[15] = a41 * x + a42 * y + a43 * z + a44 * w;\n        return this;\n    }\n    setPosition(x, y) {\n        this.data[12] = x;\n        this.data[13] = y;\n    }\n    getPosition() {\n        return vec(this.data[12], this.data[13]);\n    }\n    /**\n     * Applies rotation to the current matrix mutating it\n     * @param angle in Radians\n     */\n    rotate(angle) {\n        const a11 = this.data[0];\n        const a21 = this.data[1];\n        const a31 = this.data[2];\n        const a41 = this.data[3];\n        const a12 = this.data[4];\n        const a22 = this.data[5];\n        const a32 = this.data[6];\n        const a42 = this.data[7];\n        const sine = Math.sin(angle);\n        const cosine = Math.cos(angle);\n        this.data[0] = cosine * a11 + sine * a12;\n        this.data[1] = cosine * a21 + sine * a22;\n        this.data[2] = cosine * a31 + sine * a32;\n        this.data[3] = cosine * a41 + sine * a42;\n        this.data[4] = cosine * a12 - sine * a11;\n        this.data[5] = cosine * a22 - sine * a21;\n        this.data[6] = cosine * a32 - sine * a31;\n        this.data[7] = cosine * a42 - sine * a41;\n        return this;\n    }\n    /**\n     * Applies scaling to the current matrix mutating it\n     * @param x\n     * @param y\n     */\n    scale(x, y) {\n        const a11 = this.data[0];\n        const a21 = this.data[1];\n        const a31 = this.data[2];\n        const a41 = this.data[3];\n        const a12 = this.data[4];\n        const a22 = this.data[5];\n        const a32 = this.data[6];\n        const a42 = this.data[7];\n        this.data[0] = a11 * x;\n        this.data[1] = a21 * x;\n        this.data[2] = a31 * x;\n        this.data[3] = a41 * x;\n        this.data[4] = a12 * y;\n        this.data[5] = a22 * y;\n        this.data[6] = a32 * y;\n        this.data[7] = a42 * y;\n        return this;\n    }\n    setRotation(angle) {\n        const currentScale = this.getScale();\n        const sine = Math.sin(angle);\n        const cosine = Math.cos(angle);\n        this.data[0] = cosine * currentScale.x;\n        this.data[1] = sine * currentScale.y;\n        this.data[4] = -sine * currentScale.x;\n        this.data[5] = cosine * currentScale.y;\n    }\n    getRotation() {\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\n        return canonicalizeAngle(angle);\n    }\n    getScaleX() {\n        // absolute scale of the matrix (we lose sign so need to add it back)\n        const xscale = vec(this.data[0], this.data[4]).size;\n        return this._scaleSignX * xscale;\n    }\n    getScaleY() {\n        // absolute scale of the matrix (we lose sign so need to add it back)\n        const yscale = vec(this.data[1], this.data[5]).size;\n        return this._scaleSignY * yscale;\n    }\n    /**\n     * Get the scale of the matrix\n     */\n    getScale() {\n        return vec(this.getScaleX(), this.getScaleY());\n    }\n    setScaleX(val) {\n        if (this._scaleX === val) {\n            return;\n        }\n        this._scaleSignX = sign(val);\n        // negative scale acts like a 180 rotation, so flip\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[4] * this._scaleSignX).normalize();\n        this.data[0] = xscale.x * val;\n        this.data[4] = xscale.y * val;\n        this._scaleX = val;\n    }\n    setScaleY(val) {\n        if (this._scaleY === val) {\n            return;\n        }\n        this._scaleSignY = sign(val);\n        // negative scale acts like a 180 rotation, so flip\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[5] * this._scaleSignY).normalize();\n        this.data[1] = yscale.x * val;\n        this.data[5] = yscale.y * val;\n        this._scaleY = val;\n    }\n    setScale(scale) {\n        this.setScaleX(scale.x);\n        this.setScaleY(scale.y);\n    }\n    /**\n     * Determinant of the upper left 2x2 matrix\n     */\n    getBasisDeterminant() {\n        return this.data[0] * this.data[5] - this.data[1] * this.data[4];\n    }\n    /**\n     * Return the affine inverse, optionally store it in a target matrix.\n     *\n     * It's recommended you call .reset() the target unless you know what you're doing\n     * @param target\n     */\n    getAffineInverse(target) {\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\n        // Since we are actually only doing 2D transformations we can use this hack\n        // We don't actually use the 3rd or 4th dimension\n        const det = this.getBasisDeterminant();\n        const inverseDet = 1 / det; // todo zero check\n        const a = this.data[0];\n        const b = this.data[4];\n        const c = this.data[1];\n        const d = this.data[5];\n        const m = target || Matrix.identity();\n        // inverts rotation and scale\n        m.data[0] = d * inverseDet;\n        m.data[1] = -c * inverseDet;\n        m.data[4] = -b * inverseDet;\n        m.data[5] = a * inverseDet;\n        const tx = this.data[12];\n        const ty = this.data[13];\n        // invert translation\n        // transform translation into the matrix basis created by rot/scale\n        m.data[12] = -(tx * m.data[0] + ty * m.data[4]);\n        m.data[13] = -(tx * m.data[1] + ty * m.data[5]);\n        return m;\n    }\n    isIdentity() {\n        return (this.data[0] === 1 &&\n            this.data[1] === 0 &&\n            this.data[2] === 0 &&\n            this.data[3] === 0 &&\n            this.data[4] === 0 &&\n            this.data[5] === 1 &&\n            this.data[6] === 0 &&\n            this.data[7] === 0 &&\n            this.data[8] === 0 &&\n            this.data[9] === 0 &&\n            this.data[10] === 1 &&\n            this.data[11] === 0 &&\n            this.data[12] === 0 &&\n            this.data[13] === 0 &&\n            this.data[14] === 0 &&\n            this.data[15] === 1);\n    }\n    toString() {\n        return `\r\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\r\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\r\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\r\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\r\n`;\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/affine-matrix.ts\n\n\n\nclass AffineMatrix {\n    constructor() {\n        /**\n         * |         |         |          |\n         * | ------- | ------- | -------- |\n         * | data[0] | data[2] | data[4]  |\n         * | data[1] | data[3] | data[5]  |\n         * |   0     |    0    |    1     |\n         */\n        this.data = new Float64Array(6);\n        this._scale = new Float64Array([1, 1]);\n        this._scaleSignX = 1;\n        this._scaleSignY = 1;\n    }\n    /**\n     * Converts the current matrix into a DOMMatrix\n     *\n     * This is useful when working with the browser Canvas context\n     * @returns {DOMMatrix} DOMMatrix\n     */\n    toDOMMatrix() {\n        return new DOMMatrix([...this.data]);\n    }\n    static identity() {\n        const mat = new AffineMatrix();\n        mat.data[0] = 1;\n        mat.data[1] = 0;\n        mat.data[2] = 0;\n        mat.data[3] = 1;\n        mat.data[4] = 0;\n        mat.data[5] = 0;\n        return mat;\n    }\n    /**\n     * Creates a brand new translation matrix at the specified 3d point\n     * @param x\n     * @param y\n     */\n    static translation(x, y) {\n        const mat = AffineMatrix.identity();\n        mat.data[4] = x;\n        mat.data[5] = y;\n        return mat;\n    }\n    /**\n     * Creates a brand new scaling matrix with the specified scaling factor\n     * @param sx\n     * @param sy\n     */\n    static scale(sx, sy) {\n        const mat = AffineMatrix.identity();\n        mat.data[0] = sx;\n        mat.data[3] = sy;\n        mat._scale[0] = sx;\n        mat._scale[1] = sy;\n        return mat;\n    }\n    /**\n     * Creates a brand new rotation matrix with the specified angle\n     * @param angleRadians\n     */\n    static rotation(angleRadians) {\n        const mat = AffineMatrix.identity();\n        mat.data[0] = Math.cos(angleRadians);\n        mat.data[1] = Math.sin(angleRadians);\n        mat.data[2] = -Math.sin(angleRadians);\n        mat.data[3] = Math.cos(angleRadians);\n        return mat;\n    }\n    setPosition(x, y) {\n        this.data[4] = x;\n        this.data[5] = y;\n    }\n    getPosition() {\n        return vec(this.data[4], this.data[5]);\n    }\n    /**\n     * Applies rotation to the current matrix mutating it\n     * @param angle in Radians\n     */\n    rotate(angle) {\n        const a11 = this.data[0];\n        const a21 = this.data[1];\n        const a12 = this.data[2];\n        const a22 = this.data[3];\n        const sine = Math.sin(angle);\n        const cosine = Math.cos(angle);\n        this.data[0] = cosine * a11 + sine * a12;\n        this.data[1] = cosine * a21 + sine * a22;\n        this.data[2] = cosine * a12 - sine * a11;\n        this.data[3] = cosine * a22 - sine * a21;\n        return this;\n    }\n    /**\n     * Applies translation to the current matrix mutating it\n     * @param x\n     * @param y\n     */\n    translate(x, y) {\n        const a11 = this.data[0];\n        const a21 = this.data[1];\n        // const a31 = 0;\n        const a12 = this.data[2];\n        const a22 = this.data[3];\n        // const a32 = 0;\n        const a13 = this.data[4];\n        const a23 = this.data[5];\n        // const a33 = 1;\n        // Doesn't change z\n        this.data[4] = a11 * x + a12 * y + a13;\n        this.data[5] = a21 * x + a22 * y + a23;\n        return this;\n    }\n    /**\n     * Applies scaling to the current matrix mutating it\n     * @param x\n     * @param y\n     */\n    scale(x, y) {\n        const a11 = this.data[0];\n        const a21 = this.data[1];\n        const a12 = this.data[2];\n        const a22 = this.data[3];\n        this.data[0] = a11 * x;\n        this.data[1] = a21 * x;\n        this.data[2] = a12 * y;\n        this.data[3] = a22 * y;\n        this._scale[0] = x;\n        this._scale[1] = y;\n        return this;\n    }\n    determinant() {\n        return this.data[0] * this.data[3] - this.data[1] * this.data[2];\n    }\n    /**\n     * Return the affine inverse, optionally store it in a target matrix.\n     *\n     * It's recommended you call .reset() the target unless you know what you're doing\n     * @param target\n     */\n    inverse(target) {\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\n        // Since we are actually only doing 2D transformations we can use this hack\n        // We don't actually use the 3rd or 4th dimension\n        const det = this.determinant();\n        const inverseDet = 1 / det; // TODO zero check\n        const a = this.data[0];\n        const b = this.data[2];\n        const c = this.data[1];\n        const d = this.data[3];\n        const m = target || AffineMatrix.identity();\n        // inverts rotation and scale\n        m.data[0] = d * inverseDet;\n        m.data[1] = -c * inverseDet;\n        m.data[2] = -b * inverseDet;\n        m.data[3] = a * inverseDet;\n        const tx = this.data[4];\n        const ty = this.data[5];\n        // invert translation\n        // transform translation into the matrix basis created by rot/scale\n        m.data[4] = -(tx * m.data[0] + ty * m.data[2]);\n        m.data[5] = -(tx * m.data[1] + ty * m.data[3]);\n        return m;\n    }\n    multiply(vectorOrMatrix, dest) {\n        if (vectorOrMatrix instanceof Vector) {\n            const result = dest || new Vector(0, 0);\n            const vector = vectorOrMatrix;\n            // these shenanigans are to allow dest and vector to be the same instance\n            const resultX = vector.x * this.data[0] + vector.y * this.data[2] + this.data[4];\n            const resultY = vector.x * this.data[1] + vector.y * this.data[3] + this.data[5];\n            result.x = resultX;\n            result.y = resultY;\n            return result;\n        }\n        else {\n            const result = dest || new AffineMatrix();\n            const other = vectorOrMatrix;\n            const a11 = this.data[0];\n            const a21 = this.data[1];\n            //  const a31 = 0;\n            const a12 = this.data[2];\n            const a22 = this.data[3];\n            //  const a32 = 0;\n            const a13 = this.data[4];\n            const a23 = this.data[5];\n            //  const a33 = 1;\n            const b11 = other.data[0];\n            const b21 = other.data[1];\n            //  const b31 = 0;\n            const b12 = other.data[2];\n            const b22 = other.data[3];\n            //  const b32 = 0;\n            const b13 = other.data[4];\n            const b23 = other.data[5];\n            //  const b33 = 1;\n            result.data[0] = a11 * b11 + a12 * b21; // + a13 * b31; // zero\n            result.data[1] = a21 * b11 + a22 * b21; // + a23 * b31; // zero\n            result.data[2] = a11 * b12 + a12 * b22; // + a13 * b32; // zero\n            result.data[3] = a21 * b12 + a22 * b22; // + a23 * b32; // zero\n            result.data[4] = a11 * b13 + a12 * b23 + a13; // * b33; // one\n            result.data[5] = a21 * b13 + a22 * b23 + a23; // * b33; // one\n            const s = this.getScale();\n            result._scaleSignX = sign(s.x) * sign(result._scaleSignX);\n            result._scaleSignY = sign(s.y) * sign(result._scaleSignY);\n            return result;\n        }\n    }\n    /**\n     * Packed array of length 8, that contains 4 vertices, with 2 components each\n     * So: [x0, y0, x1, y1, x2, y2, x3, y3]\n     * @param quad\n     */\n    multiplyQuadInPlace(quad) {\n        const resultTopLeftX = quad[0] * this.data[0] + quad[1] * this.data[2] + this.data[4];\n        const resultTopLeftY = quad[0] * this.data[1] + quad[1] * this.data[3] + this.data[5];\n        quad[0] = resultTopLeftX;\n        quad[1] = resultTopLeftY;\n        const resultTopRightX = quad[2] * this.data[0] + quad[3] * this.data[2] + this.data[4];\n        const resultTopRightY = quad[2] * this.data[1] + quad[3] * this.data[3] + this.data[5];\n        quad[2] = resultTopRightX;\n        quad[3] = resultTopRightY;\n        const resultBottomLeftX = quad[4] * this.data[0] + quad[5] * this.data[2] + this.data[4];\n        const resultBottomLeftY = quad[4] * this.data[1] + quad[5] * this.data[3] + this.data[5];\n        quad[4] = resultBottomLeftX;\n        quad[5] = resultBottomLeftY;\n        const resultBottomRightX = quad[6] * this.data[0] + quad[7] * this.data[2] + this.data[4];\n        const resultBottomRightY = quad[6] * this.data[1] + quad[7] * this.data[3] + this.data[5];\n        quad[6] = resultBottomRightX;\n        quad[7] = resultBottomRightY;\n    }\n    to4x4() {\n        const mat = new Matrix();\n        mat.data[0] = this.data[0];\n        mat.data[1] = this.data[1];\n        mat.data[2] = 0;\n        mat.data[3] = 0;\n        mat.data[4] = this.data[2];\n        mat.data[5] = this.data[3];\n        mat.data[6] = 0;\n        mat.data[7] = 0;\n        mat.data[8] = 0;\n        mat.data[9] = 0;\n        mat.data[10] = 1;\n        mat.data[11] = 0;\n        mat.data[12] = this.data[4];\n        mat.data[13] = this.data[5];\n        mat.data[14] = 0;\n        mat.data[15] = 1;\n        return mat;\n    }\n    setRotation(angle) {\n        const currentScale = this.getScale();\n        const sine = Math.sin(angle);\n        const cosine = Math.cos(angle);\n        this.data[0] = cosine * currentScale.x;\n        this.data[1] = sine * currentScale.y;\n        this.data[2] = -sine * currentScale.x;\n        this.data[3] = cosine * currentScale.y;\n    }\n    getRotation() {\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\n        return canonicalizeAngle(angle);\n    }\n    getScaleX() {\n        // absolute scale of the matrix (we lose sign so need to add it back)\n        const xscale = vec(this.data[0], this.data[2]).distance();\n        return this._scaleSignX * xscale;\n    }\n    getScaleY() {\n        // absolute scale of the matrix (we lose sign so need to add it back)\n        const yscale = vec(this.data[1], this.data[3]).distance();\n        return this._scaleSignY * yscale;\n    }\n    /**\n     * Get the scale of the matrix\n     */\n    getScale() {\n        return vec(this.getScaleX(), this.getScaleY());\n    }\n    setScaleX(val) {\n        if (val === this._scale[0]) {\n            return;\n        }\n        this._scaleSignX = sign(val);\n        // negative scale acts like a 180 rotation, so flip\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[2] * this._scaleSignX).normalize();\n        this.data[0] = xscale.x * val;\n        this.data[2] = xscale.y * val;\n        this._scale[0] = val;\n    }\n    setScaleY(val) {\n        if (val === this._scale[1]) {\n            return;\n        }\n        this._scaleSignY = sign(val);\n        // negative scale acts like a 180 rotation, so flip\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[3] * this._scaleSignY).normalize();\n        this.data[1] = yscale.x * val;\n        this.data[3] = yscale.y * val;\n        this._scale[1] = val;\n    }\n    setScale(scale) {\n        this.setScaleX(scale.x);\n        this.setScaleY(scale.y);\n    }\n    isIdentity() {\n        return (this.data[0] === 1 &&\n            this.data[1] === 0 &&\n            this.data[2] === 0 &&\n            this.data[3] === 1 &&\n            this.data[4] === 0 &&\n            this.data[5] === 0);\n    }\n    /**\n     * Resets the current matrix to the identity matrix, mutating it\n     * @returns {AffineMatrix} Current matrix as identity\n     */\n    reset() {\n        const mat = this;\n        mat.data[0] = 1;\n        mat.data[1] = 0;\n        mat.data[2] = 0;\n        mat.data[3] = 1;\n        mat.data[4] = 0;\n        mat.data[5] = 0;\n        return mat;\n    }\n    /**\n     * Creates a new Matrix with the same data as the current [[AffineMatrix]]\n     */\n    clone(dest) {\n        const mat = dest || new AffineMatrix();\n        mat.data.set(this.data);\n        return mat;\n    }\n    toString() {\n        return `\r\n[${this.data[0]} ${this.data[2]} ${this.data[4]}]\r\n[${this.data[1]} ${this.data[3]} ${this.data[5]}]\r\n[0 0 1]\r\n`;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/transform-stack.ts\n\nclass TransformStack {\n    constructor() {\n        this._transforms = [];\n        this._currentTransform = AffineMatrix.identity();\n    }\n    save() {\n        this._transforms.push(this._currentTransform);\n        this._currentTransform = this._currentTransform.clone();\n    }\n    restore() {\n        this._currentTransform = this._transforms.pop();\n    }\n    translate(x, y) {\n        return this._currentTransform.translate(x, y);\n    }\n    rotate(angle) {\n        return this._currentTransform.rotate(angle);\n    }\n    scale(x, y) {\n        return this._currentTransform.scale(x, y);\n    }\n    set current(matrix) {\n        this._currentTransform = matrix;\n    }\n    get current() {\n        return this._currentTransform;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/state-stack.ts\n\nclass StateStack {\n    constructor() {\n        this.current = this._getDefaultState();\n        this._states = [];\n    }\n    _getDefaultState() {\n        return {\n            opacity: 1,\n            z: 0,\n            tint: Color.White,\n            material: null\n        };\n    }\n    _cloneState() {\n        return {\n            opacity: this.current.opacity,\n            z: this.current.z,\n            tint: this.current.tint.clone(),\n            material: this.current.material // TODO is this going to cause problems when cloning\n        };\n    }\n    save() {\n        this._states.push(this.current);\n        this.current = this._cloneState();\n    }\n    restore() {\n        this.current = this._states.pop();\n    }\n}\n\n;// CONCATENATED MODULE: ./Resources/Resource.ts\n\n\nconst ResourceEvents = {\n    Complete: 'complete',\n    Load: 'load',\n    LoadStart: 'loadstart',\n    Progress: 'progress',\n    Error: 'error'\n};\n/**\n * The [[Resource]] type allows games built in Excalibur to load generic resources.\n * For any type of remote resource it is recommended to use [[Resource]] for preloading.\n */\nclass Resource {\n    /**\n     * @param path          Path to the remote resource\n     * @param responseType  The type to expect as a response: \"\" | \"arraybuffer\" | \"blob\" | \"document\" | \"json\" | \"text\";\n     * @param bustCache     Whether or not to cache-bust requests\n     */\n    constructor(path, responseType, bustCache = false) {\n        this.path = path;\n        this.responseType = responseType;\n        this.bustCache = bustCache;\n        this.data = null;\n        this.logger = Logger.getInstance();\n        this.events = new EventEmitter();\n    }\n    /**\n     * Returns true if the Resource is completely loaded and is ready\n     * to be drawn.\n     */\n    isLoaded() {\n        return this.data !== null;\n    }\n    _cacheBust(uri) {\n        const query = /\\?\\w*=\\w*/;\n        if (query.test(uri)) {\n            uri += '&__=' + Date.now();\n        }\n        else {\n            uri += '?__=' + Date.now();\n        }\n        return uri;\n    }\n    /**\n     * Begin loading the resource and returns a promise to be resolved on completion\n     */\n    load() {\n        return new Promise((resolve, reject) => {\n            // Exit early if we already have data\n            if (this.data !== null) {\n                this.logger.debug('Already have data for resource', this.path);\n                this.events.emit('complete', this.data);\n                resolve(this.data);\n                return;\n            }\n            const request = new XMLHttpRequest();\n            request.open('GET', this.bustCache ? this._cacheBust(this.path) : this.path, true);\n            request.responseType = this.responseType;\n            request.addEventListener('loadstart', (e) => this.events.emit('loadstart', e));\n            request.addEventListener('progress', (e) => this.events.emit('progress', e));\n            request.addEventListener('error', (e) => this.events.emit('error', e));\n            request.addEventListener('load', (e) => this.events.emit('load', e));\n            request.addEventListener('load', () => {\n                // XHR on file:// success status is 0, such as with PhantomJS\n                if (request.status !== 0 && request.status !== 200) {\n                    this.logger.error('Failed to load resource ', this.path, ' server responded with error code', request.status);\n                    this.events.emit('error', request.response);\n                    reject(new Error(request.statusText));\n                    return;\n                }\n                this.data = request.response;\n                this.events.emit('complete', this.data);\n                this.logger.debug('Completed loading resource', this.path);\n                resolve(this.data);\n            });\n            request.send();\n        });\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Watch.ts\n/**\n * Watch an object with a proxy, only fires if property value is different\n */\nfunction watch(type, change) {\n    if (!type) {\n        return type;\n    }\n    if (type.__isProxy === undefined) {\n        // expando hack to mark a proxy\n        return new Proxy(type, {\n            set: (obj, prop, value) => {\n                // The default behavior to store the value\n                if (obj[prop] !== value) {\n                    obj[prop] = value;\n                    // Avoid watching private junk\n                    if (typeof prop === 'string') {\n                        if (prop[0] !== '_') {\n                            change(obj);\n                        }\n                    }\n                }\n                // Indicate success\n                return true;\n            },\n            get: (obj, prop) => {\n                if (prop !== '__isProxy') {\n                    return obj[prop];\n                }\n                return true;\n            }\n        });\n    }\n    return type;\n}\nconst createHandler = (path = [], change, typeType) => ({\n    get: (target, key) => {\n        if (key === '__isProxy') {\n            return true;\n        }\n        if (typeof target[key] === 'object' && target[key] != null) {\n            return new Proxy(target[key], createHandler([...path, key], change, typeType));\n        }\n        return target[key];\n    },\n    set: (target, key, value) => {\n        if (typeof key === 'string') {\n            if (key[0] !== '_') {\n                change(typeType);\n            }\n        }\n        target[key] = value;\n        return true;\n    }\n});\n/**\n *\n */\nfunction watchDeep(type, change) {\n    if (!type) {\n        return type;\n    }\n    if (type.__isProxy === undefined) {\n        // expando hack to mark a proxy\n        return new Proxy(type, createHandler([], change, type));\n    }\n    return type;\n}\n/**\n * Watch an object with a proxy, fires change on any property value change\n */\nfunction watchAny(type, change) {\n    if (!type) {\n        return type;\n    }\n    if (type.__isProxy === undefined) {\n        // expando hack to mark a proxy\n        return new Proxy(type, {\n            set: (obj, prop, value) => {\n                // The default behavior to store the value\n                obj[prop] = value;\n                // Avoid watching private junk\n                if (typeof prop === 'string') {\n                    if (prop[0] !== '_') {\n                        change(obj);\n                    }\n                }\n                // Indicate success\n                return true;\n            },\n            get: (obj, prop) => {\n                if (prop !== '__isProxy') {\n                    return obj[prop];\n                }\n                return true;\n            }\n        });\n    }\n    return type;\n}\n\n;// CONCATENATED MODULE: ./Graphics/Graphic.ts\n\n\n\n\n/**\n * A Graphic is the base Excalibur primitive for something that can be drawn to the [[ExcaliburGraphicsContext]].\n * [[Sprite]], [[Animation]], [[GraphicsGroup]], [[Canvas]], [[Rectangle]], [[Circle]], and [[Polygon]] all derive from the\n * [[Graphic]] abstract class.\n *\n * Implementors of a Graphic must override the abstract [[Graphic._drawImage]] method to render an image to the graphics context. Graphic\n * handles all the position, rotation, and scale transformations in [[Graphic._preDraw]] and [[Graphic._postDraw]]\n */\nclass Graphic {\n    isStale() {\n        return this._transformStale;\n    }\n    /**\n     * Gets or sets the flipHorizontal, which will flip the graphic horizontally (across the y axis)\n     */\n    get flipHorizontal() {\n        return this._flipHorizontal;\n    }\n    set flipHorizontal(value) {\n        this._flipHorizontal = value;\n        this._transformStale = true;\n    }\n    /**\n     * Gets or sets the flipVertical, which will flip the graphic vertically (across the x axis)\n     */\n    get flipVertical() {\n        return this._flipVertical;\n    }\n    set flipVertical(value) {\n        this._flipVertical = value;\n        this._transformStale = true;\n    }\n    /**\n     * Gets or sets the rotation of the graphic\n     */\n    get rotation() {\n        return this._rotation;\n    }\n    set rotation(value) {\n        this._rotation = value;\n        this._transformStale = true;\n    }\n    /**\n     * Gets or sets the scale of the graphic, this affects the width and\n     */\n    get scale() {\n        return this._scale;\n    }\n    set scale(value) {\n        this._scale = watch(value, () => {\n            this._transformStale = true;\n        });\n        this._transformStale = true;\n    }\n    /**\n     * Gets or sets the origin of the graphic, if not set the center of the graphic is the origin\n     */\n    get origin() {\n        return this._origin;\n    }\n    set origin(value) {\n        this._origin = watch(value, () => {\n            this._transformStale = true;\n        });\n        this._transformStale = true;\n    }\n    constructor(options) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        this.id = Graphic._ID++;\n        this.transform = AffineMatrix.identity();\n        this.tint = null;\n        this._transformStale = true;\n        /**\n         * Gets or sets wether to show debug information about the graphic\n         */\n        this.showDebug = false;\n        this._flipHorizontal = false;\n        this._flipVertical = false;\n        this._rotation = 0;\n        /**\n         * Gets or sets the opacity of the graphic, 0 is transparent, 1 is solid (opaque).\n         */\n        this.opacity = 1;\n        this._scale = Vector.One;\n        this._origin = null;\n        this._width = 0;\n        this._height = 0;\n        if (options) {\n            this.origin = (_a = options.origin) !== null && _a !== void 0 ? _a : this.origin;\n            this.flipHorizontal = (_b = options.flipHorizontal) !== null && _b !== void 0 ? _b : this.flipHorizontal;\n            this.flipVertical = (_c = options.flipVertical) !== null && _c !== void 0 ? _c : this.flipVertical;\n            this.rotation = (_d = options.rotation) !== null && _d !== void 0 ? _d : this.rotation;\n            this.opacity = (_e = options.opacity) !== null && _e !== void 0 ? _e : this.opacity;\n            this.scale = (_f = options.scale) !== null && _f !== void 0 ? _f : this.scale;\n            this.tint = (_g = options.tint) !== null && _g !== void 0 ? _g : this.tint;\n        }\n    }\n    cloneGraphicOptions() {\n        return {\n            width: this.width / this.scale.x,\n            height: this.height / this.scale.y,\n            origin: this.origin ? this.origin.clone() : null,\n            flipHorizontal: this.flipHorizontal,\n            flipVertical: this.flipVertical,\n            rotation: this.rotation,\n            opacity: this.opacity,\n            scale: this.scale ? this.scale.clone() : null,\n            tint: this.tint ? this.tint.clone() : null\n        };\n    }\n    /**\n     * Gets or sets the width of the graphic (always positive)\n     */\n    get width() {\n        return Math.abs(this._width * this.scale.x);\n    }\n    /**\n     * Gets or sets the height of the graphic (always positive)\n     */\n    get height() {\n        return Math.abs(this._height * this.scale.y);\n    }\n    set width(value) {\n        this._width = value;\n        this._transformStale = true;\n    }\n    set height(value) {\n        this._height = value;\n        this._transformStale = true;\n    }\n    /**\n     * Gets a copy of the bounds in pixels occupied by the graphic on the the screen. This includes scale.\n     */\n    get localBounds() {\n        return BoundingBox.fromDimension(this.width, this.height, Vector.Zero);\n    }\n    /**\n     * Draw the whole graphic to the context including transform\n     * @param ex The excalibur graphics context\n     * @param x\n     * @param y\n     */\n    draw(ex, x, y) {\n        this._preDraw(ex, x, y);\n        this._drawImage(ex, 0, 0);\n        this._postDraw(ex);\n    }\n    /**\n     * Apply affine transformations to the graphics context to manipulate the graphic before [[Graphic._drawImage]]\n     * @param ex\n     * @param x\n     * @param y\n     */\n    _preDraw(ex, x, y) {\n        ex.save();\n        ex.translate(x, y);\n        if (this._transformStale) {\n            this.transform.reset();\n            this.transform.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\n            this._rotate(this.transform);\n            this._flip(this.transform);\n            this._transformStale = false;\n        }\n        ex.multiply(this.transform);\n        // it is important to multiply alphas so graphics respect the current context\n        ex.opacity = ex.opacity * this.opacity;\n        if (this.tint) {\n            ex.tint = this.tint;\n        }\n    }\n    _rotate(ex) {\n        var _a;\n        const scaleDirX = this.scale.x > 0 ? 1 : -1;\n        const scaleDirY = this.scale.y > 0 ? 1 : -1;\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : vec(this.width / 2, this.height / 2);\n        ex.translate(origin.x, origin.y);\n        ex.rotate(this.rotation);\n        // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\n        ex.scale(scaleDirX, scaleDirY);\n        ex.translate(-origin.x, -origin.y);\n    }\n    _flip(ex) {\n        if (this.flipHorizontal) {\n            ex.translate(this.width / this.scale.x, 0);\n            ex.scale(-1, 1);\n        }\n        if (this.flipVertical) {\n            ex.translate(0, this.height / this.scale.y);\n            ex.scale(1, -1);\n        }\n    }\n    /**\n     * Apply any additional work after [[Graphic._drawImage]] and restore the context state.\n     * @param ex\n     */\n    _postDraw(ex) {\n        if (this.showDebug) {\n            ex.debug.drawRect(0, 0, this.width, this.height);\n        }\n        ex.restore();\n    }\n}\nGraphic._ID = 0;\n\n;// CONCATENATED MODULE: ./Graphics/Sprite.ts\n\n\nclass Sprite extends Graphic {\n    static from(image) {\n        return new Sprite({\n            image: image\n        });\n    }\n    constructor(options) {\n        var _a, _b;\n        super(options);\n        this._logger = Logger.getInstance();\n        this._dirty = true;\n        this.image = options.image;\n        const { width, height } = options;\n        this.sourceView = (_a = options.sourceView) !== null && _a !== void 0 ? _a : { x: 0, y: 0, width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\n        this.destSize = (_b = options.destSize) !== null && _b !== void 0 ? _b : { width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\n        this._updateSpriteDimensions();\n        // Fire when loaded\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this.image.ready.then(() => {\n            this._updateSpriteDimensions();\n        });\n    }\n    get width() {\n        return Math.abs(this.destSize.width * this.scale.x);\n    }\n    get height() {\n        return Math.abs(this.destSize.height * this.scale.y);\n    }\n    set width(newWidth) {\n        newWidth /= Math.abs(this.scale.x);\n        this.destSize.width = newWidth;\n        super.width = Math.ceil(this.destSize.width);\n    }\n    set height(newHeight) {\n        newHeight /= Math.abs(this.scale.y);\n        this.destSize.height = newHeight;\n        super.height = Math.ceil(this.destSize.height);\n    }\n    _updateSpriteDimensions() {\n        var _a, _b, _c, _d, _e, _f;\n        const { width: nativeWidth, height: nativeHeight } = this.image;\n        // This code uses || to avoid 0's\n        // If the source is not specified, use the native dimension\n        this.sourceView.width = ((_a = this.sourceView) === null || _a === void 0 ? void 0 : _a.width) || nativeWidth;\n        this.sourceView.height = ((_b = this.sourceView) === null || _b === void 0 ? void 0 : _b.height) || nativeHeight;\n        // If the destination is not specified, use the source if specified, then native\n        this.destSize.width = ((_c = this.destSize) === null || _c === void 0 ? void 0 : _c.width) || ((_d = this.sourceView) === null || _d === void 0 ? void 0 : _d.width) || nativeWidth;\n        this.destSize.height = ((_e = this.destSize) === null || _e === void 0 ? void 0 : _e.height) || ((_f = this.sourceView) === null || _f === void 0 ? void 0 : _f.height) || nativeHeight;\n        this.width = Math.ceil(this.destSize.width) * this.scale.x;\n        this.height = Math.ceil(this.destSize.height) * this.scale.y;\n    }\n    _preDraw(ex, x, y) {\n        if (this.image.isLoaded() && this._dirty) {\n            this._dirty = false;\n            this._updateSpriteDimensions();\n        }\n        super._preDraw(ex, x, y);\n    }\n    _drawImage(ex, x, y) {\n        if (this.image.isLoaded()) {\n            ex.drawImage(this.image.image, this.sourceView.x, this.sourceView.y, this.sourceView.width, this.sourceView.height, x, y, this.destSize.width, this.destSize.height);\n        }\n        else {\n            this._logger.warnOnce(`ImageSource ${this.image.path}` +\n                ` is not yet loaded and won't be drawn. Please call .load() or include in a Loader.\\n\\n` +\n                `Read https://excaliburjs.com/docs/imagesource for more information.`);\n        }\n    }\n    clone() {\n        return new Sprite({\n            image: this.image,\n            sourceView: { ...this.sourceView },\n            destSize: { ...this.destSize },\n            ...this.cloneGraphicOptions()\n        });\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Filtering.ts\n/**\n * Describes the different image filtering modes\n */\nvar ImageFiltering;\n(function (ImageFiltering) {\n    /**\n     * Pixel is useful when you do not want smoothing aka antialiasing applied to your graphics.\n     *\n     * Useful for Pixel art aesthetics.\n     */\n    ImageFiltering[\"Pixel\"] = \"Pixel\";\n    /**\n     * Blended is useful when you have high resolution artwork and would like it blended and smoothed\n     */\n    ImageFiltering[\"Blended\"] = \"Blended\";\n})(ImageFiltering || (ImageFiltering = {}));\n/**\n * Parse the image filtering attribute value, if it doesn't match returns null\n */\nfunction parseImageFiltering(val) {\n    switch (val) {\n        case ImageFiltering.Pixel: return ImageFiltering.Pixel;\n        case ImageFiltering.Blended: return ImageFiltering.Blended;\n        default: return null;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Wrapping.ts\n/**\n * Describes the different image wrapping modes\n */\nvar ImageWrapping;\n(function (ImageWrapping) {\n    ImageWrapping[\"Clamp\"] = \"Clamp\";\n    ImageWrapping[\"Repeat\"] = \"Repeat\";\n    ImageWrapping[\"Mirror\"] = \"Mirror\";\n})(ImageWrapping || (ImageWrapping = {}));\n/**\n *\n */\nfunction parseImageWrapping(val) {\n    switch (val) {\n        case ImageWrapping.Clamp: return ImageWrapping.Clamp;\n        case ImageWrapping.Repeat: return ImageWrapping.Repeat;\n        case ImageWrapping.Mirror: return ImageWrapping.Mirror;\n        default: return ImageWrapping.Clamp;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/texture-loader.ts\n\n\n\n/**\n * Manages loading image sources into webgl textures, a unique id is associated with all sources\n */\nclass TextureLoader {\n    constructor(gl) {\n        this._textureMap = new Map();\n        this._gl = gl;\n        TextureLoader._MAX_TEXTURE_SIZE = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n    }\n    dispose() {\n        for (const [image] of this._textureMap) {\n            this.delete(image);\n        }\n        this._textureMap.clear();\n        this._gl = null;\n    }\n    /**\n     * Get the WebGL Texture from a source image\n     * @param image\n     */\n    get(image) {\n        return this._textureMap.get(image);\n    }\n    /**\n     * Returns whether a source image has been loaded as a texture\n     * @param image\n     */\n    has(image) {\n        return this._textureMap.has(image);\n    }\n    /**\n     * Loads a graphic into webgl and returns it's texture info, a webgl context must be previously registered\n     * @param image Source graphic\n     * @param options {ImageSourceOptions} Optionally configure the ImageFiltering and ImageWrapping mode to apply to the loaded texture\n     * @param forceUpdate Optionally force a texture to be reloaded, useful if the source graphic has changed\n     */\n    load(image, options, forceUpdate = false) {\n        // Ignore loading if webgl is not registered\n        const gl = this._gl;\n        if (!gl) {\n            return null;\n        }\n        const { filtering, wrapping } = { ...options };\n        let tex = null;\n        // If reuse the texture if it's from the same source\n        if (this.has(image)) {\n            tex = this.get(image);\n        }\n        // Update existing webgl texture and return early\n        if (tex) {\n            if (forceUpdate) {\n                gl.bindTexture(gl.TEXTURE_2D, tex);\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n            }\n            return tex;\n        }\n        // No texture exists create a new one\n        tex = gl.createTexture();\n        // TODO implement texture gc with weakmap and timer\n        TextureLoader.checkImageSizeSupportedAndLog(image);\n        gl.bindTexture(gl.TEXTURE_2D, tex);\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n        let wrappingConfig;\n        if (wrapping) {\n            if (typeof wrapping === 'string') {\n                wrappingConfig = {\n                    x: wrapping,\n                    y: wrapping\n                };\n            }\n            else {\n                wrappingConfig = {\n                    x: wrapping.x,\n                    y: wrapping.y\n                };\n            }\n        }\n        const { x: xWrap, y: yWrap } = (wrappingConfig !== null && wrappingConfig !== void 0 ? wrappingConfig : TextureLoader.wrapping);\n        switch (xWrap) {\n            case ImageWrapping.Clamp:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n                break;\n            case ImageWrapping.Repeat:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n                break;\n            case ImageWrapping.Mirror:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.MIRRORED_REPEAT);\n                break;\n            default:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        }\n        switch (yWrap) {\n            case ImageWrapping.Clamp:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n                break;\n            case ImageWrapping.Repeat:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n                break;\n            case ImageWrapping.Mirror:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.MIRRORED_REPEAT);\n                break;\n            default:\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        }\n        // NEAREST for pixel art, LINEAR for hi-res\n        const filterMode = filtering !== null && filtering !== void 0 ? filtering : TextureLoader.filtering;\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n        this._textureMap.set(image, tex);\n        return tex;\n    }\n    delete(image) {\n        // Ignore loading if webgl is not registered\n        const gl = this._gl;\n        if (!gl) {\n            return null;\n        }\n        let tex = null;\n        if (this.has(image)) {\n            tex = this.get(image);\n            gl.deleteTexture(tex);\n        }\n    }\n    /**\n     * Takes an image and returns if it meets size criteria for hardware\n     * @param image\n     * @returns if the image will be supported at runtime\n     */\n    static checkImageSizeSupportedAndLog(image) {\n        var _a;\n        const originalSrc = (_a = image.dataset.originalSrc) !== null && _a !== void 0 ? _a : 'internal canvas bitmap';\n        if (image.width > TextureLoader._MAX_TEXTURE_SIZE || image.height > TextureLoader._MAX_TEXTURE_SIZE) {\n            TextureLoader._LOGGER.error(`The image [${originalSrc}] provided to Excalibur is too large for the device's maximum texture size of ` +\n                `(${TextureLoader._MAX_TEXTURE_SIZE}x${TextureLoader._MAX_TEXTURE_SIZE}) please resize to an image `\n                + `for excalibur to render properly.\\n\\nImages will likely render as black rectangles.\\n\\n` +\n                `Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`);\n            return false;\n        }\n        else if (image.width > 4096 || image.height > 4096) {\n            // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits\n            TextureLoader._LOGGER.warn(`The image [${originalSrc}] provided to excalibur is too large may not work on all mobile devices, ` +\n                `it is recommended you resize images to a maximum (4096x4096).\\n\\n` +\n                `Images will likely render as black rectangles on some mobile platforms.\\n\\n` +\n                `Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`);\n        }\n        return true;\n    }\n}\nTextureLoader._LOGGER = Logger.getInstance();\n/**\n * Sets the default filtering for the Excalibur texture loader, default [[ImageFiltering.Blended]]\n */\nTextureLoader.filtering = ImageFiltering.Blended;\nTextureLoader.wrapping = { x: ImageWrapping.Clamp, y: ImageWrapping.Clamp };\nTextureLoader._MAX_TEXTURE_SIZE = 4096;\n\n;// CONCATENATED MODULE: ./Graphics/ImageSource.ts\n\n\n\n\n\n\n\nconst ImageSourceAttributeConstants = {\n    Filtering: 'filtering',\n    WrappingX: 'wrapping-x',\n    WrappingY: 'wrapping-y'\n};\nclass ImageSource {\n    /**\n     * The original size of the source image in pixels\n     */\n    get width() {\n        return this.image.naturalWidth;\n    }\n    /**\n     * The original height of the source image in pixels\n     */\n    get height() {\n        return this.image.naturalHeight;\n    }\n    /**\n     * Returns true if the Texture is completely loaded and is ready\n     * to be drawn.\n     */\n    isLoaded() {\n        if (!this._src) {\n            // this boosts speed of access\n            this._src = this.data.src;\n        }\n        return !!this._src;\n    }\n    get image() {\n        return this.data;\n    }\n    constructor(path, bustCacheOrOptions, filtering) {\n        this._logger = Logger.getInstance();\n        /**\n         * Access to the underlying html image element\n         */\n        this.data = new Image();\n        this._readyFuture = new Future();\n        /**\n         * Promise the resolves when the image is loaded and ready for use, does not initiate loading\n         */\n        this.ready = this._readyFuture.promise;\n        this.path = path;\n        let bustCache = false;\n        let wrapping;\n        if (typeof bustCacheOrOptions === 'boolean') {\n            bustCache = bustCacheOrOptions;\n        }\n        else {\n            ({ filtering, wrapping, bustCache } = { ...bustCacheOrOptions });\n        }\n        this._resource = new Resource(path, 'blob', bustCache);\n        this.filtering = filtering !== null && filtering !== void 0 ? filtering : this.filtering;\n        if (typeof wrapping === 'string') {\n            this.wrapping = {\n                x: wrapping,\n                y: wrapping\n            };\n        }\n        else {\n            this.wrapping = wrapping !== null && wrapping !== void 0 ? wrapping : this.wrapping;\n        }\n        if (path.endsWith('.svg') || path.endsWith('.gif')) {\n            this._logger.warn(`Image type is not fully supported, you may have mixed results ${path}. Fully supported: jpg, bmp, and png`);\n        }\n    }\n    /**\n     * Create an ImageSource from and HTML <image> tag element\n     * @param image\n     */\n    static fromHtmlImageElement(image, options) {\n        const imageSource = new ImageSource('');\n        imageSource._src = 'image-element';\n        imageSource.data = image;\n        imageSource.data.setAttribute('data-original-src', 'image-element');\n        if (options === null || options === void 0 ? void 0 : options.filtering) {\n            imageSource.data.setAttribute(ImageSourceAttributeConstants.Filtering, options === null || options === void 0 ? void 0 : options.filtering);\n        }\n        else {\n            imageSource.data.setAttribute(ImageSourceAttributeConstants.Filtering, ImageFiltering.Blended);\n        }\n        if (options === null || options === void 0 ? void 0 : options.wrapping) {\n            let wrapping;\n            if (typeof options.wrapping === 'string') {\n                wrapping = {\n                    x: options.wrapping,\n                    y: options.wrapping\n                };\n            }\n            else {\n                wrapping = {\n                    x: options.wrapping.x,\n                    y: options.wrapping.y\n                };\n            }\n            imageSource.data.setAttribute(ImageSourceAttributeConstants.WrappingX, wrapping.x);\n            imageSource.data.setAttribute(ImageSourceAttributeConstants.WrappingY, wrapping.y);\n        }\n        else {\n            imageSource.data.setAttribute(ImageSourceAttributeConstants.WrappingX, ImageWrapping.Clamp);\n            imageSource.data.setAttribute(ImageSourceAttributeConstants.WrappingY, ImageWrapping.Clamp);\n        }\n        TextureLoader.checkImageSizeSupportedAndLog(image);\n        imageSource._readyFuture.resolve(image);\n        return imageSource;\n    }\n    /**\n     * Should excalibur add a cache busting querystring? By default false.\n     * Must be set before loading\n     */\n    get bustCache() {\n        return this._resource.bustCache;\n    }\n    set bustCache(val) {\n        this._resource.bustCache = val;\n    }\n    /**\n     * Begins loading the image and returns a promise that resolves when the image is loaded\n     */\n    async load() {\n        var _a, _b, _c, _d;\n        if (this.isLoaded()) {\n            return this.data;\n        }\n        try {\n            // Load base64 or blob if needed\n            let url;\n            if (!this.path.includes('data:image/')) {\n                const blob = await this._resource.load();\n                url = URL.createObjectURL(blob);\n            }\n            else {\n                url = this.path;\n            }\n            // Decode the image\n            const image = new Image();\n            // Use Image.onload over Image.decode()\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=1055828#c7\n            // Otherwise chrome will throw still Image.decode() failures for large textures\n            const loadedFuture = new Future();\n            image.onload = () => loadedFuture.resolve();\n            image.src = url;\n            image.setAttribute('data-original-src', this.path);\n            await loadedFuture.promise;\n            // Set results\n            // We defer loading the texture into webgl until the first draw that way we avoid a singleton\n            // and for the multi-engine case the texture needs to be created in EACH webgl context to work\n            // See image-renderer.ts draw()\n            this.data = image;\n            // emit warning if potentially too big\n            TextureLoader.checkImageSizeSupportedAndLog(this.data);\n        }\n        catch (error) {\n            throw `Error loading ImageSource from path '${this.path}' with error [${error.message}]`;\n        }\n        // Do a bad thing to pass the filtering as an attribute\n        this.data.setAttribute(ImageSourceAttributeConstants.Filtering, this.filtering);\n        this.data.setAttribute(ImageSourceAttributeConstants.WrappingX, (_b = (_a = this.wrapping) === null || _a === void 0 ? void 0 : _a.x) !== null && _b !== void 0 ? _b : ImageWrapping.Clamp);\n        this.data.setAttribute(ImageSourceAttributeConstants.WrappingY, (_d = (_c = this.wrapping) === null || _c === void 0 ? void 0 : _c.y) !== null && _d !== void 0 ? _d : ImageWrapping.Clamp);\n        // todo emit complete\n        this._readyFuture.resolve(this.data);\n        return this.data;\n    }\n    /**\n     * Build a sprite from this ImageSource\n     */\n    toSprite() {\n        return Sprite.from(this);\n    }\n    /**\n     * Unload images from memory\n     */\n    unload() {\n        this.data = new Image();\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/SpriteFont.ts\n\n\n\n\nclass SpriteFont extends Graphic {\n    constructor(options) {\n        super(options);\n        this._text = '';\n        this.alphabet = '';\n        this.shadow = null;\n        this.caseInsensitive = false;\n        this.spacing = 0;\n        this.lineHeight = undefined;\n        this._logger = Logger.getInstance();\n        const { alphabet, spriteSheet, caseInsensitive, spacing, shadow, lineHeight } = options;\n        this.alphabet = alphabet;\n        this.spriteSheet = spriteSheet;\n        this.caseInsensitive = caseInsensitive !== null && caseInsensitive !== void 0 ? caseInsensitive : this.caseInsensitive;\n        this.spacing = spacing !== null && spacing !== void 0 ? spacing : this.spacing;\n        this.shadow = shadow !== null && shadow !== void 0 ? shadow : this.shadow;\n        this.lineHeight = lineHeight !== null && lineHeight !== void 0 ? lineHeight : this.lineHeight;\n    }\n    _getCharacterSprites(text) {\n        const results = [];\n        // handle case insensitive\n        const textToRender = this.caseInsensitive ? text.toLocaleLowerCase() : text;\n        const alphabet = this.caseInsensitive ? this.alphabet.toLocaleLowerCase() : this.alphabet;\n        // for each letter in text\n        for (let letterIndex = 0; letterIndex < textToRender.length; letterIndex++) {\n            // find the sprite index in alphabet , if there is an error pick the first\n            const letter = textToRender[letterIndex];\n            let spriteIndex = alphabet.indexOf(letter);\n            if (spriteIndex === -1) {\n                spriteIndex = 0;\n                this._logger.warnOnce(`SpriteFont - Cannot find letter '${letter}' in configured alphabet '${alphabet}'.`);\n                this._logger.warnOnce('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\n            }\n            const letterSprite = this.spriteSheet.sprites[spriteIndex];\n            if (letterSprite) {\n                results.push(letterSprite);\n            }\n            else {\n                this._logger.warnOnce(`SpriteFont - Cannot find sprite for '${letter}' at index '${spriteIndex}' in configured SpriteSheet`);\n                this._logger.warnOnce('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\n            }\n        }\n        return results;\n    }\n    measureText(text, maxWidth) {\n        const lines = this._getLinesFromText(text, maxWidth);\n        const maxWidthLine = lines.reduce((a, b) => {\n            return a.length > b.length ? a : b;\n        });\n        const sprites = this._getCharacterSprites(maxWidthLine);\n        let width = 0;\n        let height = 0;\n        for (const sprite of sprites) {\n            width += sprite.width + this.spacing;\n            height = Math.max(height, sprite.height);\n        }\n        return BoundingBox.fromDimension(width, height * lines.length, Vector.Zero);\n    }\n    _drawImage(ex, x, y, maxWidth) {\n        var _a;\n        let xCursor = 0;\n        let yCursor = 0;\n        let height = 0;\n        const lines = this._getLinesFromText(this._text, maxWidth);\n        for (const line of lines) {\n            for (const sprite of this._getCharacterSprites(line)) {\n                // draw it in the right spot and increase the cursor by sprite width\n                sprite.draw(ex, x + xCursor, y + yCursor);\n                xCursor += sprite.width + this.spacing;\n                height = Math.max(height, sprite.height);\n            }\n            xCursor = 0;\n            yCursor += (_a = this.lineHeight) !== null && _a !== void 0 ? _a : height;\n        }\n    }\n    render(ex, text, _color, x, y, maxWidth) {\n        // SpriteFont doesn't support _color, yet...\n        this._text = text;\n        const bounds = this.measureText(text, maxWidth);\n        this.width = bounds.width;\n        this.height = bounds.height;\n        if (this.shadow) {\n            ex.save();\n            ex.translate(this.shadow.offset.x, this.shadow.offset.y);\n            this._preDraw(ex, x, y);\n            this._drawImage(ex, 0, 0, maxWidth);\n            this._postDraw(ex);\n            ex.restore();\n        }\n        this._preDraw(ex, x, y);\n        this._drawImage(ex, 0, 0, maxWidth);\n        this._postDraw(ex);\n    }\n    clone() {\n        return new SpriteFont({\n            alphabet: this.alphabet,\n            spriteSheet: this.spriteSheet,\n            spacing: this.spacing\n        });\n    }\n    _getLinesFromText(text, maxWidth) {\n        if (this._cachedText === text && this._cachedRenderWidth === maxWidth) {\n            return this._cachedLines;\n        }\n        const lines = text.split('\\n');\n        if (maxWidth == null) {\n            return lines;\n        }\n        // If the current line goes past the maxWidth, append a new line without modifying the underlying text.\n        for (let i = 0; i < lines.length; i++) {\n            let line = lines[i];\n            let newLine = '';\n            // Note: we subtract the spacing to counter the initial padding on the left side.\n            if (this.measureText(line).width > maxWidth) {\n                while (this.measureText(line).width > maxWidth) {\n                    newLine = line[line.length - 1] + newLine;\n                    line = line.slice(0, -1); // Remove last character from line\n                }\n                // Update the array with our new values\n                lines[i] = line;\n                lines[i + 1] = newLine;\n            }\n        }\n        this._cachedText = text;\n        this._cachedLines = lines;\n        this._cachedRenderWidth = maxWidth;\n        return lines;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/SpriteSheet.ts\n\n/**\n * Represents a collection of sprites from a source image with some organization in a grid\n */\nclass SpriteSheet {\n    /**\n     * Build a new sprite sheet from a list of sprites\n     *\n     * Use [[SpriteSheet.fromImageSource]] to create a SpriteSheet from an [[ImageSource]] organized in a grid\n     * @param options\n     */\n    constructor(options) {\n        this.sprites = [];\n        const { sprites, rows, columns } = options;\n        this.sprites = sprites;\n        this.rows = rows !== null && rows !== void 0 ? rows : 1;\n        this.columns = columns !== null && columns !== void 0 ? columns : this.sprites.length;\n    }\n    /**\n     * Find a sprite by their x/y integer coordinates in the SpriteSheet, for example `getSprite(0, 0)` is the [[Sprite]] in the top-left\n     * and `getSprite(1, 0)` is the sprite one to the right.\n     * @param x\n     * @param y\n     */\n    getSprite(x, y, options) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n        if (x >= this.columns || x < 0) {\n            throw Error(`No sprite exists in the SpriteSheet at (${x}, ${y}), x: ${x} should be between 0 and ${this.columns - 1}`);\n        }\n        if (y >= this.rows || y < 0) {\n            throw Error(`No sprite exists in the SpriteSheet at (${x}, ${y}), y: ${y} should be between 0 and ${this.rows - 1}`);\n        }\n        const spriteIndex = x + y * this.columns;\n        const sprite = this.sprites[spriteIndex];\n        if (sprite) {\n            if (options) {\n                const spriteWithOptions = sprite.clone();\n                spriteWithOptions.flipHorizontal = (_a = options.flipHorizontal) !== null && _a !== void 0 ? _a : spriteWithOptions.flipHorizontal;\n                spriteWithOptions.flipVertical = (_b = options.flipVertical) !== null && _b !== void 0 ? _b : spriteWithOptions.flipVertical;\n                spriteWithOptions.width = (_c = options.width) !== null && _c !== void 0 ? _c : spriteWithOptions.width;\n                spriteWithOptions.height = (_d = options.height) !== null && _d !== void 0 ? _d : spriteWithOptions.height;\n                spriteWithOptions.rotation = (_e = options.rotation) !== null && _e !== void 0 ? _e : spriteWithOptions.rotation;\n                spriteWithOptions.scale = (_f = options.scale) !== null && _f !== void 0 ? _f : spriteWithOptions.scale;\n                spriteWithOptions.opacity = (_g = options.opacity) !== null && _g !== void 0 ? _g : spriteWithOptions.opacity;\n                spriteWithOptions.tint = (_h = options.tint) !== null && _h !== void 0 ? _h : spriteWithOptions.tint;\n                spriteWithOptions.origin = (_j = options.origin) !== null && _j !== void 0 ? _j : spriteWithOptions.origin;\n                return spriteWithOptions;\n            }\n            return sprite;\n        }\n        throw Error(`Invalid sprite coordinates (${x}, ${y}`);\n    }\n    /**\n     * Create a sprite sheet from a sparse set of [[SourceView]] rectangles\n     * @param options\n     */\n    static fromImageSourceWithSourceViews(options) {\n        const sprites = options.sourceViews.map(sourceView => {\n            return new Sprite({\n                image: options.image,\n                sourceView\n            });\n        });\n        return new SpriteSheet({ sprites });\n    }\n    /**\n     * Create a SpriteSheet from an [[ImageSource]] organized in a grid\n     *\n     * Example:\n     * ```\n     * const spriteSheet = SpriteSheet.fromImageSource({\n     *   image: imageSource,\n     *   grid: {\n     *     rows: 5,\n     *     columns: 2,\n     *     spriteWidth: 32, // pixels\n     *     spriteHeight: 32 // pixels\n     *   },\n     *   // Optionally specify spacing\n     *   spacing: {\n     *     // pixels from the top left to start the sprite parsing\n     *     originOffset: {\n     *       x: 5,\n     *       y: 5\n     *     },\n     *     // pixels between each sprite while parsing\n     *     margin: {\n     *       x: 1,\n     *       y: 1\n     *     }\n     *   }\n     * })\n     * ```\n     * @param options\n     */\n    static fromImageSource(options) {\n        var _a;\n        const sprites = [];\n        options.spacing = (_a = options.spacing) !== null && _a !== void 0 ? _a : {};\n        const { image, grid: { rows, columns: cols, spriteWidth, spriteHeight }, spacing: { originOffset, margin } } = options;\n        const offsetDefaults = { x: 0, y: 0, ...originOffset };\n        const marginDefaults = { x: 0, y: 0, ...margin };\n        for (let x = 0; x < cols; x++) {\n            for (let y = 0; y < rows; y++) {\n                sprites[x + y * cols] = new Sprite({\n                    image: image,\n                    sourceView: {\n                        x: x * spriteWidth + marginDefaults.x * x + offsetDefaults.x,\n                        y: y * spriteHeight + marginDefaults.y * y + offsetDefaults.y,\n                        width: spriteWidth,\n                        height: spriteHeight\n                    },\n                    destSize: { height: spriteHeight, width: spriteWidth }\n                });\n            }\n        }\n        return new SpriteSheet({\n            sprites: sprites,\n            rows: rows,\n            columns: cols\n        });\n    }\n    clone() {\n        return new SpriteSheet({\n            sprites: this.sprites.map(sprite => sprite.clone()),\n            rows: this.rows,\n            columns: this.columns\n        });\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/debug-font.png\n/* harmony default export */ const debug_font = (\"data:image/png;base64,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\");\n;// CONCATENATED MODULE: ./Graphics/Context/debug-text.ts\n\n\n\n\n/**\n * Internal debugtext helper\n */\nclass DebugText {\n    constructor() {\n        /**\n         * base64 font\n         */\n        this.fontSheet = debug_font;\n        this.size = 16;\n        // We fire and forget, we don't care if it's loaded or not\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this.load();\n    }\n    load() {\n        this._imageSource = new ImageSource(this.fontSheet);\n        return this._imageSource.load().then(() => {\n            this._spriteSheet = SpriteSheet.fromImageSource({\n                image: this._imageSource,\n                grid: {\n                    rows: 4,\n                    columns: 16,\n                    spriteWidth: 16,\n                    spriteHeight: 16\n                }\n            });\n            this._spriteFont = new SpriteFont({\n                alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!\\'&.\"?-()+# ',\n                caseInsensitive: true,\n                spriteSheet: this._spriteSheet,\n                spacing: -6\n            });\n        });\n    }\n    /**\n     * Writes debug text using the built in sprint font\n     * @param ctx\n     * @param text\n     * @param pos\n     */\n    write(ctx, text, pos) {\n        if (this._imageSource.isLoaded()) {\n            this._spriteFont.render(ctx, text, null, pos.x, pos.y);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-source.ts\nclass RenderSource {\n    constructor(_gl, _texture) {\n        this._gl = _gl;\n        this._texture = _texture;\n    }\n    use() {\n        const gl = this._gl;\n        gl.activeTexture(gl.TEXTURE0);\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\n    }\n    disable() {\n        const gl = this._gl;\n        gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-target.ts\n\nclass RenderTarget {\n    constructor(options) {\n        var _a, _b;\n        this.antialias = false;\n        this.samples = 1;\n        this._gl = options.gl;\n        this.width = options.width;\n        this.height = options.height;\n        this.transparency = options.transparency;\n        this.antialias = (_a = options.antialias) !== null && _a !== void 0 ? _a : this.antialias;\n        this.samples = (_b = options.samples) !== null && _b !== void 0 ? _b : this._gl.getParameter(this._gl.MAX_SAMPLES);\n        const gl = this._gl;\n        // Determine current context format for blitting later needs to match\n        if (gl.drawingBufferFormat) {\n            this.bufferFormat = gl.drawingBufferFormat;\n        }\n        else {\n            // Documented in webgl spec\n            // https://registry.khronos.org/webgl/specs/latest/1.0/\n            if (this.transparency) {\n                this.bufferFormat = gl.RGBA8;\n            }\n            else {\n                this.bufferFormat = gl.RGB8;\n            }\n        }\n        this._setupRenderBuffer();\n        this._setupFramebuffer();\n    }\n    setResolution(width, height) {\n        const gl = this._gl;\n        this.width = width;\n        this.height = height;\n        // update backing texture size\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        // update render buffer size\n        if (this._renderBuffer) {\n            gl.bindRenderbuffer(gl.RENDERBUFFER, this._renderBuffer);\n            gl.renderbufferStorageMultisample(gl.RENDERBUFFER, Math.min(this.samples, gl.getParameter(gl.MAX_SAMPLES)), this.bufferFormat, this.width, this.height);\n        }\n    }\n    get renderBuffer() {\n        return this._renderBuffer;\n    }\n    get renderFrameBuffer() {\n        return this._renderFrameBuffer;\n    }\n    get frameBuffer() {\n        return this._frameBuffer;\n    }\n    get frameTexture() {\n        return this._frameTexture;\n    }\n    _setupRenderBuffer() {\n        if (this.antialias) {\n            const gl = this._gl;\n            // Render buffers can be used as an input to a shader\n            this._renderBuffer = gl.createRenderbuffer();\n            this._renderFrameBuffer = gl.createFramebuffer();\n            gl.bindRenderbuffer(gl.RENDERBUFFER, this._renderBuffer);\n            gl.renderbufferStorageMultisample(gl.RENDERBUFFER, Math.min(this.samples, gl.getParameter(gl.MAX_SAMPLES)), this.bufferFormat, this.width, this.height);\n            gl.bindFramebuffer(gl.FRAMEBUFFER, this._renderFrameBuffer);\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.RENDERBUFFER, this._renderBuffer);\n        }\n    }\n    _setupFramebuffer() {\n        // Allocates frame buffer\n        const gl = this._gl;\n        this._frameTexture = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        // set the filtering so we don't need mips\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        // attach the texture as the first color attachment\n        const attachmentPoint = gl.COLOR_ATTACHMENT0;\n        // After this bind all draw calls will draw to this framebuffer texture\n        this._frameBuffer = gl.createFramebuffer();\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, this._frameTexture, 0);\n        // Reset after initialized\n        this.disable();\n    }\n    toRenderSource() {\n        if (this.renderBuffer) {\n            this.blitRenderBufferToFrameBuffer();\n        }\n        const source = new RenderSource(this._gl, this._frameTexture);\n        return source;\n    }\n    blitToScreen() {\n        const gl = this._gl;\n        // set to size of canvas's drawingBuffer\n        if (this._renderBuffer) {\n            gl.bindFramebuffer(gl.READ_FRAMEBUFFER, this.renderFrameBuffer);\n            gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, null);\n            gl.clearBufferfv(gl.COLOR, 0, [0.0, 0.0, 1.0, 1.0]);\n            gl.blitFramebuffer(0, 0, this.width, this.height, 0, 0, this.width, this.height, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n        }\n        else {\n            gl.bindFramebuffer(gl.READ_FRAMEBUFFER, this.frameBuffer);\n            gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, null);\n            gl.clearBufferfv(gl.COLOR, 0, [0.0, 0.0, 1.0, 1.0]);\n            gl.blitFramebuffer(0, 0, this.width, this.height, 0, 0, this.width, this.height, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n        }\n    }\n    blitRenderBufferToFrameBuffer() {\n        if (this._renderBuffer) {\n            const gl = this._gl;\n            gl.bindFramebuffer(gl.READ_FRAMEBUFFER, this.renderFrameBuffer);\n            gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, this.frameBuffer);\n            gl.clearBufferfv(gl.COLOR, 0, [0.0, 0.0, 1.0, 1.0]);\n            gl.blitFramebuffer(0, 0, this.width, this.height, 0, 0, this.width, this.height, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n        }\n    }\n    copyToTexture(texture) {\n        const gl = this._gl;\n        if (this._renderBuffer) {\n            this.blitRenderBufferToFrameBuffer();\n        }\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 0, 0, this.width, this.height, 0);\n    }\n    /**\n     * When called, all drawing gets redirected to this render target\n     */\n    use() {\n        const gl = this._gl;\n        if (this.antialias) {\n            gl.bindFramebuffer(gl.FRAMEBUFFER, this._renderFrameBuffer);\n        }\n        else {\n            gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\n        }\n        // very important to set the viewport to the size of the framebuffer texture\n        gl.viewport(0, 0, this.width, this.height);\n    }\n    /**\n     * When called, all drawing is sent back to the canvas\n     */\n    disable() {\n        const gl = this._gl;\n        // passing null switches rendering back to the canvas\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-vertex.glsl\n/* harmony default export */ const line_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\nin vec4 a_color;\\r\\n\\r\\nout lowp vec4 v_color;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Passthrough the color\\r\\n   v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-fragment.glsl\n/* harmony default export */ const line_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// Color\\r\\nin lowp vec4 v_color;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  fragColor = v_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/webgl-util.ts\n/**\n * Return the size of the GlType in bytes\n * @param gl\n * @param type\n */\nfunction getGlTypeSizeBytes(gl, type) {\n    switch (type) {\n        case gl.FLOAT:\n            return 4;\n        case gl.SHORT:\n            return 2;\n        case gl.UNSIGNED_SHORT:\n            return 2;\n        case gl.BYTE:\n            return 1;\n        case gl.UNSIGNED_BYTE:\n            return 1;\n        default:\n            return 1;\n    }\n}\n/**\n * Checks if an attribute is present in vertex source\n */\nfunction isAttributeInSource(source, variable) {\n    const attributeRegexTemplate = `(?<type>[a-z0-9]+)\\\\s+${variable};`;\n    const regex = new RegExp(attributeRegexTemplate, 'g');\n    const matches = regex.exec(source);\n    return (matches === null || matches === void 0 ? void 0 : matches.length) > 0;\n}\n/**\n * Attempt to discern the glType of an attribute from vertex source\n * @param gl\n * @param source\n * @param variable\n */\nfunction getGLTypeFromSource(gl, source, variable) {\n    var _a;\n    const attributeRegexTemplate = `(?<type>[a-z0-9]+)\\\\s+${variable};`;\n    const regex = new RegExp(attributeRegexTemplate, 'g');\n    const matches = regex.exec(source);\n    const type = (_a = matches === null || matches === void 0 ? void 0 : matches.groups) === null || _a === void 0 ? void 0 : _a.type;\n    switch (type) {\n        case 'float':\n        case 'vec2':\n        case 'vec3':\n        case 'vec4':\n            return gl.FLOAT;\n        case 'int':\n        case 'ivec2':\n        case 'ivec3':\n        case 'ivec4':\n            return gl.INT;\n        case 'uint':\n        case 'uvec2':\n        case 'uvec3':\n        case 'uvec4':\n            return gl.UNSIGNED_INT;\n        case 'bool':\n        case 'bvec2':\n        case 'bvec3':\n        case 'bvec4':\n            return gl.BOOL;\n        case 'short':\n            return gl.SHORT;\n        case 'ushort':\n            return gl.UNSIGNED_SHORT;\n        case 'ubyte':\n            return gl.UNSIGNED_BYTE;\n        case 'byte':\n            return gl.BYTE;\n        default:\n            return gl.FLOAT;\n    }\n}\n/**\n * Based on the type return the number of attribute components\n *\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\n * @param gl\n * @param type\n */\nfunction getAttributeComponentSize(gl, type) {\n    switch (type) {\n        case gl.LOW_FLOAT:\n        case gl.HIGH_FLOAT:\n        case gl.FLOAT:\n            return 1;\n        case gl.FLOAT_VEC2:\n            return 2;\n        case gl.FLOAT_VEC3:\n            return 3;\n        case gl.FLOAT_VEC4:\n            return 4;\n        case gl.BYTE:\n            return 1;\n        case gl.UNSIGNED_BYTE:\n            return 1;\n        case gl.UNSIGNED_SHORT:\n        case gl.SHORT:\n            return 1;\n        default:\n            return 1;\n    }\n}\n/**\n * Based on the attribute return the corresponding supported attrib pointer type\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\n * @param gl\n * @param type\n */\nfunction getAttributePointerType(gl, type) {\n    switch (type) {\n        case gl.LOW_FLOAT:\n        case gl.HIGH_FLOAT:\n        case gl.FLOAT:\n        case gl.FLOAT_VEC2:\n        case gl.FLOAT_VEC3:\n        case gl.FLOAT_VEC4:\n            return gl.FLOAT;\n        case gl.BYTE:\n            return gl.BYTE;\n        case gl.UNSIGNED_BYTE:\n            return gl.UNSIGNED_BYTE;\n        case gl.SHORT:\n            return gl.SHORT;\n        case gl.UNSIGNED_SHORT:\n            return gl.UNSIGNED_SHORT;\n        default:\n            return gl.FLOAT;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/shader.ts\n\n\nclass Shader {\n    get compiled() {\n        return this._compiled;\n    }\n    /**\n     * Create a shader program in excalibur\n     * @param options specify shader vertex and fragment source\n     */\n    constructor(options) {\n        this._logger = Logger.getInstance();\n        this.uniforms = {};\n        this.attributes = {};\n        this._compiled = false;\n        const { gl, vertexSource, fragmentSource } = options;\n        this._gl = gl;\n        this.vertexSource = vertexSource;\n        this.fragmentSource = fragmentSource;\n    }\n    dispose() {\n        const gl = this._gl;\n        gl.deleteProgram(this.program);\n        this._gl = null;\n    }\n    /**\n     * Binds the shader program\n     */\n    use() {\n        const gl = this._gl;\n        gl.useProgram(this.program);\n        Shader._ACTIVE_SHADER_INSTANCE = this;\n    }\n    isCurrentlyBound() {\n        return Shader._ACTIVE_SHADER_INSTANCE === this;\n    }\n    /**\n     * Compile the current shader against a webgl context\n     */\n    compile() {\n        const gl = this._gl;\n        const vertexShader = this._compileShader(gl, this.vertexSource, gl.VERTEX_SHADER);\n        const fragmentShader = this._compileShader(gl, this.fragmentSource, gl.FRAGMENT_SHADER);\n        this.program = this._createProgram(gl, vertexShader, fragmentShader);\n        const attributes = this.getAttributes();\n        for (const attribute of attributes) {\n            this.attributes[attribute.name] = attribute;\n        }\n        const uniforms = this.getUniforms();\n        for (const uniform of uniforms) {\n            this.uniforms[uniform.name] = uniform;\n        }\n        this._compiled = true;\n        return this.program;\n    }\n    getUniforms() {\n        const gl = this._gl;\n        const uniformCount = gl.getProgramParameter(this.program, gl.ACTIVE_UNIFORMS);\n        const uniforms = [];\n        for (let i = 0; i < uniformCount; i++) {\n            const uniform = gl.getActiveUniform(this.program, i);\n            const uniformLocation = gl.getUniformLocation(this.program, uniform.name);\n            uniforms.push({\n                name: uniform.name,\n                glType: uniform.type,\n                location: uniformLocation\n            });\n        }\n        return uniforms;\n    }\n    getAttributes() {\n        const gl = this._gl;\n        const attributeCount = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\n        const attributes = [];\n        for (let i = 0; i < attributeCount; i++) {\n            const attribute = gl.getActiveAttrib(this.program, i);\n            const attributeLocation = gl.getAttribLocation(this.program, attribute.name);\n            attributes.push({\n                name: attribute.name,\n                glType: getAttributePointerType(gl, attribute.type),\n                size: getAttributeComponentSize(gl, attribute.type),\n                location: attributeLocation,\n                normalized: false\n            });\n        }\n        return attributes;\n    }\n    /**\n     * Set a texture in a gpu texture slot\n     * @param slotNumber\n     * @param texture\n     */\n    setTexture(slotNumber, texture) {\n        const gl = this._gl;\n        gl.activeTexture(gl.TEXTURE0 + slotNumber);\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n    }\n    /**\n     * Set an integer uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformInt(name, value) {\n        this.setUniform('uniform1i', name, ~~value);\n    }\n    /**\n     * Set an integer uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformInt(name, value) {\n        return this.trySetUniform('uniform1i', name, ~~value);\n    }\n    /**\n     * Set an integer array uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformIntArray(name, value) {\n        this.setUniform('uniform1iv', name, value);\n    }\n    /**\n     * Set an integer array uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformIntArray(name, value) {\n        return this.trySetUniform('uniform1iv', name, value);\n    }\n    /**\n     * Set a boolean uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformBoolean(name, value) {\n        this.setUniform('uniform1i', name, value ? 1 : 0);\n    }\n    /**\n     * Set a boolean uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformBoolean(name, value) {\n        return this.trySetUniform('uniform1i', name, value ? 1 : 0);\n    }\n    /**\n     * Set a float uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformFloat(name, value) {\n        this.setUniform('uniform1f', name, value);\n    }\n    /**\n     * Set a float uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformFloat(name, value) {\n        return this.trySetUniform('uniform1f', name, value);\n    }\n    /**\n     * Set a float array uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformFloatArray(name, value) {\n        this.setUniform('uniform1fv', name, value);\n    }\n    /**\n     * Set a float array uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformFloatArray(name, value) {\n        return this.trySetUniform('uniform1fv', name, value);\n    }\n    /**\n     * Set a [[Vector]] uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformFloatVector(name, value) {\n        this.setUniform('uniform2f', name, value.x, value.y);\n    }\n    /**\n     * Set a [[Vector]] uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformFloatVector(name, value) {\n        return this.trySetUniform('uniform2f', name, value.x, value.y);\n    }\n    /**\n     * Set a [[Color]] uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformFloatColor(name, value) {\n        this.setUniform('uniform4f', name, value.r / 255, value.g / 255, value.b / 255, value.a);\n    }\n    /**\n     * Set a [[Color]] uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformFloatColor(name, value) {\n        return this.trySetUniform('uniform4f', name, value.r / 255, value.g / 255, value.b / 255, value.a);\n    }\n    /**\n     * Set an [[Matrix]] uniform for the current shader\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    setUniformMatrix(name, value) {\n        this.setUniform('uniformMatrix4fv', name, false, value.data);\n    }\n    /**\n     * Set an [[Matrix]] uniform for the current shader, WILL NOT THROW on error.\n     *\n     * **Important** Must call ex.Shader.use() before setting a uniform!\n     * @param name\n     * @param value\n     */\n    trySetUniformMatrix(name, value) {\n        return this.trySetUniform('uniformMatrix4fv', name, false, value.data);\n    }\n    /**\n     * Set any available uniform type in webgl\n     *\n     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat`, ...);\n     */\n    setUniform(uniformType, name, ...value) {\n        if (!this._compiled) {\n            throw Error(`Must compile shader before setting a uniform ${uniformType}:${name}`);\n        }\n        if (!this.isCurrentlyBound()) {\n            throw Error('Currently accessed shader instance is not the current active shader in WebGL,' +\n                ' must call `shader.use()` before setting uniforms');\n        }\n        const gl = this._gl;\n        const location = gl.getUniformLocation(this.program, name);\n        if (location) {\n            const args = [location, ...value];\n            this._gl[uniformType].apply(this._gl, args);\n        }\n        else {\n            throw Error(`Uniform ${uniformType}:${name} doesn\\'t exist or is not used in the shader source code,` +\n                ' unused uniforms are optimized away by most browsers');\n        }\n    }\n    /**\n     * Set any available uniform type in webgl. Will try to set the uniform, will return false if the uniform didn't exist,\n     * true if it was set.\n     *\n     * WILL NOT THROW on error\n     *\n     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat`, ...);\n     *\n     */\n    trySetUniform(uniformType, name, ...value) {\n        if (!this._compiled) {\n            this._logger.warn(`Must compile shader before setting a uniform ${uniformType}:${name}`);\n            return false;\n        }\n        if (!this.isCurrentlyBound()) {\n            this._logger.warn('Currently accessed shader instance is not the current active shader in WebGL,' +\n                ' must call `shader.use()` before setting uniforms');\n            return false;\n        }\n        const gl = this._gl;\n        const location = gl.getUniformLocation(this.program, name);\n        if (location) {\n            const args = [location, ...value];\n            this._gl[uniformType].apply(this._gl, args);\n        }\n        else {\n            return false;\n        }\n        return true;\n    }\n    _createProgram(gl, vertexShader, fragmentShader) {\n        const program = gl.createProgram();\n        if (program === null) {\n            throw Error('Could not create graphics shader program');\n        }\n        // attach the shaders.\n        gl.attachShader(program, vertexShader);\n        gl.attachShader(program, fragmentShader);\n        // link the program.\n        gl.linkProgram(program);\n        const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n        if (!success) {\n            throw Error(`Could not link the program: [${gl.getProgramInfoLog(program)}]`);\n        }\n        return program;\n    }\n    _compileShader(gl, source, type) {\n        const typeName = gl.VERTEX_SHADER === type ? 'vertex' : 'fragment';\n        const shader = gl.createShader(type);\n        if (shader === null) {\n            throw Error(`Could not build shader: [${source}]`);\n        }\n        gl.shaderSource(shader, source);\n        gl.compileShader(shader);\n        const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n        if (!success) {\n            const errorInfo = gl.getShaderInfoLog(shader);\n            throw Error(`Could not compile ${typeName} shader:\\n\\n${errorInfo}${this._processSourceForError(source, errorInfo)}`);\n        }\n        return shader;\n    }\n    _processSourceForError(source, errorInfo) {\n        if (!source) {\n            return errorInfo;\n        }\n        const lines = source.split('\\n');\n        const errorLineStart = errorInfo.search(/\\d:\\d/);\n        const errorLineEnd = errorInfo.indexOf(' ', errorLineStart);\n        const [_, error2] = errorInfo.slice(errorLineStart, errorLineEnd).split(':').map(v => Number(v));\n        for (let i = 0; i < lines.length; i++) {\n            lines[i] = `${i + 1}: ${lines[i]}${error2 === (i + 1) ? ' <----- ERROR!' : ''}`;\n        }\n        return '\\n\\nSource:\\n' + lines.join('\\n');\n    }\n}\nShader._ACTIVE_SHADER_INSTANCE = null;\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-buffer.ts\n/**\n * Helper around vertex buffer to simplify creating and uploading geometry\n *\n * Under the hood uses Float32Array\n */\nclass VertexBuffer {\n    constructor(options) {\n        /**\n         * If the vertices never change switching 'static' can be more efficient on the gpu\n         *\n         * Default is 'dynamic'\n         */\n        this.type = 'dynamic';\n        const { gl, size, type, data } = options;\n        this._gl = gl;\n        this.buffer = this._gl.createBuffer();\n        if (!data && !size) {\n            throw Error('Must either provide data or a size to the VertexBuffer');\n        }\n        if (!data) {\n            this.bufferData = new Float32Array(size);\n        }\n        else {\n            this.bufferData = data;\n        }\n        this.type = type !== null && type !== void 0 ? type : this.type;\n        // Allocate buffer\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n        gl.bufferData(gl.ARRAY_BUFFER, this.bufferData, this.type === 'static' ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW);\n    }\n    /**\n     * Bind this vertex buffer\n     */\n    bind() {\n        const gl = this._gl;\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n    }\n    unbind() {\n        const gl = this._gl;\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n    }\n    /**\n     * Upload vertex buffer geometry to the GPU\n     */\n    upload(count) {\n        const gl = this._gl;\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n        if (count) {\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.bufferData, 0, count);\n        }\n        else {\n            // TODO always use bufferSubData? need to perf test it\n            gl.bufferData(gl.ARRAY_BUFFER, this.bufferData, this.type === 'static' ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW);\n        }\n    }\n    dispose() {\n        const gl = this._gl;\n        gl.deleteBuffer(this.buffer);\n        this._gl = null;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-layout.ts\n\n\n/**\n * Helper around creating vertex attributes in a given [[VertexBuffer]], this is useful for describing\n * the memory layout for your vertices inside a particular buffer\n *\n * Note: This helper assumes interleaved attributes in one [[VertexBuffer]], not many.\n *\n * Working with `gl.vertexAttribPointer` can be tricky, and this attempts to double check you\n */\nclass VertexLayout {\n    get vertexBuffer() {\n        return this._vertexBuffer;\n    }\n    get attributes() {\n        return this._attributes;\n    }\n    constructor(options) {\n        this._logger = Logger.getInstance();\n        this._suppressWarnings = false;\n        this._layout = [];\n        this._attributes = [];\n        this._vertexTotalSizeBytes = 0;\n        this._initialized = false;\n        const { gl, shader, vertexBuffer, attributes, suppressWarnings } = options;\n        this._gl = gl;\n        this._vertexBuffer = vertexBuffer;\n        this._attributes = attributes;\n        this._shader = shader;\n        this._suppressWarnings = suppressWarnings;\n        if (shader) {\n            this.initialize();\n        }\n    }\n    /**\n     * Total number of bytes that the vertex will take up\n     */\n    get totalVertexSizeBytes() {\n        return this._vertexTotalSizeBytes;\n    }\n    set shader(shader) {\n        if (shader && this._shader !== shader) {\n            this._shader = shader;\n            this.initialize();\n        }\n    }\n    get shader() {\n        return this._shader;\n    }\n    /**\n     * Layouts need shader locations and must be bound to a shader\n     */\n    initialize() {\n        if (this._initialized) {\n            return;\n        }\n        if (!this._shader) {\n            return;\n        }\n        if (!this._shader.compiled) {\n            throw Error('Shader not compiled, shader must be compiled before defining a vertex layout');\n        }\n        this._vertexTotalSizeBytes = 0;\n        this._layout.length = 0;\n        const shaderAttributes = this._shader.attributes;\n        for (const attribute of this._attributes) {\n            const attrib = shaderAttributes[attribute[0]];\n            if (!attrib) {\n                if (!isAttributeInSource(this._shader.vertexSource, attribute[0])) {\n                    throw Error(`The attribute named: ${attribute[0]} size ${attribute[1]}` +\n                        ` not found in the shader source code:\\n ${this._shader.vertexSource}`);\n                }\n                if (!this._suppressWarnings) {\n                    this._logger.warn(`The attribute named: ${attribute[0]} size ${attribute[1]}` +\n                        ` not found in the compiled shader. This is possibly a bug:\\n` +\n                        ` 1. Not a bug, but should remove unused code - attribute \"${attribute[0]}\" is unused in` +\n                        ` vertex/fragment and has been automatically removed by glsl compiler.\\n` +\n                        ` 2. Definitely a bug, attribute \"${attribute[0]}\" in layout has been mistyped or is missing` +\n                        ` in shader, check vertex/fragment source.`);\n                }\n                const glType = getGLTypeFromSource(this._gl, this._shader.vertexSource, attribute[0]);\n                // Unused attribute placeholder\n                this._layout.push({\n                    name: attribute[0],\n                    glType,\n                    size: attribute[1],\n                    location: -1,\n                    normalized: false\n                });\n            }\n            if (attrib) {\n                if (attrib.size !== attribute[1]) {\n                    throw Error(`VertexLayout size definition for attribute: [${attribute[0]}, ${attribute[1]}],`\n                        + ` doesn\\'t match shader source size ${attrib.size}:\\n ${this._shader.vertexSource}`);\n                }\n                this._layout.push(attrib);\n            }\n        }\n        // calc size\n        let componentsPerVertex = 0;\n        for (const vertAttribute of this._layout) {\n            const typeSize = getGlTypeSizeBytes(this._gl, vertAttribute.glType);\n            this._vertexTotalSizeBytes += typeSize * vertAttribute.size;\n            componentsPerVertex += vertAttribute.size;\n        }\n        if (this._vertexBuffer.bufferData.length % componentsPerVertex !== 0) {\n            this._logger.warn(`The vertex component size (${componentsPerVertex})  does NOT divide evenly into the specified vertex buffer`\n                + ` (${this._vertexBuffer.bufferData.length})`);\n        }\n        // create VAO\n        const gl = this._gl;\n        this._vao = gl.createVertexArray();\n        gl.bindVertexArray(this._vao);\n        this._vertexBuffer.bind();\n        let offset = 0;\n        for (const vert of this._layout) {\n            if (vert.location !== -1) { // skip unused attributes\n                gl.vertexAttribPointer(vert.location, vert.size, vert.glType, vert.normalized, this.totalVertexSizeBytes, offset);\n                gl.enableVertexAttribArray(vert.location);\n            }\n            offset += getGlTypeSizeBytes(gl, vert.glType) * vert.size;\n        }\n        gl.bindVertexArray(null);\n        this._vertexBuffer.unbind();\n        this._initialized = true;\n    }\n    /**\n     * Bind this layout with it's associated vertex buffer\n     * @param uploadBuffer Optionally indicate you wish to upload the buffer to the GPU associated with this layout\n     */\n    use(uploadBuffer = false, count) {\n        if (!this._shader) {\n            throw Error('No shader is associated with this vertex layout, a shader must be set');\n        }\n        const gl = this._gl;\n        if (!this._shader.isCurrentlyBound()) {\n            throw Error('Shader associated with this vertex layout is not active! Call shader.use() before layout.use()');\n        }\n        this._vertexBuffer.bind();\n        if (uploadBuffer) {\n            this._vertexBuffer.upload(count);\n        }\n        gl.bindVertexArray(this._vao);\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsDiagnostics.ts\nclass GraphicsDiagnostics {\n    static clear() {\n        GraphicsDiagnostics.DrawCallCount = 0;\n        GraphicsDiagnostics.DrawnImagesCount = 0;\n    }\n}\nGraphicsDiagnostics.DrawCallCount = 0;\nGraphicsDiagnostics.DrawnImagesCount = 0;\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-renderer.ts\n\n\n\n\nclass LineRenderer {\n    constructor() {\n        this.type = 'ex.line';\n        this.priority = 0;\n        this._maxLines = 10922;\n        this._vertexIndex = 0;\n        this._lineCount = 0;\n    }\n    initialize(gl, context) {\n        this._gl = gl;\n        this._context = context;\n        this._shader = new Shader({\n            gl,\n            vertexSource: line_vertex,\n            fragmentSource: line_fragment\n        });\n        this._shader.compile();\n        this._shader.use();\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\n        this._vertexBuffer = new VertexBuffer({\n            gl,\n            size: 6 * 2 * this._maxLines,\n            type: 'dynamic'\n        });\n        this._layout = new VertexLayout({\n            gl,\n            vertexBuffer: this._vertexBuffer,\n            shader: this._shader,\n            attributes: [\n                ['a_position', 2],\n                ['a_color', 4]\n            ]\n        });\n    }\n    dispose() {\n        this._vertexBuffer.dispose();\n        this._shader.dispose();\n        this._context = null;\n        this._gl = null;\n    }\n    draw(start, end, color) {\n        // Force a render if the batch is full\n        if (this._isFull()) {\n            this.flush();\n        }\n        this._lineCount++;\n        const transform = this._context.getTransform();\n        const finalStart = transform.multiply(start);\n        const finalEnd = transform.multiply(end);\n        const vertexBuffer = this._vertexBuffer.bufferData;\n        // Start\n        vertexBuffer[this._vertexIndex++] = finalStart.x;\n        vertexBuffer[this._vertexIndex++] = finalStart.y;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        // End\n        vertexBuffer[this._vertexIndex++] = finalEnd.x;\n        vertexBuffer[this._vertexIndex++] = finalEnd.y;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n    }\n    _isFull() {\n        if (this._lineCount >= this._maxLines) {\n            return true;\n        }\n        return false;\n    }\n    hasPendingDraws() {\n        return this._lineCount !== 0;\n    }\n    flush() {\n        // nothing to draw early exit\n        if (this._lineCount === 0) {\n            return;\n        }\n        const gl = this._gl;\n        this._shader.use();\n        this._layout.use(true);\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\n        gl.drawArrays(gl.LINES, 0, this._lineCount * 2); // 2 verts per line\n        GraphicsDiagnostics.DrawnImagesCount += this._lineCount;\n        GraphicsDiagnostics.DrawCallCount++;\n        // reset\n        this._vertexIndex = 0;\n        this._lineCount = 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-vertex.glsl\n/* harmony default export */ const point_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\nin vec4 a_color;\\r\\nin float a_size;\\r\\nout lowp vec4 v_color;\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n  gl_PointSize = a_size * 2.0;\\r\\n  v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-fragment.glsl\n/* harmony default export */ const point_fragment = (\"#version 300 es\\r\\n\\r\\nprecision mediump float;\\r\\nin lowp vec4 v_color;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\r\\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\\r\\n  r = dot(cxy, cxy);\\r\\n\\r\\n  delta = fwidth(r);\\r\\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\\r\\n  // \\\"premultiply\\\" the color by alpha\\r\\n  vec4 color = v_color;\\r\\n  color.a = color.a * alpha;\\r\\n  color.rgb = color.rgb * color.a;\\r\\n  fragColor = color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-renderer.ts\n\n\n\n\n\n\n\nclass PointRenderer {\n    constructor() {\n        this.type = 'ex.point';\n        this.priority = 0;\n        this._maxPoints = 10922;\n        this._pointCount = 0;\n        this._vertexIndex = 0;\n    }\n    initialize(gl, context) {\n        this._gl = gl;\n        this._context = context;\n        this._shader = new Shader({\n            gl,\n            vertexSource: point_vertex,\n            fragmentSource: point_fragment\n        });\n        this._shader.compile();\n        this._shader.use();\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\n        this._buffer = new VertexBuffer({\n            gl,\n            size: 7 * this._maxPoints,\n            type: 'dynamic'\n        });\n        this._layout = new VertexLayout({\n            gl,\n            shader: this._shader,\n            vertexBuffer: this._buffer,\n            attributes: [\n                ['a_position', 2],\n                ['a_color', 4],\n                ['a_size', 1]\n            ]\n        });\n    }\n    dispose() {\n        this._buffer.dispose();\n        this._shader.dispose();\n        this._context = null;\n        this._gl = null;\n    }\n    draw(point, color, size) {\n        // Force a render if the batch is full\n        if (this._isFull()) {\n            this.flush();\n        }\n        this._pointCount++;\n        const transform = this._context.getTransform();\n        const opacity = this._context.opacity;\n        const snapToPixel = this._context.snapToPixel;\n        const finalPoint = transform.multiply(point);\n        if (snapToPixel) {\n            finalPoint.x = ~~(finalPoint.x + pixelSnapEpsilon);\n            finalPoint.y = ~~(finalPoint.y + pixelSnapEpsilon);\n        }\n        const vertexBuffer = this._buffer.bufferData;\n        vertexBuffer[this._vertexIndex++] = finalPoint.x;\n        vertexBuffer[this._vertexIndex++] = finalPoint.y;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a * opacity;\n        vertexBuffer[this._vertexIndex++] = size * Math.max(transform.getScaleX(), transform.getScaleY());\n    }\n    _isFull() {\n        if (this._pointCount >= this._maxPoints) {\n            return true;\n        }\n        return false;\n    }\n    hasPendingDraws() {\n        return this._pointCount !== 0;\n    }\n    flush() {\n        // nothing to draw early exit\n        if (this._pointCount === 0) {\n            return;\n        }\n        const gl = this._gl;\n        this._shader.use();\n        this._layout.use(true);\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\n        gl.drawArrays(gl.POINTS, 0, this._pointCount);\n        GraphicsDiagnostics.DrawnImagesCount += this._pointCount;\n        GraphicsDiagnostics.DrawCallCount++;\n        this._pointCount = 0;\n        this._vertexIndex = 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-vertex.glsl\n/* harmony default export */ const screen_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\nin vec2 a_texcoord;\\r\\nout vec2 v_texcoord;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n  // Pass the texcoord to the fragment shader.\\r\\n  v_texcoord = a_texcoord;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-fragment.glsl\n/* harmony default export */ const screen_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// Passed in from the vertex shader.\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// The texture.\\r\\nuniform sampler2D u_texture;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n   fragColor = texture(u_texture, v_texcoord);\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-pass-painter.ts\n\n\n\n\n\n/**\n * This is responsible for painting the entire screen during the render passes\n */\nclass ScreenPassPainter {\n    constructor(gl) {\n        this._gl = gl;\n        this._shader = new Shader({\n            gl,\n            vertexSource: screen_vertex,\n            fragmentSource: screen_fragment\n        });\n        this._shader.compile();\n        // Setup memory layout\n        this._buffer = new VertexBuffer({\n            gl,\n            type: 'static',\n            // clip space quad + uv since we don't need a camera\n            data: new Float32Array([\n                -1, -1, 0, 0,\n                -1, 1, 0, 1,\n                1, -1, 1, 0,\n                1, -1, 1, 0,\n                -1, 1, 0, 1,\n                1, 1, 1, 1\n            ])\n        });\n        this._layout = new VertexLayout({\n            gl,\n            shader: this._shader,\n            vertexBuffer: this._buffer,\n            attributes: [\n                ['a_position', 2],\n                ['a_texcoord', 2]\n            ]\n        });\n        this._buffer.upload();\n    }\n    renderWithPostProcessor(postprocessor) {\n        const gl = this._gl;\n        postprocessor.getShader().use();\n        postprocessor.getLayout().use();\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\n    }\n    renderToScreen() {\n        const gl = this._gl;\n        this._shader.use();\n        this._layout.use();\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/quad-index-buffer.ts\n\n/**\n * Helper that defines and index buffer for quad geometry\n *\n * Index buffers allow you to save space in vertex buffers when you share vertices in geometry\n * it is almost always worth it in terms of performance to use an index buffer.\n */\nclass QuadIndexBuffer {\n    /**\n     * @param gl WebGL2RenderingContext this layout will be attached to, these cannot be reused across contexts.\n     * @param numberOfQuads Specify the max number of quads you want to draw\n     * @param useUint16 Optionally force a uint16 buffer\n     */\n    constructor(gl, numberOfQuads, useUint16) {\n        this._logger = Logger.getInstance();\n        this._gl = gl;\n        this.buffer = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\n        const totalVertices = numberOfQuads * 6;\n        if (!useUint16) {\n            this.bufferData = new Uint32Array(totalVertices);\n        }\n        else {\n            // fall back to using gl.UNSIGNED_SHORT or tell the user they are out of luck\n            const maxUint16 = 65535;\n            const maxUint16Index = Math.floor((maxUint16 - 1) / 4); // max quads\n            this.bufferGlType = gl.UNSIGNED_SHORT;\n            this.bufferData = new Uint16Array(totalVertices);\n            // TODO Should we error if this happens?? maybe not might crash mid game\n            if (numberOfQuads > maxUint16Index) {\n                this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${maxUint16Index}) requested quads(${numberOfQuads})`);\n            }\n        }\n        let currentQuad = 0;\n        for (let i = 0; i < totalVertices; i += 6) {\n            // first triangle\n            this.bufferData[i + 0] = currentQuad + 0;\n            this.bufferData[i + 1] = currentQuad + 1;\n            this.bufferData[i + 2] = currentQuad + 2;\n            // second triangle\n            this.bufferData[i + 3] = currentQuad + 2;\n            this.bufferData[i + 4] = currentQuad + 1;\n            this.bufferData[i + 5] = currentQuad + 3;\n            currentQuad += 4;\n        }\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\n    }\n    get size() {\n        return this.bufferData.length;\n    }\n    /**\n     * Upload data to the GPU\n     */\n    upload() {\n        const gl = this._gl;\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\n    }\n    /**\n     * Bind this index buffer\n     */\n    bind() {\n        const gl = this._gl;\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\n    }\n    dispose() {\n        const gl = this._gl;\n        gl.deleteBuffer(this.buffer);\n        this._gl = null;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.frag.glsl\n/* harmony default export */ const image_renderer_frag = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// Texture index\\r\\nin lowp float v_textureIndex;\\r\\n\\r\\n// Textures in the current draw\\r\\nuniform sampler2D u_textures[%%count%%];\\r\\n\\r\\nuniform bool u_pixelart;\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nin vec4 v_tint;\\r\\n\\r\\nin vec2 v_res;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\n// Inigo Quilez pixel art filter https://jorenjoestar.github.io/post/pixel_art_filtering/\\r\\nvec2 uv_iq(in vec2 uv, in vec2 texture_size) {\\r\\n  vec2 pixel = uv * texture_size;\\r\\n  \\r\\n  vec2 seam=floor(pixel+.5);\\r\\n  vec2 dudv=fwidth(pixel);\\r\\n  pixel=seam+clamp((pixel-seam)/dudv,-.5,.5);\\r\\n  \\r\\n  return pixel/texture_size;\\r\\n}\\r\\n\\r\\nvoid main(){\\r\\n  // In order to support the most efficient sprite batching, we have multiple\\r\\n  // textures loaded into the gpu (usually 8) this picker logic skips over textures\\r\\n  // that do not apply to a particular sprite.\\r\\n  \\r\\n  vec4 color=vec4(1.,0,0,1.);\\r\\n  \\r\\n  // GLSL is templated out to pick the right texture and set the vec4 color\\r\\n  %%texture_picker%%\\r\\n  \\r\\n  color.rgb=color.rgb*v_opacity;\\r\\n  color.a=color.a*v_opacity;\\r\\n  fragColor=color*v_tint;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.vert.glsl\n/* harmony default export */ const image_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// Opacity\\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_texcoord;\\r\\nout vec2 v_texcoord;\\r\\n\\r\\n// Texture res\\r\\nin vec2 a_res;\\r\\nout vec2 v_res;\\r\\n\\r\\n// Texture number\\r\\nin lowp float a_textureIndex;\\r\\nout lowp float v_textureIndex;\\r\\n\\r\\nin vec4 a_tint;\\r\\nout vec4 v_tint;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main(){\\r\\n  // Set the vertex position using the ortho transform matrix\\r\\n  gl_Position=u_matrix*vec4(a_position,0.,1.);\\r\\n  \\r\\n  // Pass through the Opacity to the fragment shader\\r\\n  v_opacity=a_opacity;\\r\\n  // Pass through the UV coord to the fragment shader\\r\\n  v_texcoord=a_texcoord;\\r\\n\\r\\n  v_res = a_res;\\r\\n\\r\\n  // Pass through the texture number to the fragment shader\\r\\n  v_textureIndex=a_textureIndex;\\r\\n  // Pass through the tint\\r\\n  v_tint=a_tint;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.ts\n\n\n\n\n\n\n\n\n\n\n\n\nclass ImageRenderer {\n    constructor(options) {\n        this.type = 'ex.image';\n        this.priority = 0;\n        this._maxImages = 10922; // max(uint16) / 6 verts\n        this._maxTextures = 0;\n        // Per flush vars\n        this._imageCount = 0;\n        this._textures = [];\n        this._textureIndex = 0;\n        this._textureToIndex = new Map();\n        this._images = new Set();\n        this._vertexIndex = 0;\n        this._imageToWidth = new Map();\n        this._imageToHeight = new Map();\n        this._view = [0, 0, 0, 0];\n        this._dest = [0, 0];\n        this._quad = [0, 0, 0, 0, 0, 0, 0, 0];\n        this.pixelArtSampler = options.pixelArtSampler;\n        this.uvPadding = options.uvPadding;\n    }\n    initialize(gl, context) {\n        this._gl = gl;\n        this._context = context;\n        // Transform shader source\n        // FIXME: PIXEL 6 complains `ERROR: Expression too complex.` if we use it's reported max texture units, 125 seems to work for now...\n        this._maxTextures = Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS), 125);\n        const transformedFrag = this._transformFragmentSource(image_renderer_frag, this._maxTextures);\n        // Compile shader\n        this._shader = new Shader({\n            gl,\n            fragmentSource: transformedFrag,\n            vertexSource: image_renderer_vert\n        });\n        this._shader.compile();\n        // setup uniforms\n        this._shader.use();\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\n        // Initialize texture slots to [0, 1, 2, 3, 4, .... maxGPUTextures]\n        this._shader.setUniformIntArray('u_textures', [...Array(this._maxTextures)].map((_, i) => i));\n        // Setup memory layout\n        this._buffer = new VertexBuffer({\n            gl,\n            size: 12 * 4 * this._maxImages, // 12 components * 4 verts\n            type: 'dynamic'\n        });\n        this._layout = new VertexLayout({\n            gl,\n            shader: this._shader,\n            vertexBuffer: this._buffer,\n            attributes: [\n                ['a_position', 2],\n                ['a_opacity', 1],\n                ['a_res', 2],\n                ['a_texcoord', 2],\n                ['a_textureIndex', 1],\n                ['a_tint', 4]\n            ]\n        });\n        // Setup index buffer\n        this._quads = new QuadIndexBuffer(gl, this._maxImages, true);\n    }\n    dispose() {\n        this._buffer.dispose();\n        this._quads.dispose();\n        this._shader.dispose();\n        this._textures.length = 0;\n        this._context = null;\n        this._gl = null;\n    }\n    _transformFragmentSource(source, maxTextures) {\n        let newSource = source.replace('%%count%%', maxTextures.toString());\n        let texturePickerBuilder = '';\n        for (let i = 0; i < maxTextures; i++) {\n            if (i === 0) {\n                texturePickerBuilder += `if (v_textureIndex <= ${i}.5) {\\n`;\n            }\n            else {\n                texturePickerBuilder += `   else if (v_textureIndex <= ${i}.5) {\\n`;\n            }\n            texturePickerBuilder += `      vec2 uv = u_pixelart ? uv_iq(v_texcoord, v_res) : v_texcoord;\\n`;\n            texturePickerBuilder += `      color = texture(u_textures[${i}], uv);\\n`;\n            texturePickerBuilder += `   }\\n`;\n        }\n        newSource = newSource.replace('%%texture_picker%%', texturePickerBuilder);\n        return newSource;\n    }\n    _addImageAsTexture(image) {\n        if (this._images.has(image)) {\n            return;\n        }\n        const maybeFiltering = image.getAttribute(ImageSourceAttributeConstants.Filtering);\n        const filtering = maybeFiltering ? parseImageFiltering(maybeFiltering) : null;\n        const wrapX = parseImageWrapping(image.getAttribute(ImageSourceAttributeConstants.WrappingX));\n        const wrapY = parseImageWrapping(image.getAttribute(ImageSourceAttributeConstants.WrappingY));\n        const force = image.getAttribute('forceUpload') === 'true' ? true : false;\n        const texture = this._context.textureLoader.load(image, {\n            filtering,\n            wrapping: { x: wrapX, y: wrapY }\n        }, force);\n        // remove force attribute after upload\n        image.removeAttribute('forceUpload');\n        if (this._textures.indexOf(texture) === -1) {\n            this._textures.push(texture);\n            this._textureToIndex.set(texture, this._textureIndex++);\n            this._images.add(image);\n        }\n    }\n    _bindTextures(gl) {\n        // Bind textures in the correct order\n        for (let i = 0; i < this._maxTextures; i++) {\n            gl.activeTexture(gl.TEXTURE0 + i);\n            gl.bindTexture(gl.TEXTURE_2D, this._textures[i] || this._textures[0]);\n        }\n    }\n    _getTextureIdForImage(image) {\n        var _a;\n        if (image) {\n            const maybeTexture = this._context.textureLoader.get(image);\n            return (_a = this._textureToIndex.get(maybeTexture)) !== null && _a !== void 0 ? _a : -1; //this._textures.indexOf(maybeTexture);\n        }\n        return -1;\n    }\n    _isFull() {\n        if (this._imageCount >= this._maxImages) {\n            return true;\n        }\n        if (this._textures.length >= this._maxTextures) {\n            return true;\n        }\n        return false;\n    }\n    _getImageWidth(image) {\n        let maybeWidth = this._imageToWidth.get(image);\n        if (maybeWidth === undefined) {\n            maybeWidth = image.width;\n            this._imageToWidth.set(image, maybeWidth);\n        }\n        return maybeWidth;\n    }\n    _getImageHeight(image) {\n        let maybeHeight = this._imageToHeight.get(image);\n        if (maybeHeight === undefined) {\n            maybeHeight = image.height;\n            this._imageToHeight.set(image, maybeHeight);\n        }\n        return maybeHeight;\n    }\n    draw(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\n        var _a, _b, _c, _d;\n        // Force a render if the batch is full\n        if (this._isFull()) {\n            this.flush();\n        }\n        this._imageCount++;\n        // This creates and uploads the texture if not already done\n        this._addImageAsTexture(image);\n        const maybeImageWidth = this._getImageWidth(image);\n        const maybeImageHeight = this._getImageHeight(image);\n        let width = maybeImageWidth || swidth || 0;\n        let height = maybeImageHeight || sheight || 0;\n        this._view[0] = 0;\n        this._view[1] = 0;\n        this._view[2] = (_a = swidth !== null && swidth !== void 0 ? swidth : maybeImageWidth) !== null && _a !== void 0 ? _a : 0;\n        this._view[3] = (_b = sheight !== null && sheight !== void 0 ? sheight : maybeImageHeight) !== null && _b !== void 0 ? _b : 0;\n        this._dest[0] = sx !== null && sx !== void 0 ? sx : 1;\n        this._dest[1] = sy !== null && sy !== void 0 ? sy : 1;\n        // If destination is specified, update view and dest\n        if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\n            this._view[0] = sx !== null && sx !== void 0 ? sx : 1;\n            this._view[1] = sy !== null && sy !== void 0 ? sy : 1;\n            this._view[2] = (_c = swidth !== null && swidth !== void 0 ? swidth : maybeImageWidth) !== null && _c !== void 0 ? _c : 0;\n            this._view[3] = (_d = sheight !== null && sheight !== void 0 ? sheight : maybeImageHeight) !== null && _d !== void 0 ? _d : 0;\n            this._dest[0] = dx;\n            this._dest[1] = dy;\n            width = dwidth;\n            height = dheight;\n        }\n        sx = this._view[0];\n        sy = this._view[1];\n        const sw = this._view[2];\n        const sh = this._view[3];\n        // transform based on current context\n        const transform = this._context.getTransform();\n        const opacity = this._context.opacity;\n        const snapToPixel = this._context.snapToPixel;\n        // top left\n        this._quad[0] = this._dest[0];\n        this._quad[1] = this._dest[1];\n        // top right\n        this._quad[2] = this._dest[0] + width;\n        this._quad[3] = this._dest[1];\n        // bottom left\n        this._quad[4] = this._dest[0];\n        this._quad[5] = this._dest[1] + height;\n        // bottom right\n        this._quad[6] = this._dest[0] + width;\n        this._quad[7] = this._dest[1] + height;\n        transform.multiplyQuadInPlace(this._quad);\n        if (snapToPixel) {\n            this._quad[0] = ~~(this._quad[0] + sign(this._quad[0]) * pixelSnapEpsilon);\n            this._quad[1] = ~~(this._quad[1] + sign(this._quad[1]) * pixelSnapEpsilon);\n            this._quad[2] = ~~(this._quad[2] + sign(this._quad[2]) * pixelSnapEpsilon);\n            this._quad[3] = ~~(this._quad[3] + sign(this._quad[3]) * pixelSnapEpsilon);\n            this._quad[4] = ~~(this._quad[4] + sign(this._quad[4]) * pixelSnapEpsilon);\n            this._quad[5] = ~~(this._quad[5] + sign(this._quad[5]) * pixelSnapEpsilon);\n            this._quad[6] = ~~(this._quad[6] + sign(this._quad[6]) * pixelSnapEpsilon);\n            this._quad[7] = ~~(this._quad[7] + sign(this._quad[7]) * pixelSnapEpsilon);\n        }\n        const tint = this._context.tint;\n        const textureId = this._getTextureIdForImage(image);\n        const imageWidth = maybeImageWidth || width;\n        const imageHeight = maybeImageHeight || height;\n        const uvx0 = (sx + this.uvPadding) / imageWidth;\n        const uvy0 = (sy + this.uvPadding) / imageHeight;\n        const uvx1 = (sx + sw - this.uvPadding) / imageWidth;\n        const uvy1 = (sy + sh - this.uvPadding) / imageHeight;\n        const txWidth = maybeImageWidth;\n        const txHeight = maybeImageHeight;\n        // update data\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\n        // (0, 0) - 0\n        vertexBuffer[this._vertexIndex++] = this._quad[0];\n        vertexBuffer[this._vertexIndex++] = this._quad[1];\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = txWidth;\n        vertexBuffer[this._vertexIndex++] = txHeight;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = textureId;\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\n        vertexBuffer[this._vertexIndex++] = tint.a;\n        // (0, 1) - 1\n        vertexBuffer[this._vertexIndex++] = this._quad[4];\n        vertexBuffer[this._vertexIndex++] = this._quad[5];\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = txWidth;\n        vertexBuffer[this._vertexIndex++] = txHeight;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = textureId;\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\n        vertexBuffer[this._vertexIndex++] = tint.a;\n        // (1, 0) - 2\n        vertexBuffer[this._vertexIndex++] = this._quad[2];\n        vertexBuffer[this._vertexIndex++] = this._quad[3];\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = txWidth;\n        vertexBuffer[this._vertexIndex++] = txHeight;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = textureId;\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\n        vertexBuffer[this._vertexIndex++] = tint.a;\n        // (1, 1) - 3\n        vertexBuffer[this._vertexIndex++] = this._quad[6];\n        vertexBuffer[this._vertexIndex++] = this._quad[7];\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = txWidth;\n        vertexBuffer[this._vertexIndex++] = txHeight;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = textureId;\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\n        vertexBuffer[this._vertexIndex++] = tint.a;\n    }\n    hasPendingDraws() {\n        return this._imageCount !== 0;\n    }\n    flush() {\n        // nothing to draw early exit\n        if (this._imageCount === 0) {\n            return;\n        }\n        const gl = this._gl;\n        // Bind the shader\n        this._shader.use();\n        // Bind the memory layout and upload data\n        this._layout.use(true, 4 * 12 * this._imageCount); // 4 verts * 12 components\n        // Update ortho matrix uniform\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\n        // Turn on pixel art aa sampler\n        this._shader.setUniformBoolean('u_pixelart', this.pixelArtSampler);\n        // Bind textures to\n        this._bindTextures(gl);\n        // Bind index buffer\n        this._quads.bind();\n        // Draw all the quads\n        gl.drawElements(gl.TRIANGLES, this._imageCount * 6, this._quads.bufferGlType, 0);\n        GraphicsDiagnostics.DrawnImagesCount += this._imageCount;\n        GraphicsDiagnostics.DrawCallCount++;\n        // Reset\n        this._imageCount = 0;\n        this._vertexIndex = 0;\n        this._textures.length = 0;\n        this._textureIndex = 0;\n        this._textureToIndex.clear();\n        this._images.clear();\n        this._imageToWidth.clear();\n        this._imageToHeight.clear();\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.frag.glsl\n/* harmony default export */ const rectangle_renderer_frag = (\"#version 300 es\\r\\n\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_uv;\\r\\n\\r\\nin vec2 v_size; // in pixels\\r\\n\\r\\n// Color coord to blend with image\\r\\nin lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nin lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nin lowp float v_strokeThickness; // in pixels\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\\r\\n    vec2 uv = v_uv;\\r\\n    vec2 fragCoord = uv * v_size;\\r\\n    float maxX = v_size.x - v_strokeThickness;\\r\\n    float minX = v_strokeThickness;\\r\\n    float maxY = v_size.y - v_strokeThickness;\\r\\n    float minY = v_strokeThickness;\\r\\n\\r\\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\\r\\n        fragCoord.y < maxY && fragCoord.y > minY) {\\r\\n      fragColor = v_color;\\r\\n    } else {\\r\\n      fragColor = v_strokeColor;\\r\\n    }\\r\\n    fragColor.a *= v_opacity;\\r\\n    fragColor.rgb *= fragColor.a;\\r\\n\\r\\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\\r\\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\\r\\n\\r\\n    // float fHalfBorderDist      = 0.0;\\r\\n    // float fHalfBorderThickness = 0.0;\\r\\n\\r\\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \\r\\n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \\r\\n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else\\r\\n    // {\\r\\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\\r\\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\\r\\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\\r\\n        \\r\\n    //     float ellipse_ab    = v_radius-v_strokeThickness;\\r\\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\\r\\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \\r\\n            \\r\\n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\\r\\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\\r\\n    // }\\r\\n\\r\\n    // vec4 v4FromColor = v_strokeColor;\\r\\n    // v4FromColor.rgb *= v4FromColor.a;\\r\\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\\r\\n    // if (fHalfBorderDist < 0.0) {\\r\\n    //     v4ToColor = v_color;\\r\\n    //     v4ToColor.rgb *= v4ToColor.a;\\r\\n    // }\\r\\n\\r\\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\\r\\n\\r\\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\\r\\n    // gl_FragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.vert.glsl\n/* harmony default export */ const rectangle_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_uv;\\r\\nout vec2 v_uv;\\r\\n\\r\\nin vec2 a_size;\\r\\nout vec2 v_size;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\nin vec4 a_color;\\r\\nout vec4 v_color;\\r\\n\\r\\nin vec4 a_strokeColor;\\r\\nout vec4 v_strokeColor;\\r\\n\\r\\nin float a_strokeThickness;\\r\\nout float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through size\\r\\n   v_size = a_size;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.ts\n\n\n\n\n\n\n\n\n\n\nclass RectangleRenderer {\n    constructor() {\n        this.type = 'ex.rectangle';\n        this.priority = 0;\n        this._maxRectangles = 10922; // max(uint16) / 6 verts\n        this._rectangleCount = 0;\n        this._vertexIndex = 0;\n    }\n    initialize(gl, context) {\n        this._gl = gl;\n        this._context = context;\n        // https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\n        this._shader = new Shader({\n            gl,\n            fragmentSource: rectangle_renderer_frag,\n            vertexSource: rectangle_renderer_vert\n        });\n        this._shader.compile();\n        // setup uniforms\n        this._shader.use();\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\n        this._buffer = new VertexBuffer({\n            gl,\n            size: 16 * 4 * this._maxRectangles,\n            type: 'dynamic'\n        });\n        this._layout = new VertexLayout({\n            gl,\n            shader: this._shader,\n            vertexBuffer: this._buffer,\n            attributes: [\n                ['a_position', 2],\n                ['a_uv', 2],\n                ['a_size', 2],\n                ['a_opacity', 1],\n                ['a_color', 4],\n                ['a_strokeColor', 4],\n                ['a_strokeThickness', 1]\n            ]\n        });\n        this._quads = new QuadIndexBuffer(gl, this._maxRectangles, true);\n    }\n    dispose() {\n        this._buffer.dispose();\n        this._quads.dispose();\n        this._shader.dispose();\n        this._context = null;\n        this._gl = null;\n    }\n    _isFull() {\n        if (this._rectangleCount >= this._maxRectangles) {\n            return true;\n        }\n        return false;\n    }\n    draw(...args) {\n        if (args[0] instanceof Vector && args[1] instanceof Vector) {\n            this.drawLine.apply(this, args);\n        }\n        else {\n            this.drawRectangle.apply(this, args);\n        }\n    }\n    drawLine(start, end, color, thickness = 1) {\n        if (this._isFull()) {\n            this.flush();\n        }\n        this._rectangleCount++;\n        // transform based on current context\n        const transform = this._context.getTransform();\n        const opacity = this._context.opacity;\n        const snapToPixel = this._context.snapToPixel;\n        const dir = end.sub(start);\n        const length = dir.size;\n        const normal = dir.normalize().perpendicular();\n        const halfThick = thickness / 2;\n        /**\n         *    +---------------------^----------------------+\n         *    |                     | (normal)             |\n         *   (startx, starty)------------------>(endx, endy)\n         *    |                                            |\n         *    + -------------------------------------------+\n         */\n        const startTop = transform.multiply(normal.scale(halfThick).add(start));\n        const startBottom = transform.multiply(normal.scale(-halfThick).add(start));\n        const endTop = transform.multiply(normal.scale(halfThick).add(end));\n        const endBottom = transform.multiply(normal.scale(-halfThick).add(end));\n        if (snapToPixel) {\n            startTop.x = ~~(startTop.x + pixelSnapEpsilon);\n            startTop.y = ~~(startTop.y + pixelSnapEpsilon);\n            endTop.x = ~~(endTop.x + pixelSnapEpsilon);\n            endTop.y = ~~(endTop.y + pixelSnapEpsilon);\n            startBottom.x = ~~(startBottom.x + pixelSnapEpsilon);\n            startBottom.y = ~~(startBottom.y + pixelSnapEpsilon);\n            endBottom.x = ~~(endBottom.x + pixelSnapEpsilon);\n            endBottom.y = ~~(endBottom.y + pixelSnapEpsilon);\n        }\n        // TODO uv could be static vertex buffer\n        const uvx0 = 0;\n        const uvy0 = 0;\n        const uvx1 = 1;\n        const uvy1 = 1;\n        const stroke = Color.Transparent;\n        const strokeThickness = 0;\n        const width = 1;\n        // update data\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\n        // (0, 0) - 0\n        vertexBuffer[this._vertexIndex++] = startTop.x;\n        vertexBuffer[this._vertexIndex++] = startTop.y;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = length;\n        vertexBuffer[this._vertexIndex++] = thickness;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\n        // (0, 1) - 1\n        vertexBuffer[this._vertexIndex++] = startBottom.x;\n        vertexBuffer[this._vertexIndex++] = startBottom.y;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = length;\n        vertexBuffer[this._vertexIndex++] = thickness;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\n        // (1, 0) - 2\n        vertexBuffer[this._vertexIndex++] = endTop.x;\n        vertexBuffer[this._vertexIndex++] = endTop.y;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = length;\n        vertexBuffer[this._vertexIndex++] = thickness;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\n        // (1, 1) - 3\n        vertexBuffer[this._vertexIndex++] = endBottom.x;\n        vertexBuffer[this._vertexIndex++] = endBottom.y;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = length;\n        vertexBuffer[this._vertexIndex++] = thickness;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\n    }\n    drawRectangle(pos, width, height, color, stroke = Color.Transparent, strokeThickness = 0) {\n        if (this._isFull()) {\n            this.flush();\n        }\n        this._rectangleCount++;\n        // transform based on current context\n        const transform = this._context.getTransform();\n        const opacity = this._context.opacity;\n        const snapToPixel = this._context.snapToPixel;\n        const topLeft = transform.multiply(pos.add(vec(0, 0)));\n        const topRight = transform.multiply(pos.add(vec(width, 0)));\n        const bottomRight = transform.multiply(pos.add(vec(width, height)));\n        const bottomLeft = transform.multiply(pos.add(vec(0, height)));\n        if (snapToPixel) {\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\n        }\n        // TODO uv could be static vertex buffer\n        const uvx0 = 0;\n        const uvy0 = 0;\n        const uvx1 = 1;\n        const uvy1 = 1;\n        // update data\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\n        // (0, 0) - 0\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = width;\n        vertexBuffer[this._vertexIndex++] = height;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\n        // (0, 1) - 1\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = width;\n        vertexBuffer[this._vertexIndex++] = height;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\n        // (1, 0) - 2\n        vertexBuffer[this._vertexIndex++] = topRight.x;\n        vertexBuffer[this._vertexIndex++] = topRight.y;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = width;\n        vertexBuffer[this._vertexIndex++] = height;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\n        // (1, 1) - 3\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = width;\n        vertexBuffer[this._vertexIndex++] = height;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\n    }\n    hasPendingDraws() {\n        return this._rectangleCount !== 0;\n    }\n    flush() {\n        // nothing to draw early exit\n        if (this._rectangleCount === 0) {\n            return;\n        }\n        const gl = this._gl;\n        // Bind the shader\n        this._shader.use();\n        // Bind the memory layout and upload data\n        this._layout.use(true);\n        // Update ortho matrix uniform\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\n        // Bind index buffer\n        this._quads.bind();\n        // Draw all the quads\n        gl.drawElements(gl.TRIANGLES, this._rectangleCount * 6, this._quads.bufferGlType, 0);\n        GraphicsDiagnostics.DrawnImagesCount += this._rectangleCount;\n        GraphicsDiagnostics.DrawCallCount++;\n        // Reset\n        this._rectangleCount = 0;\n        this._vertexIndex = 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.frag.glsl\n/* harmony default export */ const circle_renderer_frag = (\"#version 300 es\\r\\nprecision highp float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_uv;\\r\\n\\r\\n// Color coord to blend with image\\r\\nin lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nin lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nin lowp float v_strokeThickness;\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  // make (0, 0) the center the uv \\r\\n  vec2 uv = v_uv * 2.0 - 1.0;\\r\\n\\r\\n  vec4 color = v_color;\\r\\n  vec4 strokeColor = v_strokeColor;\\r\\n\\r\\n  // circle border is at radius 1.0 \\r\\n  // dist is > 0 when inside the circle \\r\\n  float d = length(uv);\\r\\n  float dist = 1.0 - length(uv);\\r\\n\\r\\n  // Fade based on fwidth\\r\\n  float fade = fwidth(dot(uv, uv));\\r\\n\\r\\n  // if dist is greater than 0 step to 1;\\r\\n  // when we cross this 0 threshold add a smooth fade\\r\\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\\r\\n\\r\\n  // if dist is greater than the stroke thickness step to 1\\r\\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\\r\\n\\r\\n  strokeColor.a *= fill * stroke;\\r\\n  strokeColor.rgb *= strokeColor.a;\\r\\n\\r\\n  color.a *= fill * (1.0 - stroke);\\r\\n  color.rgb *= color.a;\\r\\n\\r\\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\\r\\n  finalColor.rgb = finalColor.rgb * v_opacity;\\r\\n  finalColor.a = finalColor.a * v_opacity;\\r\\n  fragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.vert.glsl\n/* harmony default export */ const circle_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_uv;\\r\\nout vec2 v_uv;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\nin vec4 a_color;\\r\\nout vec4 v_color;\\r\\n\\r\\nin vec4 a_strokeColor;\\r\\nout vec4 v_strokeColor;\\r\\n\\r\\nin float a_strokeThickness;\\r\\nout float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.ts\n\n\n\n\n\n\n\n\n\n\nclass CircleRenderer {\n    constructor() {\n        this.type = 'ex.circle';\n        this.priority = 0;\n        this._maxCircles = 10922; // max(uint16) / 6 verts\n        this._circleCount = 0;\n        this._vertexIndex = 0;\n    }\n    initialize(gl, context) {\n        this._gl = gl;\n        this._context = context;\n        this._shader = new Shader({\n            gl,\n            fragmentSource: circle_renderer_frag,\n            vertexSource: circle_renderer_vert\n        });\n        this._shader.compile();\n        // setup uniforms\n        this._shader.use();\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\n        this._buffer = new VertexBuffer({\n            gl,\n            size: 14 * 4 * this._maxCircles,\n            type: 'dynamic'\n        });\n        this._layout = new VertexLayout({\n            gl,\n            shader: this._shader,\n            vertexBuffer: this._buffer,\n            attributes: [\n                ['a_position', 2],\n                ['a_uv', 2],\n                ['a_opacity', 1],\n                ['a_color', 4],\n                ['a_strokeColor', 4],\n                ['a_strokeThickness', 1]\n            ]\n        });\n        this._quads = new QuadIndexBuffer(gl, this._maxCircles, true);\n    }\n    dispose() {\n        this._buffer.dispose();\n        this._quads.dispose();\n        this._shader.dispose();\n        this._context = null;\n        this._gl = null;\n    }\n    _isFull() {\n        if (this._circleCount >= this._maxCircles) {\n            return true;\n        }\n        return false;\n    }\n    draw(pos, radius, color, stroke = Color.Transparent, strokeThickness = 0) {\n        if (this._isFull()) {\n            this.flush();\n        }\n        this._circleCount++;\n        // transform based on current context\n        const transform = this._context.getTransform();\n        const opacity = this._context.opacity;\n        const snapToPixel = this._context.snapToPixel;\n        const topLeft = transform.multiply(pos.add(vec(-radius, -radius)));\n        const topRight = transform.multiply(pos.add(vec(radius, -radius)));\n        const bottomRight = transform.multiply(pos.add(vec(radius, radius)));\n        const bottomLeft = transform.multiply(pos.add(vec(-radius, radius)));\n        if (snapToPixel) {\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\n        }\n        // TODO UV could be static vertex buffer\n        const uvx0 = 0;\n        const uvy0 = 0;\n        const uvx1 = 1;\n        const uvy1 = 1;\n        // update data\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\n        // (0, 0) - 0\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\n        // (0, 1) - 1\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\n        vertexBuffer[this._vertexIndex++] = uvx0;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\n        // (1, 0) - 2\n        vertexBuffer[this._vertexIndex++] = topRight.x;\n        vertexBuffer[this._vertexIndex++] = topRight.y;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy0;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\n        // (1, 1) - 3\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\n        vertexBuffer[this._vertexIndex++] = uvx1;\n        vertexBuffer[this._vertexIndex++] = uvy1;\n        vertexBuffer[this._vertexIndex++] = opacity;\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\n        vertexBuffer[this._vertexIndex++] = color.a;\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\n        vertexBuffer[this._vertexIndex++] = stroke.a;\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\n    }\n    hasPendingDraws() {\n        return this._circleCount !== 0;\n    }\n    flush() {\n        // nothing to draw early exit\n        if (this._circleCount === 0) {\n            return;\n        }\n        const gl = this._gl;\n        // Bind the shader\n        this._shader.use();\n        // Bind the memory layout and upload data\n        this._layout.use(true);\n        // Update ortho matrix uniform\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\n        // Bind index buffer\n        this._quads.bind();\n        // Draw all the quads\n        gl.drawElements(gl.TRIANGLES, this._circleCount * 6, this._quads.bufferGlType, 0);\n        GraphicsDiagnostics.DrawnImagesCount += this._circleCount;\n        GraphicsDiagnostics.DrawCallCount++;\n        // Reset\n        this._circleCount = 0;\n        this._vertexIndex = 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Pool.ts\n\nclass Pool {\n    constructor(builder, recycler, maxObjects = 100) {\n        this.builder = builder;\n        this.recycler = recycler;\n        this.maxObjects = maxObjects;\n        this.totalAllocations = 0;\n        this.index = 0;\n        this.objects = [];\n        this.disableWarnings = false;\n        this._logger = Logger.getInstance();\n    }\n    dispose() {\n        this.objects.length = 0;\n    }\n    preallocate() {\n        for (let i = 0; i < this.maxObjects; i++) {\n            this.objects[i] = this.builder();\n        }\n    }\n    /**\n     * Use many instances out of the in the context and return all to the pool.\n     *\n     * By returning values out of the context they will be un-hooked from the pool and are free to be passed to consumers\n     * @param context\n     */\n    using(context) {\n        const result = context(this);\n        if (result) {\n            return this.done(...result);\n        }\n        return this.done();\n    }\n    /**\n     * Use a single instance out of th pool and immediately return it to the pool\n     * @param context\n     */\n    borrow(context) {\n        const object = this.get();\n        context(object);\n        this.index--;\n    }\n    /**\n     * Retrieve a value from the pool, will allocate a new instance if necessary or recycle from the pool\n     */\n    get() {\n        if (this.index === this.maxObjects) {\n            if (!this.disableWarnings) {\n                this._logger.warn('Max pooled objects reached, possible memory leak? Doubling');\n            }\n            this.maxObjects = this.maxObjects * 2;\n        }\n        if (this.objects[this.index]) {\n            // Pool has an available object already constructed\n            return this.recycler(this.objects[this.index++]);\n        }\n        else {\n            // New allocation\n            this.totalAllocations++;\n            const object = (this.objects[this.index++] = this.builder());\n            return object;\n        }\n    }\n    done(...objects) {\n        // All objects in pool now considered \"free\"\n        this.index = 0;\n        for (const object of objects) {\n            const poolIndex = this.objects.indexOf(object);\n            // Build a new object to take the pool place\n            this.objects[poolIndex] = this.builder();\n            this.totalAllocations++;\n        }\n        return objects;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/draw-call.ts\n\n\nclass DrawCall {\n    constructor() {\n        this.z = 0;\n        this.priority = 0;\n        this.transform = AffineMatrix.identity();\n        this.state = {\n            z: 0,\n            opacity: 1,\n            tint: Color.White,\n            material: null\n        };\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/material.ts\n\n\n\n\n\n\nconst defaultVertexSource = `#version 300 es\r\nin vec2 a_position;\r\n\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\nin vec2 a_screenuv;\r\nout vec2 v_screenuv;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_transform;\r\n\r\nvoid main() {\r\n  // Set the vertex position using the ortho & transform matrix\r\n  gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);\r\n\r\n  // Pass through the UV coord to the fragment shader\r\n  v_uv = a_uv;\r\n  v_screenuv = a_screenuv;\r\n}\r\n`;\nclass Material {\n    constructor(options) {\n        this._logger = Logger.getInstance();\n        this._color = Color.Transparent;\n        this._initialized = false;\n        this._images = new Map();\n        this._textures = new Map();\n        const { color, name, vertexSource, fragmentSource, graphicsContext, images } = options;\n        this._name = name !== null && name !== void 0 ? name : 'anonymous material';\n        this._vertexSource = vertexSource !== null && vertexSource !== void 0 ? vertexSource : defaultVertexSource;\n        this._fragmentSource = fragmentSource;\n        this._color = color !== null && color !== void 0 ? color : this._color;\n        if (!graphicsContext) {\n            throw Error(`Material ${name} must be provided an excalibur webgl graphics context`);\n        }\n        if (graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\n            this._graphicsContext = graphicsContext;\n            this._initialize(graphicsContext);\n        }\n        else {\n            this._logger.warn(`Material ${name} was created in 2D Canvas mode, currently only WebGL is supported`);\n        }\n        if (images) {\n            for (const key in images) {\n                this.addImageSource(key, images[key]);\n            }\n        }\n    }\n    _initialize(graphicsContextWebGL) {\n        if (this._initialized) {\n            return;\n        }\n        const gl = graphicsContextWebGL.__gl;\n        // max texture slots - 2 for the graphic texture and screen texture\n        this._maxTextureSlots = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS) - 2;\n        this._shader = graphicsContextWebGL.createShader({\n            vertexSource: this._vertexSource,\n            fragmentSource: this._fragmentSource\n        });\n        this._shader.compile();\n        this._initialized = true;\n    }\n    get name() {\n        var _a;\n        return (_a = this._name) !== null && _a !== void 0 ? _a : 'anonymous material';\n    }\n    get isUsingScreenTexture() {\n        return this._fragmentSource.includes('u_screen_texture');\n    }\n    update(callback) {\n        if (this._shader) {\n            this._shader.use();\n            callback(this._shader);\n        }\n    }\n    getShader() {\n        return this._shader;\n    }\n    addImageSource(textureUniformName, image) {\n        if (this._images.size < this._maxTextureSlots) {\n            this._images.set(textureUniformName, image);\n        }\n        else {\n            this._logger.warn(`Max number texture slots ${this._maxTextureSlots} have been reached for material \"${this.name}\", ` +\n                `no more textures will be uploaded due to hardware constraints.`);\n        }\n    }\n    removeImageSource(textureName) {\n        const image = this._images.get(textureName);\n        this._graphicsContext.textureLoader.delete(image.image);\n        this._images.delete(textureName);\n    }\n    _loadImageSource(image) {\n        const imageElement = image.image;\n        const maybeFiltering = imageElement.getAttribute(ImageSourceAttributeConstants.Filtering);\n        const filtering = maybeFiltering ? parseImageFiltering(maybeFiltering) : null;\n        const wrapX = parseImageWrapping(imageElement.getAttribute(ImageSourceAttributeConstants.WrappingX));\n        const wrapY = parseImageWrapping(imageElement.getAttribute(ImageSourceAttributeConstants.WrappingY));\n        const force = imageElement.getAttribute('forceUpload') === 'true' ? true : false;\n        const texture = this._graphicsContext.textureLoader.load(imageElement, {\n            filtering,\n            wrapping: { x: wrapX, y: wrapY }\n        }, force);\n        // remove force attribute after upload\n        imageElement.removeAttribute('forceUpload');\n        if (!this._textures.has(image)) {\n            this._textures.set(image, texture);\n        }\n        return texture;\n    }\n    uploadAndBind(gl, startingTextureSlot = 2) {\n        let textureSlot = startingTextureSlot;\n        for (const [textureName, image] of this._images.entries()) {\n            if (!image.isLoaded()) {\n                this._logger.warnOnce(`Image named ${textureName} in material ${this.name} not loaded, nothing will be uploaded to the shader.` +\n                    ` Did you forget to add this to a loader? https://excaliburjs.com/docs/loaders/`);\n                continue;\n            } // skip unloaded images, maybe warn\n            const texture = this._loadImageSource(image);\n            gl.activeTexture(gl.TEXTURE0 + textureSlot);\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            this._shader.trySetUniformInt(textureName, textureSlot);\n            textureSlot++;\n        }\n    }\n    use() {\n        if (this._initialized) {\n            // bind the shader\n            this._shader.use();\n            // Apply standard uniforms\n            this._shader.trySetUniformFloatColor('u_color', this._color);\n        }\n        else {\n            throw Error(`Material ${this.name} not yet initialized, use the ExcaliburGraphicsContext.createMaterial() to work around this.`);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/material-renderer/material-renderer.ts\n\n\n\n\n\n\n\n\nclass MaterialRenderer {\n    constructor() {\n        this.type = 'ex.material';\n        this.priority = 0;\n        this._textures = [];\n    }\n    initialize(gl, context) {\n        this._gl = gl;\n        this._context = context;\n        // Setup memory layout\n        this._buffer = new VertexBuffer({\n            gl,\n            size: 6 * 4, // 6 components * 4 verts\n            type: 'dynamic'\n        });\n        // Setup a vertex layout/buffer to the material\n        this._layout = new VertexLayout({\n            gl,\n            vertexBuffer: this._buffer,\n            attributes: [\n                ['a_position', 2],\n                ['a_uv', 2],\n                ['a_screenuv', 2]\n            ],\n            suppressWarnings: true\n        });\n        // Setup index buffer\n        this._quads = new QuadIndexBuffer(gl, 1, true);\n    }\n    dispose() {\n        this._buffer.dispose();\n        this._quads.dispose();\n        this._textures.length = 0;\n        this._context = null;\n        this._gl = null;\n    }\n    draw(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\n        var _a, _b, _c, _d;\n        const gl = this._gl;\n        // Extract context info\n        const material = this._context.material;\n        const transform = this._context.getTransform();\n        const opacity = this._context.opacity;\n        // material shader\n        const shader = material.getShader();\n        // construct geometry, or hold on to it in the material?\n        // geometry primitive for drawing rectangles?\n        // update data\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\n        let vertexIndex = 0;\n        let width = (image === null || image === void 0 ? void 0 : image.width) || swidth || 0;\n        let height = (image === null || image === void 0 ? void 0 : image.height) || sheight || 0;\n        let view = [0, 0, (_a = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _a !== void 0 ? _a : 0, (_b = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _b !== void 0 ? _b : 0];\n        let dest = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1];\n        // If destination is specified, update view and dest\n        if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\n            view = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1, (_c = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _c !== void 0 ? _c : 0, (_d = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _d !== void 0 ? _d : 0];\n            dest = [dx, dy];\n            width = dwidth;\n            height = dheight;\n        }\n        sx = view[0];\n        sy = view[1];\n        const sw = view[2];\n        const sh = view[3];\n        const topLeft = vec(dest[0], dest[1]);\n        const topRight = vec(dest[0] + width, dest[1]);\n        const bottomLeft = vec(dest[0], dest[1] + height);\n        const bottomRight = vec(dest[0] + width, dest[1] + height);\n        const imageWidth = image.width || width;\n        const imageHeight = image.height || height;\n        const uvx0 = (sx) / imageWidth;\n        const uvy0 = (sy) / imageHeight;\n        const uvx1 = (sx + sw - 0.01) / imageWidth;\n        const uvy1 = (sy + sh - 0.01) / imageHeight;\n        const topLeftScreen = transform.getPosition();\n        const bottomRightScreen = topLeftScreen.add(bottomRight);\n        const screenUVX0 = topLeftScreen.x / this._context.width;\n        const screenUVY0 = topLeftScreen.y / this._context.height;\n        const screenUVX1 = bottomRightScreen.x / this._context.width;\n        const screenUVY1 = bottomRightScreen.y / this._context.height;\n        // (0, 0) - 0\n        vertexBuffer[vertexIndex++] = topLeft.x;\n        vertexBuffer[vertexIndex++] = topLeft.y;\n        vertexBuffer[vertexIndex++] = uvx0;\n        vertexBuffer[vertexIndex++] = uvy0;\n        vertexBuffer[vertexIndex++] = screenUVX0;\n        vertexBuffer[vertexIndex++] = screenUVY0;\n        // (0, 1) - 1\n        vertexBuffer[vertexIndex++] = bottomLeft.x;\n        vertexBuffer[vertexIndex++] = bottomLeft.y;\n        vertexBuffer[vertexIndex++] = uvx0;\n        vertexBuffer[vertexIndex++] = uvy1;\n        vertexBuffer[vertexIndex++] = screenUVX0;\n        vertexBuffer[vertexIndex++] = screenUVY1;\n        // (1, 0) - 2\n        vertexBuffer[vertexIndex++] = topRight.x;\n        vertexBuffer[vertexIndex++] = topRight.y;\n        vertexBuffer[vertexIndex++] = uvx1;\n        vertexBuffer[vertexIndex++] = uvy0;\n        vertexBuffer[vertexIndex++] = screenUVX1;\n        vertexBuffer[vertexIndex++] = screenUVY0;\n        // (1, 1) - 3\n        vertexBuffer[vertexIndex++] = bottomRight.x;\n        vertexBuffer[vertexIndex++] = bottomRight.y;\n        vertexBuffer[vertexIndex++] = uvx1;\n        vertexBuffer[vertexIndex++] = uvy1;\n        vertexBuffer[vertexIndex++] = screenUVX1;\n        vertexBuffer[vertexIndex++] = screenUVY1;\n        // This creates and uploads the texture if not already done\n        const texture = this._addImageAsTexture(image);\n        // apply material\n        material.use();\n        this._layout.shader = shader;\n        // apply layout and geometry\n        this._layout.use(true);\n        // apply time in ms since the page (performance.now())\n        shader.trySetUniformFloat('u_time_ms', performance.now());\n        // apply opacity\n        shader.trySetUniformFloat('u_opacity', opacity);\n        // apply resolution\n        shader.trySetUniformFloatVector('u_resolution', vec(this._context.width, this._context.height));\n        // apply graphic resolution\n        shader.trySetUniformFloatVector('u_graphic_resolution', vec(imageWidth, imageHeight));\n        // apply size\n        shader.trySetUniformFloatVector('u_size', vec(sw, sh));\n        // apply orthographic projection\n        shader.trySetUniformMatrix('u_matrix', this._context.ortho);\n        // apply geometry transform\n        shader.trySetUniformMatrix('u_transform', transform.to4x4());\n        // bind graphic image texture 'uniform sampler2D u_graphic;'\n        gl.activeTexture(gl.TEXTURE0 + 0);\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        shader.trySetUniformInt('u_graphic', 0);\n        // bind the screen texture\n        gl.activeTexture(gl.TEXTURE0 + 1);\n        gl.bindTexture(gl.TEXTURE_2D, this._context.materialScreenTexture);\n        shader.trySetUniformInt('u_screen_texture', 1);\n        // bind any additional textures in the material\n        material.uploadAndBind(gl);\n        // bind quad index buffer\n        this._quads.bind();\n        // Draw a single quad\n        gl.drawElements(gl.TRIANGLES, 6, this._quads.bufferGlType, 0);\n        GraphicsDiagnostics.DrawnImagesCount++;\n        GraphicsDiagnostics.DrawCallCount++;\n    }\n    _addImageAsTexture(image) {\n        const maybeFiltering = image.getAttribute(ImageSourceAttributeConstants.Filtering);\n        const filtering = maybeFiltering ? parseImageFiltering(maybeFiltering) : null;\n        const wrapX = parseImageWrapping(image.getAttribute(ImageSourceAttributeConstants.WrappingX));\n        const wrapY = parseImageWrapping(image.getAttribute(ImageSourceAttributeConstants.WrappingY));\n        const force = image.getAttribute('forceUpload') === 'true' ? true : false;\n        const texture = this._context.textureLoader.load(image, {\n            filtering,\n            wrapping: { x: wrapX, y: wrapY }\n        }, force);\n        // remove force attribute after upload\n        image.removeAttribute('forceUpload');\n        if (this._textures.indexOf(texture) === -1) {\n            this._textures.push(texture);\n        }\n        return texture;\n    }\n    hasPendingDraws() {\n        return false;\n    }\n    flush() {\n        // flush does not do anything, material renderer renders immediately per draw\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContextWebGL.ts\n\n\n\n\n\n\n\n\n\n// renderers\n\n\n\n\n\n\n\n\n\n\n\n\nconst pixelSnapEpsilon = 0.0001;\nclass ExcaliburGraphicsContextWebGLDebug {\n    constructor(_webglCtx) {\n        this._webglCtx = _webglCtx;\n        this._debugText = new DebugText();\n    }\n    /**\n     * Draw a debugging rectangle to the context\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     */\n    drawRect(x, y, width, height, rectOptions = { color: Color.Black }) {\n        this.drawLine(vec(x, y), vec(x + width, y), { ...rectOptions });\n        this.drawLine(vec(x + width, y), vec(x + width, y + height), { ...rectOptions });\n        this.drawLine(vec(x + width, y + height), vec(x, y + height), { ...rectOptions });\n        this.drawLine(vec(x, y + height), vec(x, y), { ...rectOptions });\n    }\n    /**\n     * Draw a debugging line to the context\n     * @param start\n     * @param end\n     * @param lineOptions\n     */\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\n        this._webglCtx.draw('ex.line', start, end, lineOptions.color);\n    }\n    /**\n     * Draw a debugging point to the context\n     * @param point\n     * @param pointOptions\n     */\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\n        this._webglCtx.draw('ex.point', point, pointOptions.color, pointOptions.size);\n    }\n    drawText(text, pos) {\n        this._debugText.write(this._webglCtx, text, pos);\n    }\n}\nclass ExcaliburGraphicsContextWebGL {\n    get z() {\n        return this._state.current.z;\n    }\n    set z(value) {\n        this._state.current.z = value;\n    }\n    get opacity() {\n        return this._state.current.opacity;\n    }\n    set opacity(value) {\n        this._state.current.opacity = value;\n    }\n    get tint() {\n        return this._state.current.tint;\n    }\n    set tint(color) {\n        this._state.current.tint = color;\n    }\n    get width() {\n        return this.__gl.canvas.width;\n    }\n    get height() {\n        return this.__gl.canvas.height;\n    }\n    get ortho() {\n        return this._ortho;\n    }\n    /**\n     * Checks the underlying webgl implementation if the requested internal resolution is supported\n     * @param dim\n     */\n    checkIfResolutionSupported(dim) {\n        // Slight hack based on this thread https://groups.google.com/g/webgl-dev-list/c/AHONvz3oQTo\n        let supported = true;\n        if (dim.width > 4096 || dim.height > 4096) {\n            supported = false;\n        }\n        return supported;\n    }\n    constructor(options) {\n        this._logger = Logger.getInstance();\n        this._renderers = new Map();\n        this._isDrawLifecycle = false;\n        this.useDrawSorting = true;\n        this._drawCallPool = new Pool(() => new DrawCall(), (instance) => {\n            instance.priority = 0;\n            instance.z = 0;\n            instance.renderer = undefined;\n            instance.args = undefined;\n            return instance;\n        }, 4000);\n        this._drawCallIndex = 0;\n        this._drawCalls = (new Array(4000)).fill(null);\n        // Postprocessing is a tuple with 2 render targets, these are flip-flopped during the postprocessing process\n        this._postProcessTargets = [];\n        this._postprocessors = [];\n        this._transform = new TransformStack();\n        this._state = new StateStack();\n        /**\n         * Snaps the drawing x/y coordinate to the nearest whole pixel\n         */\n        this.snapToPixel = false;\n        /**\n         * Native context smoothing\n         */\n        this.smoothing = false;\n        /**\n         * Whether the pixel art sampler is enabled for smooth sub pixel anti-aliasing\n         */\n        this.pixelArtSampler = false;\n        /**\n         * UV padding in pixels to use in internal image rendering to prevent texture bleed\n         *\n         */\n        this.uvPadding = .01;\n        this.backgroundColor = Color.ExcaliburBlue;\n        this.multiSampleAntialiasing = true;\n        this.transparency = true;\n        this._isContextLost = false;\n        this._disposed = false;\n        this._imageToWidth = new Map();\n        this._imageToHeight = new Map();\n        this.debug = new ExcaliburGraphicsContextWebGLDebug(this);\n        this._totalPostProcessorTime = 0;\n        const { canvasElement, context, enableTransparency, antialiasing, uvPadding, multiSampleAntialiasing, pixelArtSampler, powerPreference, snapToPixel, backgroundColor, useDrawSorting, handleContextLost, handleContextRestored } = options;\n        this.__gl = context !== null && context !== void 0 ? context : canvasElement.getContext('webgl2', {\n            antialias: antialiasing !== null && antialiasing !== void 0 ? antialiasing : this.smoothing,\n            premultipliedAlpha: false,\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : this.transparency,\n            depth: false,\n            powerPreference: powerPreference !== null && powerPreference !== void 0 ? powerPreference : 'high-performance'\n        });\n        if (!this.__gl) {\n            throw Error('Failed to retrieve webgl context from browser');\n        }\n        if (handleContextLost) {\n            this.__gl.canvas.addEventListener('webglcontextlost', handleContextLost, false);\n        }\n        if (handleContextRestored) {\n            this.__gl.canvas.addEventListener('webglcontextrestored', handleContextRestored, false);\n        }\n        this.__gl.canvas.addEventListener('webglcontextlost', () => {\n            this._isContextLost = true;\n        });\n        this.__gl.canvas.addEventListener('webglcontextrestored', () => {\n            this._isContextLost = false;\n        });\n        this.textureLoader = new TextureLoader(this.__gl);\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\n        this.smoothing = antialiasing !== null && antialiasing !== void 0 ? antialiasing : this.smoothing;\n        this.transparency = enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : this.transparency;\n        this.pixelArtSampler = pixelArtSampler !== null && pixelArtSampler !== void 0 ? pixelArtSampler : this.pixelArtSampler;\n        this.uvPadding = uvPadding !== null && uvPadding !== void 0 ? uvPadding : this.uvPadding;\n        this.multiSampleAntialiasing = typeof multiSampleAntialiasing === 'boolean' ? multiSampleAntialiasing : this.multiSampleAntialiasing;\n        this.samples = typeof multiSampleAntialiasing === 'object' ? multiSampleAntialiasing.samples : undefined;\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\n        this.useDrawSorting = useDrawSorting !== null && useDrawSorting !== void 0 ? useDrawSorting : this.useDrawSorting;\n        this._drawCallPool.disableWarnings = true;\n        this._drawCallPool.preallocate();\n        this._init();\n    }\n    dispose() {\n        if (!this._disposed) {\n            this._disposed = true;\n            this.textureLoader.dispose();\n            for (const renderer of this._renderers.values()) {\n                renderer.dispose();\n            }\n            this._renderers.clear();\n            this._drawCallPool.dispose();\n            this._drawCalls.length = 0;\n            this.__gl = null;\n        }\n    }\n    _init() {\n        const gl = this.__gl;\n        // Setup viewport and view matrix\n        this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n        // Clear background\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n        // Enable alpha blending\n        // https://www.realtimerendering.com/blog/gpus-prefer-premultiplication/\n        gl.enable(gl.BLEND);\n        gl.blendEquation(gl.FUNC_ADD);\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\n        gl.blendFuncSeparate(gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n        // Setup builtin renderers\n        this.register(new ImageRenderer({\n            uvPadding: this.uvPadding,\n            pixelArtSampler: this.pixelArtSampler\n        }));\n        this.register(new MaterialRenderer());\n        this.register(new RectangleRenderer());\n        this.register(new CircleRenderer());\n        this.register(new PointRenderer());\n        this.register(new LineRenderer());\n        this.materialScreenTexture = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, this.materialScreenTexture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        this._screenRenderer = new ScreenPassPainter(gl);\n        this._renderTarget = new RenderTarget({\n            gl,\n            transparency: this.transparency,\n            width: gl.canvas.width,\n            height: gl.canvas.height\n        });\n        this._postProcessTargets = [\n            new RenderTarget({\n                gl,\n                transparency: this.transparency,\n                width: gl.canvas.width,\n                height: gl.canvas.height\n            }),\n            new RenderTarget({\n                gl,\n                transparency: this.transparency,\n                width: gl.canvas.width,\n                height: gl.canvas.height\n            })\n        ];\n        this._msaaTarget = new RenderTarget({\n            gl,\n            transparency: this.transparency,\n            width: gl.canvas.width,\n            height: gl.canvas.height,\n            antialias: this.multiSampleAntialiasing,\n            samples: this.samples\n        });\n    }\n    register(renderer) {\n        this._renderers.set(renderer.type, renderer);\n        renderer.initialize(this.__gl, this);\n    }\n    get(rendererName) {\n        return this._renderers.get(rendererName);\n    }\n    _isCurrentRenderer(renderer) {\n        if (!this._currentRenderer || this._currentRenderer === renderer) {\n            return true;\n        }\n        return false;\n    }\n    beginDrawLifecycle() {\n        this._isDrawLifecycle = true;\n    }\n    endDrawLifecycle() {\n        this._isDrawLifecycle = false;\n    }\n    draw(rendererName, ...args) {\n        if (!this._isDrawLifecycle) {\n            this._logger.warnOnce(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\\n` +\n                `If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`);\n        }\n        if (this._isContextLost) {\n            this._logger.errorOnce(`Unable to draw ${rendererName}, the webgl context is lost`);\n            return;\n        }\n        const renderer = this._renderers.get(rendererName);\n        if (renderer) {\n            if (this.useDrawSorting) {\n                const drawCall = this._drawCallPool.get();\n                drawCall.z = this._state.current.z;\n                drawCall.priority = renderer.priority;\n                drawCall.renderer = rendererName;\n                this.getTransform().clone(drawCall.transform);\n                drawCall.state.z = this._state.current.z;\n                drawCall.state.opacity = this._state.current.opacity;\n                drawCall.state.tint = this._state.current.tint;\n                drawCall.state.material = this._state.current.material;\n                drawCall.args = args;\n                this._drawCalls[this._drawCallIndex++] = drawCall;\n            }\n            else {\n                // Set the current renderer if not defined\n                if (!this._currentRenderer) {\n                    this._currentRenderer = renderer;\n                }\n                if (!this._isCurrentRenderer(renderer)) {\n                    // switching graphics means we must flush the previous\n                    this._currentRenderer.flush();\n                }\n                // If we are still using the same renderer we can add to the current batch\n                renderer.draw(...args);\n                this._currentRenderer = renderer;\n            }\n        }\n        else {\n            throw Error(`No renderer with name ${rendererName} has been registered`);\n        }\n    }\n    resetTransform() {\n        this._transform.current = AffineMatrix.identity();\n    }\n    updateViewport(resolution) {\n        const gl = this.__gl;\n        this._ortho = this._ortho = Matrix.ortho(0, resolution.width, resolution.height, 0, 400, -400);\n        this._renderTarget.setResolution(gl.canvas.width, gl.canvas.height);\n        this._msaaTarget.setResolution(gl.canvas.width, gl.canvas.height);\n        this._postProcessTargets[0].setResolution(gl.canvas.width, gl.canvas.height);\n        this._postProcessTargets[1].setResolution(gl.canvas.width, gl.canvas.height);\n    }\n    _getImageWidth(image) {\n        let maybeWidth = this._imageToWidth.get(image);\n        if (maybeWidth === undefined) {\n            maybeWidth = image.width;\n            this._imageToWidth.set(image, maybeWidth);\n        }\n        return maybeWidth;\n    }\n    _getImageHeight(image) {\n        let maybeHeight = this._imageToHeight.get(image);\n        if (maybeHeight === undefined) {\n            maybeHeight = image.height;\n            this._imageToHeight.set(image, maybeHeight);\n        }\n        return maybeHeight;\n    }\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\n        if (swidth === 0 || sheight === 0) {\n            return; // zero dimension dest exit early\n        }\n        else if (dwidth === 0 || dheight === 0) {\n            return; // zero dimension dest exit early\n        }\n        else if (this._getImageWidth(image) === 0 || this._getImageHeight(image) === 0) {\n            return; // zero dimension source exit early\n        }\n        if (!image) {\n            Logger.getInstance().warn('Cannot draw a null or undefined image');\n            // tslint:disable-next-line: no-console\n            if (console.trace) {\n                // tslint:disable-next-line: no-console\n                console.trace();\n            }\n            return;\n        }\n        if (this._state.current.material) {\n            this.draw('ex.material', image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\n        }\n        else {\n            this.draw('ex.image', image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\n        }\n    }\n    drawLine(start, end, color, thickness = 1) {\n        this.draw('ex.rectangle', start, end, color, thickness);\n    }\n    drawRectangle(pos, width, height, color, stroke, strokeThickness) {\n        this.draw('ex.rectangle', pos, width, height, color, stroke, strokeThickness);\n    }\n    drawCircle(pos, radius, color, stroke, thickness) {\n        this.draw('ex.circle', pos, radius, color, stroke, thickness);\n    }\n    save() {\n        this._transform.save();\n        this._state.save();\n    }\n    restore() {\n        this._transform.restore();\n        this._state.restore();\n    }\n    translate(x, y) {\n        this._transform.translate(this.snapToPixel ? ~~(x + pixelSnapEpsilon) : x, this.snapToPixel ? ~~(y + pixelSnapEpsilon) : y);\n    }\n    rotate(angle) {\n        this._transform.rotate(angle);\n    }\n    scale(x, y) {\n        this._transform.scale(x, y);\n    }\n    transform(matrix) {\n        this._transform.current = matrix;\n    }\n    getTransform() {\n        return this._transform.current;\n    }\n    multiply(m) {\n        this._transform.current.multiply(m, this._transform.current);\n    }\n    addPostProcessor(postprocessor) {\n        this._postprocessors.push(postprocessor);\n        postprocessor.initialize(this.__gl);\n    }\n    removePostProcessor(postprocessor) {\n        const index = this._postprocessors.indexOf(postprocessor);\n        if (index !== -1) {\n            this._postprocessors.splice(index, 1);\n        }\n    }\n    clearPostProcessors() {\n        this._postprocessors.length = 0;\n    }\n    updatePostProcessors(delta) {\n        for (const postprocessor of this._postprocessors) {\n            const shader = postprocessor.getShader();\n            shader.use();\n            const uniforms = shader.getUniforms();\n            this._totalPostProcessorTime += delta;\n            if (uniforms.find(u => u.name === 'u_time_ms')) {\n                shader.setUniformFloat('u_time_ms', this._totalPostProcessorTime);\n            }\n            if (uniforms.find(u => u.name === 'u_elapsed_ms')) {\n                shader.setUniformFloat('u_elapsed_ms', delta);\n            }\n            if (uniforms.find(u => u.name === 'u_resolution')) {\n                shader.setUniformFloatVector('u_resolution', vec(this.width, this.height));\n            }\n            if (postprocessor.onUpdate) {\n                postprocessor.onUpdate(delta);\n            }\n        }\n    }\n    set material(material) {\n        this._state.current.material = material;\n    }\n    get material() {\n        return this._state.current.material;\n    }\n    /**\n     * Creates and initializes the material which compiles the internal shader\n     * @param options\n     * @returns Material\n     */\n    createMaterial(options) {\n        const material = new Material({ ...options, graphicsContext: this });\n        return material;\n    }\n    createShader(options) {\n        const gl = this.__gl;\n        const { vertexSource, fragmentSource } = options;\n        const shader = new Shader({\n            gl,\n            vertexSource,\n            fragmentSource\n        });\n        shader.compile();\n        return shader;\n    }\n    clear() {\n        const gl = this.__gl;\n        const currentTarget = this.multiSampleAntialiasing ? this._msaaTarget : this._renderTarget;\n        currentTarget.use();\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\n        // Clear the context with the newly set color. This is\n        // the function call that actually does the drawing.\n        gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n    /**\n     * Flushes all batched rendering to the screen\n     */\n    flush() {\n        if (this._isContextLost) {\n            this._logger.errorOnce(`Unable to flush the webgl context is lost`);\n            return;\n        }\n        // render target captures all draws and redirects to the render target\n        let currentTarget = this.multiSampleAntialiasing ? this._msaaTarget : this._renderTarget;\n        currentTarget.use();\n        if (this.useDrawSorting) {\n            // null out unused draw calls\n            for (let i = this._drawCallIndex; i < this._drawCalls.length; i++) {\n                this._drawCalls[i] = null;\n            }\n            // sort draw calls\n            // Find the original order of the first instance of the draw call\n            const originalSort = new Map();\n            for (const [name] of this._renderers) {\n                let firstIndex = 0;\n                for (firstIndex = 0; firstIndex < this._drawCallIndex; firstIndex++) {\n                    if (this._drawCalls[firstIndex].renderer === name) {\n                        break;\n                    }\n                }\n                originalSort.set(name, firstIndex);\n            }\n            this._drawCalls.sort((a, b) => {\n                if (a === null || b === null) {\n                    return 0;\n                }\n                const zIndex = a.z - b.z;\n                const originalSortOrder = originalSort.get(a.renderer) - originalSort.get(b.renderer);\n                const priority = a.priority - b.priority;\n                if (zIndex === 0) { // sort by z first\n                    if (priority === 0) { // sort by priority\n                        return originalSortOrder; // use the original order to inform draw call packing to maximally preserve painter order\n                    }\n                    return priority;\n                }\n                return zIndex;\n            });\n            const oldTransform = this._transform.current;\n            const oldState = this._state.current;\n            if (this._drawCalls.length && this._drawCallIndex) {\n                let currentRendererName = this._drawCalls[0].renderer;\n                let currentRenderer = this._renderers.get(currentRendererName);\n                for (let i = 0; i < this._drawCallIndex; i++) {\n                    // hydrate the state for renderers\n                    this._transform.current = this._drawCalls[i].transform;\n                    this._state.current = this._drawCalls[i].state;\n                    if (this._drawCalls[i].renderer !== currentRendererName) {\n                        // switching graphics renderer means we must flush the previous\n                        currentRenderer.flush();\n                        currentRendererName = this._drawCalls[i].renderer;\n                        currentRenderer = this._renderers.get(currentRendererName);\n                    }\n                    // ! hack to grab screen texture before materials run because they might want it\n                    if (currentRenderer instanceof MaterialRenderer && this.material.isUsingScreenTexture) {\n                        currentTarget.copyToTexture(this.materialScreenTexture);\n                        currentTarget.use();\n                    }\n                    // If we are still using the same renderer we can add to the current batch\n                    currentRenderer.draw(...this._drawCalls[i].args);\n                }\n                if (currentRenderer.hasPendingDraws()) {\n                    currentRenderer.flush();\n                }\n            }\n            // reset state\n            this._transform.current = oldTransform;\n            this._state.current = oldState;\n            // reclaim draw calls\n            this._drawCallPool.done();\n            this._drawCallIndex = 0;\n            this._imageToHeight.clear();\n            this._imageToWidth.clear();\n        }\n        else {\n            // This is the final flush at the moment to draw any leftover pending draw\n            for (const renderer of this._renderers.values()) {\n                if (renderer.hasPendingDraws()) {\n                    renderer.flush();\n                }\n            }\n        }\n        currentTarget.disable();\n        // post process step\n        if (this._postprocessors.length > 0) {\n            const source = currentTarget.toRenderSource();\n            source.use();\n        }\n        // flip flop render targets for post processing\n        for (let i = 0; i < this._postprocessors.length; i++) {\n            currentTarget = this._postProcessTargets[i % 2];\n            this._postProcessTargets[i % 2].use();\n            this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]);\n            this._postProcessTargets[i % 2].toRenderSource().use();\n        }\n        // Final blit to the screen\n        currentTarget.blitToScreen();\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContext2DCanvas.ts\n\n\n\n\nconst ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon = 0.0001;\nclass ExcaliburGraphicsContext2DCanvasDebug {\n    constructor(_ex) {\n        this._ex = _ex;\n        this._debugText = new DebugText();\n    }\n    /**\n     * Draw a debug rectangle to the context\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     */\n    drawRect(x, y, width, height) {\n        this._ex.__ctx.save();\n        this._ex.__ctx.strokeStyle = 'red';\n        this._ex.__ctx.strokeRect(this._ex.snapToPixel ? ~~(x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : x, this._ex.snapToPixel ? ~~(y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : y, this._ex.snapToPixel ? ~~(width + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : width, this._ex.snapToPixel ? ~~(height + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : height);\n        this._ex.__ctx.restore();\n    }\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\n        this._ex.__ctx.save();\n        this._ex.__ctx.beginPath();\n        this._ex.__ctx.strokeStyle = lineOptions.color.toString();\n        this._ex.__ctx.moveTo(this._ex.snapToPixel ? ~~(start.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.x, this._ex.snapToPixel ? ~~(start.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.y);\n        this._ex.__ctx.lineTo(this._ex.snapToPixel ? ~~(end.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.x, this._ex.snapToPixel ? ~~(end.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.y);\n        this._ex.__ctx.lineWidth = 2;\n        this._ex.__ctx.stroke();\n        this._ex.__ctx.closePath();\n        this._ex.__ctx.restore();\n    }\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\n        this._ex.__ctx.save();\n        this._ex.__ctx.beginPath();\n        this._ex.__ctx.fillStyle = pointOptions.color.toString();\n        this._ex.__ctx.arc(this._ex.snapToPixel ? ~~(point.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : point.x, this._ex.snapToPixel ? ~~(point.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : point.y, pointOptions.size, 0, Math.PI * 2);\n        this._ex.__ctx.fill();\n        this._ex.__ctx.closePath();\n        this._ex.__ctx.restore();\n    }\n    drawText(text, pos) {\n        this._debugText.write(this._ex, text, pos);\n    }\n}\nclass ExcaliburGraphicsContext2DCanvas {\n    get width() {\n        return this.__ctx.canvas.width;\n    }\n    get height() {\n        return this.__ctx.canvas.height;\n    }\n    get opacity() {\n        return this._state.current.opacity;\n    }\n    set opacity(value) {\n        this._state.current.opacity = value;\n    }\n    get tint() {\n        return this._state.current.tint;\n    }\n    set tint(color) {\n        this._state.current.tint = color;\n    }\n    get smoothing() {\n        return this.__ctx.imageSmoothingEnabled;\n    }\n    set smoothing(value) {\n        this.__ctx.imageSmoothingEnabled = value;\n    }\n    constructor(options) {\n        /**\n         * Unused in Canvas implementation\n         */\n        this.useDrawSorting = false;\n        /**\n         * Unused in Canvas implementation\n         */\n        this.z = 0;\n        this.backgroundColor = Color.ExcaliburBlue;\n        this._state = new StateStack();\n        this.snapToPixel = false;\n        this.debug = new ExcaliburGraphicsContext2DCanvasDebug(this);\n        const { canvasElement, context, enableTransparency, snapToPixel, antialiasing: smoothing, backgroundColor } = options;\n        this.__ctx = context !== null && context !== void 0 ? context : canvasElement.getContext('2d', {\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true\n        });\n        if (!this.__ctx) {\n            throw new Error('Cannot build new ExcaliburGraphicsContext2D for some reason!');\n        }\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\n    }\n    resetTransform() {\n        this.__ctx.resetTransform();\n    }\n    updateViewport(_resolution) {\n        // pass\n    }\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\n        if (swidth === 0 || sheight === 0) {\n            return; // zero dimension dest exit early\n        }\n        else if (dwidth === 0 || dheight === 0) {\n            return; // zero dimension dest exit early\n        }\n        else if (image.width === 0 || image.height === 0) {\n            return; // zero dimension source exit early\n        }\n        this.__ctx.globalAlpha = this.opacity;\n        const args = [image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight]\n            .filter((a) => a !== undefined)\n            .map((a) => (typeof a === 'number' && this.snapToPixel ? ~~a : a));\n        this.__ctx.drawImage.apply(this.__ctx, args);\n        GraphicsDiagnostics.DrawCallCount++;\n        GraphicsDiagnostics.DrawnImagesCount = 1;\n    }\n    drawLine(start, end, color, thickness = 1) {\n        this.__ctx.save();\n        this.__ctx.beginPath();\n        this.__ctx.strokeStyle = color.toString();\n        this.__ctx.moveTo(this.snapToPixel ? ~~(start.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.x, this.snapToPixel ? ~~(start.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.y);\n        this.__ctx.lineTo(this.snapToPixel ? ~~(end.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.x, this.snapToPixel ? ~~(end.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.y);\n        this.__ctx.lineWidth = thickness;\n        this.__ctx.stroke();\n        this.__ctx.closePath();\n        this.__ctx.restore();\n    }\n    drawRectangle(pos, width, height, color) {\n        this.__ctx.save();\n        this.__ctx.fillStyle = color.toString();\n        this.__ctx.fillRect(this.snapToPixel ? ~~(pos.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.x, this.snapToPixel ? ~~(pos.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.y, this.snapToPixel ? ~~(width + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : width, this.snapToPixel ? ~~(height + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : height);\n        this.__ctx.restore();\n    }\n    drawCircle(pos, radius, color, stroke, thickness) {\n        this.__ctx.save();\n        this.__ctx.beginPath();\n        if (stroke) {\n            this.__ctx.strokeStyle = stroke.toString();\n        }\n        if (thickness) {\n            this.__ctx.lineWidth = thickness;\n        }\n        this.__ctx.fillStyle = color.toString();\n        this.__ctx.arc(this.snapToPixel ? ~~(pos.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.x, this.snapToPixel ? ~~(pos.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.y, radius, 0, Math.PI * 2);\n        this.__ctx.fill();\n        if (stroke) {\n            this.__ctx.stroke();\n        }\n        this.__ctx.closePath();\n        this.__ctx.restore();\n    }\n    /**\n     * Save the current state of the canvas to the stack (transforms and opacity)\n     */\n    save() {\n        this.__ctx.save();\n        this._state.save();\n    }\n    /**\n     * Restore the state of the canvas from the stack\n     */\n    restore() {\n        this.__ctx.restore();\n        this._state.restore();\n    }\n    /**\n     * Translate the origin of the context by an x and y\n     * @param x\n     * @param y\n     */\n    translate(x, y) {\n        this.__ctx.translate(this.snapToPixel ? ~~(x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : x, this.snapToPixel ? ~~(y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : y);\n    }\n    /**\n     * Rotate the context about the current origin\n     */\n    rotate(angle) {\n        this.__ctx.rotate(angle);\n    }\n    /**\n     * Scale the context by an x and y factor\n     * @param x\n     * @param y\n     */\n    scale(x, y) {\n        this.__ctx.scale(x, y);\n    }\n    getTransform() {\n        throw new Error('Not implemented');\n    }\n    multiply(_m) {\n        this.__ctx.setTransform(this.__ctx.getTransform().multiply(_m.toDOMMatrix()));\n    }\n    addPostProcessor(_postprocessor) {\n        // pass\n    }\n    removePostProcessor(_postprocessor) {\n        // pass\n    }\n    clearPostProcessors() {\n        // pass\n    }\n    updatePostProcessors(delta) {\n        // pass\n    }\n    beginDrawLifecycle() {\n        // pass\n    }\n    endDrawLifecycle() {\n        // pass\n    }\n    set material(material) {\n        this._state.current.material = material;\n    }\n    get material() {\n        return this._state.current.material;\n    }\n    createMaterial(options) {\n        // pass\n        return null;\n    }\n    clear() {\n        // Clear frame\n        this.__ctx.clearRect(0, 0, this.width, this.height);\n        this.__ctx.fillStyle = this.backgroundColor.toString();\n        this.__ctx.fillRect(0, 0, this.width, this.height);\n        GraphicsDiagnostics.clear();\n    }\n    /**\n     * Flushes the batched draw calls to the screen\n     */\n    flush() {\n        // pass\n    }\n    dispose() {\n        this.__ctx = null;\n    }\n}\n\n;// CONCATENATED MODULE: ./Screen.ts\n\n\n\n\n\n\n\n/**\n * Enum representing the different display modes available to Excalibur.\n */\nvar DisplayMode;\n(function (DisplayMode) {\n    /**\n     * Default, use a specified resolution for the game. Like 800x600 pixels for example.\n     */\n    DisplayMode[\"Fixed\"] = \"Fixed\";\n    /**\n     * Fit the aspect ratio given by the game resolution within the container at all times will fill any gaps with canvas.\n     * The displayed area outside the aspect ratio is not guaranteed to be on the screen, only the [[Screen.contentArea]]\n     * is guaranteed to be on screen.\n     */\n    DisplayMode[\"FitContainerAndFill\"] = \"FitContainerAndFill\";\n    /**\n     * Fit the aspect ratio given by the game resolution the screen at all times will fill the screen.\n     * This displayed area outside the aspect ratio is not guaranteed to be on the screen, only the [[Screen.contentArea]]\n     * is guaranteed to be on screen.\n     */\n    DisplayMode[\"FitScreenAndFill\"] = \"FitScreenAndFill\";\n    /**\n     * Fit the viewport to the parent element maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars\n     * (letterbox) that would otherwise be present in [[FitContainer]].\n     *\n     * **warning** This will clip some drawable area from the user because of the zoom,\n     * use [[Screen.contentArea]] to know the safe to draw area.\n     */\n    DisplayMode[\"FitContainerAndZoom\"] = \"FitContainerAndZoom\";\n    /**\n     * Fit the viewport to the device screen maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars\n     * (letterbox) that would otherwise be present in [[FitScreen]].\n     *\n     * **warning** This will clip some drawable area from the user because of the zoom,\n     * use [[Screen.contentArea]] to know the safe to draw area.\n     */\n    DisplayMode[\"FitScreenAndZoom\"] = \"FitScreenAndZoom\";\n    /**\n     * Fit to screen using as much space as possible while maintaining aspect ratio and resolution.\n     * This is not the same as [[Screen.goFullScreen]] but behaves in a similar way maintaining aspect ratio.\n     *\n     * You may want to center your game here is an example\n     * ```html\n     * <!-- html -->\n     * <body>\n     * <main>\n     *   <canvas id=\"game\"></canvas>\n     * </main>\n     * </body>\n     * ```\n     *\n     * ```css\n     * // css\n     * main {\n     *   display: flex;\n     *   align-items: center;\n     *   justify-content: center;\n     *   height: 100%;\n     *   width: 100%;\n     * }\n     * ```\n     */\n    DisplayMode[\"FitScreen\"] = \"FitScreen\";\n    /**\n     * Fill the entire screen's css width/height for the game resolution dynamically. This means the resolution of the game will\n     * change dynamically as the window is resized. This is not the same as [[Screen.goFullScreen]]\n     */\n    DisplayMode[\"FillScreen\"] = \"FillScreen\";\n    /**\n     * Fit to parent element width/height using as much space as possible while maintaining aspect ratio and resolution.\n     */\n    DisplayMode[\"FitContainer\"] = \"FitContainer\";\n    /**\n     * Use the parent DOM container's css width/height for the game resolution dynamically\n     */\n    DisplayMode[\"FillContainer\"] = \"FillContainer\";\n})(DisplayMode || (DisplayMode = {}));\n/**\n * Convenience class for quick resolutions\n * Mostly sourced from https://emulation.gametechwiki.com/index.php/Resolution\n */\nclass Resolution {\n    /* istanbul ignore next */\n    static get SVGA() {\n        return { width: 800, height: 600 };\n    }\n    /* istanbul ignore next */\n    static get Standard() {\n        return { width: 1920, height: 1080 };\n    }\n    /* istanbul ignore next */\n    static get Atari2600() {\n        return { width: 160, height: 192 };\n    }\n    /* istanbul ignore next */\n    static get GameBoy() {\n        return { width: 160, height: 144 };\n    }\n    /* istanbul ignore next */\n    static get GameBoyAdvance() {\n        return { width: 240, height: 160 };\n    }\n    /* istanbul ignore next */\n    static get NintendoDS() {\n        return { width: 256, height: 192 };\n    }\n    /* istanbul ignore next */\n    static get NES() {\n        return { width: 256, height: 224 };\n    }\n    /* istanbul ignore next */\n    static get SNES() {\n        return { width: 256, height: 244 };\n    }\n}\nconst ScreenEvents = {\n    ScreenResize: 'resize',\n    PixelRatioChange: 'pixelratio',\n    FullScreenChange: 'fullscreen'\n};\n/**\n * The Screen handles all aspects of interacting with the screen for Excalibur.\n */\nclass Screen {\n    constructor(options) {\n        var _a, _b, _c, _d;\n        /**\n         * Listen to screen events [[ScreenEvents]]\n         */\n        this.events = new EventEmitter();\n        this._antialiasing = true;\n        this._canvasImageRendering = 'auto';\n        this._resolutionStack = [];\n        this._viewportStack = [];\n        this._pixelRatioOverride = null;\n        this._isFullScreen = false;\n        this._isDisposed = false;\n        this._logger = Logger.getInstance();\n        this._fullscreenChangeHandler = () => {\n            if (this._isDisposed) {\n                return;\n            }\n            this._isFullScreen = !this._isFullScreen;\n            this._logger.debug('Fullscreen Change', this._isFullScreen);\n            this.events.emit('fullscreen', {\n                fullscreen: this.isFullScreen\n            });\n        };\n        this._pixelRatioChangeHandler = () => {\n            if (this._isDisposed) {\n                return;\n            }\n            this._logger.debug('Pixel Ratio Change', window.devicePixelRatio);\n            this._listenForPixelRatio();\n            this._devicePixelRatio = this._calculateDevicePixelRatio();\n            this.applyResolutionAndViewport();\n            this.events.emit('pixelratio', {\n                pixelRatio: this.pixelRatio\n            });\n        };\n        this._resizeHandler = () => {\n            if (this._isDisposed) {\n                return;\n            }\n            const parent = this.parent;\n            this._logger.debug('View port resized');\n            this._setResolutionAndViewportByDisplayMode(parent);\n            this.applyResolutionAndViewport();\n            // Emit resize event\n            this.events.emit('resize', {\n                resolution: this.resolution,\n                viewport: this.viewport\n            });\n        };\n        // Asking the window.devicePixelRatio is expensive we do it once\n        this._devicePixelRatio = this._calculateDevicePixelRatio();\n        this._contentArea = new BoundingBox();\n        this._unsafeArea = new BoundingBox();\n        this.viewport = options.viewport;\n        this.resolution = (_a = options.resolution) !== null && _a !== void 0 ? _a : { ...this.viewport };\n        this._contentResolution = this.resolution;\n        this._displayMode = (_b = options.displayMode) !== null && _b !== void 0 ? _b : DisplayMode.Fixed;\n        this._canvas = options.canvas;\n        this.graphicsContext = options.context;\n        this._antialiasing = (_c = options.antialiasing) !== null && _c !== void 0 ? _c : this._antialiasing;\n        this._canvasImageRendering = (_d = options.canvasImageRendering) !== null && _d !== void 0 ? _d : this._canvasImageRendering;\n        this._browser = options.browser;\n        this._pixelRatioOverride = options.pixelRatio;\n        this._applyDisplayMode();\n        this._listenForPixelRatio();\n        this._canvas.addEventListener('fullscreenchange', this._fullscreenChangeHandler);\n        this.applyResolutionAndViewport();\n    }\n    _listenForPixelRatio() {\n        if (this._mediaQueryList && !this._mediaQueryList.addEventListener) {\n            // Safari <=13.1 workaround, remove any existing handlers\n            this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\n        }\n        this._mediaQueryList = this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);\n        // Safari <=13.1 workaround\n        if (this._mediaQueryList.addEventListener) {\n            this._mediaQueryList.addEventListener('change', this._pixelRatioChangeHandler, { once: true });\n        }\n        else {\n            this._mediaQueryList.addListener(this._pixelRatioChangeHandler);\n        }\n    }\n    dispose() {\n        if (!this._isDisposed) {\n            // Clean up handlers\n            this._isDisposed = true;\n            this.events.clear();\n            this._browser.window.off('resize', this._resizeHandler);\n            this._browser.window.clear();\n            if (this._resizeObserver) {\n                this._resizeObserver.disconnect();\n            }\n            this.parent.removeEventListener('resize', this._resizeHandler);\n            // Safari <=13.1 workaround\n            if (this._mediaQueryList.removeEventListener) {\n                this._mediaQueryList.removeEventListener('change', this._pixelRatioChangeHandler);\n            }\n            else {\n                this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\n            }\n            this._canvas.removeEventListener('fullscreenchange', this._fullscreenChangeHandler);\n            this._canvas = null;\n        }\n    }\n    _calculateDevicePixelRatio() {\n        if (window.devicePixelRatio < 1) {\n            return 1;\n        }\n        const devicePixelRatio = window.devicePixelRatio || 1;\n        return devicePixelRatio;\n    }\n    /**\n     * Returns the computed pixel ratio, first using any override, then the device pixel ratio\n     */\n    get pixelRatio() {\n        if (this._pixelRatioOverride) {\n            return this._pixelRatioOverride;\n        }\n        return this._devicePixelRatio;\n    }\n    /**\n     * Get or set the pixel ratio override\n     *\n     * You will need to call applyResolutionAndViewport() affect change on the screen\n     */\n    get pixelRatioOverride() {\n        return this._pixelRatioOverride;\n    }\n    set pixelRatioOverride(value) {\n        this._pixelRatioOverride = value;\n    }\n    get isHiDpi() {\n        return this.pixelRatio !== 1;\n    }\n    get displayMode() {\n        return this._displayMode;\n    }\n    get canvas() {\n        return this._canvas;\n    }\n    get parent() {\n        switch (this.displayMode) {\n            case DisplayMode.FillContainer:\n            case DisplayMode.FitContainer:\n            case DisplayMode.FitContainerAndFill:\n            case DisplayMode.FitContainerAndZoom:\n                return this.canvas.parentElement || document.body;\n            default:\n                return window;\n        }\n    }\n    get resolution() {\n        return this._resolution;\n    }\n    set resolution(resolution) {\n        this._resolution = resolution;\n    }\n    /**\n     * Returns screen dimensions in pixels or percentage\n     */\n    get viewport() {\n        if (this._viewport) {\n            return this._viewport;\n        }\n        return this._resolution;\n    }\n    set viewport(viewport) {\n        this._viewport = viewport;\n    }\n    get aspectRatio() {\n        return this._resolution.width / this._resolution.height;\n    }\n    get scaledWidth() {\n        return this._resolution.width * this.pixelRatio;\n    }\n    get scaledHeight() {\n        return this._resolution.height * this.pixelRatio;\n    }\n    setCurrentCamera(camera) {\n        this._camera = camera;\n    }\n    pushResolutionAndViewport() {\n        this._resolutionStack.push(this.resolution);\n        this._viewportStack.push(this.viewport);\n        this.resolution = { ...this.resolution };\n        this.viewport = { ...this.viewport };\n    }\n    peekViewport() {\n        return this._viewportStack[this._viewportStack.length - 1];\n    }\n    peekResolution() {\n        return this._resolutionStack[this._resolutionStack.length - 1];\n    }\n    popResolutionAndViewport() {\n        if (this._resolutionStack.length && this._viewportStack.length) {\n            this.resolution = this._resolutionStack.pop();\n            this.viewport = this._viewportStack.pop();\n        }\n    }\n    applyResolutionAndViewport() {\n        if (this.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\n            const scaledResolutionSupported = this.graphicsContext.checkIfResolutionSupported({\n                width: this.scaledWidth,\n                height: this.scaledHeight\n            });\n            if (!scaledResolutionSupported) {\n                this._logger.warnOnce(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio})` +\n                    ' are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly.' +\n                    ' Try reducing the resolution or disabling Hi DPI scaling to avoid this' +\n                    ' (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).');\n                // Attempt to recover if the user hasn't configured a specific ratio for up scaling\n                if (!this.pixelRatioOverride) {\n                    let currentPixelRatio = Math.max(1, this.pixelRatio - .5);\n                    let newResolutionSupported = false;\n                    while (currentPixelRatio > 1 && !newResolutionSupported) {\n                        currentPixelRatio = Math.max(1, currentPixelRatio - .5);\n                        const width = this._resolution.width * currentPixelRatio;\n                        const height = this._resolution.height * currentPixelRatio;\n                        newResolutionSupported = this.graphicsContext.checkIfResolutionSupported({ width, height });\n                    }\n                    this.pixelRatioOverride = currentPixelRatio;\n                    this._logger.warnOnce('Scaled resolution too big attempted recovery!' +\n                        ` Pixel ratio was automatically reduced to (${this.pixelRatio}) to avoid 4k texture limit.` +\n                        ' Setting `ex.Engine({pixelRatio: ...}) will override any automatic recalculation, do so at your own risk.` ' +\n                        ' (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).');\n                }\n            }\n        }\n        this._canvas.width = this.scaledWidth;\n        this._canvas.height = this.scaledHeight;\n        if (this._canvasImageRendering === 'auto') {\n            this._canvas.style.imageRendering = 'auto';\n        }\n        else {\n            this._canvas.style.imageRendering = 'pixelated';\n            // Fall back to 'crisp-edges' if 'pixelated' is not supported\n            // Currently for firefox https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering\n            if (this._canvas.style.imageRendering === '') {\n                this._canvas.style.imageRendering = 'crisp-edges';\n            }\n        }\n        const widthUnit = this.viewport.widthUnit === 'percent' ? '%' : 'px';\n        const heightUnit = this.viewport.heightUnit === 'percent' ? '%' : 'px';\n        this._canvas.style.width = this.viewport.width + widthUnit;\n        this._canvas.style.height = this.viewport.height + heightUnit;\n        // After messing with the canvas width/height the graphics context is invalidated and needs to have some properties reset\n        this.graphicsContext.updateViewport(this.resolution);\n        this.graphicsContext.resetTransform();\n        this.graphicsContext.smoothing = this._antialiasing;\n        if (this.graphicsContext instanceof ExcaliburGraphicsContext2DCanvas) {\n            this.graphicsContext.scale(this.pixelRatio, this.pixelRatio);\n        }\n    }\n    get antialiasing() {\n        return this._antialiasing;\n    }\n    set antialiasing(isSmooth) {\n        this._antialiasing = isSmooth;\n        this.graphicsContext.smoothing = this._antialiasing;\n    }\n    /**\n     * Returns true if excalibur is fullscreen using the browser fullscreen api\n     */\n    get isFullScreen() {\n        return this._isFullScreen;\n    }\n    /**\n     * Requests to go fullscreen using the browser fullscreen api, requires user interaction to be successful.\n     * For example, wire this to a user click handler.\n     *\n     * Optionally specify a target element id to go fullscreen, by default the game canvas is used\n     * @param elementId\n     */\n    goFullScreen(elementId) {\n        if (elementId) {\n            const maybeElement = document.getElementById(elementId);\n            if (maybeElement) {\n                if (!maybeElement.getAttribute('ex-fullscreen-listener')) {\n                    maybeElement.setAttribute('ex-fullscreen-listener', 'true');\n                    maybeElement.addEventListener('fullscreenchange', this._fullscreenChangeHandler);\n                }\n                const fullscreenPromise = maybeElement.requestFullscreen();\n                return fullscreenPromise;\n            }\n        }\n        return this._canvas.requestFullscreen();\n    }\n    /**\n     * Requests to exit fullscreen using the browser fullscreen api\n     */\n    exitFullScreen() {\n        return document.exitFullscreen();\n    }\n    _viewportToPixels(viewport) {\n        return {\n            width: viewport.widthUnit === 'percent' ? this.canvas.offsetWidth : viewport.width,\n            height: viewport.heightUnit === 'percent' ? this.canvas.offsetHeight : viewport.height\n        };\n    }\n    /**\n     * Takes a coordinate in normal html page space, for example from a pointer move event, and translates it to\n     * Excalibur screen space.\n     *\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\n     * bottom right corner (resolutionX, resolutionY). When using *AndFill suffixed display modes screen space\n     * (0, 0) is the top left of the safe content area bounding box not the viewport.\n     * @param point\n     */\n    pageToScreenCoordinates(point) {\n        let newX = point.x;\n        let newY = point.y;\n        if (!this._isFullScreen) {\n            newX -= getPosition(this._canvas).x;\n            newY -= getPosition(this._canvas).y;\n        }\n        const viewport = this._viewportToPixels(this.viewport);\n        // if fullscreen api on it centers with black bars\n        // we need to adjust the screen to world coordinates in this case\n        if (this._isFullScreen) {\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\n                const screenHeight = window.innerWidth / this.aspectRatio;\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\n                newY = ((newY - screenMarginY) / screenHeight) * viewport.height;\n                newX = (newX / window.innerWidth) * viewport.width;\n            }\n            else {\n                const screenWidth = window.innerHeight * this.aspectRatio;\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\n                newX = ((newX - screenMarginX) / screenWidth) * viewport.width;\n                newY = (newY / window.innerHeight) * viewport.height;\n            }\n        }\n        newX = (newX / viewport.width) * this.resolution.width;\n        newY = (newY / viewport.height) * this.resolution.height;\n        // offset by content area\n        newX = newX - this.contentArea.left;\n        newY = newY - this.contentArea.top;\n        return new Vector(newX, newY);\n    }\n    /**\n     * Takes a coordinate in Excalibur screen space, and translates it to normal html page space. For example,\n     * this is where html elements might live if you want to position them relative to Excalibur.\n     *\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\n     * bottom right corner (resolutionX, resolutionY)\n     * @param point\n     */\n    screenToPageCoordinates(point) {\n        let newX = point.x;\n        let newY = point.y;\n        // no need to offset by content area, drawing is already offset by this\n        const viewport = this._viewportToPixels(this.viewport);\n        newX = (newX / this.resolution.width) * viewport.width;\n        newY = (newY / this.resolution.height) * viewport.height;\n        if (this._isFullScreen) {\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\n                const screenHeight = window.innerWidth / this.aspectRatio;\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\n                newY = (newY / viewport.height) * screenHeight + screenMarginY;\n                newX = (newX / viewport.width) * window.innerWidth;\n            }\n            else {\n                const screenWidth = window.innerHeight * this.aspectRatio;\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\n                newX = (newX / viewport.width) * screenWidth + screenMarginX;\n                newY = (newY / viewport.height) * window.innerHeight;\n            }\n        }\n        if (!this._isFullScreen) {\n            newX += getPosition(this._canvas).x;\n            newY += getPosition(this._canvas).y;\n        }\n        return new Vector(newX, newY);\n    }\n    /**\n     * Takes a coordinate in Excalibur screen space, and translates it to Excalibur world space.\n     *\n     * World space is where [[Entity|entities]] in Excalibur live by default [[CoordPlane.World]]\n     * and extends infinitely out relative from the [[Camera]].\n     * @param point  Screen coordinate to convert\n     */\n    screenToWorldCoordinates(point) {\n        // offset by content area\n        point = point.add(vec(this.contentArea.left, this.contentArea.top));\n        // the only difference between screen & world is the camera transform\n        if (this._camera) {\n            return this._camera.inverse.multiply(point);\n        }\n        return point.sub(vec(this.resolution.width / 2, this.resolution.height / 2));\n    }\n    /**\n     * Takes a coordinate in Excalibur world space, and translates it to Excalibur screen space.\n     *\n     * Screen space is where [[ScreenElement|screen elements]] and [[Entity|entities]] with [[CoordPlane.Screen]] live.\n     * @param point  World coordinate to convert\n     */\n    worldToScreenCoordinates(point) {\n        if (this._camera) {\n            return this._camera.transform.multiply(point);\n        }\n        return point.add(vec(this.resolution.width / 2, this.resolution.height / 2));\n    }\n    pageToWorldCoordinates(point) {\n        const screen = this.pageToScreenCoordinates(point);\n        return this.screenToWorldCoordinates(screen);\n    }\n    worldToPageCoordinates(point) {\n        const screen = this.worldToScreenCoordinates(point);\n        return this.screenToPageCoordinates(screen);\n    }\n    /**\n     * Returns a BoundingBox of the top left corner of the screen\n     * and the bottom right corner of the screen.\n     *\n     * World bounds are in world coordinates, useful for culling objects offscreen that are in world space\n     */\n    getWorldBounds() {\n        const bounds = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Half)\n            .scale(vec(1 / this._camera.zoom, 1 / this._camera.zoom))\n            .rotate(this._camera.rotation)\n            .translate(this._camera.drawPos);\n        return bounds;\n    }\n    /**\n     * Returns a BoundingBox of the top left corner of the screen and the bottom right corner of the screen.\n     *\n     * Screen bounds are in screen coordinates, useful for culling objects offscreen that are in screen space\n     */\n    getScreenBounds() {\n        const bounds = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero, Vector.Zero);\n        return bounds;\n    }\n    /**\n     * The width of the game canvas in pixels (physical width component of the\n     * resolution of the canvas element)\n     */\n    get canvasWidth() {\n        return this.canvas.width;\n    }\n    /**\n     * Returns half width of the game canvas in pixels (half physical width component)\n     */\n    get halfCanvasWidth() {\n        return this.canvas.width / 2;\n    }\n    /**\n     * The height of the game canvas in pixels, (physical height component of\n     * the resolution of the canvas element)\n     */\n    get canvasHeight() {\n        return this.canvas.height;\n    }\n    /**\n     * Returns half height of the game canvas in pixels (half physical height component)\n     */\n    get halfCanvasHeight() {\n        return this.canvas.height / 2;\n    }\n    /**\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get drawWidth() {\n        if (this._camera) {\n            return this.resolution.width / this._camera.zoom;\n        }\n        return this.resolution.width;\n    }\n    /**\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get halfDrawWidth() {\n        return this.drawWidth / 2;\n    }\n    /**\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get drawHeight() {\n        if (this._camera) {\n            return this.resolution.height / this._camera.zoom;\n        }\n        return this.resolution.height;\n    }\n    /**\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get halfDrawHeight() {\n        return this.drawHeight / 2;\n    }\n    /**\n     * Returns screen center coordinates including zoom and device pixel ratio.\n     */\n    get center() {\n        return vec(this.halfDrawWidth, this.halfDrawHeight);\n    }\n    /**\n     * Returns the content area in screen space where it is safe to place content\n     */\n    get contentArea() {\n        return this._contentArea;\n    }\n    /**\n     * Returns the unsafe area in screen space, this is the full screen and some space may not be onscreen.\n     */\n    get unsafeArea() {\n        return this._unsafeArea;\n    }\n    _computeFit() {\n        document.body.style.margin = '0px';\n        document.body.style.overflow = 'hidden';\n        const aspect = this.aspectRatio;\n        let adjustedWidth = 0;\n        let adjustedHeight = 0;\n        if (window.innerWidth / aspect < window.innerHeight) {\n            adjustedWidth = window.innerWidth;\n            adjustedHeight = window.innerWidth / aspect;\n        }\n        else {\n            adjustedWidth = window.innerHeight * aspect;\n            adjustedHeight = window.innerHeight;\n        }\n        this.viewport = {\n            width: adjustedWidth,\n            height: adjustedHeight\n        };\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\n        this._unsafeArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\n        this.events.emit('resize', {\n            resolution: this.resolution,\n            viewport: this.viewport\n        });\n    }\n    _computeFitScreenAndFill() {\n        document.body.style.margin = '0px';\n        document.body.style.overflow = 'hidden';\n        const vw = window.innerWidth;\n        const vh = window.innerHeight;\n        this._computeFitAndFill(vw, vh);\n        this.events.emit('resize', {\n            resolution: this.resolution,\n            viewport: this.viewport\n        });\n    }\n    _computeFitContainerAndFill() {\n        this.canvas.style.width = '100%';\n        this.canvas.style.height = '100%';\n        this._computeFitAndFill(this.canvas.offsetWidth, this.canvas.offsetHeight, {\n            width: 100,\n            widthUnit: 'percent',\n            height: 100,\n            heightUnit: 'percent'\n        });\n        this.events.emit('resize', {\n            resolution: this.resolution,\n            viewport: this.viewport\n        });\n    }\n    _computeFitAndFill(vw, vh, viewport) {\n        this.viewport = viewport !== null && viewport !== void 0 ? viewport : {\n            width: vw,\n            height: vh\n        };\n        // if the current screen aspectRatio is less than the original aspectRatio\n        if (vw / vh <= this._contentResolution.width / this._contentResolution.height) {\n            // compute new resolution to match the original aspect ratio\n            this.resolution = {\n                width: vw * this._contentResolution.width / vw,\n                height: vw * this._contentResolution.width / vw * vh / vw\n            };\n            const clip = (this.resolution.height - this._contentResolution.height) / 2;\n            this._contentArea = new BoundingBox({\n                top: clip,\n                left: 0,\n                right: this._contentResolution.width,\n                bottom: this.resolution.height - clip\n            });\n            this._unsafeArea = new BoundingBox({\n                top: -clip,\n                left: 0,\n                right: this._contentResolution.width,\n                bottom: this.resolution.height + clip\n            });\n        }\n        else {\n            this.resolution = {\n                width: vh * this._contentResolution.height / vh * vw / vh,\n                height: vh * this._contentResolution.height / vh\n            };\n            const clip = (this.resolution.width - this._contentResolution.width) / 2;\n            this._contentArea = new BoundingBox({\n                top: 0,\n                left: clip,\n                right: this.resolution.width - clip,\n                bottom: this._contentResolution.height\n            });\n            this._unsafeArea = new BoundingBox({\n                top: 0,\n                left: -clip,\n                right: this.resolution.width + clip,\n                bottom: this._contentResolution.height\n            });\n        }\n    }\n    _computeFitScreenAndZoom() {\n        document.body.style.margin = '0px';\n        document.body.style.overflow = 'hidden';\n        this.canvas.style.position = 'absolute';\n        const vw = window.innerWidth;\n        const vh = window.innerHeight;\n        this._computeFitAndZoom(vw, vh);\n        this.events.emit('resize', {\n            resolution: this.resolution,\n            viewport: this.viewport\n        });\n    }\n    _computeFitContainerAndZoom() {\n        this.canvas.style.width = '100%';\n        this.canvas.style.height = '100%';\n        this.canvas.style.position = 'relative';\n        const parent = this.canvas.parentElement;\n        parent.style.overflow = 'hidden';\n        const { offsetWidth: vw, offsetHeight: vh } = this.canvas;\n        this._computeFitAndZoom(vw, vh);\n        this.events.emit('resize', {\n            resolution: this.resolution,\n            viewport: this.viewport\n        });\n    }\n    _computeFitAndZoom(vw, vh) {\n        const aspect = this.aspectRatio;\n        let adjustedWidth = 0;\n        let adjustedHeight = 0;\n        if (vw / aspect < vh) {\n            adjustedWidth = vw;\n            adjustedHeight = vw / aspect;\n        }\n        else {\n            adjustedWidth = vh * aspect;\n            adjustedHeight = vh;\n        }\n        const scaleX = vw / adjustedWidth;\n        const scaleY = vh / adjustedHeight;\n        const maxScaleFactor = Math.max(scaleX, scaleY);\n        const zoomedWidth = adjustedWidth * maxScaleFactor;\n        const zoomedHeight = adjustedHeight * maxScaleFactor;\n        // Center zoomed dimension if bigger than the screen\n        if (zoomedWidth > vw) {\n            this.canvas.style.left = -(zoomedWidth - vw) / 2 + 'px';\n        }\n        else {\n            this.canvas.style.left = '';\n        }\n        if (zoomedHeight > vh) {\n            this.canvas.style.top = -(zoomedHeight - vh) / 2 + 'px';\n        }\n        else {\n            this.canvas.style.top = '';\n        }\n        this.viewport = {\n            width: zoomedWidth,\n            height: zoomedHeight\n        };\n        const bounds = BoundingBox.fromDimension(this.viewport.width, this.viewport.height, Vector.Zero);\n        // return safe area\n        if (this.viewport.width > vw) {\n            const clip = (this.viewport.width - vw) / this.viewport.width * this.resolution.width;\n            bounds.top = 0;\n            bounds.left = clip / 2;\n            bounds.right = this.resolution.width - clip / 2;\n            bounds.bottom = this.resolution.height;\n        }\n        if (this.viewport.height > vh) {\n            const clip = (this.viewport.height - vh) / this.viewport.height * this.resolution.height;\n            bounds.top = clip / 2;\n            bounds.left = 0;\n            bounds.bottom = this.resolution.height - clip / 2;\n            bounds.right = this.resolution.width;\n        }\n        this._contentArea = bounds;\n    }\n    _computeFitContainer() {\n        const aspect = this.aspectRatio;\n        let adjustedWidth = 0;\n        let adjustedHeight = 0;\n        let widthUnit = 'pixel';\n        let heightUnit = 'pixel';\n        const parent = this.canvas.parentElement;\n        if (parent.clientWidth / aspect < parent.clientHeight) {\n            this.canvas.style.width = '100%';\n            adjustedWidth = 100;\n            widthUnit = 'percent';\n            adjustedHeight = this.canvas.offsetWidth / aspect;\n        }\n        else {\n            this.canvas.style.height = '100%';\n            adjustedHeight = 100;\n            heightUnit = 'percent';\n            adjustedWidth = this.canvas.offsetHeight * aspect;\n        }\n        this.viewport = {\n            width: adjustedWidth,\n            widthUnit,\n            height: adjustedHeight,\n            heightUnit\n        };\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\n        this.events.emit('resize', {\n            resolution: this.resolution,\n            viewport: this.viewport\n        });\n    }\n    _applyDisplayMode() {\n        this._setResolutionAndViewportByDisplayMode(this.parent);\n        // watch resizing\n        if (this.parent instanceof Window) {\n            this._browser.window.on('resize', this._resizeHandler);\n        }\n        else {\n            this._resizeObserver = new ResizeObserver(() => {\n                this._resizeHandler();\n            });\n            this._resizeObserver.observe(this.parent);\n        }\n        this.parent.addEventListener('resize', this._resizeHandler);\n    }\n    /**\n     * Sets the resolution and viewport based on the selected display mode.\n     */\n    _setResolutionAndViewportByDisplayMode(parent) {\n        if (this.displayMode === DisplayMode.FillContainer) {\n            this.canvas.style.width = '100%';\n            this.canvas.style.height = '100%';\n            this.viewport = {\n                width: 100,\n                widthUnit: 'percent',\n                height: 100,\n                heightUnit: 'percent'\n            };\n            this.resolution = {\n                width: this.canvas.offsetWidth,\n                height: this.canvas.offsetHeight\n            };\n        }\n        if (this.displayMode === DisplayMode.FillScreen) {\n            document.body.style.margin = '0px';\n            document.body.style.overflow = 'hidden';\n            this.resolution = {\n                width: parent.innerWidth,\n                height: parent.innerHeight\n            };\n            this.viewport = this.resolution;\n        }\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\n        if (this.displayMode === DisplayMode.FitScreen) {\n            this._computeFit();\n        }\n        if (this.displayMode === DisplayMode.FitContainer) {\n            this._computeFitContainer();\n        }\n        if (this.displayMode === DisplayMode.FitScreenAndFill) {\n            this._computeFitScreenAndFill();\n        }\n        if (this.displayMode === DisplayMode.FitContainerAndFill) {\n            this._computeFitContainerAndFill();\n        }\n        if (this.displayMode === DisplayMode.FitScreenAndZoom) {\n            this._computeFitScreenAndZoom();\n        }\n        if (this.displayMode === DisplayMode.FitContainerAndZoom) {\n            this._computeFitContainerAndZoom();\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Resources/Sound/AudioContext.ts\n/**\n * Internal class used to build instances of AudioContext\n */\n/* istanbul ignore next */\nclass AudioContextFactory {\n    static create() {\n        if (!this._INSTANCE) {\n            if (window.AudioContext || window.webkitAudioContext) {\n                this._INSTANCE = new AudioContext();\n            }\n        }\n        return this._INSTANCE;\n    }\n}\nAudioContextFactory._INSTANCE = null;\n\n;// CONCATENATED MODULE: ./Util/WebAudio.ts\n\n\n/**\n * Patch for detecting legacy web audio in browsers\n * @internal\n * @param source\n */\nfunction isLegacyWebAudioSource(source) {\n    return !!source.playbackState;\n}\nclass WebAudio {\n    /**\n     * Play an empty sound to unlock Safari WebAudio context. Call this function\n     * right after a user interaction event.\n     * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n     */\n    static unlock() {\n        const promise = new Promise((resolve, reject) => {\n            if (WebAudio._UNLOCKED || !AudioContextFactory.create()) {\n                return resolve(true);\n            }\n            const unlockTimeoutTimer = setTimeout(() => {\n                Logger.getInstance().warn('Excalibur was unable to unlock the audio context, audio probably will not play in this browser.');\n                resolve(false);\n            }, 200);\n            const audioContext = AudioContextFactory.create();\n            audioContext.resume().then(() => {\n                // create empty buffer and play it\n                const buffer = audioContext.createBuffer(1, 1, 22050);\n                const source = audioContext.createBufferSource();\n                let ended = false;\n                source.buffer = buffer;\n                source.connect(audioContext.destination);\n                source.onended = () => (ended = true);\n                source.start(0);\n                // by checking the play state after some time, we know if we're really unlocked\n                setTimeout(() => {\n                    if (isLegacyWebAudioSource(source)) {\n                        if (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\n                            WebAudio._UNLOCKED = true;\n                        }\n                    }\n                    else {\n                        if (audioContext.currentTime > 0 || ended) {\n                            WebAudio._UNLOCKED = true;\n                        }\n                    }\n                }, 0);\n                clearTimeout(unlockTimeoutTimer);\n                resolve(true);\n            }, () => {\n                reject();\n            });\n        });\n        return promise;\n    }\n    static isUnlocked() {\n        return this._UNLOCKED;\n    }\n}\nWebAudio._UNLOCKED = false;\n\n;// CONCATENATED MODULE: ./Graphics/Raster.ts\n\n\n\n\n\n\n/**\n * A Raster is a Graphic that needs to be first painted to a HTMLCanvasElement before it can be drawn to the\n * [[ExcaliburGraphicsContext]]. This is useful for generating custom images using the 2D canvas api.\n *\n * Implementors must implement the [[Raster.execute]] method to rasterize their drawing.\n */\nclass Raster extends Graphic {\n    constructor(options) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n        super(omit(options, ['width', 'height'])); // rasters do some special sauce with width/height\n        this.filtering = null;\n        this.lineCap = 'butt';\n        this.quality = 1;\n        this._dirty = true;\n        this._smoothing = false;\n        this._color = watch(Color.Black, () => this.flagDirty());\n        this._lineWidth = 1;\n        this._lineDash = [];\n        this._padding = 0;\n        if (options) {\n            this.quality = (_a = options.quality) !== null && _a !== void 0 ? _a : this.quality;\n            this.color = (_b = options.color) !== null && _b !== void 0 ? _b : Color.Black;\n            this.strokeColor = options === null || options === void 0 ? void 0 : options.strokeColor;\n            this.smoothing = (_c = options.smoothing) !== null && _c !== void 0 ? _c : this.smoothing;\n            this.lineWidth = (_d = options.lineWidth) !== null && _d !== void 0 ? _d : this.lineWidth;\n            this.lineDash = (_e = options.lineDash) !== null && _e !== void 0 ? _e : this.lineDash;\n            this.lineCap = (_f = options.lineCap) !== null && _f !== void 0 ? _f : this.lineCap;\n            this.padding = (_g = options.padding) !== null && _g !== void 0 ? _g : this.padding;\n            this.filtering = (_h = options.filtering) !== null && _h !== void 0 ? _h : this.filtering;\n        }\n        this._bitmap = document.createElement('canvas');\n        // get the default canvas width/height as a fallback\n        const bitmapWidth = (_j = options === null || options === void 0 ? void 0 : options.width) !== null && _j !== void 0 ? _j : this._bitmap.width;\n        const bitmapHeight = (_k = options === null || options === void 0 ? void 0 : options.height) !== null && _k !== void 0 ? _k : this._bitmap.height;\n        this.width = bitmapWidth;\n        this.height = bitmapHeight;\n        const maybeCtx = this._bitmap.getContext('2d');\n        if (!maybeCtx) {\n            /* istanbul ignore next */\n            throw new Error('Browser does not support 2d canvas drawing, cannot create Raster graphic');\n        }\n        else {\n            this._ctx = maybeCtx;\n        }\n    }\n    cloneRasterOptions() {\n        return {\n            color: this.color ? this.color.clone() : null,\n            strokeColor: this.strokeColor ? this.strokeColor.clone() : null,\n            smoothing: this.smoothing,\n            lineWidth: this.lineWidth,\n            lineDash: this.lineDash,\n            lineCap: this.lineCap,\n            quality: this.quality,\n            padding: this.padding\n        };\n    }\n    /**\n     * Gets whether the graphic is dirty, this means there are changes that haven't been re-rasterized\n     */\n    get dirty() {\n        return this._dirty;\n    }\n    /**\n     * Flags the graphic as dirty, meaning it must be re-rasterized before draw.\n     * This should be called any time the graphics state changes such that it affects the outputted drawing\n     */\n    flagDirty() {\n        this._dirty = true;\n    }\n    /**\n     * Gets or sets the current width of the Raster graphic. Setting the width will cause the raster\n     * to be flagged dirty causing a re-raster on the next draw.\n     *\n     * Any `padding`s or `quality` set will be factored into the width\n     */\n    get width() {\n        return Math.abs(this._getTotalWidth() * this.scale.x);\n    }\n    set width(value) {\n        value /= Math.abs(this.scale.x);\n        this._bitmap.width = value;\n        this._originalWidth = value;\n        this.flagDirty();\n    }\n    /**\n     * Gets or sets the current height of the Raster graphic. Setting the height will cause the raster\n     * to be flagged dirty causing a re-raster on the next draw.\n     *\n     * Any `padding` or `quality` set will be factored into the height\n     */\n    get height() {\n        return Math.abs(this._getTotalHeight() * this.scale.y);\n    }\n    set height(value) {\n        value /= Math.abs(this.scale.y);\n        this._bitmap.height = value;\n        this._originalHeight = value;\n        this.flagDirty();\n    }\n    _getTotalWidth() {\n        var _a;\n        return (((_a = this._originalWidth) !== null && _a !== void 0 ? _a : this._bitmap.width) + this.padding * 2) * 1;\n    }\n    _getTotalHeight() {\n        var _a;\n        return (((_a = this._originalHeight) !== null && _a !== void 0 ? _a : this._bitmap.height) + this.padding * 2) * 1;\n    }\n    /**\n     * Returns the local bounds of the Raster including the padding\n     */\n    get localBounds() {\n        return BoundingBox.fromDimension(this._getTotalWidth() * this.scale.x, this._getTotalHeight() * this.scale.y, Vector.Zero);\n    }\n    /**\n     * Gets or sets the smoothing (anti-aliasing of the graphic). Setting the height will cause the raster\n     * to be flagged dirty causing a re-raster on the next draw.\n     */\n    get smoothing() {\n        return this._smoothing;\n    }\n    set smoothing(value) {\n        this._smoothing = value;\n        this.flagDirty();\n    }\n    /**\n     * Gets or sets the fillStyle of the Raster graphic. Setting the fillStyle will cause the raster to be\n     * flagged dirty causing a re-raster on the next draw.\n     */\n    get color() {\n        return this._color;\n    }\n    set color(value) {\n        this.flagDirty();\n        this._color = watch(value, () => this.flagDirty());\n    }\n    /**\n     * Gets or sets the strokeStyle of the Raster graphic. Setting the strokeStyle will cause the raster to be\n     * flagged dirty causing a re-raster on the next draw.\n     */\n    get strokeColor() {\n        return this._strokeColor;\n    }\n    set strokeColor(value) {\n        this.flagDirty();\n        this._strokeColor = watch(value, () => this.flagDirty());\n    }\n    /**\n     * Gets or sets the line width of the Raster graphic. Setting the lineWidth will cause the raster to be\n     * flagged dirty causing a re-raster on the next draw.\n     */\n    get lineWidth() {\n        return this._lineWidth;\n    }\n    set lineWidth(value) {\n        this._lineWidth = value;\n        this.flagDirty();\n    }\n    get lineDash() {\n        return this._lineDash;\n    }\n    set lineDash(value) {\n        this._lineDash = value;\n        this.flagDirty();\n    }\n    get padding() {\n        return this._padding;\n    }\n    set padding(value) {\n        this._padding = value;\n        this.flagDirty();\n    }\n    /**\n     * Rasterize the graphic to a bitmap making it usable as in excalibur. Rasterize is called automatically if\n     * the graphic is [[Raster.dirty]] on the next [[Graphic.draw]] call\n     */\n    rasterize() {\n        this._dirty = false;\n        this._ctx.clearRect(0, 0, this._getTotalWidth(), this._getTotalHeight());\n        this._ctx.save();\n        this._applyRasterProperties(this._ctx);\n        this.execute(this._ctx);\n        this._ctx.restore();\n    }\n    _applyRasterProperties(ctx) {\n        var _a, _b, _c;\n        this._bitmap.width = this._getTotalWidth() * this.quality;\n        this._bitmap.height = this._getTotalHeight() * this.quality;\n        // Do a bad thing to pass the filtering as an attribute\n        this._bitmap.setAttribute('filtering', this.filtering);\n        this._bitmap.setAttribute('forceUpload', 'true');\n        ctx.scale(this.quality, this.quality);\n        ctx.translate(this.padding, this.padding);\n        ctx.imageSmoothingEnabled = this.smoothing;\n        ctx.lineWidth = this.lineWidth;\n        ctx.setLineDash((_a = this.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\n        ctx.lineCap = this.lineCap;\n        ctx.strokeStyle = (_b = this.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\n        ctx.fillStyle = (_c = this.color) === null || _c === void 0 ? void 0 : _c.toString();\n    }\n    _drawImage(ex, x, y) {\n        if (this._dirty) {\n            this.rasterize();\n        }\n        ex.scale(1 / this.quality, 1 / this.quality);\n        ex.drawImage(this._bitmap, x, y);\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Canvas.ts\n\n/**\n * A canvas [[Graphic]] to provide an adapter between the 2D Canvas API and the [[ExcaliburGraphicsContext]].\n *\n * The [[Canvas]] works by re-rastering a draw handler to a HTMLCanvasElement for every draw which is then passed\n * to the [[ExcaliburGraphicsContext]] implementation as a rendered image.\n *\n * **Low performance API**\n */\nclass Canvas extends Raster {\n    /**\n     * Return the 2D graphics context of this canvas\n     */\n    get ctx() {\n        return this._ctx;\n    }\n    constructor(_options) {\n        super(_options);\n        this._options = _options;\n    }\n    clone() {\n        return new Canvas({\n            ...this._options,\n            ...this.cloneGraphicOptions(),\n            ...this.cloneRasterOptions()\n        });\n    }\n    execute(ctx) {\n        var _a, _b;\n        if ((_a = this._options) === null || _a === void 0 ? void 0 : _a.draw) {\n            (_b = this._options) === null || _b === void 0 ? void 0 : _b.draw(ctx);\n        }\n        if (!this._options.cache) {\n            this.flagDirty();\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Interfaces/AudioImplementation.ts\nclass ExResponse {\n}\nExResponse.type = {\n    any: '',\n    blob: 'blob',\n    json: 'json',\n    text: 'text',\n    document: 'document',\n    arraybuffer: 'arraybuffer'\n};\n\n;// CONCATENATED MODULE: ./Util/StateMachine.ts\nclass StateMachine {\n    constructor() {\n        this.states = new Map();\n    }\n    get currentState() {\n        return this._currentState;\n    }\n    set currentState(state) {\n        this._currentState = state;\n    }\n    static create(machineDescription, data) {\n        const machine = new StateMachine();\n        machine.data = data;\n        for (const stateName in machineDescription.states) {\n            machine.states.set(stateName, {\n                name: stateName,\n                ...machineDescription.states[stateName]\n            });\n        }\n        // validate transitions are states\n        for (const state of machine.states.values()) {\n            for (const transitionState of state.transitions) {\n                if (transitionState === '*') {\n                    continue;\n                }\n                if (!machine.states.has(transitionState)) {\n                    throw Error(`Invalid state machine, state [${state.name}] has a transition to another state that doesn't exist [${transitionState}]`);\n                }\n            }\n        }\n        machine.currentState = machine.startState = machine.states.get(machineDescription.start);\n        return machine;\n    }\n    in(state) {\n        return this.currentState.name === state;\n    }\n    go(stateName, eventData) {\n        var _a, _b;\n        if (this.currentState.transitions.includes(stateName) || this.currentState.transitions.includes('*')) {\n            const potentialNewState = this.states.get(stateName);\n            if (this.currentState.onExit) {\n                const canExit = (_a = this.currentState) === null || _a === void 0 ? void 0 : _a.onExit({ to: potentialNewState.name, data: this.data });\n                if (canExit === false) {\n                    return false;\n                }\n            }\n            if (potentialNewState === null || potentialNewState === void 0 ? void 0 : potentialNewState.onEnter) {\n                const canEnter = potentialNewState === null || potentialNewState === void 0 ? void 0 : potentialNewState.onEnter({ from: this.currentState.name, eventData, data: this.data });\n                if (canEnter === false) {\n                    return false;\n                }\n            }\n            // console.log(`${this.currentState.name} => ${potentialNewState.name} (${eventData})`);\n            this.currentState = potentialNewState;\n            if ((_b = this.currentState) === null || _b === void 0 ? void 0 : _b.onState) {\n                this.currentState.onState();\n            }\n            return true;\n        }\n        return false;\n    }\n    update(elapsedMs) {\n        if (this.currentState.onUpdate) {\n            this.currentState.onUpdate(this.data, elapsedMs);\n        }\n    }\n    save(saveKey) {\n        localStorage.setItem(saveKey, JSON.stringify({\n            currentState: this.currentState.name,\n            data: this.data\n        }));\n    }\n    restore(saveKey) {\n        const state = JSON.parse(localStorage.getItem(saveKey));\n        this.currentState = this.states.get(state.currentState);\n        this.data = state.data;\n    }\n}\n\n;// CONCATENATED MODULE: ./Resources/Sound/WebAudioInstance.ts\n\n\n\n\n/**\n * Internal class representing a Web Audio AudioBufferSourceNode instance\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\n */\nclass WebAudioInstance {\n    _createNewBufferSource() {\n        this._instance = this._audioContext.createBufferSource();\n        this._instance.buffer = this._src;\n        this._instance.loop = this.loop;\n        this._instance.playbackRate.value = this._playbackRate;\n        this._instance.connect(this._volumeNode);\n        this._volumeNode.connect(this._audioContext.destination);\n    }\n    _handleEnd() {\n        if (!this.loop) {\n            this._instance.onended = () => {\n                this._playingFuture.resolve(true);\n            };\n        }\n    }\n    set loop(value) {\n        this._loop = value;\n        if (this._instance) {\n            this._instance.loop = value;\n            if (!this.loop) {\n                this._instance.onended = () => {\n                    this._playingFuture.resolve(true);\n                };\n            }\n        }\n    }\n    get loop() {\n        return this._loop;\n    }\n    set volume(value) {\n        value = clamp(value, 0, 1.0);\n        this._volume = value;\n        if (this._stateMachine.in('PLAYING') && this._volumeNode.gain.setTargetAtTime) {\n            // https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime\n            // After each .1 seconds timestep, the target value will ~63.2% closer to the target value.\n            // This exponential ramp provides a more pleasant transition in gain\n            this._volumeNode.gain.setTargetAtTime(value, this._audioContext.currentTime, 0.1);\n        }\n        else {\n            this._volumeNode.gain.value = value;\n        }\n    }\n    get volume() {\n        return this._volume;\n    }\n    /**\n     * Returns the set duration to play, otherwise returns the total duration if unset\n     */\n    get duration() {\n        var _a;\n        return (_a = this._duration) !== null && _a !== void 0 ? _a : this.getTotalPlaybackDuration();\n    }\n    /**\n     * Set the duration that this audio should play.\n     *\n     * Note: if you seek to a specific point the duration will start from that point, for example\n     *\n     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.\n     */\n    set duration(duration) {\n        this._duration = duration;\n    }\n    constructor(_src) {\n        this._src = _src;\n        this._audioContext = AudioContextFactory.create();\n        this._volumeNode = this._audioContext.createGain();\n        this._playingFuture = new Future();\n        this._stateMachine = StateMachine.create({\n            start: 'STOPPED',\n            states: {\n                PLAYING: {\n                    onEnter: ({ data }) => {\n                        // Buffer nodes are single use\n                        this._createNewBufferSource();\n                        this._handleEnd();\n                        if (this.loop) {\n                            // when looping don't set a duration\n                            this._instance.start(0, data.pausedAt * this._playbackRate);\n                        }\n                        else {\n                            this._instance.start(0, data.pausedAt * this._playbackRate, this.duration);\n                        }\n                        data.startedAt = (this._audioContext.currentTime - data.pausedAt);\n                        data.pausedAt = 0;\n                    },\n                    onState: () => this._playStarted(),\n                    onExit: ({ to }) => {\n                        // If you've exited early only resolve if explicitly STOPPED\n                        if (to === 'STOPPED') {\n                            this._playingFuture.resolve(true);\n                        }\n                        // Whenever you're not playing... you stop!\n                        this._instance.onended = null; // disconnect the wired on-end handler\n                        this._instance.disconnect();\n                        this._instance.stop(0);\n                        this._instance = null;\n                    },\n                    transitions: ['STOPPED', 'PAUSED', 'SEEK']\n                },\n                SEEK: {\n                    onEnter: ({ eventData: position, data }) => {\n                        data.pausedAt = (position !== null && position !== void 0 ? position : 0) / this._playbackRate;\n                        data.startedAt = 0;\n                    },\n                    transitions: ['*']\n                },\n                STOPPED: {\n                    onEnter: ({ data }) => {\n                        data.pausedAt = 0;\n                        data.startedAt = 0;\n                        this._playingFuture.resolve(true);\n                    },\n                    transitions: ['PLAYING', 'PAUSED', 'SEEK']\n                },\n                PAUSED: {\n                    onEnter: ({ data }) => {\n                        // Playback rate will be a scale factor of how fast/slow the audio is being played\n                        // default is 1.0\n                        // we need to invert it to get the time scale\n                        data.pausedAt = (this._audioContext.currentTime - data.startedAt);\n                    },\n                    transitions: ['PLAYING', 'STOPPED', 'SEEK']\n                }\n            }\n        }, {\n            startedAt: 0,\n            pausedAt: 0\n        });\n        this._volume = 1;\n        this._loop = false;\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        this._playStarted = () => { };\n        this._playbackRate = 1.0;\n        this._createNewBufferSource();\n    }\n    isPlaying() {\n        return this._stateMachine.in('PLAYING');\n    }\n    isPaused() {\n        return this._stateMachine.in('PAUSED') || this._stateMachine.in('SEEK');\n    }\n    isStopped() {\n        return this._stateMachine.in('STOPPED');\n    }\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    play(playStarted = () => { }) {\n        this._playStarted = playStarted;\n        this._stateMachine.go('PLAYING');\n        return this._playingFuture.promise;\n    }\n    pause() {\n        this._stateMachine.go('PAUSED');\n    }\n    stop() {\n        this._stateMachine.go('STOPPED');\n    }\n    seek(position) {\n        this._stateMachine.go('PAUSED');\n        this._stateMachine.go('SEEK', position);\n    }\n    getTotalPlaybackDuration() {\n        return this._src.duration;\n    }\n    getPlaybackPosition() {\n        const { pausedAt, startedAt } = this._stateMachine.data;\n        if (pausedAt) {\n            return pausedAt * this._playbackRate;\n        }\n        if (startedAt) {\n            return (this._audioContext.currentTime - startedAt) * this._playbackRate;\n        }\n        return 0;\n    }\n    set playbackRate(playbackRate) {\n        this._instance.playbackRate.value = this._playbackRate = playbackRate;\n    }\n    get playbackRate() {\n        return this._instance.playbackRate.value;\n    }\n}\n\n;// CONCATENATED MODULE: ./Events.ts\nvar EventTypes;\n(function (EventTypes) {\n    EventTypes[\"Kill\"] = \"kill\";\n    EventTypes[\"PreKill\"] = \"prekill\";\n    EventTypes[\"PostKill\"] = \"postkill\";\n    EventTypes[\"PreDraw\"] = \"predraw\";\n    EventTypes[\"PostDraw\"] = \"postdraw\";\n    EventTypes[\"PreDebugDraw\"] = \"predebugdraw\";\n    EventTypes[\"PostDebugDraw\"] = \"postdebugdraw\";\n    EventTypes[\"PreUpdate\"] = \"preupdate\";\n    EventTypes[\"PostUpdate\"] = \"postupdate\";\n    EventTypes[\"PreFrame\"] = \"preframe\";\n    EventTypes[\"PostFrame\"] = \"postframe\";\n    EventTypes[\"PreCollision\"] = \"precollision\";\n    EventTypes[\"CollisionStart\"] = \"collisionstart\";\n    EventTypes[\"CollisionEnd\"] = \"collisionend\";\n    EventTypes[\"PostCollision\"] = \"postcollision\";\n    EventTypes[\"Initialize\"] = \"initialize\";\n    EventTypes[\"Activate\"] = \"activate\";\n    EventTypes[\"Deactivate\"] = \"deactivate\";\n    EventTypes[\"ExitViewport\"] = \"exitviewport\";\n    EventTypes[\"EnterViewport\"] = \"enterviewport\";\n    EventTypes[\"ExitTrigger\"] = \"exit\";\n    EventTypes[\"EnterTrigger\"] = \"enter\";\n    EventTypes[\"Connect\"] = \"connect\";\n    EventTypes[\"Disconnect\"] = \"disconnect\";\n    EventTypes[\"Button\"] = \"button\";\n    EventTypes[\"Axis\"] = \"axis\";\n    EventTypes[\"Visible\"] = \"visible\";\n    EventTypes[\"Hidden\"] = \"hidden\";\n    EventTypes[\"Start\"] = \"start\";\n    EventTypes[\"Stop\"] = \"stop\";\n    EventTypes[\"PointerUp\"] = \"pointerup\";\n    EventTypes[\"PointerDown\"] = \"pointerdown\";\n    EventTypes[\"PointerMove\"] = \"pointermove\";\n    EventTypes[\"PointerEnter\"] = \"pointerenter\";\n    EventTypes[\"PointerLeave\"] = \"pointerleave\";\n    EventTypes[\"PointerCancel\"] = \"pointercancel\";\n    EventTypes[\"PointerWheel\"] = \"pointerwheel\";\n    EventTypes[\"Up\"] = \"up\";\n    EventTypes[\"Down\"] = \"down\";\n    EventTypes[\"Move\"] = \"move\";\n    EventTypes[\"Enter\"] = \"enter\";\n    EventTypes[\"Leave\"] = \"leave\";\n    EventTypes[\"Cancel\"] = \"cancel\";\n    EventTypes[\"Wheel\"] = \"wheel\";\n    EventTypes[\"Press\"] = \"press\";\n    EventTypes[\"Release\"] = \"release\";\n    EventTypes[\"Hold\"] = \"hold\";\n    EventTypes[\"PointerDragStart\"] = \"pointerdragstart\";\n    EventTypes[\"PointerDragEnd\"] = \"pointerdragend\";\n    EventTypes[\"PointerDragEnter\"] = \"pointerdragenter\";\n    EventTypes[\"PointerDragLeave\"] = \"pointerdragleave\";\n    EventTypes[\"PointerDragMove\"] = \"pointerdragmove\";\n    EventTypes[\"ActionStart\"] = \"actionstart\";\n    EventTypes[\"ActionComplete\"] = \"actioncomplete\";\n})(EventTypes || (EventTypes = {}));\n/**\n * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,\n * some events are unique to a type, others are not.\n *\n */\nclass GameEvent {\n    constructor() {\n        this._bubbles = true;\n    }\n    /**\n     * If set to false, prevents event from propagating to other actors. If true it will be propagated\n     * to all actors that apply.\n     */\n    get bubbles() {\n        return this._bubbles;\n    }\n    set bubbles(value) {\n        this._bubbles = value;\n    }\n    /**\n     * Prevents event from bubbling\n     */\n    stopPropagation() {\n        this.bubbles = false;\n    }\n}\n/**\n * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.\n */\nclass KillEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * The 'prekill' event is emitted directly before an actor is killed.\n */\nclass PreKillEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * The 'postkill' event is emitted directly after the actor is killed.\n */\nclass PostKillEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * The 'start' event is emitted on engine when has started and is ready for interaction.\n */\nclass GameStartEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.\n */\nclass GameStopEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics\n * transform so that all drawing takes place with the actor as the origin.\n *\n */\nclass PreDrawEvent extends GameEvent {\n    constructor(ctx, delta, target) {\n        super();\n        this.ctx = ctx;\n        this.delta = delta;\n        this.target = target;\n    }\n}\n/**\n * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics\n * transform so that all drawing takes place with the actor as the origin.\n *\n */\nclass PostDrawEvent extends GameEvent {\n    constructor(ctx, delta, target) {\n        super();\n        this.ctx = ctx;\n        this.delta = delta;\n        this.target = target;\n    }\n}\n/**\n * The 'pretransformdraw' event is emitted on actors/entities before any graphics transforms have taken place.\n * Useful if you need to completely customize the draw or modify the transform before drawing in the draw step (for example needing\n * latest camera positions)\n *\n */\nclass PreTransformDrawEvent extends GameEvent {\n    constructor(ctx, delta, target) {\n        super();\n        this.ctx = ctx;\n        this.delta = delta;\n        this.target = target;\n    }\n}\n/**\n * The 'posttransformdraw' event is emitted on actors/entities after all graphics have been draw and transforms reset.\n * Useful if you need to completely custom the draw after everything is done.\n *\n */\nclass PostTransformDrawEvent extends GameEvent {\n    constructor(ctx, delta, target) {\n        super();\n        this.ctx = ctx;\n        this.delta = delta;\n        this.target = target;\n    }\n}\n/**\n * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.\n */\nclass PreDebugDrawEvent extends GameEvent {\n    constructor(ctx, target) {\n        super();\n        this.ctx = ctx;\n        this.target = target;\n    }\n}\n/**\n * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.\n */\nclass PostDebugDrawEvent extends GameEvent {\n    constructor(ctx, target) {\n        super();\n        this.ctx = ctx;\n        this.target = target;\n    }\n}\n/**\n * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.\n */\nclass PreUpdateEvent extends GameEvent {\n    constructor(engine, delta, target) {\n        super();\n        this.engine = engine;\n        this.delta = delta;\n        this.target = target;\n    }\n}\n/**\n * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.\n */\nclass PostUpdateEvent extends GameEvent {\n    constructor(engine, delta, target) {\n        super();\n        this.engine = engine;\n        this.delta = delta;\n        this.target = target;\n    }\n}\n/**\n * The 'preframe' event is emitted on the engine, before the frame begins.\n */\nclass PreFrameEvent extends GameEvent {\n    constructor(engine, prevStats) {\n        super();\n        this.engine = engine;\n        this.prevStats = prevStats;\n        this.target = engine;\n    }\n}\n/**\n * The 'postframe' event is emitted on the engine, after a frame ends.\n */\nclass PostFrameEvent extends GameEvent {\n    constructor(engine, stats) {\n        super();\n        this.engine = engine;\n        this.stats = stats;\n        this.target = engine;\n    }\n}\n/**\n * Event received when a gamepad is connected to Excalibur. [[Gamepads]] receives this event.\n */\nclass GamepadConnectEvent extends GameEvent {\n    constructor(index, gamepad) {\n        super();\n        this.index = index;\n        this.gamepad = gamepad;\n        this.target = gamepad;\n    }\n}\n/**\n * Event received when a gamepad is disconnected from Excalibur. [[Gamepads]] receives this event.\n */\nclass GamepadDisconnectEvent extends GameEvent {\n    constructor(index, gamepad) {\n        super();\n        this.index = index;\n        this.gamepad = gamepad;\n        this.target = gamepad;\n    }\n}\n/**\n * Gamepad button event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\n */\nclass GamepadButtonEvent extends GameEvent {\n    /**\n     * @param button  The Gamepad button\n     * @param value   A numeric value between 0 and 1\n     */\n    constructor(button, value, target) {\n        super();\n        this.button = button;\n        this.value = value;\n        this.target = target;\n    }\n}\n/**\n * Gamepad axis event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\n */\nclass GamepadAxisEvent extends GameEvent {\n    /**\n     * @param axis  The Gamepad axis\n     * @param value A numeric value between -1 and 1\n     */\n    constructor(axis, value, target) {\n        super();\n        this.axis = axis;\n        this.value = value;\n        this.target = target;\n    }\n}\n/**\n * Event received by the [[Engine]] when the browser window is visible on a screen.\n */\nclass VisibleEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * Event received by the [[Engine]] when the browser window is hidden from all screens.\n */\nclass HiddenEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * Event thrown on an [[Actor|actor]] when a collision will occur this frame if it resolves\n */\nclass PreCollisionEvent extends GameEvent {\n    /**\n     * @param actor         The actor the event was thrown on\n     * @param other         The actor that will collided with the current actor\n     * @param side          The side that will be collided with the current actor\n     * @param intersection  Intersection vector\n     */\n    constructor(actor, other, side, intersection, contact) {\n        super();\n        this.other = other;\n        this.side = side;\n        this.intersection = intersection;\n        this.contact = contact;\n        this.target = actor;\n    }\n}\n/**\n * Event thrown on an [[Actor|actor]] when a collision has been resolved (body reacted) this frame\n */\nclass PostCollisionEvent extends GameEvent {\n    /**\n     * @param actor         The actor the event was thrown on\n     * @param other         The actor that did collide with the current actor\n     * @param side          The side that did collide with the current actor\n     * @param intersection  Intersection vector\n     */\n    constructor(actor, other, side, intersection, contact) {\n        super();\n        this.other = other;\n        this.side = side;\n        this.intersection = intersection;\n        this.contact = contact;\n        this.target = actor;\n    }\n    get actor() {\n        return this.target;\n    }\n    set actor(actor) {\n        this.target = actor;\n    }\n}\nclass ContactStartEvent {\n    constructor(target, other, side, contact) {\n        this.target = target;\n        this.other = other;\n        this.side = side;\n        this.contact = contact;\n    }\n}\nclass ContactEndEvent {\n    constructor(target, other, side, lastContact) {\n        this.target = target;\n        this.other = other;\n        this.side = side;\n        this.lastContact = lastContact;\n    }\n}\nclass CollisionPreSolveEvent {\n    constructor(target, other, side, intersection, contact) {\n        this.target = target;\n        this.other = other;\n        this.side = side;\n        this.intersection = intersection;\n        this.contact = contact;\n    }\n}\nclass CollisionPostSolveEvent {\n    constructor(target, other, side, intersection, contact) {\n        this.target = target;\n        this.other = other;\n        this.side = side;\n        this.intersection = intersection;\n        this.contact = contact;\n    }\n}\n/**\n * Event thrown the first time an [[Actor|actor]] collides with another, after an actor is in contact normal collision events are fired.\n */\nclass CollisionStartEvent extends GameEvent {\n    /**\n     *\n     * @param actor\n     * @param other\n     * @param side\n     * @param contact\n     */\n    constructor(actor, other, side, contact) {\n        super();\n        this.other = other;\n        this.side = side;\n        this.contact = contact;\n        this.target = actor;\n    }\n    get actor() {\n        return this.target;\n    }\n    set actor(actor) {\n        this.target = actor;\n    }\n}\n/**\n * Event thrown when the [[Actor|actor]] is no longer colliding with another\n */\nclass CollisionEndEvent extends GameEvent {\n    /**\n     *\n     */\n    constructor(actor, other, side, lastContact) {\n        super();\n        this.other = other;\n        this.side = side;\n        this.lastContact = lastContact;\n        this.target = actor;\n    }\n    get actor() {\n        return this.target;\n    }\n    set actor(actor) {\n        this.target = actor;\n    }\n}\n/**\n * Event thrown on an [[Actor]], [[Scene]], and [[Engine]] only once before the first update call\n */\nclass InitializeEvent extends GameEvent {\n    /**\n     * @param engine  The reference to the current engine\n     */\n    constructor(engine, target) {\n        super();\n        this.engine = engine;\n        this.target = target;\n    }\n}\n/**\n * Event thrown on a [[Scene]] on activation\n */\nclass ActivateEvent extends GameEvent {\n    /**\n     * @param context  The context for the scene activation\n     */\n    constructor(context, target) {\n        super();\n        this.context = context;\n        this.target = target;\n    }\n}\n/**\n * Event thrown on a [[Scene]] on deactivation\n */\nclass DeactivateEvent extends GameEvent {\n    /**\n     * @param context  The context for the scene deactivation\n     */\n    constructor(context, target) {\n        super();\n        this.context = context;\n        this.target = target;\n    }\n}\n/**\n * Event thrown on an [[Actor]] when the graphics bounds completely leaves the screen.\n */\nclass ExitViewPortEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\n/**\n * Event thrown on an [[Actor]] when any part of the graphics bounds are on screen.\n */\nclass EnterViewPortEvent extends GameEvent {\n    constructor(target) {\n        super();\n        this.target = target;\n    }\n}\nclass EnterTriggerEvent extends GameEvent {\n    constructor(target, actor) {\n        super();\n        this.target = target;\n        this.actor = actor;\n    }\n}\nclass ExitTriggerEvent extends GameEvent {\n    constructor(target, actor) {\n        super();\n        this.target = target;\n        this.actor = actor;\n    }\n}\n/**\n * Event thrown on an [[Actor]] when an action starts.\n */\nclass ActionStartEvent extends GameEvent {\n    constructor(action, target) {\n        super();\n        this.action = action;\n        this.target = target;\n    }\n}\n/**\n * Event thrown on an [[Actor]] when an action completes.\n */\nclass ActionCompleteEvent extends GameEvent {\n    constructor(action, target) {\n        super();\n        this.action = action;\n        this.target = target;\n    }\n}\n\n;// CONCATENATED MODULE: ./Events/MediaEvents.ts\n\nclass MediaEvent extends GameEvent {\n    /**\n     * Media event cannot bubble\n     */\n    set bubbles(_value) {\n        // stubbed\n    }\n    /**\n     * Media event cannot bubble\n     */\n    get bubbles() {\n        return false;\n    }\n    /**\n     * Media event cannot bubble, so they have no path\n     */\n    get _path() {\n        return null;\n    }\n    /**\n     * Media event cannot bubble, so they have no path\n     */\n    set _path(_val) {\n        // stubbed\n    }\n    constructor(target, _name = 'MediaEvent') {\n        super();\n        this.target = target;\n        this._name = _name;\n    }\n    /**\n     * Prevents event from bubbling\n     */\n    stopPropagation() {\n        /**\n         * Stub\n         */\n    }\n    /**\n     * Action, that calls when event happens\n     */\n    action() {\n        /**\n         * Stub\n         */\n    }\n    /**\n     * Propagate event further through event path\n     */\n    propagate() {\n        /**\n         * Stub\n         */\n    }\n    layPath(_actor) {\n        /**\n         * Stub\n         */\n    }\n}\nclass NativeSoundEvent extends MediaEvent {\n    constructor(target, track) {\n        super(target, 'NativeSoundEvent');\n        this.track = track;\n    }\n}\nclass NativeSoundProcessedEvent extends MediaEvent {\n    constructor(target, _processedData) {\n        super(target, 'NativeSoundProcessedEvent');\n        this._processedData = _processedData;\n        this.data = this._processedData;\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Sound.ts\n\n/**\n * Whether or not the browser can play this file as HTML5 Audio\n */\nfunction canPlayFile(file) {\n    try {\n        const a = new Audio();\n        const filetype = /.*\\.([A-Za-z0-9]+)(?:(?:\\?|\\#).*)*$/;\n        const type = file.match(filetype)[1];\n        if (a.canPlayType('audio/' + type)) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    catch (e) {\n        Logger.getInstance().warn('Cannot determine audio support, assuming no support for the Audio Tag', e);\n        return false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Resources/Sound/Sound.ts\n\n\n\n\n\n\n\n\nconst SoundEvents = {\n    VolumeChange: 'volumechange',\n    Processed: 'processed',\n    Pause: 'pause',\n    Stop: 'stop',\n    PlaybackEnd: 'playbackend',\n    Resume: 'resume',\n    PlaybackStart: 'playbackstart'\n};\n/**\n * The [[Sound]] object allows games built in Excalibur to load audio\n * components, from soundtracks to sound effects. [[Sound]] is an [[Loadable]]\n * which means it can be passed to a [[Loader]] to pre-load before a game or level.\n */\nclass Sound {\n    /**\n     * Indicates whether the clip should loop when complete\n     * @param value  Set the looping flag\n     */\n    set loop(value) {\n        this._loop = value;\n        for (const track of this._tracks) {\n            track.loop = this._loop;\n        }\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._loop);\n    }\n    get loop() {\n        return this._loop;\n    }\n    set volume(value) {\n        this._volume = value;\n        for (const track of this._tracks) {\n            track.volume = this._volume;\n        }\n        this.events.emit('volumechange', new NativeSoundEvent(this));\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._volume);\n    }\n    get volume() {\n        return this._volume;\n    }\n    /**\n     * Get the duration that this audio should play. If unset the total natural playback duration will be used.\n     */\n    get duration() {\n        return this._duration;\n    }\n    /**\n     * Set the duration that this audio should play. If unset the total natural playback duration will be used.\n     *\n     * Note: if you seek to a specific point the duration will start from that point, for example\n     *\n     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.\n     */\n    set duration(duration) {\n        this._duration = duration;\n    }\n    /**\n     * Return array of Current AudioInstances playing or being paused\n     */\n    get instances() {\n        return this._tracks;\n    }\n    get path() {\n        return this._resource.path;\n    }\n    set path(val) {\n        this._resource.path = val;\n    }\n    /**\n     * Should excalibur add a cache busting querystring? By default false.\n     * Must be set before loading\n     */\n    get bustCache() {\n        return this._resource.bustCache;\n    }\n    set bustCache(val) {\n        this._resource.bustCache = val;\n    }\n    /**\n     * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.\n     */\n    constructor(...paths) {\n        this.events = new EventEmitter();\n        this.logger = Logger.getInstance();\n        this._loop = false;\n        this._volume = 1;\n        this._isStopped = false;\n        // private _isPaused = false;\n        this._tracks = [];\n        this._wasPlayingOnHidden = false;\n        this._playbackRate = 1.0;\n        this._audioContext = AudioContextFactory.create();\n        this._resource = new Resource('', ExResponse.type.arraybuffer);\n        /**\n         * Chrome : MP3, WAV, Ogg\n         * Firefox : WAV, Ogg,\n         * IE : MP3, WAV coming soon\n         * Safari MP3, WAV, Ogg\n         */\n        for (const path of paths) {\n            if (canPlayFile(path)) {\n                this.path = path;\n                break;\n            }\n        }\n        if (!this.path) {\n            this.logger.warn('This browser does not support any of the audio files specified:', paths.join(', '));\n            this.logger.warn('Attempting to use', paths[0]);\n            this.path = paths[0]; // select the first specified\n        }\n    }\n    isLoaded() {\n        return !!this.data;\n    }\n    async load() {\n        var _a, _b;\n        if (this.data) {\n            return this.data;\n        }\n        const arraybuffer = await this._resource.load();\n        const audiobuffer = await this.decodeAudio(arraybuffer.slice(0));\n        this._duration = (_b = (_a = this._duration) !== null && _a !== void 0 ? _a : audiobuffer === null || audiobuffer === void 0 ? void 0 : audiobuffer.duration) !== null && _b !== void 0 ? _b : undefined;\n        this.events.emit('processed', new NativeSoundProcessedEvent(this, audiobuffer));\n        return this.data = audiobuffer;\n    }\n    async decodeAudio(data) {\n        try {\n            return await this._audioContext.decodeAudioData(data.slice(0));\n        }\n        catch (e) {\n            this.logger.error('Unable to decode ' +\n                ' this browser may not fully support this format, or the file may be corrupt, ' +\n                'if this is an mp3 try removing id3 tags and album art from the file.');\n            return await Promise.reject();\n        }\n    }\n    wireEngine(engine) {\n        if (engine) {\n            this._engine = engine;\n            this._engine.on('hidden', () => {\n                if (engine.pauseAudioWhenHidden && this.isPlaying()) {\n                    this._wasPlayingOnHidden = true;\n                    this.pause();\n                }\n            });\n            this._engine.on('visible', () => {\n                if (engine.pauseAudioWhenHidden && this._wasPlayingOnHidden) {\n                    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                    this.play();\n                    this._wasPlayingOnHidden = false;\n                }\n            });\n            this._engine.on('start', () => {\n                this._isStopped = false;\n            });\n            this._engine.on('stop', () => {\n                this.stop();\n                this._isStopped = true;\n            });\n        }\n    }\n    /**\n     * Returns how many instances of the sound are currently playing\n     */\n    instanceCount() {\n        return this._tracks.length;\n    }\n    /**\n     * Whether or not the sound is playing right now\n     */\n    isPlaying() {\n        return this._tracks.some((t) => t.isPlaying());\n    }\n    isPaused() {\n        return this._tracks.some(t => t.isPaused());\n    }\n    isStopped() {\n        return this._tracks.some(t => t.isStopped());\n    }\n    /**\n     * Play the sound, returns a promise that resolves when the sound is done playing\n     * An optional volume argument can be passed in to play the sound. Max volume is 1.0\n     */\n    play(volume) {\n        if (!this.isLoaded()) {\n            this.logger.warn('Cannot start playing. Resource', this.path, 'is not loaded yet');\n            return Promise.resolve(true);\n        }\n        if (this._isStopped) {\n            this.logger.warn('Cannot start playing. Engine is in a stopped state.');\n            return Promise.resolve(false);\n        }\n        this.volume = volume || this.volume;\n        if (this.isPaused()) {\n            return this._resumePlayback();\n        }\n        else {\n            return this._startPlayback();\n        }\n    }\n    /**\n     * Stop the sound, and do not rewind\n     */\n    pause() {\n        if (!this.isPlaying()) {\n            return;\n        }\n        for (const track of this._tracks) {\n            track.pause();\n        }\n        this.events.emit('pause', new NativeSoundEvent(this));\n        this.logger.debug('Paused all instances of sound', this.path);\n    }\n    /**\n     * Stop the sound if it is currently playing and rewind the track. If the sound is not playing, rewinds the track.\n     */\n    stop() {\n        for (const track of this._tracks) {\n            track.stop();\n        }\n        this.events.emit('stop', new NativeSoundEvent(this));\n        this._tracks.length = 0;\n        this.logger.debug('Stopped all instances of sound', this.path);\n    }\n    get playbackRate() {\n        return this._playbackRate;\n    }\n    set playbackRate(playbackRate) {\n        this._playbackRate = playbackRate;\n        this._tracks.forEach(t => {\n            t.playbackRate = this._playbackRate;\n        });\n    }\n    seek(position, trackId = 0) {\n        if (this._tracks.length === 0) {\n            this._getTrackInstance(this.data);\n        }\n        this._tracks[trackId].seek(position);\n    }\n    getTotalPlaybackDuration() {\n        if (!this.isLoaded()) {\n            this.logger.warnOnce(`Sound from ${this.path} is not loaded, cannot return total playback duration.` +\n                `Did you forget to add Sound to a loader? https://excaliburjs.com/docs/loaders/`);\n            return 0;\n        }\n        return this.data.duration;\n    }\n    /**\n     * Return the current playback time of the playing track in seconds from the start.\n     *\n     * Optionally specify the track to query if multiple are playing at once.\n     * @param trackId\n     */\n    getPlaybackPosition(trackId = 0) {\n        if (this._tracks.length) {\n            return this._tracks[trackId].getPlaybackPosition();\n        }\n        return 0;\n    }\n    /**\n     * Get Id of provided AudioInstance in current trackList\n     * @param track [[Audio]] which Id is to be given\n     */\n    getTrackId(track) {\n        return this._tracks.indexOf(track);\n    }\n    async _resumePlayback() {\n        if (this.isPaused) {\n            const resumed = [];\n            // ensure we resume *current* tracks (if paused)\n            for (const track of this._tracks) {\n                resumed.push(track.play().then(() => {\n                    this._tracks.splice(this.getTrackId(track), 1);\n                    return true;\n                }));\n            }\n            this.events.emit('resume', new NativeSoundEvent(this));\n            this.logger.debug('Resuming paused instances for sound', this.path, this._tracks);\n            // resolve when resumed tracks are done\n            await Promise.all(resumed);\n        }\n        return true;\n    }\n    /**\n     * Starts playback, returns a promise that resolves when playback is complete\n     */\n    async _startPlayback() {\n        const track = this._getTrackInstance(this.data);\n        const complete = await track.play(() => {\n            this.events.emit('playbackstart', new NativeSoundEvent(this, track));\n            this.logger.debug('Playing new instance for sound', this.path);\n        });\n        this.events.emit('playbackend', new NativeSoundEvent(this, track));\n        // cleanup any done tracks\n        const trackId = this.getTrackId(track);\n        if (trackId !== -1) {\n            this._tracks.splice(trackId, 1);\n        }\n        return complete;\n    }\n    _getTrackInstance(data) {\n        const newTrack = new WebAudioInstance(data);\n        newTrack.loop = this.loop;\n        newTrack.volume = this.volume;\n        newTrack.duration = this.duration;\n        newTrack.playbackRate = this._playbackRate;\n        this._tracks.push(newTrack);\n        return newTrack;\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n}\n\n;// CONCATENATED MODULE: ./Director/DefaultLoader.ts\n\n\n\n\n\n\n\n\n\nconst LoaderEvents = {\n    // Add event types here\n    BeforeLoad: 'beforeload',\n    AfterLoad: 'afterload',\n    UserAction: 'useraction',\n    LoadResourceStart: 'loadresourcestart',\n    LoadResourceEnd: 'loadresourceend'\n};\n/**\n * Returns true if the constructor is for an Excalibur Loader\n */\nfunction isLoaderConstructor(x) {\n    var _a, _b;\n    return !!(x === null || x === void 0 ? void 0 : x.prototype) && !!((_b = (_a = x === null || x === void 0 ? void 0 : x.prototype) === null || _a === void 0 ? void 0 : _a.constructor) === null || _b === void 0 ? void 0 : _b.name);\n}\nclass DefaultLoader {\n    get resources() {\n        return this._resources;\n    }\n    /**\n     * @param options Optionally provide the list of resources you want to load at constructor time\n     */\n    constructor(options) {\n        var _a;\n        this.events = new EventEmitter();\n        this.canvas = new Canvas({\n            filtering: ImageFiltering.Blended,\n            smoothing: true,\n            cache: false,\n            draw: this.onDraw.bind(this)\n        });\n        this._resources = [];\n        this._numLoaded = 0;\n        this._totalTimeMs = 0;\n        this._loadingFuture = new Future();\n        if (options && ((_a = options.loadables) === null || _a === void 0 ? void 0 : _a.length)) {\n            this.addResources(options.loadables);\n        }\n    }\n    /**\n     * Called by the engine before loading\n     * @param engine\n     */\n    onInitialize(engine) {\n        this.engine = engine;\n        this.canvas.width = this.engine.screen.resolution.width;\n        this.canvas.height = this.engine.screen.resolution.height;\n    }\n    /**\n     * Return a promise that resolves when the user interacts with the loading screen in some way, usually a click.\n     *\n     * It's important to implement this in order to unlock the audio context in the browser. Browsers automatically prevent\n     * audio from playing until the user performs an action.\n     *\n     */\n    async onUserAction() {\n        return await Promise.resolve();\n    }\n    /**\n     * Overridable lifecycle method, called directly before loading starts\n     */\n    async onBeforeLoad() {\n        // override me\n    }\n    /**\n     * Overridable lifecycle method, called after loading has completed\n     */\n    async onAfterLoad() {\n        // override me\n        await delay(500, this.engine.clock); // avoid a flicker\n    }\n    /**\n     * Add a resource to the loader to load\n     * @param loadable  Resource to add\n     */\n    addResource(loadable) {\n        this._resources.push(loadable);\n    }\n    /**\n     * Add a list of resources to the loader to load\n     * @param loadables  The list of resources to load\n     */\n    addResources(loadables) {\n        let i = 0;\n        const len = loadables.length;\n        for (i; i < len; i++) {\n            this.addResource(loadables[i]);\n        }\n    }\n    markResourceComplete() {\n        this._numLoaded++;\n    }\n    /**\n     * Returns the progress of the loader as a number between [0, 1] inclusive.\n     */\n    get progress() {\n        const total = this._resources.length;\n        return total > 0 ? clamp(this._numLoaded, 0, total) / total : 1;\n    }\n    /**\n     * Returns true if the loader has completely loaded all resources\n     */\n    isLoaded() {\n        return this._numLoaded === this._resources.length;\n    }\n    /**\n     * Optionally override the onUpdate\n     * @param engine\n     * @param elapsedMilliseconds\n     */\n    onUpdate(engine, elapsedMilliseconds) {\n        this._totalTimeMs += elapsedMilliseconds;\n        // override me\n    }\n    /**\n     * Optionally override the onDraw\n     */\n    onDraw(ctx) {\n        const seconds = this._totalTimeMs / 1000;\n        ctx.fillStyle = Color.Black.toRGBA();\n        ctx.fillRect(0, 0, this.engine.screen.resolution.width, this.engine.screen.resolution.height);\n        ctx.save();\n        ctx.translate(this.engine.screen.resolution.width / 2, this.engine.screen.resolution.height / 2);\n        const speed = seconds * 10;\n        ctx.strokeStyle = 'white';\n        ctx.lineWidth = 10;\n        ctx.lineCap = 'round';\n        ctx.arc(0, 0, 40, speed, speed + (Math.PI * 3 / 2));\n        ctx.stroke();\n        ctx.fillStyle = 'white';\n        ctx.font = '16px sans-serif';\n        const text = (this.progress * 100).toFixed(0) + '%';\n        const textbox = ctx.measureText(text);\n        const width = Math.abs(textbox.actualBoundingBoxLeft) + Math.abs(textbox.actualBoundingBoxRight);\n        const height = Math.abs(textbox.actualBoundingBoxAscent) + Math.abs(textbox.actualBoundingBoxDescent);\n        ctx.fillText(text, -width / 2, height / 2); // center\n        ctx.restore();\n    }\n    areResourcesLoaded() {\n        return this._loadingFuture.promise;\n    }\n    /**\n     * Not meant to be overridden\n     *\n     * Begin loading all of the supplied resources, returning a promise\n     * that resolves when loading of all is complete AND the user has interacted with the loading screen\n     */\n    async load() {\n        await this.onBeforeLoad();\n        this.events.emit('beforeload');\n        this.canvas.flagDirty();\n        await Promise.all(this._resources.map(async (r) => {\n            this.events.emit('loadresourcestart', r);\n            await r.load().finally(() => {\n                // capture progress\n                this._numLoaded++;\n                this.canvas.flagDirty();\n                this.events.emit('loadresourceend', r);\n            });\n        }));\n        // Wire all sound to the engine\n        for (const resource of this._resources) {\n            if (resource instanceof Sound) {\n                resource.wireEngine(this.engine);\n            }\n        }\n        this._loadingFuture.resolve();\n        this.canvas.flagDirty();\n        // Unlock browser AudioContext in after user gesture\n        // See: https://github.com/excaliburjs/Excalibur/issues/262\n        // See: https://github.com/excaliburjs/Excalibur/issues/1031\n        await this.onUserAction();\n        this.events.emit('useraction');\n        await WebAudio.unlock();\n        await this.onAfterLoad();\n        this.events.emit('afterload');\n        return (this.data = this._resources);\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/DrawUtil.ts\n\n/* istanbul ignore next */\n/**\n * Draw a line on canvas context\n * @param ctx The canvas context\n * @param color The color of the line\n * @param x1 The start x coordinate\n * @param y1 The start y coordinate\n * @param x2 The ending x coordinate\n * @param y2 The ending y coordinate\n * @param thickness The line thickness\n * @param cap The [[LineCapStyle]] (butt, round, or square)\n */\nfunction line(ctx, color = Color.Red, x1, y1, x2, y2, thickness = 1, cap = 'butt') {\n    ctx.save();\n    ctx.beginPath();\n    ctx.lineWidth = thickness;\n    ctx.lineCap = cap;\n    ctx.strokeStyle = color.toString();\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y2);\n    ctx.closePath();\n    ctx.stroke();\n    ctx.restore();\n}\n/* istanbul ignore next */\n/**\n * Draw the vector as a point onto the canvas.\n */\nfunction point(ctx, color = Color.Red, point) {\n    ctx.beginPath();\n    ctx.strokeStyle = color.toString();\n    ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.stroke();\n}\n/**\n * Draw the vector as a line onto the canvas starting a origin point.\n */\n/* istanbul ignore next */\n/**\n *\n */\nfunction vector(ctx, color, origin, vector, scale = 1.0) {\n    const c = color ? color.toString() : 'blue';\n    const v = vector.scale(scale);\n    ctx.beginPath();\n    ctx.strokeStyle = c;\n    ctx.moveTo(origin.x, origin.y);\n    ctx.lineTo(origin.x + v.x, origin.y + v.y);\n    ctx.closePath();\n    ctx.stroke();\n}\n/**\n * Draw a round rectangle on a canvas context\n * @param ctx The canvas context\n * @param x The top-left x coordinate\n * @param y The top-left y coordinate\n * @param width The width of the rectangle\n * @param height The height of the rectangle\n * @param radius The border radius of the rectangle\n * @param stroke The [[Color]] to stroke rectangle with\n * @param fill The [[Color]] to fill rectangle with\n */\nfunction roundRect(ctx, x, y, width, height, radius = 5, stroke = Color.White, fill = null) {\n    let br;\n    if (typeof radius === 'number') {\n        br = { tl: radius, tr: radius, br: radius, bl: radius };\n    }\n    else {\n        const defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\n        for (const prop in defaultRadius) {\n            if (defaultRadius.hasOwnProperty(prop)) {\n                const side = prop;\n                br[side] = radius[side] || defaultRadius[side];\n            }\n        }\n    }\n    ctx.beginPath();\n    ctx.moveTo(x + br.tl, y);\n    ctx.lineTo(x + width - br.tr, y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + br.tr);\n    ctx.lineTo(x + width, y + height - br.br);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - br.br, y + height);\n    ctx.lineTo(x + br.bl, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - br.bl);\n    ctx.lineTo(x, y + br.tl);\n    ctx.quadraticCurveTo(x, y, x + br.tl, y);\n    ctx.closePath();\n    if (fill) {\n        ctx.fillStyle = fill.toString();\n        ctx.fill();\n    }\n    if (stroke) {\n        ctx.strokeStyle = stroke.toString();\n        ctx.stroke();\n    }\n}\n/**\n *\n */\nfunction circle(ctx, x, y, radius, stroke = Color.White, fill = null) {\n    ctx.beginPath();\n    ctx.arc(x, y, radius, 0, Math.PI * 2);\n    ctx.closePath();\n    if (fill) {\n        ctx.fillStyle = fill.toString();\n        ctx.fill();\n    }\n    if (stroke) {\n        ctx.strokeStyle = stroke.toString();\n        ctx.stroke();\n    }\n}\n\n;// CONCATENATED MODULE: ./Director/Loader.logo.png\n/* harmony default export */ const Loader_logo = (\"data:image/png;base64,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\");\n// EXTERNAL MODULE: ./Director/Loader.css\nvar Director_Loader = __webpack_require__(8851);\n;// CONCATENATED MODULE: ./Director/Loader.ts\n\n\n\n\n\n\n\n\n\n/**\n * Pre-loading assets\n *\n * The loader provides a mechanism to preload multiple resources at\n * one time. The loader must be passed to the engine in order to\n * trigger the loading progress bar.\n *\n * The [[Loader]] itself implements [[Loadable]] so you can load loaders.\n *\n * ## Example: Pre-loading resources for a game\n *\n * ```js\n * // create a loader\n * var loader = new ex.Loader();\n *\n * // create a resource dictionary (best practice is to keep a separate file)\n * var resources = {\n *   TextureGround: new ex.Texture(\"/images/textures/ground.png\"),\n *   SoundDeath: new ex.Sound(\"/sound/death.wav\", \"/sound/death.mp3\")\n * };\n *\n * // loop through dictionary and add to loader\n * for (var loadable in resources) {\n *   if (resources.hasOwnProperty(loadable)) {\n *     loader.addResource(resources[loadable]);\n *   }\n * }\n *\n * // start game\n * game.start(loader).then(function () {\n *   console.log(\"Game started!\");\n * });\n * ```\n *\n * ## Customize the Loader\n *\n * The loader can be customized to show different, text, logo, background color, and button.\n *\n * ```typescript\n * const loader = new ex.Loader([playerTexture]);\n *\n * // The loaders button text can simply modified using this\n * loader.playButtonText = 'Start the best game ever';\n *\n * // The logo can be changed by inserting a base64 image string here\n *\n * loader.logo = 'data:image/png;base64,iVBORw...';\n * loader.logoWidth = 15;\n * loader.logoHeight = 14;\n *\n * // The background color can be changed like so by supplying a valid CSS color string\n *\n * loader.backgroundColor = 'red'\n * loader.backgroundColor = '#176BAA'\n *\n * // To build a completely new button\n * loader.startButtonFactory = () => {\n *     let myButton = document.createElement('button');\n *     myButton.textContent = 'The best button';\n *     return myButton;\n * };\n *\n * engine.start(loader).then(() => {});\n * ```\n */\nclass Loader extends DefaultLoader {\n    get _image() {\n        if (!this._imageElement) {\n            this._imageElement = new Image();\n            this._imageElement.onload = () => this._imageLoaded.resolve();\n            this._imageElement.src = this.logo;\n        }\n        return this._imageElement;\n    }\n    get playButtonRootElement() {\n        return this._playButtonRootElement;\n    }\n    get playButtonElement() {\n        return this._playButtonElement;\n    }\n    get _playButton() {\n        const existingRoot = document.getElementById('excalibur-play-root');\n        if (existingRoot) {\n            this._playButtonRootElement = existingRoot;\n        }\n        if (!this._playButtonRootElement) {\n            this._playButtonRootElement = document.createElement('div');\n            this._playButtonRootElement.id = 'excalibur-play-root';\n            this._playButtonRootElement.style.position = 'absolute';\n            document.body.appendChild(this._playButtonRootElement);\n        }\n        if (!this._styleBlock) {\n            this._styleBlock = document.createElement('style');\n            this._styleBlock.textContent = this._playButtonStyles;\n            document.head.appendChild(this._styleBlock);\n        }\n        if (!this._playButtonElement) {\n            this._playButtonElement = this.startButtonFactory();\n            this._playButtonRootElement.appendChild(this._playButtonElement);\n        }\n        return this._playButtonElement;\n    }\n    constructor(loadablesOrOptions) {\n        const options = Array.isArray(loadablesOrOptions) ? {\n            loadables: loadablesOrOptions\n        } : loadablesOrOptions;\n        super(options);\n        this._logger = Logger.getInstance();\n        this._originalOptions = { loadables: [] };\n        this.events = new EventEmitter();\n        this._playButtonShown = false;\n        // logo drawing stuff\n        // base64 string encoding of the excalibur logo (logo-white.png)\n        this.logo = Loader_logo;\n        this.logoWidth = 468;\n        this.logoHeight = 118;\n        /**\n         * Gets or sets the color of the loading bar, default is [[Color.White]]\n         */\n        this.loadingBarColor = Color.White;\n        /**\n         * Gets or sets the background color of the loader as a hex string\n         */\n        this.backgroundColor = '#176BAA';\n        this._imageLoaded = new Future();\n        this.suppressPlayButton = false;\n        /** Loads the css from Loader.css */\n        this._playButtonStyles = Director_Loader/* default */.A.toString();\n        /**\n         * Get/set play button text\n         */\n        this.playButtonText = 'Play game';\n        /**\n         * Return a html button element for excalibur to use as a play button\n         */\n        this.startButtonFactory = () => {\n            let buttonElement = document.getElementById('excalibur-play');\n            if (!buttonElement) {\n                buttonElement = document.createElement('button');\n            }\n            buttonElement.id = 'excalibur-play';\n            buttonElement.textContent = this.playButtonText;\n            buttonElement.style.display = 'none';\n            return buttonElement;\n        };\n        this._configuredPixelRatio = null;\n        this._originalOptions = { ...Loader._DEFAULT_LOADER_OPTIONS, ...options };\n    }\n    onInitialize(engine) {\n        this.engine = engine;\n        this.screen = engine.screen;\n        this.canvas.width = this.engine.canvas.width;\n        this.canvas.height = this.engine.canvas.height;\n        this.screen.events.on('resize', () => {\n            this.canvas.width = this.engine.canvas.width;\n            this.canvas.height = this.engine.canvas.height;\n        });\n    }\n    /**\n     * Shows the play button and returns a promise that resolves when clicked\n     */\n    async showPlayButton() {\n        var _a, _b;\n        if (this.suppressPlayButton) {\n            this.hidePlayButton();\n            // Delay is to give the logo a chance to show, otherwise don't delay\n            await delay(500, (_a = this.engine) === null || _a === void 0 ? void 0 : _a.clock);\n        }\n        else {\n            const resizeHandler = () => {\n                try {\n                    this._positionPlayButton();\n                }\n                catch (_a) {\n                    // swallow if can't position\n                }\n                ;\n            };\n            if ((_b = this.engine) === null || _b === void 0 ? void 0 : _b.browser) {\n                this.engine.browser.window.on('resize', resizeHandler);\n            }\n            this._playButtonShown = true;\n            this._playButton.style.display = 'block';\n            document.body.addEventListener('keyup', (evt) => {\n                if (evt.key === 'Enter') {\n                    this._playButton.click();\n                }\n            });\n            this._positionPlayButton();\n            const playButtonClicked = new Promise(resolve => {\n                const startButtonHandler = (e) => {\n                    var _a;\n                    // We want to stop propagation to keep bubbling to the engine pointer handlers\n                    e.stopPropagation();\n                    // Hide Button after click\n                    this.hidePlayButton();\n                    if ((_a = this.engine) === null || _a === void 0 ? void 0 : _a.browser) {\n                        this.engine.browser.window.off('resize', resizeHandler);\n                    }\n                    if (this._originalOptions.fullscreenAfterLoad) {\n                        try {\n                            this._logger.info('requesting fullscreen');\n                            if (this._originalOptions.fullscreenContainer instanceof HTMLElement) {\n                                this._originalOptions.fullscreenContainer.requestFullscreen();\n                            }\n                            else {\n                                this.engine.screen.goFullScreen(this._originalOptions.fullscreenContainer);\n                            }\n                        }\n                        catch (error) {\n                            this._logger.error('could not go fullscreen', error);\n                        }\n                    }\n                    resolve();\n                };\n                this._playButton.addEventListener('click', startButtonHandler);\n                this._playButton.addEventListener('touchend', startButtonHandler);\n                this._playButton.addEventListener('pointerup', startButtonHandler);\n            });\n            return await playButtonClicked;\n        }\n    }\n    hidePlayButton() {\n        this._playButtonShown = false;\n        this._playButton.style.display = 'none';\n    }\n    /**\n     * Clean up generated elements for the loader\n     */\n    dispose() {\n        if (this._playButtonRootElement.parentElement) {\n            this._playButtonRootElement.removeChild(this._playButtonElement);\n            document.body.removeChild(this._playButtonRootElement);\n            document.head.removeChild(this._styleBlock);\n            this._playButtonRootElement = null;\n            this._playButtonElement = null;\n            this._styleBlock = null;\n        }\n    }\n    async onUserAction() {\n        var _a;\n        // short delay in showing the button for aesthetics\n        await delay(200, (_a = this.engine) === null || _a === void 0 ? void 0 : _a.clock);\n        this.canvas.flagDirty();\n        // show play button\n        await this.showPlayButton();\n    }\n    async onBeforeLoad() {\n        const image = this._image;\n        await this._imageLoaded.promise;\n        await (image === null || image === void 0 ? void 0 : image.decode()); // decode logo if it exists\n    }\n    // eslint-disable-next-line require-await\n    async onAfterLoad() {\n        this.screen.pixelRatioOverride = this._configuredPixelRatio;\n        this.screen.popResolutionAndViewport();\n        this.screen.applyResolutionAndViewport();\n        this.dispose();\n    }\n    _positionPlayButton() {\n        if (this.engine) {\n            const { x: left, y: top, width: screenWidth, height: screenHeight } = this.engine.canvas.getBoundingClientRect();\n            if (this._playButtonRootElement) {\n                const buttonWidth = this._playButton.clientWidth;\n                const buttonHeight = this._playButton.clientHeight;\n                if (this.playButtonPosition) {\n                    this._playButtonRootElement.style.left = `${this.playButtonPosition.x}px`;\n                    this._playButtonRootElement.style.top = `${this.playButtonPosition.y}px`;\n                }\n                else {\n                    this._playButtonRootElement.style.left = `${left + screenWidth / 2 - buttonWidth / 2}px`;\n                    this._playButtonRootElement.style.top = `${top + screenHeight / 2 - buttonHeight / 2 + 100}px`;\n                }\n            }\n        }\n    }\n    /**\n     * Loader draw function. Draws the default Excalibur loading screen.\n     * Override `logo`, `logoWidth`, `logoHeight` and `backgroundColor` properties\n     * to customize the drawing, or just override entire method.\n     */\n    onDraw(ctx) {\n        const canvasHeight = this.engine.canvasHeight / this.engine.pixelRatio;\n        const canvasWidth = this.engine.canvasWidth / this.engine.pixelRatio;\n        this._positionPlayButton();\n        ctx.fillStyle = this.backgroundColor;\n        ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n        let logoY = canvasHeight / 2;\n        const width = Math.min(this.logoWidth, canvasWidth * 0.75);\n        let logoX = canvasWidth / 2 - width / 2;\n        if (this.logoPosition) {\n            logoX = this.logoPosition.x;\n            logoY = this.logoPosition.y;\n        }\n        const imageHeight = Math.floor(width * (this.logoHeight / this.logoWidth)); // OG height/width factor\n        const oldAntialias = this.engine.getAntialiasing();\n        this.engine.setAntialiasing(true);\n        if (!this.logoPosition) {\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY - imageHeight - 20, width, imageHeight);\n        }\n        else {\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY, width, imageHeight);\n        }\n        // loading box\n        if (!this.suppressPlayButton && this._playButtonShown) {\n            this.engine.setAntialiasing(oldAntialias);\n            return;\n        }\n        let loadingX = logoX;\n        let loadingY = logoY;\n        if (this.loadingBarPosition) {\n            loadingX = this.loadingBarPosition.x;\n            loadingY = this.loadingBarPosition.y;\n        }\n        ctx.lineWidth = 2;\n        roundRect(ctx, loadingX, loadingY, width, 20, 10, this.loadingBarColor);\n        const progress = width * this.progress;\n        const margin = 5;\n        const progressWidth = progress - margin * 2;\n        const height = 20 - margin * 2;\n        roundRect(ctx, loadingX + margin, loadingY + margin, progressWidth > 10 ? progressWidth : 10, height, 5, null, this.loadingBarColor);\n        this.engine.setAntialiasing(oldAntialias);\n    }\n}\nLoader._DEFAULT_LOADER_OPTIONS = {\n    loadables: [],\n    fullscreenAfterLoad: false,\n    fullscreenContainer: undefined\n};\n\n;// CONCATENATED MODULE: ./Util/Detector.ts\n\n/**\n * This is the list of features that will be used to log the supported\n * features to the console when Detector.logBrowserFeatures() is called.\n */\nconst REPORTED_FEATURES = {\n    webgl: 'WebGL',\n    webaudio: 'WebAudio',\n    gamepadapi: 'Gamepad API'\n};\n/**\n * Excalibur internal feature detection helper class\n */\nclass Detector {\n    constructor() {\n        this._features = null;\n        this.failedTests = [];\n        // critical browser features required for ex to run\n        this._criticalTests = {\n            // Test canvas/2d context support\n            canvasSupport: function () {\n                const elem = document.createElement('canvas');\n                return !!(elem.getContext && elem.getContext('2d'));\n            },\n            // Test array buffer support ex uses for downloading binary data\n            arrayBufferSupport: function () {\n                const xhr = new XMLHttpRequest();\n                xhr.open('GET', '/');\n                try {\n                    xhr.responseType = 'arraybuffer';\n                }\n                catch (e) {\n                    return false;\n                }\n                return xhr.responseType === 'arraybuffer';\n            },\n            // Test data urls ex uses for sprites\n            dataUrlSupport: function () {\n                const canvas = document.createElement('canvas');\n                return canvas.toDataURL('image/png').indexOf('data:image/png') === 0;\n            },\n            // Test object url support for loading\n            objectUrlSupport: function () {\n                return 'URL' in window && 'revokeObjectURL' in URL && 'createObjectURL' in URL;\n            },\n            // RGBA support for colors\n            rgbaSupport: function () {\n                const style = document.createElement('a').style;\n                style.cssText = 'background-color:rgba(150,255,150,.5)';\n                return ('' + style.backgroundColor).indexOf('rgba') > -1;\n            }\n        };\n        // warnings excalibur performance will be degraded\n        this._warningTest = {\n            webAudioSupport: function () {\n                return !!(window.AudioContext ||\n                    window.webkitAudioContext ||\n                    window.mozAudioContext ||\n                    window.msAudioContext ||\n                    window.oAudioContext);\n            },\n            webglSupport: function () {\n                const elem = document.createElement('canvas');\n                return !!(elem.getContext && elem.getContext('webgl'));\n            }\n        };\n        this._features = this._loadBrowserFeatures();\n    }\n    /**\n     * Returns a map of currently supported browser features. This method\n     * treats the features as a singleton and will only calculate feature\n     * support if it has not previously been done.\n     */\n    getBrowserFeatures() {\n        if (this._features === null) {\n            this._features = this._loadBrowserFeatures();\n        }\n        return this._features;\n    }\n    /**\n     * Report on non-critical browser support for debugging purposes.\n     * Use native browser console colors for visibility.\n     */\n    logBrowserFeatures() {\n        let msg = '%cSUPPORTED BROWSER FEATURES\\n==========================%c\\n';\n        const args = ['font-weight: bold; color: navy', 'font-weight: normal; color: inherit'];\n        const supported = this.getBrowserFeatures();\n        for (const feature of Object.keys(REPORTED_FEATURES)) {\n            if (supported[feature]) {\n                msg += '(%c\\u2713%c)'; // ()\n                args.push('font-weight: bold; color: green');\n                args.push('font-weight: normal; color: inherit');\n            }\n            else {\n                msg += '(%c\\u2717%c)'; // ()\n                args.push('font-weight: bold; color: red');\n                args.push('font-weight: normal; color: inherit');\n            }\n            msg += ' ' + REPORTED_FEATURES[feature] + '\\n';\n        }\n        args.unshift(msg);\n        // eslint-disable-next-line no-console\n        console.log.apply(console, args);\n    }\n    /**\n     * Executes several IIFE's to get a constant reference to supported\n     * features within the current execution context.\n     */\n    _loadBrowserFeatures() {\n        return {\n            // IIFE to check canvas support\n            canvas: (() => {\n                return this._criticalTests.canvasSupport();\n            })(),\n            // IIFE to check arraybuffer support\n            arraybuffer: (() => {\n                return this._criticalTests.arrayBufferSupport();\n            })(),\n            // IIFE to check dataurl support\n            dataurl: (() => {\n                return this._criticalTests.dataUrlSupport();\n            })(),\n            // IIFE to check objecturl support\n            objecturl: (() => {\n                return this._criticalTests.objectUrlSupport();\n            })(),\n            // IIFE to check rgba support\n            rgba: (() => {\n                return this._criticalTests.rgbaSupport();\n            })(),\n            // IIFE to check webaudio support\n            webaudio: (() => {\n                return this._warningTest.webAudioSupport();\n            })(),\n            // IIFE to check webgl support\n            webgl: (() => {\n                return this._warningTest.webglSupport();\n            })(),\n            // IIFE to check gamepadapi support\n            gamepadapi: (() => {\n                return !!navigator.getGamepads;\n            })()\n        };\n    }\n    test() {\n        // Critical test will for ex not to run\n        let failedCritical = false;\n        for (const test in this._criticalTests) {\n            if (!this._criticalTests[test].call(this)) {\n                this.failedTests.push(test);\n                Logger.getInstance().error('Critical browser feature missing, Excalibur requires:', test);\n                failedCritical = true;\n            }\n        }\n        if (failedCritical) {\n            return false;\n        }\n        // Warning tests do not for ex to return false to compatibility\n        for (const warning in this._warningTest) {\n            if (!this._warningTest[warning]()) {\n                Logger.getInstance().warn('Warning browser feature missing, Excalibur will have reduced performance:', warning);\n            }\n        }\n        return true;\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/CollisionType.ts\n/**\n * An enum that describes the types of collisions bodies can participate in\n */\nvar CollisionType;\n(function (CollisionType) {\n    /**\n     * Bodies with the `PreventCollision` setting do not participate in any\n     * collisions and do not raise collision events.\n     */\n    CollisionType[\"PreventCollision\"] = \"PreventCollision\";\n    /**\n     * Bodies with the `Passive` setting only raise collision events, but are not\n     * influenced or moved by other bodies and do not influence or move other bodies.\n     * This is useful for use in trigger type behavior.\n     */\n    CollisionType[\"Passive\"] = \"Passive\";\n    /**\n     * Bodies with the `Active` setting raise collision events and participate\n     * in collisions with other bodies and will be push or moved by bodies sharing\n     * the `Active` or `Fixed` setting.\n     */\n    CollisionType[\"Active\"] = \"Active\";\n    /**\n     * Bodies with the `Fixed` setting raise collision events and participate in\n     * collisions with other bodies. Actors with the `Fixed` setting will not be\n     * pushed or moved by other bodies sharing the `Fixed`. Think of Fixed\n     * bodies as \"immovable/unstoppable\" objects. If two `Fixed` bodies meet they will\n     * not be pushed or moved by each other, they will not interact except to throw\n     * collision events.\n     */\n    CollisionType[\"Fixed\"] = \"Fixed\";\n})(CollisionType || (CollisionType = {}));\n\n;// CONCATENATED MODULE: ./Math/coord-plane.ts\n/**\n * Enum representing the coordinate plane for the position 2D vector in the [[TransformComponent]]\n */\nvar CoordPlane;\n(function (CoordPlane) {\n    /**\n     * The world coordinate plane (default) represents world space, any entities drawn with world\n     * space move when the camera moves.\n     */\n    CoordPlane[\"World\"] = \"world\";\n    /**\n     * The screen coordinate plane represents screen space, entities drawn in screen space are pinned\n     * to screen coordinates ignoring the camera.\n     */\n    CoordPlane[\"Screen\"] = \"screen\";\n})(CoordPlane || (CoordPlane = {}));\n\n;// CONCATENATED MODULE: ./Math/vector-view.ts\n\nclass VectorView extends Vector {\n    constructor(options) {\n        super(0, 0);\n        this._getX = options.getX;\n        this._getY = options.getY;\n        this._setX = options.setX;\n        this._setY = options.setY;\n    }\n    get x() {\n        return (this._x = this._getX());\n    }\n    set x(val) {\n        this._setX(val);\n        this._x = val;\n    }\n    get y() {\n        return (this._y = this._getY());\n    }\n    set y(val) {\n        this._setY(val);\n        this._y = val;\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/watch-vector.ts\n\n/**\n * Wraps a vector and watches for changes in the x/y, modifies the original vector.\n */\nclass WatchVector extends Vector {\n    constructor(original, change) {\n        super(original.x, original.y);\n        this.original = original;\n        this.change = change;\n    }\n    get x() {\n        return this._x = this.original.x;\n    }\n    set x(newX) {\n        this.change(newX, this._y);\n        this._x = this.original.x = newX;\n    }\n    get y() {\n        return this._y = this.original.y;\n    }\n    set y(newY) {\n        this.change(this._x, newY);\n        this._y = this.original.y = newY;\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/transform.ts\n\n\n\n\n\nclass transform_Transform {\n    constructor() {\n        this._parent = null;\n        this._children = [];\n        this._pos = vec(0, 0);\n        this._rotation = 0;\n        this._scale = vec(1, 1);\n        this._isDirty = false;\n        this._isInverseDirty = false;\n        this._matrix = AffineMatrix.identity();\n        this._inverse = AffineMatrix.identity();\n    }\n    get parent() {\n        return this._parent;\n    }\n    set parent(transform) {\n        if (this._parent) {\n            const index = this._parent._children.indexOf(this);\n            if (index > -1) {\n                this._parent._children.splice(index, 1);\n            }\n        }\n        this._parent = transform;\n        if (this._parent) {\n            this._parent._children.push(this);\n        }\n        this.flagDirty();\n    }\n    get children() {\n        return this._children;\n    }\n    set pos(v) {\n        if (!v.equals(this._pos)) {\n            this._pos.x = v.x;\n            this._pos.y = v.y;\n            this.flagDirty();\n        }\n    }\n    get pos() {\n        return new WatchVector(this._pos, (x, y) => {\n            if (x !== this._pos.x || y !== this._pos.y) {\n                this.flagDirty();\n            }\n        });\n    }\n    set globalPos(v) {\n        let localPos = v.clone();\n        if (this.parent) {\n            localPos = this.parent.inverse.multiply(v);\n        }\n        if (!localPos.equals(this._pos)) {\n            this._pos = localPos;\n            this.flagDirty();\n        }\n    }\n    get globalPos() {\n        return new VectorView({\n            getX: () => this.matrix.data[4],\n            getY: () => this.matrix.data[5],\n            setX: (x) => {\n                if (this.parent) {\n                    const { x: newX } = this.parent.inverse.multiply(vec(x, this.pos.y));\n                    this.pos.x = newX;\n                }\n                else {\n                    this.pos.x = x;\n                }\n                if (x !== this.matrix.data[4]) {\n                    this.flagDirty();\n                }\n            },\n            setY: (y) => {\n                if (this.parent) {\n                    const { y: newY } = this.parent.inverse.multiply(vec(this.pos.x, y));\n                    this.pos.y = newY;\n                }\n                else {\n                    this.pos.y = y;\n                }\n                if (y !== this.matrix.data[5]) {\n                    this.flagDirty();\n                }\n            }\n        });\n    }\n    set rotation(rotation) {\n        const canonRotation = canonicalizeAngle(rotation);\n        if (canonRotation !== this._rotation) {\n            this.flagDirty();\n        }\n        this._rotation = canonRotation;\n    }\n    get rotation() {\n        return this._rotation;\n    }\n    set globalRotation(rotation) {\n        let inverseRotation = 0;\n        if (this.parent) {\n            inverseRotation = this.parent.globalRotation;\n        }\n        const canonRotation = canonicalizeAngle(rotation + inverseRotation);\n        if (canonRotation !== this._rotation) {\n            this.flagDirty();\n        }\n        this._rotation = canonRotation;\n    }\n    get globalRotation() {\n        if (this.parent) {\n            return this.matrix.getRotation();\n        }\n        return this.rotation;\n    }\n    set scale(v) {\n        if (v.x !== this._scale.x || v.y !== this._scale.y) {\n            this._scale.x = v.x;\n            this._scale.y = v.y;\n            this.flagDirty();\n        }\n    }\n    get scale() {\n        return new WatchVector(this._scale, (x, y) => {\n            if (x !== this._scale.x || y !== this._scale.y) {\n                this.flagDirty();\n            }\n        });\n    }\n    set globalScale(v) {\n        let inverseScale = vec(1, 1);\n        if (this.parent) {\n            inverseScale = this.parent.globalScale;\n        }\n        this.scale = v.scale(vec(1 / inverseScale.x, 1 / inverseScale.y));\n    }\n    get globalScale() {\n        return new VectorView({\n            getX: () => this.parent ? this.matrix.getScaleX() : this.scale.x,\n            getY: () => this.parent ? this.matrix.getScaleY() : this.scale.y,\n            setX: (x) => {\n                if (this.parent) {\n                    const globalScaleX = this.parent.globalScale.x;\n                    this.scale.x = x / globalScaleX;\n                }\n                else {\n                    this.scale.x = x;\n                }\n            },\n            setY: (y) => {\n                if (this.parent) {\n                    const globalScaleY = this.parent.globalScale.y;\n                    this.scale.y = y / globalScaleY;\n                }\n                else {\n                    this.scale.y = y;\n                }\n            }\n        });\n    }\n    get matrix() {\n        if (this._isDirty) {\n            if (this.parent === null) {\n                this._matrix = this._calculateMatrix();\n            }\n            else {\n                this._matrix = this.parent.matrix.multiply(this._calculateMatrix());\n            }\n            this._isDirty = false;\n        }\n        return this._matrix;\n    }\n    get inverse() {\n        if (this._isInverseDirty) {\n            this._inverse = this.matrix.inverse();\n            this._isInverseDirty = false;\n        }\n        return this._inverse;\n    }\n    _calculateMatrix() {\n        const matrix = AffineMatrix.identity()\n            .translate(this.pos.x, this.pos.y)\n            .rotate(this.rotation)\n            .scale(this.scale.x, this.scale.y);\n        return matrix;\n    }\n    flagDirty() {\n        this._isDirty = true;\n        this._isInverseDirty = true;\n        for (let i = 0; i < this._children.length; i++) {\n            this._children[i].flagDirty();\n        }\n    }\n    apply(point) {\n        return this.matrix.multiply(point);\n    }\n    applyInverse(point) {\n        return this.inverse.multiply(point);\n    }\n    setTransform(pos, rotation, scale) {\n        this._pos.x = pos.x;\n        this._pos.y = pos.y;\n        this._rotation = canonicalizeAngle(rotation);\n        this._scale.x = scale.x;\n        this._scale.y = scale.y;\n        this.flagDirty();\n    }\n    /**\n     * Clones the current transform\n     * **Warning does not clone the parent**\n     * @param dest\n     */\n    clone(dest) {\n        const target = dest !== null && dest !== void 0 ? dest : new transform_Transform();\n        this._pos.clone(target._pos);\n        target._rotation = this._rotation;\n        this._scale.clone(target._scale);\n        target.flagDirty();\n        return target;\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Component.ts\n/**\n *\n */\nfunction isComponentCtor(value) {\n    return !!value && !!value.prototype && !!value.prototype.constructor;\n}\n/**\n * Type guard to check if a component implements clone\n * @param x\n */\nfunction hasClone(x) {\n    return !!(x === null || x === void 0 ? void 0 : x.clone);\n}\n/**\n * Components are containers for state in Excalibur, the are meant to convey capabilities that an Entity possesses\n *\n * Implementations of Component must have a zero-arg constructor to support dependencies\n *\n * ```typescript\n * class MyComponent extends ex.Component {\n *   // zero arg support required if you want to use component dependencies\n *   constructor(public optionalPos?: ex.Vector) {}\n * }\n * ```\n */\nclass Component {\n    constructor() {\n        // TODO maybe generate a unique id?\n        /**\n         * Current owning [[Entity]], if any, of this component. Null if not added to any [[Entity]]\n         */\n        this.owner = undefined;\n    }\n    /**\n     * Clones any properties on this component, if that property value has a `clone()` method it will be called\n     */\n    clone() {\n        const newComponent = new this.constructor();\n        for (const prop in this) {\n            if (this.hasOwnProperty(prop)) {\n                const val = this[prop];\n                if (hasClone(val) && prop !== 'owner' && prop !== 'clone') {\n                    newComponent[prop] = val.clone();\n                }\n                else {\n                    newComponent[prop] = val;\n                }\n            }\n        }\n        return newComponent;\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Observable.ts\n/**\n * Simple Observable implementation\n * @template T is the typescript Type that defines the data being observed\n */\nclass Observable {\n    constructor() {\n        this.observers = [];\n        this.subscriptions = [];\n    }\n    /**\n     * Register an observer to listen to this observable\n     * @param observer\n     */\n    register(observer) {\n        this.observers.push(observer);\n    }\n    /**\n     * Register a callback to listen to this observable\n     * @param func\n     */\n    subscribe(func) {\n        this.subscriptions.push(func);\n    }\n    /**\n     * Remove an observer from the observable\n     * @param observer\n     */\n    unregister(observer) {\n        const i = this.observers.indexOf(observer);\n        if (i !== -1) {\n            this.observers.splice(i, 1);\n        }\n    }\n    /**\n     * Remove a callback that is listening to this observable\n     * @param func\n     */\n    unsubscribe(func) {\n        const i = this.subscriptions.indexOf(func);\n        if (i !== -1) {\n            this.subscriptions.splice(i, 1);\n        }\n    }\n    /**\n     * Broadcasts a message to all observers and callbacks\n     * @param message\n     */\n    notifyAll(message) {\n        const observersLength = this.observers.length;\n        for (let i = 0; i < observersLength; i++) {\n            this.observers[i].notify(message);\n        }\n        const subscriptionsLength = this.subscriptions.length;\n        for (let i = 0; i < subscriptionsLength; i++) {\n            this.subscriptions[i](message);\n        }\n    }\n    /**\n     * Removes all observers and callbacks\n     */\n    clear() {\n        this.observers.length = 0;\n        this.subscriptions.length = 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/TransformComponent.ts\n\n\n\n\n\nclass TransformComponent extends Component {\n    constructor() {\n        super(...arguments);\n        this._logger = Logger.getInstance();\n        this._parentComponent = null;\n        this._transform = new transform_Transform();\n        this._addChildTransform = (child) => {\n            const childTxComponent = child.get(TransformComponent);\n            if (childTxComponent) {\n                childTxComponent._transform.parent = this._transform;\n                childTxComponent._parentComponent = this;\n            }\n        };\n        /**\n         * Observable that emits when the z index changes on this component\n         */\n        this.zIndexChanged$ = new Observable();\n        this._z = 0;\n        this._coordPlane = CoordPlane.World;\n    }\n    get() {\n        return this._transform;\n    }\n    onAdd(owner) {\n        for (const child of owner.children) {\n            this._addChildTransform(child);\n        }\n        owner.childrenAdded$.subscribe(child => this._addChildTransform(child));\n        owner.childrenRemoved$.subscribe(child => {\n            const childTxComponent = child.get(TransformComponent);\n            if (childTxComponent) {\n                childTxComponent._transform.parent = null;\n                childTxComponent._parentComponent = null;\n            }\n        });\n    }\n    onRemove(_previousOwner) {\n        this._transform.parent = null;\n        this._parentComponent = null;\n    }\n    /**\n     * The z-index ordering of the entity, a higher values are drawn on top of lower values.\n     * For example z=99 would be drawn on top of z=0.\n     */\n    get z() {\n        return this._z;\n    }\n    set z(val) {\n        const oldz = this._z;\n        this._z = val;\n        if (oldz !== val) {\n            this.zIndexChanged$.notifyAll(val);\n        }\n    }\n    /**\n     * The [[CoordPlane|coordinate plane|]] for this transform for the entity.\n     */\n    get coordPlane() {\n        if (this._parentComponent) {\n            return this._parentComponent.coordPlane;\n        }\n        return this._coordPlane;\n    }\n    set coordPlane(value) {\n        var _a;\n        if (!this._parentComponent) {\n            this._coordPlane = value;\n        }\n        else {\n            this._logger.warn(`Cannot set coordinate plane on child entity ${(_a = this.owner) === null || _a === void 0 ? void 0 : _a.name}, children inherit their coordinate plane from their parents.`);\n        }\n    }\n    get pos() {\n        return this._transform.pos;\n    }\n    set pos(v) {\n        this._transform.pos = v;\n    }\n    get globalPos() {\n        return this._transform.globalPos;\n    }\n    set globalPos(v) {\n        this._transform.globalPos = v;\n    }\n    get rotation() {\n        return this._transform.rotation;\n    }\n    set rotation(rotation) {\n        this._transform.rotation = rotation;\n    }\n    get globalRotation() {\n        return this._transform.globalRotation;\n    }\n    set globalRotation(rotation) {\n        this._transform.globalRotation = rotation;\n    }\n    get scale() {\n        return this._transform.scale;\n    }\n    set scale(v) {\n        this._transform.scale = v;\n    }\n    get globalScale() {\n        return this._transform.globalScale;\n    }\n    set globalScale(v) {\n        this._transform.globalScale = v;\n    }\n    applyInverse(v) {\n        return this._transform.applyInverse(v);\n    }\n    apply(v) {\n        return this._transform.apply(v);\n    }\n    clone() {\n        const component = new TransformComponent();\n        component._transform = this._transform.clone();\n        component._z = this._z;\n        return component;\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/MotionComponent.ts\n\n\nclass MotionComponent extends Component {\n    constructor() {\n        super(...arguments);\n        /**\n         * The velocity of an entity in pixels per second\n         */\n        this.vel = Vector.Zero;\n        /**\n         * The acceleration of entity in pixels per second^2\n         */\n        this.acc = Vector.Zero;\n        /**\n         * The scale rate of change in scale units per second\n         */\n        this.scaleFactor = Vector.Zero;\n        /**\n         * The angular velocity which is how quickly the entity is rotating in radians per second\n         */\n        this.angularVelocity = 0;\n        /**\n         * The amount of torque applied to the entity, angular acceleration is torque * inertia\n         */\n        this.torque = 0;\n        /**\n         * Inertia can be thought of as the resistance to motion\n         */\n        this.inertia = 1;\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroupManager.ts\n\n/**\n * Static class for managing collision groups in excalibur, there is a maximum of 32 collision groups possible in excalibur\n */\nclass CollisionGroupManager {\n    /**\n     * Create a new named collision group up to a max of 32.\n     * @param name Name for the collision group\n     * @param mask Optionally provide your own 32-bit mask, if none is provide the manager will generate one\n     */\n    static create(name, mask) {\n        if (this._CURRENT_GROUP > this._MAX_GROUPS) {\n            throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);\n        }\n        if (this._GROUPS.get(name)) {\n            const existingGroup = this._GROUPS.get(name);\n            if (existingGroup.mask === mask) {\n                return existingGroup;\n            }\n            throw new Error(`Collision group ${name} already exists with a different mask!`);\n        }\n        const group = new CollisionGroup(name, this._CURRENT_BIT, mask !== undefined ? mask : ~this._CURRENT_BIT);\n        this._CURRENT_BIT = (this._CURRENT_BIT << 1) | 0;\n        this._CURRENT_GROUP++;\n        this._GROUPS.set(name, group);\n        return group;\n    }\n    /**\n     * Get all collision groups currently tracked by excalibur\n     */\n    static get groups() {\n        return Array.from(this._GROUPS.values());\n    }\n    /**\n     * Get a collision group by it's name\n     * @param name\n     */\n    static groupByName(name) {\n        return this._GROUPS.get(name);\n    }\n    /**\n     * Resets the managers internal group management state\n     */\n    static reset() {\n        this._GROUPS = new Map();\n        this._CURRENT_BIT = this._STARTING_BIT;\n        this._CURRENT_GROUP = 1;\n    }\n}\n// using bitmasking the maximum number of groups is 32, because that is the highest 32bit integer that JS can present.\nCollisionGroupManager._STARTING_BIT = 0b1 | 0;\nCollisionGroupManager._MAX_GROUPS = 32;\nCollisionGroupManager._CURRENT_GROUP = 1;\nCollisionGroupManager._CURRENT_BIT = CollisionGroupManager._STARTING_BIT;\nCollisionGroupManager._GROUPS = new Map();\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroup.ts\n\n/**\n * CollisionGroups indicate like members that do not collide with each other. Use [[CollisionGroupManager]] to create [[CollisionGroup]]s\n *\n * For example:\n *\n * Players have collision group \"player\"\n *\n * ![Player Collision Group](/assets/images/docs/CollisionGroupsPlayer.png)\n *\n * Enemies have collision group \"enemy\"\n *\n * ![Enemy Collision Group](/assets/images/docs/CollisionGroupsEnemy.png)\n *\n * Blocks have collision group \"ground\"\n *\n * ![Ground collision group](/assets/images/docs/CollisionGroupsGround.png)\n *\n * Players don't collide with each other, but enemies and blocks. Likewise, enemies don't collide with each other but collide\n * with players and blocks.\n *\n * This is done with bitmasking, see the following pseudo-code\n *\n * PlayerGroup = `0b001`\n * PlayerGroupMask = `0b110`\n *\n * EnemyGroup = `0b010`\n * EnemyGroupMask = `0b101`\n *\n * BlockGroup = `0b100`\n * BlockGroupMask = `0b011`\n *\n * Should Players collide? No because the bitwise mask evaluates to 0\n * `(player1.group & player2.mask) === 0`\n * `(0b001 & 0b110) === 0`\n *\n * Should Players and Enemies collide? Yes because the bitwise mask is non-zero\n * `(player1.group & enemy1.mask) === 1`\n * `(0b001 & 0b101) === 1`\n *\n * Should Players and Blocks collide? Yes because the bitwise mask is non-zero\n * `(player1.group & blocks1.mask) === 1`\n * `(0b001 & 0b011) === 1`\n */\nclass CollisionGroup {\n    /**\n     * STOP!!** It is preferred that [[CollisionGroupManager.create]] is used to create collision groups\n     *  unless you know how to construct the proper bitmasks. See https://github.com/excaliburjs/Excalibur/issues/1091 for more info.\n     * @param name Name of the collision group\n     * @param category 32 bit category for the group, should be a unique power of 2. For example `0b001` or `0b010`\n     * @param mask 32 bit mask of category, or `~category` generally. For a category of `0b001`, the mask would be `0b110`\n     */\n    constructor(name, category, mask) {\n        this._name = name;\n        this._category = category;\n        this._mask = mask;\n    }\n    /**\n     * Get the name of the collision group\n     */\n    get name() {\n        return this._name;\n    }\n    /**\n     * Get the category of the collision group, a 32 bit number which should be a unique power of 2\n     */\n    get category() {\n        return this._category;\n    }\n    /**\n     * Get the mask for this collision group\n     */\n    get mask() {\n        return this._mask;\n    }\n    /**\n     * Evaluates whether 2 collision groups can collide\n     *\n     * This means the mask has the same bit set the other category and vice versa\n     * @param other  CollisionGroup\n     */\n    canCollide(other) {\n        const overlap1 = this.category & other.mask;\n        const overlap2 = this.mask & other.category;\n        return (overlap1 !== 0) && (overlap2 !== 0);\n    }\n    /**\n     * Inverts the collision group. For example, if before the group specified \"players\",\n     * inverting would specify all groups except players\n     * @returns CollisionGroup\n     */\n    invert() {\n        const group = CollisionGroupManager.create('~(' + this.name + ')', ~this.mask | 0);\n        group._category = ~this.category;\n        return group;\n    }\n    /**\n     * Combine collision groups with each other. The new group includes all of the previous groups.\n     * @param collisionGroups\n     */\n    static combine(collisionGroups) {\n        const combinedName = collisionGroups.map((c) => c.name).join('+');\n        const combinedCategory = collisionGroups.reduce((current, g) => g.category | current, 0b0);\n        const combinedMask = ~combinedCategory;\n        return CollisionGroupManager.create(combinedName, combinedMask);\n    }\n    /**\n     * Creates a collision group that collides with the listed groups\n     * @param collisionGroups\n     */\n    static collidesWith(collisionGroups) {\n        const combinedName = `collidesWith(${collisionGroups.map((c) => c.name).join('+')})`;\n        const combinedMask = collisionGroups.reduce((current, g) => g.category | current, 0b0);\n        return CollisionGroupManager.create(combinedName, combinedMask);\n    }\n    toString() {\n        return `\r\ncategory: ${this.category.toString(2).padStart(32, '0')}\r\nmask:     ${(this.mask >>> 0).toString(2).padStart(32, '0')}\r\n    `;\n    }\n}\n/**\n * The `All` [[CollisionGroup]] is a special group that collides with all other groups including itself,\n * it is the default collision group on colliders.\n */\nCollisionGroup.All = new CollisionGroup('Collide with all groups', -1, -1);\n\n;// CONCATENATED MODULE: ./Collision/Detection/Pair.ts\n\n\n/**\n * Models a potential collision between 2 colliders\n */\nclass Pair {\n    constructor(colliderA, colliderB) {\n        this.colliderA = colliderA;\n        this.colliderB = colliderB;\n        this.id = null;\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\n    }\n    /**\n     * Returns whether a it is allowed for 2 colliders in a Pair to collide\n     * @param colliderA\n     * @param colliderB\n     */\n    static canCollide(colliderA, colliderB) {\n        var _a, _b;\n        const bodyA = (_a = colliderA === null || colliderA === void 0 ? void 0 : colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n        const bodyB = (_b = colliderB === null || colliderB === void 0 ? void 0 : colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n        // Prevent self collision\n        if (colliderA.id === colliderB.id) {\n            return false;\n        }\n        // Colliders with the same owner do not collide (composite colliders)\n        if (colliderA.owner &&\n            colliderB.owner &&\n            colliderA.owner.id === colliderB.owner.id) {\n            return false;\n        }\n        // if the pair has a member with zero dimension don't collide\n        if (colliderA.localBounds.hasZeroDimensions() || colliderB.localBounds.hasZeroDimensions()) {\n            return false;\n        }\n        // Body's needed for collision in the current state\n        // TODO can we collide without a body?\n        if (!bodyA || !bodyB) {\n            return false;\n        }\n        // If both are in the same collision group short circuit\n        if (!bodyA.group.canCollide(bodyB.group)) {\n            return false;\n        }\n        // if both are fixed short circuit\n        if (bodyA.collisionType === CollisionType.Fixed && bodyB.collisionType === CollisionType.Fixed) {\n            return false;\n        }\n        // if the either is prevent collision short circuit\n        if (bodyB.collisionType === CollisionType.PreventCollision || bodyA.collisionType === CollisionType.PreventCollision) {\n            return false;\n        }\n        // if either is dead short circuit\n        if (!bodyA.active || !bodyB.active) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Returns whether or not it is possible for the pairs to collide\n     */\n    get canCollide() {\n        const colliderA = this.colliderA;\n        const colliderB = this.colliderB;\n        return Pair.canCollide(colliderA, colliderB);\n    }\n    /**\n     * Runs the collision intersection logic on the members of this pair\n     */\n    collide() {\n        return this.colliderA.collide(this.colliderB);\n    }\n    /**\n     * Check if the collider is part of the pair\n     * @param collider\n     */\n    hasCollider(collider) {\n        return collider === this.colliderA || collider === this.colliderB;\n    }\n    /**\n     * Calculates the unique pair hash id for this collision pair (owning id)\n     */\n    static calculatePairHash(idA, idB) {\n        if (idA.value < idB.value) {\n            return `#${idA.value}+${idB.value}`;\n        }\n        else {\n            return `#${idB.value}+${idA.value}`;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/projection.ts\n/**\n * A 1 dimensional projection on an axis, used to test overlaps\n */\nclass Projection {\n    constructor(min, max) {\n        this.min = min;\n        this.max = max;\n    }\n    overlaps(projection) {\n        return this.max > projection.min && projection.max > this.min;\n    }\n    getOverlap(projection) {\n        if (this.overlaps(projection)) {\n            if (this.max > projection.max) {\n                return projection.max - this.min;\n            }\n            else {\n                return this.max - projection.min;\n            }\n        }\n        return 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTree.ts\n\n\n\n\n/**\n * Dynamic Tree Node used for tracking bounds within the tree\n */\nclass TreeNode {\n    constructor(parent) {\n        this.parent = parent;\n        this.parent = parent || null;\n        this.data = null;\n        this.bounds = new BoundingBox();\n        this.left = null;\n        this.right = null;\n        this.height = 0;\n    }\n    isLeaf() {\n        return !this.left && !this.right;\n    }\n}\n/**\n * The DynamicTrees provides a spatial partitioning data structure for quickly querying for overlapping bounding boxes for\n * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.\n *\n * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.\n * Every non-leaf node is a bounding box that contains child bounding boxes.\n */\nclass DynamicTree {\n    constructor(_config, worldBounds = new BoundingBox(-Number.MAX_VALUE, -Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)) {\n        this._config = _config;\n        this.worldBounds = worldBounds;\n        this.root = null;\n        this.nodes = {};\n    }\n    /**\n     * Inserts a node into the dynamic tree\n     */\n    _insert(leaf) {\n        // If there are no nodes in the tree, make this the root leaf\n        if (this.root === null) {\n            this.root = leaf;\n            this.root.parent = null;\n            return;\n        }\n        // Search the tree for a node that is not a leaf and find the best place to insert\n        const leafAABB = leaf.bounds;\n        let currentRoot = this.root;\n        while (!currentRoot.isLeaf()) {\n            const left = currentRoot.left;\n            const right = currentRoot.right;\n            const area = currentRoot.bounds.getPerimeter();\n            const combinedAABB = currentRoot.bounds.combine(leafAABB);\n            const combinedArea = combinedAABB.getPerimeter();\n            // Calculate cost heuristic for creating a new parent and leaf\n            const cost = 2 * combinedArea;\n            // Minimum cost of pushing the leaf down the tree\n            const inheritanceCost = 2 * (combinedArea - area);\n            // Cost of descending\n            let leftCost = 0;\n            const leftCombined = leafAABB.combine(left.bounds);\n            let newArea;\n            let oldArea;\n            if (left.isLeaf()) {\n                leftCost = leftCombined.getPerimeter() + inheritanceCost;\n            }\n            else {\n                oldArea = left.bounds.getPerimeter();\n                newArea = leftCombined.getPerimeter();\n                leftCost = newArea - oldArea + inheritanceCost;\n            }\n            let rightCost = 0;\n            const rightCombined = leafAABB.combine(right.bounds);\n            if (right.isLeaf()) {\n                rightCost = rightCombined.getPerimeter() + inheritanceCost;\n            }\n            else {\n                oldArea = right.bounds.getPerimeter();\n                newArea = rightCombined.getPerimeter();\n                rightCost = newArea - oldArea + inheritanceCost;\n            }\n            // cost is acceptable\n            if (cost < leftCost && cost < rightCost) {\n                break;\n            }\n            // Descend to the depths\n            if (leftCost < rightCost) {\n                currentRoot = left;\n            }\n            else {\n                currentRoot = right;\n            }\n        }\n        // Create the new parent node and insert into the tree\n        const oldParent = currentRoot.parent;\n        const newParent = new TreeNode(oldParent);\n        newParent.bounds = leafAABB.combine(currentRoot.bounds);\n        newParent.height = currentRoot.height + 1;\n        if (oldParent !== null) {\n            // The sibling node was not the root\n            if (oldParent.left === currentRoot) {\n                oldParent.left = newParent;\n            }\n            else {\n                oldParent.right = newParent;\n            }\n            newParent.left = currentRoot;\n            newParent.right = leaf;\n            currentRoot.parent = newParent;\n            leaf.parent = newParent;\n        }\n        else {\n            // The sibling node was the root\n            newParent.left = currentRoot;\n            newParent.right = leaf;\n            currentRoot.parent = newParent;\n            leaf.parent = newParent;\n            this.root = newParent;\n        }\n        // Walk up the tree fixing heights and AABBs\n        let currentNode = leaf.parent;\n        while (currentNode) {\n            currentNode = this._balance(currentNode);\n            if (!currentNode.left) {\n                throw new Error('Parent of current leaf cannot have a null left child' + currentNode);\n            }\n            if (!currentNode.right) {\n                throw new Error('Parent of current leaf cannot have a null right child' + currentNode);\n            }\n            currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\n            currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\n            currentNode = currentNode.parent;\n        }\n    }\n    /**\n     * Removes a node from the dynamic tree\n     */\n    _remove(leaf) {\n        if (leaf === this.root) {\n            this.root = null;\n            return;\n        }\n        const parent = leaf.parent;\n        const grandParent = parent.parent;\n        let sibling;\n        if (parent.left === leaf) {\n            sibling = parent.right;\n        }\n        else {\n            sibling = parent.left;\n        }\n        if (grandParent) {\n            if (grandParent.left === parent) {\n                grandParent.left = sibling;\n            }\n            else {\n                grandParent.right = sibling;\n            }\n            sibling.parent = grandParent;\n            let currentNode = grandParent;\n            while (currentNode) {\n                currentNode = this._balance(currentNode);\n                currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\n                currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\n                currentNode = currentNode.parent;\n            }\n        }\n        else {\n            this.root = sibling;\n            sibling.parent = null;\n        }\n    }\n    /**\n     * Tracks a body in the dynamic tree\n     */\n    trackCollider(collider) {\n        const node = new TreeNode();\n        node.data = collider;\n        node.bounds = collider.bounds;\n        node.bounds.left -= 2;\n        node.bounds.top -= 2;\n        node.bounds.right += 2;\n        node.bounds.bottom += 2;\n        this.nodes[collider.id.value] = node;\n        this._insert(node);\n    }\n    /**\n     * Updates the dynamic tree given the current bounds of each body being tracked\n     */\n    updateCollider(collider) {\n        var _a;\n        const node = this.nodes[collider.id.value];\n        if (!node) {\n            return false;\n        }\n        const b = collider.bounds;\n        // if the body is outside the world no longer update it\n        if (!this.worldBounds.contains(b)) {\n            Logger.getInstance().warn('Collider with id ' + collider.id.value + ' is outside the world bounds and will no longer be tracked for physics');\n            this.untrackCollider(collider);\n            return false;\n        }\n        if (node.bounds.contains(b)) {\n            return false;\n        }\n        this._remove(node);\n        b.left -= this._config.boundsPadding;\n        b.top -= this._config.boundsPadding;\n        b.right += this._config.boundsPadding;\n        b.bottom += this._config.boundsPadding;\n        // THIS IS CAUSING UNNECESSARY CHECKS\n        if (collider.owner) {\n            const body = (_a = collider.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n            if (body) {\n                const multdx = ((body.vel.x * 32) / 1000) * this._config.velocityMultiplier;\n                const multdy = ((body.vel.y * 32) / 1000) * this._config.velocityMultiplier;\n                if (multdx < 0) {\n                    b.left += multdx;\n                }\n                else {\n                    b.right += multdx;\n                }\n                if (multdy < 0) {\n                    b.top += multdy;\n                }\n                else {\n                    b.bottom += multdy;\n                }\n            }\n        }\n        node.bounds = b;\n        this._insert(node);\n        return true;\n    }\n    /**\n     * Untracks a body from the dynamic tree\n     */\n    untrackCollider(collider) {\n        const node = this.nodes[collider.id.value];\n        if (!node) {\n            return;\n        }\n        this._remove(node);\n        this.nodes[collider.id.value] = null;\n        delete this.nodes[collider.id.value];\n    }\n    /**\n     * Balances the tree about a node\n     */\n    _balance(node) {\n        if (node === null) {\n            throw new Error('Cannot balance at null node');\n        }\n        if (node.isLeaf() || node.height < 2) {\n            return node;\n        }\n        const left = node.left;\n        const right = node.right;\n        const a = node;\n        const b = left;\n        const c = right;\n        const d = left.left;\n        const e = left.right;\n        const f = right.left;\n        const g = right.right;\n        const balance = c.height - b.height;\n        // Rotate c node up\n        if (balance > 1) {\n            // Swap the right node with it's parent\n            c.left = a;\n            c.parent = a.parent;\n            a.parent = c;\n            // The original node's old parent should point to the right node\n            // this is mega confusing\n            if (c.parent) {\n                if (c.parent.left === a) {\n                    c.parent.left = c;\n                }\n                else {\n                    c.parent.right = c;\n                }\n            }\n            else {\n                this.root = c;\n            }\n            // Rotate\n            if (f.height > g.height) {\n                c.right = f;\n                a.right = g;\n                g.parent = a;\n                a.bounds = b.bounds.combine(g.bounds);\n                c.bounds = a.bounds.combine(f.bounds);\n                a.height = 1 + Math.max(b.height, g.height);\n                c.height = 1 + Math.max(a.height, f.height);\n            }\n            else {\n                c.right = g;\n                a.right = f;\n                f.parent = a;\n                a.bounds = b.bounds.combine(f.bounds);\n                c.bounds = a.bounds.combine(g.bounds);\n                a.height = 1 + Math.max(b.height, f.height);\n                c.height = 1 + Math.max(a.height, g.height);\n            }\n            return c;\n        }\n        // Rotate left node up\n        if (balance < -1) {\n            // swap\n            b.left = a;\n            b.parent = a.parent;\n            a.parent = b;\n            // node's old parent should point to b\n            if (b.parent) {\n                if (b.parent.left === a) {\n                    b.parent.left = b;\n                }\n                else {\n                    if (b.parent.right !== a) {\n                        throw 'Error rotating Dynamic Tree';\n                    }\n                    b.parent.right = b;\n                }\n            }\n            else {\n                this.root = b;\n            }\n            // rotate\n            if (d.height > e.height) {\n                b.right = d;\n                a.left = e;\n                e.parent = a;\n                a.bounds = c.bounds.combine(e.bounds);\n                b.bounds = a.bounds.combine(d.bounds);\n                a.height = 1 + Math.max(c.height, e.height);\n                b.height = 1 + Math.max(a.height, d.height);\n            }\n            else {\n                b.right = e;\n                a.left = d;\n                d.parent = a;\n                a.bounds = c.bounds.combine(d.bounds);\n                b.bounds = a.bounds.combine(e.bounds);\n                a.height = 1 + Math.max(c.height, d.height);\n                b.height = 1 + Math.max(a.height, e.height);\n            }\n            return b;\n        }\n        return node;\n    }\n    /**\n     * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows\n     */\n    getHeight() {\n        if (this.root === null) {\n            return 0;\n        }\n        return this.root.height;\n    }\n    /**\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.\n     *\n     * In the query callback, it will be passed a potential collider. Returning true from this callback indicates\n     * that you are complete with your query and you do not want to continue. Returning false will continue searching\n     * the tree until all possible colliders have been returned.\n     */\n    query(collider, callback) {\n        const bounds = collider.bounds;\n        const helper = (currentNode) => {\n            if (currentNode && currentNode.bounds.overlaps(bounds)) {\n                if (currentNode.isLeaf() && currentNode.data !== collider) {\n                    if (callback.call(collider, currentNode.data)) {\n                        return true;\n                    }\n                }\n                else {\n                    return helper(currentNode.left) || helper(currentNode.right);\n                }\n            }\n            return false;\n        };\n        helper(this.root);\n    }\n    /**\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely\n     * long ray to test the tree specified by `max`.\n     *\n     * In the query callback, it will be passed a potential body that intersects with the raycast. Returning true from this\n     * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching\n     * the tree until all possible bodies that would intersect with the ray have been returned.\n     */\n    rayCastQuery(ray, max = Infinity, callback) {\n        const helper = (currentNode) => {\n            if (currentNode && currentNode.bounds.rayCast(ray, max)) {\n                if (currentNode.isLeaf()) {\n                    if (callback.call(ray, currentNode.data)) {\n                        // ray hit a leaf! return the body\n                        return true;\n                    }\n                }\n                else {\n                    // ray hit but not at a leaf, recurse deeper\n                    return helper(currentNode.left) || helper(currentNode.right);\n                }\n            }\n            return false; // ray missed\n        };\n        helper(this.root);\n    }\n    getNodes() {\n        const helper = (currentNode) => {\n            if (currentNode) {\n                return [currentNode].concat(helper(currentNode.left), helper(currentNode.right));\n            }\n            else {\n                return [];\n            }\n        };\n        return helper(this.root);\n    }\n    debug(ex) {\n        // draw all the nodes in the Dynamic Tree\n        const helper = (currentNode) => {\n            if (currentNode) {\n                if (currentNode.isLeaf()) {\n                    currentNode.bounds.draw(ex, Color.Green);\n                }\n                else {\n                    currentNode.bounds.draw(ex, Color.White);\n                }\n                if (currentNode.left) {\n                    helper(currentNode.left);\n                }\n                if (currentNode.right) {\n                    helper(currentNode.right);\n                }\n            }\n        };\n        helper(this.root);\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/ray.ts\n/**\n * A 2D ray that can be cast into the scene to do collision detection\n */\nclass Ray {\n    /**\n     * @param pos The starting position for the ray\n     * @param dir The vector indicating the direction of the ray\n     */\n    constructor(pos, dir) {\n        this.pos = pos;\n        this.dir = dir.normalize();\n    }\n    /**\n     * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.\n     * This number indicates the mathematical intersection time.\n     * @param line  The line to test\n     */\n    intersect(line) {\n        const numerator = line.begin.sub(this.pos);\n        // Test is line and ray are parallel and non intersecting\n        if (this.dir.cross(line.getSlope()) === 0 && numerator.cross(this.dir) !== 0) {\n            return -1;\n        }\n        // Lines are parallel\n        const divisor = this.dir.cross(line.getSlope());\n        if (divisor === 0) {\n            return -1;\n        }\n        const t = numerator.cross(line.getSlope()) / divisor;\n        if (t >= 0) {\n            const u = numerator.cross(this.dir) / divisor / line.getLength();\n            if (u >= 0 && u <= 1) {\n                return t;\n            }\n        }\n        return -1;\n    }\n    intersectPoint(line) {\n        const time = this.intersect(line);\n        if (time < 0) {\n            return null;\n        }\n        return this.getPoint(time);\n    }\n    /**\n     * Returns the point of intersection given the intersection time\n     */\n    getPoint(time) {\n        return this.pos.add(this.dir.scale(time));\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTreeCollisionProcessor.ts\n\n\n\n\n\n\n\n\n\n/**\n * Responsible for performing the collision broadphase (locating potential collisions) and\n * the narrowphase (actual collision contacts)\n */\nclass DynamicTreeCollisionProcessor {\n    constructor(_config) {\n        this._config = _config;\n        this._pairs = new Set();\n        this._collisionPairCache = [];\n        this._colliders = [];\n        this._dynamicCollisionTree = new DynamicTree(_config.dynamicTree);\n    }\n    getColliders() {\n        return this._colliders;\n    }\n    rayCast(ray, options) {\n        var _a, _b, _c;\n        const results = [];\n        const maxDistance = (_a = options === null || options === void 0 ? void 0 : options.maxDistance) !== null && _a !== void 0 ? _a : Infinity;\n        const collisionGroup = options === null || options === void 0 ? void 0 : options.collisionGroup;\n        const collisionMask = !collisionGroup ? (_b = options === null || options === void 0 ? void 0 : options.collisionMask) !== null && _b !== void 0 ? _b : CollisionGroup.All.category : collisionGroup.category;\n        const searchAllColliders = (_c = options === null || options === void 0 ? void 0 : options.searchAllColliders) !== null && _c !== void 0 ? _c : false;\n        this._dynamicCollisionTree.rayCastQuery(ray, maxDistance, (collider) => {\n            const owner = collider.owner;\n            const maybeBody = owner.get(BodyComponent);\n            if ((options === null || options === void 0 ? void 0 : options.ignoreCollisionGroupAll) && maybeBody.group === CollisionGroup.All) {\n                return false;\n            }\n            const canCollide = (collisionMask & maybeBody.group.category) !== 0;\n            // Early exit if not the right group\n            if ((maybeBody === null || maybeBody === void 0 ? void 0 : maybeBody.group) && !canCollide) {\n                return false;\n            }\n            const hit = collider.rayCast(ray, maxDistance);\n            if (hit) {\n                if (options === null || options === void 0 ? void 0 : options.filter) {\n                    if (options.filter(hit)) {\n                        results.push(hit);\n                        if (!searchAllColliders) {\n                            // returning true exits the search\n                            return true;\n                        }\n                    }\n                }\n                else {\n                    results.push(hit);\n                    if (!searchAllColliders) {\n                        // returning true exits the search\n                        return true;\n                    }\n                }\n            }\n            return false;\n        });\n        return results;\n    }\n    /**\n     * Tracks a physics body for collisions\n     */\n    track(target) {\n        if (!target) {\n            Logger.getInstance().warn('Cannot track null collider');\n            return;\n        }\n        if (target instanceof CompositeCollider) {\n            const colliders = target.getColliders();\n            for (const c of colliders) {\n                c.owner = target.owner;\n                this._colliders.push(c);\n                this._dynamicCollisionTree.trackCollider(c);\n            }\n        }\n        else {\n            this._colliders.push(target);\n            this._dynamicCollisionTree.trackCollider(target);\n        }\n    }\n    /**\n     * Untracks a physics body\n     */\n    untrack(target) {\n        if (!target) {\n            Logger.getInstance().warn('Cannot untrack a null collider');\n            return;\n        }\n        if (target instanceof CompositeCollider) {\n            const colliders = target.getColliders();\n            for (const c of colliders) {\n                const index = this._colliders.indexOf(c);\n                if (index !== -1) {\n                    this._colliders.splice(index, 1);\n                }\n                this._dynamicCollisionTree.untrackCollider(c);\n            }\n        }\n        else {\n            const index = this._colliders.indexOf(target);\n            if (index !== -1) {\n                this._colliders.splice(index, 1);\n            }\n            this._dynamicCollisionTree.untrackCollider(target);\n        }\n    }\n    _pairExists(colliderA, colliderB) {\n        // if the collision pair has been calculated already short circuit\n        const hash = Pair.calculatePairHash(colliderA.id, colliderB.id);\n        return this._pairs.has(hash);\n    }\n    /**\n     * Detects potential collision pairs in a broadphase approach with the dynamic AABB tree strategy\n     */\n    broadphase(targets, delta, stats) {\n        const seconds = delta / 1000;\n        // Retrieve the list of potential colliders, exclude killed, prevented, and self\n        const potentialColliders = targets.filter((other) => {\n            var _a, _b;\n            const body = (_a = other.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n            return ((_b = other.owner) === null || _b === void 0 ? void 0 : _b.active) && body.collisionType !== CollisionType.PreventCollision;\n        });\n        // clear old list of collision pairs\n        this._collisionPairCache = [];\n        this._pairs.clear();\n        // check for normal collision pairs\n        let collider;\n        for (let j = 0, l = potentialColliders.length; j < l; j++) {\n            collider = potentialColliders[j];\n            // Query the collision tree for potential colliders\n            this._dynamicCollisionTree.query(collider, (other) => {\n                if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\n                    const pair = new Pair(collider, other);\n                    this._pairs.add(pair.id);\n                    this._collisionPairCache.push(pair);\n                }\n                // Always return false, to query whole tree. Returning true in the query method stops searching\n                return false;\n            });\n        }\n        if (stats) {\n            stats.physics.pairs = this._collisionPairCache.length;\n        }\n        // Check dynamic tree for fast moving objects\n        // Fast moving objects are those moving at least there smallest bound per frame\n        if (this._config.continuous.checkForFastBodies) {\n            for (const collider of potentialColliders) {\n                const body = collider.owner.get(BodyComponent);\n                // Skip non-active objects. Does not make sense on other collision types\n                if (body.collisionType !== CollisionType.Active) {\n                    continue;\n                }\n                // Maximum travel distance next frame\n                const updateDistance = body.vel.size * seconds + // velocity term\n                    body.acc.size * 0.5 * seconds * seconds; // acc term\n                // Find the minimum dimension\n                const minDimension = Math.min(collider.bounds.height, collider.bounds.width);\n                if (this._config.continuous.disableMinimumSpeedForFastBody || updateDistance > minDimension / 2) {\n                    if (stats) {\n                        stats.physics.fastBodies++;\n                    }\n                    // start with the oldPos because the integration for actors has already happened\n                    // objects resting on a surface may be slightly penetrating in the current position\n                    const updateVec = body.globalPos.sub(body.oldPos);\n                    const centerPoint = collider.center;\n                    const furthestPoint = collider.getFurthestPoint(body.vel);\n                    const origin = furthestPoint.sub(updateVec);\n                    const ray = new Ray(origin, body.vel);\n                    // back the ray up by -2x surfaceEpsilon to account for fast moving objects starting on the surface\n                    ray.pos = ray.pos.add(ray.dir.scale(-2 * this._config.continuous.surfaceEpsilon));\n                    let minCollider;\n                    let minTranslate = new Vector(Infinity, Infinity);\n                    this._dynamicCollisionTree.rayCastQuery(ray, updateDistance + this._config.continuous.surfaceEpsilon * 2, (other) => {\n                        if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\n                            const hit = other.rayCast(ray, updateDistance + this._config.continuous.surfaceEpsilon * 10);\n                            if (hit) {\n                                const translate = hit.point.sub(origin);\n                                if (translate.size < minTranslate.size) {\n                                    minTranslate = translate;\n                                    minCollider = other;\n                                }\n                            }\n                        }\n                        return false;\n                    });\n                    if (minCollider && Vector.isValid(minTranslate)) {\n                        const pair = new Pair(collider, minCollider);\n                        if (!this._pairs.has(pair.id)) {\n                            this._pairs.add(pair.id);\n                            this._collisionPairCache.push(pair);\n                        }\n                        // move the fast moving object to the other body\n                        // need to push into the surface by ex.Physics.surfaceEpsilon\n                        const shift = centerPoint.sub(furthestPoint);\n                        body.globalPos = origin\n                            .add(shift)\n                            .add(minTranslate)\n                            .add(ray.dir.scale(10 * this._config.continuous.surfaceEpsilon)); // needed to push the shape slightly into contact\n                        collider.update(body.transform.get());\n                        if (stats) {\n                            stats.physics.fastBodyCollisions++;\n                        }\n                    }\n                }\n            }\n        }\n        // return cache\n        return this._collisionPairCache;\n    }\n    /**\n     * Applies narrow phase on collision pairs to find actual area intersections\n     * Adds actual colliding pairs to stats' Frame data\n     */\n    narrowphase(pairs, stats) {\n        let contacts = [];\n        for (let i = 0; i < pairs.length; i++) {\n            const newContacts = pairs[i].collide();\n            contacts = contacts.concat(newContacts);\n            if (stats && newContacts.length > 0) {\n                for (const c of newContacts) {\n                    stats.physics.contacts.set(c.id, c);\n                }\n            }\n        }\n        if (stats) {\n            stats.physics.collisions += contacts.length;\n        }\n        return contacts;\n    }\n    /**\n     * Update the dynamic tree positions\n     */\n    update(targets) {\n        let updated = 0;\n        const len = targets.length;\n        for (let i = 0; i < len; i++) {\n            if (this._dynamicCollisionTree.updateCollider(targets[i])) {\n                updated++;\n            }\n        }\n        return updated;\n    }\n    debug(ex) {\n        this._dynamicCollisionTree.debug(ex);\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Collider.ts\n\n\n\n/**\n * A collision collider specifies the geometry that can detect when other collision colliders intersect\n * for the purposes of colliding 2 objects in excalibur.\n */\nclass Collider {\n    constructor() {\n        this.id = createId('collider', Collider._ID++);\n        /**\n         * Composite collider if any this collider is attached to\n         *\n         * **WARNING** do not tamper with this property\n         */\n        this.composite = null;\n        this.events = new EventEmitter();\n        /**\n         * Pixel offset of the collision collider relative to the collider, by default (0, 0) meaning the collider is positioned\n         * on top of the collider.\n         */\n        this.offset = Vector.Zero;\n    }\n    /**\n     * Returns a boolean indicating whether this body collided with\n     * or was in stationary contact with\n     * the body of the other [[Collider]]\n     */\n    touching(other) {\n        const contact = this.collide(other);\n        if (contact) {\n            return true;\n        }\n        return false;\n    }\n}\nCollider._ID = 0;\n\n;// CONCATENATED MODULE: ./Collision/SolverStrategy.ts\n/**\n * Possible collision resolution strategies\n *\n * The default is [[SolverStrategy.Arcade]] which performs simple axis aligned arcade style physics. This is useful for things\n * like platformers or top down games.\n *\n * More advanced rigid body physics are enabled by setting [[SolverStrategy.Realistic]] which allows for complicated\n * simulated physical interactions.\n */\nvar SolverStrategy;\n(function (SolverStrategy) {\n    SolverStrategy[\"Arcade\"] = \"arcade\";\n    SolverStrategy[\"Realistic\"] = \"realistic\";\n})(SolverStrategy || (SolverStrategy = {}));\n\n;// CONCATENATED MODULE: ./Collision/Physics.ts\n\n\n/**\n * Possible broadphase collision pair identification strategies\n *\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\n * potential collision pairs which is O(nlog(n)) faster.\n * @deprecated Unused in Excalibur, will be removed in v0.30\n */\nvar BroadphaseStrategy;\n(function (BroadphaseStrategy) {\n    BroadphaseStrategy[BroadphaseStrategy[\"DynamicAABBTree\"] = 0] = \"DynamicAABBTree\";\n})(BroadphaseStrategy || (BroadphaseStrategy = {}));\n/**\n * Possible numerical integrators for position and velocity\n * @deprecated Unused in Excalibur, will be removed in v0.30\n */\nvar Integrator;\n(function (Integrator) {\n    Integrator[Integrator[\"Euler\"] = 0] = \"Euler\";\n})(Integrator || (Integrator = {}));\n/**\n * The [[Physics]] object is the global configuration object for all Excalibur physics.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\n/* istanbul ignore next */\nclass Physics {\n    /**\n     * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n     */\n    static get gravity() {\n        return Physics.acc;\n    }\n    static set gravity(v) {\n        Physics.acc = v;\n    }\n    /**\n     * Configures Excalibur to use \"arcade\" physics. Arcade physics which performs simple axis aligned arcade style physics.\n     * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n     */\n    static useArcadePhysics() {\n        Physics.collisionResolutionStrategy = SolverStrategy.Arcade;\n    }\n    /**\n     * Configures Excalibur to use rigid body physics. Rigid body physics allows for complicated\n     * simulated physical interactions.\n     * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n     */\n    static useRealisticPhysics() {\n        Physics.collisionResolutionStrategy = SolverStrategy.Realistic;\n    }\n}\n/**\n * Global acceleration that is applied to all vanilla actors that have a [[CollisionType.Active|active]] collision type.\n * Global acceleration won't effect [[Label|labels]], [[ScreenElement|ui actors]], or [[Trigger|triggers]] in Excalibur.\n *\n * This is a great way to globally simulate effects like gravity.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.acc = new Vector(0, 0);\n/**\n * Globally switches all Excalibur physics behavior on or off.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.enabled = true;\n/**\n * Gets or sets the broadphase pair identification strategy.\n *\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\n * potential collision pairs which is O(nlog(n)) faster.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.broadphaseStrategy = BroadphaseStrategy.DynamicAABBTree;\n/**\n * Gets or sets the global collision resolution strategy (narrowphase).\n *\n * The default is [[SolverStrategy.Arcade]] which performs simple axis aligned arcade style physics.\n *\n * More advanced rigid body physics are enabled by setting [[SolverStrategy.Realistic]] which allows for complicated\n * simulated physical interactions.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.collisionResolutionStrategy = SolverStrategy.Arcade;\n/**\n * The default mass to use if none is specified\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.defaultMass = 10;\n/**\n * Gets or sets the position and velocity positional integrator, currently only Euler is supported.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.integrator = Integrator.Euler;\n/**\n * Factor to add to the RigidBody BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplier);\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.dynamicTreeVelocityMultiplier = 2;\n/**\n * Pad RigidBody BoundingBox by a constant amount\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.boundsPadding = 5;\n/**\n * Number of position iterations (overlap) to run in the solver\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.positionIterations = 3;\n/**\n * Number of velocity iteration (response) to run in the solver\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.velocityIterations = 8;\n/**\n * Amount of overlap to tolerate in pixels\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.slop = 1;\n/**\n * Amount of positional overlap correction to apply each position iteration of the solver\n * O - meaning no correction, 1 - meaning correct all overlap\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.steeringFactor = 0.2;\n/**\n * Warm start set to true re-uses impulses from previous frames back in the solver\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.warmStart = true;\n/**\n * By default bodies do not sleep\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.bodiesCanSleepByDefault = false;\n/**\n * Surface epsilon is used to help deal with surface penetration\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.surfaceEpsilon = 0.1;\n/**\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.sleepEpsilon = 0.07;\n/**\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.wakeThreshold = Physics.sleepEpsilon * 3;\n/**\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.sleepBias = 0.9;\n/**\n * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent\n * bodies from tunneling through one another.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.checkForFastBodies = true;\n/**\n * Disable minimum fast moving body raycast, by default if ex.Physics.checkForFastBodies = true Excalibur will only check if the\n * body is moving at least half of its minimum dimension in an update. If ex.Physics.disableMinimumSpeedForFastBody is set to true,\n * Excalibur will always perform the fast body raycast regardless of speed.\n * @deprecated Use engine args to configure Physics `new ex.Engine({physics: {...}})`, will be removed in v0.30\n */\nPhysics.disableMinimumSpeedForFastBody = false;\n\n;// CONCATENATED MODULE: ./Collision/Solver/ContactBias.ts\n/**\n * Tells the Arcade collision solver to prefer certain contacts over others\n */\nvar ContactSolveBias;\n(function (ContactSolveBias) {\n    ContactSolveBias[\"None\"] = \"none\";\n    ContactSolveBias[\"VerticalFirst\"] = \"vertical-first\";\n    ContactSolveBias[\"HorizontalFirst\"] = \"horizontal-first\";\n})(ContactSolveBias || (ContactSolveBias = {}));\n/**\n * Vertical First contact solve bias Used by the [[ArcadeSolver]] to sort contacts\n */\nconst VerticalFirst = {\n    'vertical': 1,\n    'horizontal': 2\n};\n/**\n * Horizontal First contact solve bias Used by the [[ArcadeSolver]] to sort contacts\n */\nconst HorizontalFirst = {\n    'horizontal': 1,\n    'vertical': 2\n};\n/**\n * None value, [[ArcadeSolver]] sorts contacts using distance by default\n */\nconst None = {\n    'horizontal': 0,\n    'vertical': 0\n};\n\n;// CONCATENATED MODULE: ./Collision/PhysicsConfig.ts\n\n\n\n\nconst DefaultPhysicsConfig = {\n    enabled: true,\n    gravity: vec(0, 0),\n    solver: SolverStrategy.Arcade,\n    colliders: {\n        compositeStrategy: 'together'\n    },\n    continuous: {\n        checkForFastBodies: true,\n        disableMinimumSpeedForFastBody: false,\n        surfaceEpsilon: 0.1\n    },\n    bodies: {\n        canSleepByDefault: false,\n        sleepEpsilon: 0.07,\n        wakeThreshold: 0.07 * 3,\n        sleepBias: 0.9,\n        defaultMass: 10\n    },\n    dynamicTree: {\n        boundsPadding: 5,\n        velocityMultiplier: 2\n    },\n    arcade: {\n        contactSolveBias: ContactSolveBias.None\n    },\n    realistic: {\n        positionIterations: 3,\n        velocityIterations: 8,\n        slop: 1,\n        steeringFactor: 0.2,\n        warmStart: true\n    }\n};\n/**\n * @deprecated will be removed in v0.30\n */\nfunction DeprecatedStaticToConfig() {\n    return {\n        enabled: Physics.enabled,\n        gravity: Physics.gravity,\n        solver: Physics.collisionResolutionStrategy,\n        continuous: {\n            checkForFastBodies: Physics.checkForFastBodies,\n            disableMinimumSpeedForFastBody: Physics.disableMinimumSpeedForFastBody,\n            surfaceEpsilon: Physics.surfaceEpsilon\n        },\n        colliders: {\n            compositeStrategy: 'together'\n        },\n        bodies: {\n            canSleepByDefault: Physics.bodiesCanSleepByDefault,\n            sleepEpsilon: Physics.sleepEpsilon,\n            wakeThreshold: Physics.wakeThreshold,\n            sleepBias: Physics.sleepBias,\n            defaultMass: Physics.defaultMass\n        },\n        dynamicTree: {\n            boundsPadding: Physics.boundsPadding,\n            velocityMultiplier: Physics.dynamicTreeVelocityMultiplier\n        },\n        arcade: {\n            contactSolveBias: ContactSolveBias.None\n        },\n        realistic: {\n            positionIterations: Physics.positionIterations,\n            velocityIterations: Physics.velocityIterations,\n            slop: Physics.slop,\n            steeringFactor: Physics.steeringFactor,\n            warmStart: Physics.warmStart\n        }\n    };\n}\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CompositeCollider.ts\n\n\n\n\n\n\n\n\n\nclass CompositeCollider extends Collider {\n    /**\n     * Treat composite collider's member colliders as either separate colliders for the purposes of onCollisionStart/onCollision\n     * or as a single collider together.\n     *\n     * This property can be overridden on individual [[CompositeColliders]].\n     *\n     * For composites without gaps or small groups of colliders, you probably want 'together'\n     *\n     * For composites with deliberate gaps, like a platforming level layout, you probably want 'separate'\n     *\n     * Default is 'together' if unset\n     */\n    set compositeStrategy(value) {\n        this._compositeStrategy = value;\n    }\n    get compositeStrategy() {\n        return this._compositeStrategy;\n    }\n    constructor(colliders) {\n        super();\n        this._collisionProcessor = new DynamicTreeCollisionProcessor(DefaultPhysicsConfig);\n        this._dynamicAABBTree = new DynamicTree(DefaultPhysicsConfig.dynamicTree);\n        this._colliders = [];\n        for (const c of colliders) {\n            this.addCollider(c);\n        }\n    }\n    clearColliders() {\n        this._colliders = [];\n    }\n    addCollider(collider) {\n        let colliders;\n        if (collider instanceof CompositeCollider) {\n            colliders = collider.getColliders();\n            colliders.forEach(c => c.offset.addEqual(collider.offset));\n        }\n        else {\n            colliders = [collider];\n        }\n        // Flatten composites\n        for (const c of colliders) {\n            c.events.pipe(this.events);\n            c.composite = this;\n            this._colliders.push(c);\n            this._collisionProcessor.track(c);\n            this._dynamicAABBTree.trackCollider(c);\n        }\n    }\n    removeCollider(collider) {\n        collider.events.pipe(this.events);\n        collider.composite = null;\n        removeItemFromArray(collider, this._colliders);\n        this._collisionProcessor.untrack(collider);\n        this._dynamicAABBTree.untrackCollider(collider);\n    }\n    getColliders() {\n        return this._colliders;\n    }\n    get worldPos() {\n        var _a, _b;\n        return ((_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero).add(this.offset);\n    }\n    get center() {\n        var _a, _b;\n        return ((_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero).add(this.offset);\n    }\n    get bounds() {\n        var _a, _b;\n        // TODO cache this\n        const colliders = this.getColliders();\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.bounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox().translate(this.worldPos));\n        return results.translate(this.offset);\n    }\n    get localBounds() {\n        var _a, _b;\n        // TODO cache this\n        const colliders = this.getColliders();\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.localBounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox());\n        return results;\n    }\n    get axes() {\n        // TODO cache this\n        const colliders = this.getColliders();\n        let axes = [];\n        for (const collider of colliders) {\n            axes = axes.concat(collider.axes);\n        }\n        return axes;\n    }\n    getFurthestPoint(direction) {\n        const colliders = this.getColliders();\n        const furthestPoints = [];\n        for (const collider of colliders) {\n            furthestPoints.push(collider.getFurthestPoint(direction));\n        }\n        // Pick best point from all colliders\n        let bestPoint = furthestPoints[0];\n        let maxDistance = -Number.MAX_VALUE;\n        for (const point of furthestPoints) {\n            const distance = point.dot(direction);\n            if (distance > maxDistance) {\n                bestPoint = point;\n                maxDistance = distance;\n            }\n        }\n        return bestPoint;\n    }\n    getInertia(mass) {\n        const colliders = this.getColliders();\n        let totalInertia = 0;\n        for (const collider of colliders) {\n            totalInertia += collider.getInertia(mass);\n        }\n        return totalInertia;\n    }\n    collide(other) {\n        let otherColliders = [other];\n        if (other instanceof CompositeCollider) {\n            otherColliders = other.getColliders();\n        }\n        const pairs = [];\n        for (const c of otherColliders) {\n            this._dynamicAABBTree.query(c, (potentialCollider) => {\n                pairs.push(new Pair(c, potentialCollider));\n                return false;\n            });\n        }\n        let contacts = [];\n        for (const p of pairs) {\n            contacts = contacts.concat(p.collide());\n        }\n        return contacts;\n    }\n    getClosestLineBetween(other) {\n        const colliders = this.getColliders();\n        const lines = [];\n        if (other instanceof CompositeCollider) {\n            const otherColliders = other.getColliders();\n            for (const colliderA of colliders) {\n                for (const colliderB of otherColliders) {\n                    const maybeLine = colliderA.getClosestLineBetween(colliderB);\n                    if (maybeLine) {\n                        lines.push(maybeLine);\n                    }\n                }\n            }\n        }\n        else {\n            for (const collider of colliders) {\n                const maybeLine = other.getClosestLineBetween(collider);\n                if (maybeLine) {\n                    lines.push(maybeLine);\n                }\n            }\n        }\n        if (lines.length) {\n            let minLength = lines[0].getLength();\n            let minLine = lines[0];\n            for (const line of lines) {\n                const length = line.getLength();\n                if (length < minLength) {\n                    minLength = length;\n                    minLine = line;\n                }\n            }\n            return minLine;\n        }\n        return null;\n    }\n    contains(point) {\n        const colliders = this.getColliders();\n        for (const collider of colliders) {\n            if (collider.contains(point)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    rayCast(ray, max) {\n        const colliders = this.getColliders();\n        const hits = [];\n        for (const collider of colliders) {\n            const hit = collider.rayCast(ray, max);\n            if (hit) {\n                hits.push(hit);\n            }\n        }\n        if (hits.length) {\n            let minHit = hits[0];\n            let minDistance = minHit.point.dot(ray.dir);\n            for (const hit of hits) {\n                const distance = ray.dir.dot(hit.point);\n                if (distance < minDistance) {\n                    minHit = hit;\n                    minDistance = distance;\n                }\n            }\n            return minHit;\n        }\n        return null;\n    }\n    project(axis) {\n        const colliders = this.getColliders();\n        const projections = [];\n        for (const collider of colliders) {\n            const proj = collider.project(axis);\n            if (proj) {\n                projections.push(proj);\n            }\n        }\n        // Merge all proj's on the same axis\n        if (projections.length) {\n            const newProjection = new Projection(projections[0].min, projections[0].max);\n            for (const proj of projections) {\n                newProjection.min = Math.min(proj.min, newProjection.min);\n                newProjection.max = Math.max(proj.max, newProjection.max);\n            }\n            return newProjection;\n        }\n        return null;\n    }\n    update(transform) {\n        if (transform) {\n            const colliders = this.getColliders();\n            for (const collider of colliders) {\n                collider.owner = this.owner;\n                collider.update(transform);\n            }\n        }\n    }\n    debug(ex, color, options) {\n        const colliders = this.getColliders();\n        ex.save();\n        ex.translate(this.offset.x, this.offset.y);\n        for (const collider of colliders) {\n            collider.debug(ex, color, options);\n        }\n        ex.restore();\n    }\n    clone() {\n        const result = new CompositeCollider(this._colliders.map((c) => c.clone()));\n        result.offset = this.offset.clone();\n        return result;\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/line-segment.ts\n\n/**\n * A 2D line segment\n */\nclass LineSegment {\n    /**\n     * @param begin  The starting point of the line segment\n     * @param end  The ending point of the line segment\n     */\n    constructor(begin, end) {\n        this.begin = begin;\n        this.end = end;\n    }\n    /**\n     * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.\n     */\n    get slope() {\n        return (this.end.y - this.begin.y) / (this.end.x - this.begin.x);\n    }\n    /**\n     * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.\n     */\n    get intercept() {\n        return this.begin.y - this.slope * this.begin.x;\n    }\n    /**\n     * Gets the normal of the line\n     */\n    normal() {\n        if (this._normal) {\n            return this._normal;\n        }\n        return this._normal = this.end.sub(this.begin).normal();\n    }\n    dir() {\n        if (this._dir) {\n            return this._dir;\n        }\n        return this._dir = this.end.sub(this.begin);\n    }\n    getPoints() {\n        return [this.begin, this.end];\n    }\n    /**\n     * Returns the slope of the line in the form of a vector of length 1\n     */\n    getSlope() {\n        if (this._slope) {\n            return this._slope;\n        }\n        const begin = this.begin;\n        const end = this.end;\n        const distance = begin.distance(end);\n        return this._slope = end.sub(begin).scale(1 / distance);\n    }\n    /**\n     * Returns the edge of the line as vector, the length of the vector is the length of the edge\n     */\n    getEdge() {\n        const begin = this.begin;\n        const end = this.end;\n        return end.sub(begin);\n    }\n    /**\n     * Returns the length of the line segment in pixels\n     */\n    getLength() {\n        if (this._length) {\n            return this._length;\n        }\n        const begin = this.begin;\n        const end = this.end;\n        const distance = begin.distance(end);\n        return this._length = distance;\n    }\n    /**\n     * Returns the midpoint of the edge\n     */\n    get midpoint() {\n        return this.begin.add(this.end).scale(0.5);\n    }\n    /**\n     * Flips the direction of the line segment\n     */\n    flip() {\n        return new LineSegment(this.end, this.begin);\n    }\n    /**\n     * Tests if a given point is below the line, points in the normal direction above the line are considered above.\n     * @param point\n     */\n    below(point) {\n        const above2 = (this.end.x - this.begin.x) * (point.y - this.begin.y) - (this.end.y - this.begin.y) * (point.x - this.begin.x);\n        return above2 >= 0;\n    }\n    /**\n     * Returns the clip point\n     * @param sideVector Vector that traces the line\n     * @param length Length to clip along side\n     */\n    clip(sideVector, length) {\n        let dir = sideVector;\n        dir = dir.normalize();\n        const near = dir.dot(this.begin) - length;\n        const far = dir.dot(this.end) - length;\n        const results = [];\n        if (near <= 0) {\n            results.push(this.begin);\n        }\n        if (far <= 0) {\n            results.push(this.end);\n        }\n        if (near * far < 0) {\n            const clipTime = near / (near - far);\n            results.push(this.begin.add(this.end.sub(this.begin).scale(clipTime)));\n        }\n        if (results.length !== 2) {\n            return null;\n        }\n        return new LineSegment(results[0], results[1]);\n    }\n    /**\n     * Find the perpendicular distance from the line to a point\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\n     * @param point\n     */\n    distanceToPoint(point, signed = false) {\n        const x0 = point.x;\n        const y0 = point.y;\n        const l = this.getLength();\n        const dy = this.end.y - this.begin.y;\n        const dx = this.end.x - this.begin.x;\n        const distance = (dy * x0 - dx * y0 + this.end.x * this.begin.y - this.end.y * this.begin.x) / l;\n        return signed ? distance : Math.abs(distance);\n    }\n    /**\n     * Find the perpendicular line from the line to a point\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\n     * (a - p) - ((a - p) * n)n\n     * a is a point on the line\n     * p is the arbitrary point above the line\n     * n is a unit vector in direction of the line\n     * @param point\n     */\n    findVectorToPoint(point) {\n        const aMinusP = this.begin.sub(point);\n        const n = this.getSlope();\n        return aMinusP.sub(n.scale(aMinusP.dot(n)));\n    }\n    /**\n     * Finds a point on the line given only an X or a Y value. Given an X value, the function returns\n     * a new point with the calculated Y value and vice-versa.\n     * @param x The known X value of the target point\n     * @param y The known Y value of the target point\n     * @returns A new point with the other calculated axis value\n     */\n    findPoint(x = null, y = null) {\n        const m = this.slope;\n        const b = this.intercept;\n        if (x !== null) {\n            return new Vector(x, m * x + b);\n        }\n        else if (y !== null) {\n            return new Vector((y - b) / m, y);\n        }\n        else {\n            throw new Error('You must provide an X or a Y value');\n        }\n    }\n    /**\n     * @see http://stackoverflow.com/a/11908158/109458\n     */\n    hasPoint() {\n        let currPoint;\n        let threshold = 0;\n        if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\n            currPoint = new Vector(arguments[0], arguments[1]);\n            threshold = arguments[2] || 0;\n        }\n        else if (arguments[0] instanceof Vector) {\n            currPoint = arguments[0];\n            threshold = arguments[1] || 0;\n        }\n        else {\n            throw 'Could not determine the arguments for Vector.hasPoint';\n        }\n        const dxc = currPoint.x - this.begin.x;\n        const dyc = currPoint.y - this.begin.y;\n        const dx1 = this.end.x - this.begin.x;\n        const dy1 = this.end.y - this.begin.y;\n        const cross = dxc * dy1 - dyc * dx1;\n        // check whether point lines on the line\n        if (Math.abs(cross) > threshold) {\n            return false;\n        }\n        // check whether point lies in-between start and end\n        if (Math.abs(dx1) >= Math.abs(dy1)) {\n            return dx1 > 0 ? this.begin.x <= currPoint.x && currPoint.x <= this.end.x : this.end.x <= currPoint.x && currPoint.x <= this.begin.x;\n        }\n        else {\n            return dy1 > 0 ? this.begin.y <= currPoint.y && currPoint.y <= this.end.y : this.end.y <= currPoint.y && currPoint.y <= this.begin.y;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Colliders/ClosestLineJumpTable.ts\n\n\n\n/**\n * Finds the closes line between 2 line segments, were the magnitude of u, v are the lengths of each segment\n * L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n * L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n * @param p0 Point where L1 begins\n * @param u Direction and length of L1\n * @param q0 Point were L2 begins\n * @param v Direction and length of L2\n */\nfunction ClosestLine(p0, u, q0, v) {\n    // Distance between 2 lines http://geomalgorithms.com/a07-_distance.html\n    // w(s, t) = P(s) - Q(t)\n    // The w(s, t) that has the minimum distance we will say is w(sClosest, tClosest) = wClosest\n    //\n    // wClosest is the vector that is uniquely perpendicular to the 2 line directions u & v.\n    // wClosest = w0 + sClosest * u - tClosest * v, where w0 is p0 - q0\n    //\n    // The closest point between 2 lines then satisfies this pair of equations\n    // 1: u * wClosest = 0\n    // 2: v * wClosest = 0\n    //\n    // Substituting wClosest into the equations we get\n    //\n    // 1: (u * u) * sClosest - (u * v) tClosest = -u * w0\n    // 2: (v * u) * sClosest - (v * v) tClosest = -v * w0\n    // simplify w0\n    const w0 = p0.sub(q0);\n    // simplify (u * u);\n    const a = u.dot(u);\n    // simplify (u * v);\n    const b = u.dot(v);\n    // simplify (v * v)\n    const c = v.dot(v);\n    // simplify (u * w0)\n    const d = u.dot(w0);\n    // simplify (v * w0)\n    const e = v.dot(w0);\n    // denominator ac - b^2\n    const denom = a * c - b * b;\n    let sDenom = denom;\n    let tDenom = denom;\n    // if denom is 0 they are parallel, use any point from either as the start in this case p0\n    if (denom === 0 || denom <= 0.01) {\n        const tClosestParallel = d / b;\n        return new LineSegment(p0, q0.add(v.scale(tClosestParallel)));\n    }\n    // Solve for sClosest for infinite line\n    let sClosest = b * e - c * d; // / denom;\n    // Solve for tClosest for infinite line\n    let tClosest = a * e - b * d; // / denom;\n    // Solve for segments candidate edges, if sClosest and tClosest are outside their segments\n    if (sClosest < 0) {\n        sClosest = 0;\n        tClosest = e;\n        tDenom = c;\n    }\n    else if (sClosest > sDenom) {\n        sClosest = sDenom;\n        tClosest = e + b;\n        tDenom = c;\n    }\n    if (tClosest < 0) {\n        tClosest = 0;\n        if (-d < 0) {\n            sClosest = 0;\n        }\n        else if (-d > a) {\n            sClosest = sDenom;\n        }\n        else {\n            sClosest = -d;\n            sDenom = a;\n        }\n    }\n    else if (tClosest > tDenom) {\n        tClosest = tDenom;\n        if (-d + b < 0) {\n            sClosest = 0;\n        }\n        else if (-d + b > a) {\n            sClosest = sDenom;\n        }\n        else {\n            sClosest = -d + b;\n            sDenom = a;\n        }\n    }\n    sClosest = Math.abs(sClosest) < 0.001 ? 0 : sClosest / sDenom;\n    tClosest = Math.abs(tClosest) < 0.001 ? 0 : tClosest / tDenom;\n    return new LineSegment(p0.add(u.scale(sClosest)), q0.add(v.scale(tClosest)));\n}\nconst ClosestLineJumpTable = {\n    PolygonPolygonClosestLine(polygonA, polygonB) {\n        // Find the 2 closest faces on each polygon\n        const otherWorldPos = polygonB.worldPos;\n        const otherDirection = otherWorldPos.sub(polygonA.worldPos);\n        const thisDirection = otherDirection.negate();\n        const rayTowardsOther = new Ray(polygonA.worldPos, otherDirection);\n        const rayTowardsThis = new Ray(otherWorldPos, thisDirection);\n        const thisPoint = polygonA.rayCast(rayTowardsOther).point.add(rayTowardsOther.dir.scale(0.1));\n        const otherPoint = polygonB.rayCast(rayTowardsThis).point.add(rayTowardsThis.dir.scale(0.1));\n        const thisFace = polygonA.getClosestFace(thisPoint);\n        const otherFace = polygonB.getClosestFace(otherPoint);\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n        const p0 = thisFace.face.begin;\n        const u = thisFace.face.getEdge();\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n        const q0 = otherFace.face.begin;\n        const v = otherFace.face.getEdge();\n        return ClosestLine(p0, u, q0, v);\n    },\n    PolygonEdgeClosestLine(polygon, edge) {\n        // Find the 2 closest faces on each polygon\n        const otherWorldPos = edge.worldPos;\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection);\n        const thisPoint = polygon.rayCast(rayTowardsOther).point.add(rayTowardsOther.dir.scale(0.1));\n        const thisFace = polygon.getClosestFace(thisPoint);\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n        const p0 = thisFace.face.begin;\n        const u = thisFace.face.getEdge();\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n        const edgeLine = edge.asLine();\n        const edgeStart = edgeLine.begin;\n        const edgeVector = edgeLine.getEdge();\n        const q0 = edgeStart;\n        const v = edgeVector;\n        return ClosestLine(p0, u, q0, v);\n    },\n    PolygonCircleClosestLine(polygon, circle) {\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\n        // Find the 2 closest faces on each polygon\n        const otherWorldPos = circle.worldPos;\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection.normalize());\n        const thisPoint = polygon.rayCast(rayTowardsOther).point.add(rayTowardsOther.dir.scale(0.1));\n        const thisFace = polygon.getClosestFace(thisPoint);\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n        const p0 = thisFace.face.begin;\n        const u = thisFace.face.getEdge();\n        // Time of minimum distance\n        let t = (u.x * (otherWorldPos.x - p0.x) + u.y * (otherWorldPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\n        // If time of minimum is past the edge clamp\n        if (t > 1) {\n            t = 1;\n        }\n        else if (t < 0) {\n            t = 0;\n        }\n        // Minimum distance\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - otherWorldPos.x, 2) + Math.pow(p0.y + u.y * t - otherWorldPos.y, 2)) - circle.radius;\n        const circlex = ((p0.x + u.x * t - otherWorldPos.x) * circle.radius) / (circle.radius + d);\n        const circley = ((p0.y + u.y * t - otherWorldPos.y) * circle.radius) / (circle.radius + d);\n        return new LineSegment(u.scale(t).add(p0), new Vector(otherWorldPos.x + circlex, otherWorldPos.y + circley));\n    },\n    CircleCircleClosestLine(circleA, circleB) {\n        // Find the 2 closest faces on each polygon\n        const otherWorldPos = circleB.worldPos;\n        const otherDirection = otherWorldPos.sub(circleA.worldPos);\n        const thisWorldPos = circleA.worldPos;\n        const thisDirection = thisWorldPos.sub(circleB.worldPos);\n        const rayTowardsOther = new Ray(circleA.worldPos, otherDirection);\n        const rayTowardsThis = new Ray(circleB.worldPos, thisDirection);\n        const thisPoint = circleA.rayCast(rayTowardsOther);\n        const otherPoint = circleB.rayCast(rayTowardsThis);\n        return new LineSegment(thisPoint.point, otherPoint.point);\n    },\n    CircleEdgeClosestLine(circle, edge) {\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\n        const circleWorldPos = circle.worldPos;\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n        const edgeLine = edge.asLine();\n        const edgeStart = edgeLine.begin;\n        const edgeVector = edgeLine.getEdge();\n        const p0 = edgeStart;\n        const u = edgeVector;\n        // Time of minimum distance\n        let t = (u.x * (circleWorldPos.x - p0.x) + u.y * (circleWorldPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\n        // If time of minimum is past the edge clamp to edge\n        if (t > 1) {\n            t = 1;\n        }\n        else if (t < 0) {\n            t = 0;\n        }\n        // Minimum distance\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - circleWorldPos.x, 2) + Math.pow(p0.y + u.y * t - circleWorldPos.y, 2)) - circle.radius;\n        const circlex = ((p0.x + u.x * t - circleWorldPos.x) * circle.radius) / (circle.radius + d);\n        const circley = ((p0.y + u.y * t - circleWorldPos.y) * circle.radius) / (circle.radius + d);\n        return new LineSegment(u.scale(t).add(p0), new Vector(circleWorldPos.x + circlex, circleWorldPos.y + circley));\n    },\n    EdgeEdgeClosestLine(edgeA, edgeB) {\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\n        const edgeLineA = edgeA.asLine();\n        const edgeStartA = edgeLineA.begin;\n        const edgeVectorA = edgeLineA.getEdge();\n        const p0 = edgeStartA;\n        const u = edgeVectorA;\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\n        const edgeLineB = edgeB.asLine();\n        const edgeStartB = edgeLineB.begin;\n        const edgeVectorB = edgeLineB.getEdge();\n        const q0 = edgeStartB;\n        const v = edgeVectorB;\n        return ClosestLine(p0, u, q0, v);\n    }\n};\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CircleCollider.ts\n\n\n\n\n\n\n\n\n\n\n\n/**\n * This is a circle collider for the excalibur rigid body physics simulation\n */\nclass CircleCollider extends Collider {\n    get worldPos() {\n        return this._globalMatrix.getPosition();\n    }\n    /**\n     * Get the radius of the circle\n     */\n    get radius() {\n        var _a;\n        const tx = this._transform;\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\n        return this._naturalRadius * Math.min(scale.x, scale.y);\n    }\n    /**\n     * Set the radius of the circle\n     */\n    set radius(val) {\n        var _a;\n        const tx = this._transform;\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\n        this._naturalRadius = val / Math.min(scale.x, scale.y);\n    }\n    constructor(options) {\n        super();\n        /**\n         * Position of the circle relative to the collider, by default (0, 0).\n         */\n        this.offset = Vector.Zero;\n        this._globalMatrix = AffineMatrix.identity();\n        this.offset = options.offset || Vector.Zero;\n        this.radius = options.radius || 0;\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\n    }\n    /**\n     * Returns a clone of this shape, not associated with any collider\n     */\n    clone() {\n        return new CircleCollider({\n            offset: this.offset.clone(),\n            radius: this.radius\n        });\n    }\n    /**\n     * Get the center of the collider in world coordinates\n     */\n    get center() {\n        return this._globalMatrix.getPosition();\n    }\n    /**\n     * Tests if a point is contained in this collider\n     */\n    contains(point) {\n        var _a, _b;\n        const pos = (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : this.offset;\n        const distance = pos.distance(point);\n        if (distance <= this.radius) {\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Casts a ray at the Circle collider and returns the nearest point of collision\n     * @param ray\n     */\n    rayCast(ray, max = Infinity) {\n        var _a, _b;\n        //https://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection\n        const c = this.center;\n        const dir = ray.dir;\n        const orig = ray.pos;\n        const discriminant = Math.sqrt(Math.pow(dir.dot(orig.sub(c)), 2) - Math.pow(orig.sub(c).distance(), 2) + Math.pow(this.radius, 2));\n        if (discriminant < 0) {\n            // no intersection\n            return null;\n        }\n        else {\n            let toi = 0;\n            // tangent case\n            if (discriminant === 0) {\n                toi = -dir.dot(orig.sub(c));\n                if (toi > 0 && toi < max) {\n                    const point = ray.getPoint(toi);\n                    return {\n                        point,\n                        normal: point.sub(c).normalize(),\n                        collider: this,\n                        body: (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent),\n                        distance: toi\n                    };\n                }\n                return null;\n            }\n            else { // two point\n                const toi1 = -dir.dot(orig.sub(c)) + discriminant;\n                const toi2 = -dir.dot(orig.sub(c)) - discriminant;\n                const positiveToi = [];\n                if (toi1 >= 0) {\n                    positiveToi.push(toi1);\n                }\n                if (toi2 >= 0) {\n                    positiveToi.push(toi2);\n                }\n                const minToi = Math.min(...positiveToi);\n                if (minToi <= max) {\n                    const point = ray.getPoint(minToi);\n                    return {\n                        point,\n                        normal: point.sub(c).normalize(),\n                        collider: this,\n                        body: (_b = this.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent),\n                        distance: minToi\n                    };\n                }\n                return null;\n            }\n        }\n    }\n    getClosestLineBetween(shape) {\n        if (shape instanceof CircleCollider) {\n            return ClosestLineJumpTable.CircleCircleClosestLine(this, shape);\n        }\n        else if (shape instanceof PolygonCollider) {\n            return ClosestLineJumpTable.PolygonCircleClosestLine(shape, this).flip();\n        }\n        else if (shape instanceof EdgeCollider) {\n            return ClosestLineJumpTable.CircleEdgeClosestLine(this, shape).flip();\n        }\n        else {\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\n        }\n    }\n    /**\n     * @inheritdoc\n     */\n    collide(collider) {\n        if (collider instanceof CircleCollider) {\n            return CollisionJumpTable.CollideCircleCircle(this, collider);\n        }\n        else if (collider instanceof PolygonCollider) {\n            return CollisionJumpTable.CollideCirclePolygon(this, collider);\n        }\n        else if (collider instanceof EdgeCollider) {\n            return CollisionJumpTable.CollideCircleEdge(this, collider);\n        }\n        else {\n            throw new Error(`Circle could not collide with unknown CollisionShape ${typeof collider}`);\n        }\n    }\n    /**\n     * Find the point on the collider furthest in the direction specified\n     */\n    getFurthestPoint(direction) {\n        return this.center.add(direction.normalize().scale(this.radius));\n    }\n    /**\n     * Find the local point on the shape in the direction specified\n     * @param direction\n     */\n    getFurthestLocalPoint(direction) {\n        const dir = direction.normalize();\n        return dir.scale(this.radius);\n    }\n    /**\n     * Get the axis aligned bounding box for the circle collider in world coordinates\n     */\n    get bounds() {\n        var _a, _b, _c;\n        const tx = this._transform;\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius).rotate(rotation).scale(scale).translate(pos);\n    }\n    /**\n     * Get the axis aligned bounding box for the circle collider in local coordinates\n     */\n    get localBounds() {\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius);\n    }\n    /**\n     * Get axis not implemented on circles, since there are infinite axis in a circle\n     */\n    get axes() {\n        return [];\n    }\n    /**\n     * Returns the moment of inertia of a circle given it's mass\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n     */\n    getInertia(mass) {\n        return (mass * this.radius * this.radius) / 2;\n    }\n    /* istanbul ignore next */\n    update(transform) {\n        var _a;\n        this._transform = transform;\n        const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\n        globalMat.clone(this._globalMatrix);\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\n    }\n    /**\n     * Project the circle along a specified axis\n     */\n    project(axis) {\n        const scalars = [];\n        const point = this.center;\n        const dotProduct = point.dot(axis);\n        scalars.push(dotProduct);\n        scalars.push(dotProduct + this.radius);\n        scalars.push(dotProduct - this.radius);\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\n    }\n    debug(ex, color, options) {\n        var _a, _b, _c, _d;\n        const { lineWidth } = { ...{ lineWidth: 1 }, ...options };\n        const tx = this._transform;\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\n        ex.save();\n        ex.translate(pos.x, pos.y);\n        ex.rotate(rotation);\n        ex.scale(scale.x, scale.y);\n        ex.drawCircle(((_d = this.offset) !== null && _d !== void 0 ? _d : Vector.Zero), this._naturalRadius, Color.Transparent, color, lineWidth);\n        ex.restore();\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Detection/CollisionContact.ts\n\n\n\n/**\n * Collision contacts are used internally by Excalibur to resolve collision between colliders. This\n * Pair prevents collisions from being evaluated more than one time\n */\nclass CollisionContact {\n    constructor(colliderA, colliderB, mtv, normal, tangent, points, localPoints, info) {\n        var _a, _b, _c, _d, _e, _f;\n        this._canceled = false;\n        this.colliderA = colliderA;\n        this.colliderB = colliderB;\n        this.mtv = mtv;\n        this.normal = normal;\n        this.tangent = tangent;\n        this.points = points;\n        this.localPoints = localPoints;\n        this.info = info;\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\n        if (colliderA.composite || colliderB.composite) {\n            // Add on the parent composite pair for start/end contact if 'together\n            const colliderAId = ((_a = colliderA.composite) === null || _a === void 0 ? void 0 : _a.compositeStrategy) === 'separate' ? colliderA.id : (_c = (_b = colliderA.composite) === null || _b === void 0 ? void 0 : _b.id) !== null && _c !== void 0 ? _c : colliderA.id;\n            const colliderBId = ((_d = colliderB.composite) === null || _d === void 0 ? void 0 : _d.compositeStrategy) === 'separate' ? colliderB.id : (_f = (_e = colliderB.composite) === null || _e === void 0 ? void 0 : _e.id) !== null && _f !== void 0 ? _f : colliderB.id;\n            this.id += '|' + Pair.calculatePairHash(colliderAId, colliderBId);\n        }\n    }\n    /**\n     * Match contact awake state, except if body's are Fixed\n     */\n    matchAwake() {\n        const bodyA = this.colliderA.owner.get(BodyComponent);\n        const bodyB = this.colliderB.owner.get(BodyComponent);\n        if (bodyA && bodyB) {\n            if (bodyA.sleeping !== bodyB.sleeping) {\n                if (bodyA.sleeping && bodyA.collisionType !== CollisionType.Fixed && bodyB.sleepMotion >= bodyA.wakeThreshold) {\n                    bodyA.setSleeping(false);\n                }\n                if (bodyB.sleeping && bodyB.collisionType !== CollisionType.Fixed && bodyA.sleepMotion >= bodyB.wakeThreshold) {\n                    bodyB.setSleeping(false);\n                }\n            }\n        }\n    }\n    isCanceled() {\n        return this._canceled;\n    }\n    cancel() {\n        this._canceled = true;\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Colliders/SeparatingAxis.ts\nclass SeparatingAxis {\n    static findPolygonPolygonSeparation(polyA, polyB) {\n        let bestSeparation = -Number.MAX_VALUE;\n        let bestSide = null;\n        let bestAxis = null;\n        let bestSideIndex = -1;\n        let bestOtherPoint = null;\n        const sides = polyA.getSides();\n        const localSides = polyA.getLocalSides();\n        for (let i = 0; i < sides.length; i++) {\n            const side = sides[i];\n            const axis = side.normal();\n            const vertB = polyB.getFurthestPoint(axis.negate());\n            // Separation on side i's axis\n            // We are looking for the largest separation between poly A's sides\n            const vertSeparation = side.distanceToPoint(vertB, true);\n            if (vertSeparation > bestSeparation) {\n                bestSeparation = vertSeparation;\n                bestSide = side;\n                bestAxis = axis;\n                bestSideIndex = i;\n                bestOtherPoint = vertB;\n            }\n        }\n        return {\n            collider: polyA,\n            separation: bestAxis ? bestSeparation : 99,\n            axis: bestAxis,\n            side: bestSide,\n            localSide: localSides[bestSideIndex],\n            sideId: bestSideIndex,\n            point: bestOtherPoint,\n            localPoint: bestAxis ? polyB.getFurthestLocalPoint(bestAxis.negate()) : null\n        };\n    }\n    static findCirclePolygonSeparation(circle, polygon) {\n        const axes = polygon.axes;\n        const pc = polygon.center;\n        // Special SAT with circles\n        const polyDir = pc.sub(circle.worldPos);\n        const closestPointOnPoly = polygon.getFurthestPoint(polyDir.negate());\n        axes.push(closestPointOnPoly.sub(circle.worldPos).normalize());\n        let minOverlap = Number.MAX_VALUE;\n        let minAxis = null;\n        let minIndex = -1;\n        for (let i = 0; i < axes.length; i++) {\n            const proj1 = polygon.project(axes[i]);\n            const proj2 = circle.project(axes[i]);\n            const overlap = proj1.getOverlap(proj2);\n            if (overlap <= 0) {\n                return null;\n            }\n            else {\n                if (overlap < minOverlap) {\n                    minOverlap = overlap;\n                    minAxis = axes[i];\n                    minIndex = i;\n                }\n            }\n        }\n        if (minIndex < 0) {\n            return null;\n        }\n        return minAxis.normalize().scale(minOverlap);\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CollisionJumpTable.ts\n\n\n\n\n\n\n\n\nconst CollisionJumpTable = {\n    CollideCircleCircle(circleA, circleB) {\n        const circleAPos = circleA.worldPos;\n        const circleBPos = circleB.worldPos;\n        const combinedRadius = circleA.radius + circleB.radius;\n        const distance = circleAPos.distance(circleBPos);\n        if (distance > combinedRadius) {\n            return [];\n        }\n        // negative means overlap\n        const separation = combinedRadius - distance;\n        // Normal points from A -> B\n        const normal = circleBPos.sub(circleAPos).normalize();\n        const tangent = normal.perpendicular();\n        const mvt = normal.scale(separation);\n        const point = circleA.getFurthestPoint(normal);\n        const local = circleA.getFurthestLocalPoint(normal);\n        const info = {\n            collider: circleA,\n            separation,\n            axis: normal,\n            point: point\n        };\n        return [new CollisionContact(circleA, circleB, mvt, normal, tangent, [point], [local], info)];\n    },\n    CollideCirclePolygon(circle, polygon) {\n        var _a, _b;\n        let minAxis = SeparatingAxis.findCirclePolygonSeparation(circle, polygon);\n        if (!minAxis) {\n            return [];\n        }\n        // make sure that the minAxis is pointing away from circle\n        const samedir = minAxis.dot(polygon.center.sub(circle.center));\n        minAxis = samedir < 0 ? minAxis.negate() : minAxis;\n        const point = circle.getFurthestPoint(minAxis);\n        const xf = (_b = (_a = circle.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\n        const local = xf.applyInverse(point);\n        const normal = minAxis.normalize();\n        const info = {\n            collider: circle,\n            separation: -minAxis.size,\n            axis: normal,\n            point: point,\n            localPoint: local,\n            side: polygon.findSide(normal.negate()),\n            localSide: polygon.findLocalSide(normal.negate())\n        };\n        return [new CollisionContact(circle, polygon, minAxis, normal, normal.perpendicular(), [point], [local], info)];\n    },\n    CollideCircleEdge(circle, edge) {\n        // TODO not sure this actually abides by local/world collisions\n        // Are edge.begin and edge.end local space or world space? I think they should be local\n        // center of the circle in world pos\n        const cc = circle.center;\n        // vector in the direction of the edge\n        const edgeWorld = edge.asLine();\n        const e = edgeWorld.end.sub(edgeWorld.begin);\n        // amount of overlap with the circle's center along the edge direction\n        const u = e.dot(edgeWorld.end.sub(cc));\n        const v = e.dot(cc.sub(edgeWorld.begin));\n        const side = edge.asLine();\n        const localSide = edge.asLocalLine();\n        // Potential region A collision (circle is on the left side of the edge, before the beginning)\n        if (v <= 0) {\n            const da = edgeWorld.begin.sub(cc);\n            const dda = da.dot(da); // quick and dirty way of calc'n distance in r^2 terms saves some sqrts\n            // save some sqrts\n            if (dda > circle.radius * circle.radius) {\n                return []; // no collision\n            }\n            const normal = da.normalize();\n            const separation = circle.radius - Math.sqrt(dda);\n            const info = {\n                collider: circle,\n                separation: separation,\n                axis: normal,\n                point: side.begin,\n                side: side,\n                localSide: localSide\n            };\n            return [\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.begin], [localSide.begin], info)\n            ];\n        }\n        // Potential region B collision (circle is on the right side of the edge, after the end)\n        if (u <= 0) {\n            const db = edgeWorld.end.sub(cc);\n            const ddb = db.dot(db);\n            if (ddb > circle.radius * circle.radius) {\n                return [];\n            }\n            const normal = db.normalize();\n            const separation = circle.radius - Math.sqrt(ddb);\n            const info = {\n                collider: circle,\n                separation: separation,\n                axis: normal,\n                point: side.end,\n                side: side,\n                localSide: localSide\n            };\n            return [\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.end], [localSide.end], info)\n            ];\n        }\n        // Otherwise potential region AB collision (circle is in the middle of the edge between the beginning and end)\n        const den = e.dot(e);\n        const pointOnEdge = edgeWorld.begin\n            .scale(u)\n            .add(edgeWorld.end.scale(v))\n            .scale(1 / den);\n        const d = cc.sub(pointOnEdge);\n        const dd = d.dot(d);\n        if (dd > circle.radius * circle.radius) {\n            return []; // no collision\n        }\n        let normal = e.perpendicular();\n        // flip correct direction\n        if (normal.dot(cc.sub(edgeWorld.begin)) < 0) {\n            normal.x = -normal.x;\n            normal.y = -normal.y;\n        }\n        normal = normal.normalize();\n        const separation = circle.radius - Math.sqrt(dd);\n        const mvt = normal.scale(separation);\n        const info = {\n            collider: circle,\n            separation: separation,\n            axis: normal,\n            point: pointOnEdge,\n            side: side,\n            localSide: localSide\n        };\n        return [\n            new CollisionContact(circle, edge, mvt, normal.negate(), normal.negate().perpendicular(), [pointOnEdge], [pointOnEdge.sub(edge.worldPos)], info)\n        ];\n    },\n    CollideEdgeEdge() {\n        // Edge-edge collision doesn't make sense\n        return [];\n    },\n    CollidePolygonEdge(polygon, edge) {\n        var _a;\n        const pc = polygon.center;\n        const ec = edge.center;\n        const dir = ec.sub(pc).normalize();\n        // build a temporary polygon from the edge to use SAT\n        const linePoly = new PolygonCollider({\n            points: [edge.begin, edge.end, edge.end.add(dir.scale(100)), edge.begin.add(dir.scale(100))],\n            offset: edge.offset\n        });\n        linePoly.owner = edge.owner;\n        const tx = (_a = edge.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\n        if (tx) {\n            linePoly.update(edge.owner.get(TransformComponent).get());\n        }\n        // Gross hack but poly-poly works well\n        const contact = this.CollidePolygonPolygon(polygon, linePoly);\n        if (contact.length) {\n            // Fudge the contact back to edge\n            contact[0].colliderB = edge;\n            contact[0].id = Pair.calculatePairHash(polygon.id, edge.id);\n        }\n        return contact;\n    },\n    CollidePolygonPolygon(polyA, polyB) {\n        var _a, _b, _c, _d;\n        // Multi contact from SAT\n        // https://gamedev.stackexchange.com/questions/111390/multiple-contacts-for-sat-collision-detection\n        // do a SAT test to find a min axis if it exists\n        const separationA = SeparatingAxis.findPolygonPolygonSeparation(polyA, polyB);\n        // If there is no overlap from boxA's perspective we can end early\n        if (separationA.separation > 0) {\n            return [];\n        }\n        const separationB = SeparatingAxis.findPolygonPolygonSeparation(polyB, polyA);\n        // If there is no overlap from boxB's perspective exit now\n        if (separationB.separation > 0) {\n            return [];\n        }\n        // Separations are both negative, we want to pick the least negative (minimal movement)\n        const separation = separationA.separation > separationB.separation ? separationA : separationB;\n        // The incident side is the most opposite from the axes of collision on the other collider\n        const other = separation.collider === polyA ? polyB : polyA;\n        const incident = other.findSide(separation.axis.negate());\n        // Clip incident side by the perpendicular lines at each end of the reference side\n        // https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm\n        const reference = separation.side;\n        const refDir = reference.dir().normalize();\n        // Find our contact points by clipping the incident by the collision side\n        const clipRight = incident.clip(refDir.negate(), -refDir.dot(reference.begin));\n        let clipLeft = null;\n        if (clipRight) {\n            clipLeft = clipRight.clip(refDir, refDir.dot(reference.end));\n        }\n        // If there is no left there is no collision\n        if (clipLeft) {\n            // We only want clip points below the reference edge, discard the others\n            const points = clipLeft.getPoints().filter((p) => {\n                return reference.below(p);\n            });\n            let normal = separation.axis;\n            let tangent = normal.perpendicular();\n            // Point Contact A -> B\n            if (polyB.center.sub(polyA.center).dot(normal) < 0) {\n                normal = normal.negate();\n                tangent = normal.perpendicular();\n            }\n            // Points are clipped from incident which is the other collider\n            // Store those as locals\n            let localPoints = [];\n            if (separation.collider === polyA) {\n                const xf = (_b = (_a = polyB.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\n                localPoints = points.map((p) => xf.applyInverse(p));\n            }\n            else {\n                const xf = (_d = (_c = polyA.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\n                localPoints = points.map((p) => xf.applyInverse(p));\n            }\n            return [new CollisionContact(polyA, polyB, normal.scale(-separation.separation), normal, tangent, points, localPoints, separation)];\n        }\n        return [];\n    },\n    FindContactSeparation(contact, localPoint) {\n        var _a, _b, _c, _d;\n        const shapeA = contact.colliderA;\n        const txA = (_b = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\n        const shapeB = contact.colliderB;\n        const txB = (_d = (_c = contact.colliderB.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\n        // both are circles\n        if (shapeA instanceof CircleCollider && shapeB instanceof CircleCollider) {\n            const combinedRadius = shapeA.radius + shapeB.radius;\n            const distance = txA.pos.distance(txB.pos);\n            const separation = combinedRadius - distance;\n            return -separation;\n        }\n        // both are polygons\n        if (shapeA instanceof PolygonCollider && shapeB instanceof PolygonCollider) {\n            if (contact.info.localSide) {\n                let side;\n                let worldPoint;\n                if (contact.info.collider === shapeA) {\n                    side = new LineSegment(txA.apply(contact.info.localSide.begin), txA.apply(contact.info.localSide.end));\n                    worldPoint = txB.apply(localPoint);\n                }\n                else {\n                    side = new LineSegment(txB.apply(contact.info.localSide.begin), txB.apply(contact.info.localSide.end));\n                    worldPoint = txA.apply(localPoint);\n                }\n                return side.distanceToPoint(worldPoint, true);\n            }\n        }\n        // polygon v circle\n        if ((shapeA instanceof PolygonCollider && shapeB instanceof CircleCollider) ||\n            (shapeB instanceof PolygonCollider && shapeA instanceof CircleCollider)) {\n            const worldPoint = txA.apply(localPoint);\n            if (contact.info.side) {\n                return contact.info.side.distanceToPoint(worldPoint, true);\n            }\n        }\n        // polygon v edge\n        if ((shapeA instanceof EdgeCollider && shapeB instanceof PolygonCollider) ||\n            (shapeB instanceof EdgeCollider && shapeA instanceof PolygonCollider)) {\n            let worldPoint;\n            if (contact.info.collider === shapeA) {\n                worldPoint = txB.apply(localPoint);\n            }\n            else {\n                worldPoint = txA.apply(localPoint);\n            }\n            if (contact.info.side) {\n                return contact.info.side.distanceToPoint(worldPoint, true);\n            }\n        }\n        // circle v edge\n        if ((shapeA instanceof CircleCollider && shapeB instanceof EdgeCollider) ||\n            (shapeB instanceof CircleCollider && shapeA instanceof EdgeCollider)) {\n            // Local point is always on the edge which is always shapeB\n            const worldPoint = txB.apply(localPoint);\n            let circlePoint;\n            if (shapeA instanceof CircleCollider) {\n                circlePoint = shapeA.getFurthestPoint(contact.normal);\n            }\n            const dist = worldPoint.distance(circlePoint);\n            if (contact.info.side) {\n                return dist > 0 ? -dist : 0;\n            }\n        }\n        return 0;\n    }\n};\n\n;// CONCATENATED MODULE: ./Collision/Colliders/EdgeCollider.ts\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Edge is a single line collider to create collisions with a single line.\n */\nclass EdgeCollider extends Collider {\n    constructor(options) {\n        var _a;\n        super();\n        this._globalMatrix = AffineMatrix.identity();\n        this.begin = options.begin || Vector.Zero;\n        this.end = options.end || Vector.Zero;\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\n    }\n    /**\n     * Returns a clone of this Edge, not associated with any collider\n     */\n    clone() {\n        return new EdgeCollider({\n            begin: this.begin.clone(),\n            end: this.end.clone()\n        });\n    }\n    get worldPos() {\n        var _a;\n        const tx = this._transform;\n        return (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos.add(this.offset)) !== null && _a !== void 0 ? _a : this.offset;\n    }\n    /**\n     * Get the center of the collision area in world coordinates\n     */\n    get center() {\n        const begin = this._getTransformedBegin();\n        const end = this._getTransformedEnd();\n        const pos = begin.average(end);\n        return pos;\n    }\n    _getTransformedBegin() {\n        return this._globalMatrix.multiply(this.begin);\n    }\n    _getTransformedEnd() {\n        return this._globalMatrix.multiply(this.end);\n    }\n    /**\n     * Returns the slope of the line in the form of a vector\n     */\n    getSlope() {\n        const begin = this._getTransformedBegin();\n        const end = this._getTransformedEnd();\n        const distance = begin.distance(end);\n        return end.sub(begin).scale(1 / distance);\n    }\n    /**\n     * Returns the length of the line segment in pixels\n     */\n    getLength() {\n        const begin = this._getTransformedBegin();\n        const end = this._getTransformedEnd();\n        const distance = begin.distance(end);\n        return distance;\n    }\n    /**\n     * Tests if a point is contained in this collision area\n     */\n    contains() {\n        return false;\n    }\n    /**\n     * @inheritdoc\n     */\n    rayCast(ray, max = Infinity) {\n        var _a;\n        const numerator = this._getTransformedBegin().sub(ray.pos);\n        // Test is line and ray are parallel and non intersecting\n        if (ray.dir.cross(this.getSlope()) === 0 && numerator.cross(ray.dir) !== 0) {\n            return null;\n        }\n        // Lines are parallel\n        const divisor = ray.dir.cross(this.getSlope());\n        if (divisor === 0) {\n            return null;\n        }\n        const t = numerator.cross(this.getSlope()) / divisor;\n        if (t >= 0 && t <= max) {\n            const u = numerator.cross(ray.dir) / divisor / this.getLength();\n            if (u >= 0 && u <= 1) {\n                return {\n                    distance: t,\n                    normal: this.asLine().normal(),\n                    collider: this,\n                    body: (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent),\n                    point: ray.getPoint(t)\n                };\n            }\n        }\n        return null;\n    }\n    /**\n     * Returns the closes line between this and another collider, from this -> collider\n     * @param shape\n     */\n    getClosestLineBetween(shape) {\n        if (shape instanceof CircleCollider) {\n            return ClosestLineJumpTable.CircleEdgeClosestLine(shape, this);\n        }\n        else if (shape instanceof PolygonCollider) {\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(shape, this).flip();\n        }\n        else if (shape instanceof EdgeCollider) {\n            return ClosestLineJumpTable.EdgeEdgeClosestLine(this, shape);\n        }\n        else {\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\n        }\n    }\n    /**\n     * @inheritdoc\n     */\n    collide(shape) {\n        if (shape instanceof CircleCollider) {\n            return CollisionJumpTable.CollideCircleEdge(shape, this);\n        }\n        else if (shape instanceof PolygonCollider) {\n            return CollisionJumpTable.CollidePolygonEdge(shape, this);\n        }\n        else if (shape instanceof EdgeCollider) {\n            return CollisionJumpTable.CollideEdgeEdge();\n        }\n        else {\n            throw new Error(`Edge could not collide with unknown CollisionShape ${typeof shape}`);\n        }\n    }\n    /**\n     * Find the point on the collider furthest in the direction specified\n     */\n    getFurthestPoint(direction) {\n        const transformedBegin = this._getTransformedBegin();\n        const transformedEnd = this._getTransformedEnd();\n        if (direction.dot(transformedBegin) > 0) {\n            return transformedBegin;\n        }\n        else {\n            return transformedEnd;\n        }\n    }\n    _boundsFromBeginEnd(begin, end, padding = 10) {\n        // A perfectly vertical or horizontal edge would have a bounds 0 width or height\n        // this causes problems for the collision system so we give them some padding\n        return new BoundingBox(Math.min(begin.x, end.x) - padding, Math.min(begin.y, end.y) - padding, Math.max(begin.x, end.x) + padding, Math.max(begin.y, end.y) + padding);\n    }\n    /**\n     * Get the axis aligned bounding box for the edge collider in world space\n     */\n    get bounds() {\n        const transformedBegin = this._getTransformedBegin();\n        const transformedEnd = this._getTransformedEnd();\n        return this._boundsFromBeginEnd(transformedBegin, transformedEnd);\n    }\n    /**\n     * Get the axis aligned bounding box for the edge collider in local space\n     */\n    get localBounds() {\n        return this._boundsFromBeginEnd(this.begin, this.end);\n    }\n    /**\n     * Returns this edge represented as a line in world coordinates\n     */\n    asLine() {\n        return new LineSegment(this._getTransformedBegin(), this._getTransformedEnd());\n    }\n    /**\n     * Return this edge as a line in local line coordinates (relative to the position)\n     */\n    asLocalLine() {\n        return new LineSegment(this.begin, this.end);\n    }\n    /**\n     * Get the axis associated with the edge\n     */\n    get axes() {\n        const e = this._getTransformedEnd().sub(this._getTransformedBegin());\n        const edgeNormal = e.normal();\n        const axes = [];\n        axes.push(edgeNormal);\n        axes.push(edgeNormal.negate());\n        axes.push(edgeNormal.normal());\n        axes.push(edgeNormal.normal().negate());\n        return axes;\n    }\n    /**\n     * Get the moment of inertia for an edge\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n     */\n    getInertia(mass) {\n        const length = this.end.sub(this.begin).distance() / 2;\n        return mass * length * length;\n    }\n    /**\n     * @inheritdoc\n     */\n    update(transform) {\n        var _a;\n        this._transform = transform;\n        const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\n        globalMat.clone(this._globalMatrix);\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\n    }\n    /**\n     * Project the edge along a specified axis\n     */\n    project(axis) {\n        const scalars = [];\n        const points = [this._getTransformedBegin(), this._getTransformedEnd()];\n        const len = points.length;\n        for (let i = 0; i < len; i++) {\n            scalars.push(points[i].dot(axis));\n        }\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\n    }\n    debug(ex, color) {\n        const begin = this._getTransformedBegin();\n        const end = this._getTransformedEnd();\n        ex.drawLine(begin, end, color, 2);\n        ex.drawCircle(begin, 2, color);\n        ex.drawCircle(end, 2, color);\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Debug.ts\n\nclass Debug {\n    static registerGraphicsContext(ctx) {\n        Debug._ctx = ctx;\n    }\n    static draw(debugDrawCall) {\n        this._drawCalls.push(debugDrawCall);\n    }\n    static drawPoint(point, options) {\n        Debug.draw(ctx => {\n            ctx.debug.drawPoint(point, options);\n        });\n    }\n    static drawLine(start, end, options) {\n        Debug.draw(ctx => {\n            ctx.debug.drawLine(start, end, options);\n        });\n    }\n    static drawLines(points, options) {\n        if (points.length > 1) {\n            Debug.draw(ctx => {\n                for (let i = 0; i < points.length - 1; i++) {\n                    ctx.debug.drawLine(points[i], points[i + 1], options);\n                }\n            });\n        }\n    }\n    static drawText(text, pos) {\n        Debug.draw(ctx => {\n            ctx.debug.drawText(text, pos);\n        });\n    }\n    static drawPolygon(points, options) {\n        if (points.length > 1) {\n            Debug.draw(ctx => {\n                const firstPoint = points[0];\n                const polygon = [...points, firstPoint];\n                for (let i = 0; i < polygon.length - 1; i++) {\n                    ctx.debug.drawLine(polygon[i], polygon[i + 1], options);\n                }\n            });\n        }\n    }\n    static drawCircle(center, radius, options) {\n        const { color, strokeColor, width } = {\n            color: Color.Black,\n            strokeColor: undefined,\n            width: undefined,\n            ...options\n        };\n        Debug.draw(ctx => {\n            ctx.drawCircle(center, radius, color, strokeColor, width);\n        });\n    }\n    static drawBounds(boundingBox, options) {\n        Debug.draw(ctx => {\n            ctx.debug.drawRect(boundingBox.left, boundingBox.top, boundingBox.width, boundingBox.height, options);\n        });\n    }\n    static drawRay(ray, options) {\n        const { distance, color } = {\n            color: Color.Blue,\n            distance: 10,\n            ...options\n        };\n        Debug.draw((ctx) => {\n            const start = ray.pos;\n            const end = ray.pos.add(ray.dir.scale(distance));\n            ctx.debug.drawLine(start, end, { color });\n        });\n    }\n    static flush(ctx) {\n        ctx.save();\n        ctx.z = Debug.z;\n        for (const drawCall of Debug._drawCalls) {\n            drawCall(ctx);\n        }\n        ctx.restore();\n        Debug.clear();\n    }\n    static clear() {\n        Debug._drawCalls.length = 0;\n    }\n}\nDebug._drawCalls = [];\nDebug.z = Infinity;\n\n;// CONCATENATED MODULE: ./Collision/Colliders/PolygonCollider.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Polygon collider for detecting collisions\n */\nclass PolygonCollider extends Collider {\n    flagDirty() {\n        this._localBoundsDirty = true;\n        this._localSidesDirty = true;\n        this._transformedPointsDirty = true;\n        this._sidesDirty = true;\n    }\n    /**\n     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\n     * Excalibur stores these in counter-clockwise order\n     */\n    set points(points) {\n        this._points = points;\n        this.flagDirty();\n    }\n    /**\n     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\n     * Excalibur stores these in counter-clockwise order\n     */\n    get points() {\n        return this._points;\n    }\n    constructor(options) {\n        var _a, _b;\n        super();\n        this._logger = Logger.getInstance();\n        this._transformedPoints = [];\n        this._sides = [];\n        this._localSides = [];\n        this._globalMatrix = AffineMatrix.identity();\n        this._transformedPointsDirty = true;\n        this._sidesDirty = true;\n        this._localSidesDirty = true;\n        this._localBoundsDirty = true;\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\n        this.points = (_b = options.points) !== null && _b !== void 0 ? _b : [];\n        const counterClockwise = this._isCounterClockwiseWinding(this.points);\n        if (!counterClockwise) {\n            this.points.reverse();\n        }\n        if (!this.isConvex()) {\n            if (!options.suppressConvexWarning) {\n                this._logger.warn('Excalibur only supports convex polygon colliders and will not behave properly.' +\n                    'Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles');\n            }\n        }\n        // calculate initial transformation\n        this._calculateTransformation();\n    }\n    _isCounterClockwiseWinding(points) {\n        // https://stackoverflow.com/a/1165943\n        let sum = 0;\n        for (let i = 0; i < points.length; i++) {\n            sum += (points[(i + 1) % points.length].x - points[i].x) * (points[(i + 1) % points.length].y + points[i].y);\n        }\n        return sum < 0;\n    }\n    /**\n     * Returns if the polygon collider is convex, Excalibur does not handle non-convex collision shapes.\n     * Call [[Polygon.triangulate]] to generate a [[CompositeCollider]] from this non-convex shape\n     */\n    isConvex() {\n        // From SO: https://stackoverflow.com/a/45372025\n        if (this.points.length < 3) {\n            return false;\n        }\n        let oldPoint = this.points[this.points.length - 2];\n        let newPoint = this.points[this.points.length - 1];\n        let direction = Math.atan2(newPoint.y - oldPoint.y, newPoint.x - oldPoint.x);\n        let oldDirection = 0;\n        let orientation = 0;\n        let angleSum = 0;\n        for (const [i, point] of this.points.entries()) {\n            oldPoint = newPoint;\n            oldDirection = direction;\n            newPoint = point;\n            direction = Math.atan2(newPoint.y - oldPoint.y, newPoint.x - oldPoint.x);\n            if (oldPoint.equals(newPoint)) {\n                return false; // repeat point\n            }\n            let angle = direction - oldDirection;\n            if (angle <= -Math.PI) {\n                angle += Math.PI * 2;\n            }\n            else if (angle > Math.PI) {\n                angle -= Math.PI * 2;\n            }\n            if (i === 0) {\n                if (angle === 0.0) {\n                    return false;\n                }\n                orientation = angle > 0 ? 1 : -1;\n            }\n            else {\n                if (orientation * angle <= 0) {\n                    return false;\n                }\n            }\n            angleSum += angle;\n        }\n        return Math.abs(Math.round(angleSum / (Math.PI * 2))) === 1;\n    }\n    /**\n     * Tessellates the polygon into a triangle fan as a [[CompositeCollider]] of triangle polygons\n     */\n    tessellate() {\n        const polygons = [];\n        for (let i = 1; i < this.points.length - 2; i++) {\n            polygons.push([this.points[0], this.points[i + 1], this.points[i + 2]]);\n        }\n        polygons.push([this.points[0], this.points[1], this.points[2]]);\n        return new CompositeCollider(polygons.map(points => Shape.Polygon(points)));\n    }\n    /**\n     * Triangulate the polygon collider using the \"Ear Clipping\" algorithm.\n     * Returns a new [[CompositeCollider]] made up of smaller triangles.\n     */\n    triangulate() {\n        // https://www.youtube.com/watch?v=hTJFcHutls8\n        if (this.points.length < 3) {\n            throw Error('Invalid polygon');\n        }\n        const triangles = [];\n        // algorithm likes clockwise\n        const vertices = [...this.points].reverse();\n        let vertexCount = vertices.length;\n        /**\n         * Returns the previous index based on the current vertex\n         */\n        function getPrevIndex(index) {\n            return index === 0 ? vertexCount - 1 : index - 1;\n        }\n        /**\n         * Retrieves the next index based on the current vertex\n         */\n        function getNextIndex(index) {\n            return index === vertexCount - 1 ? 0 : index + 1;\n        }\n        /**\n         * Whether or not the angle at this vertex index is convex\n         */\n        function isConvex(index) {\n            const prev = getPrevIndex(index);\n            const next = getNextIndex(index);\n            const va = vertices[prev];\n            const vb = vertices[index];\n            const vc = vertices[next];\n            // Check convexity\n            const leftArm = va.sub(vb);\n            const rightArm = vc.sub(vb);\n            // Positive cross product is convex\n            if (leftArm.cross(rightArm) < 0) {\n                return false;\n            }\n            return true;\n        }\n        const convexVertices = vertices.map((_, i) => isConvex(i));\n        /**\n         * Quick test for point in triangle\n         */\n        function isPointInTriangle(point, a, b, c) {\n            const ab = b.sub(a);\n            const bc = c.sub(b);\n            const ca = a.sub(c);\n            const ap = point.sub(a);\n            const bp = point.sub(b);\n            const cp = point.sub(c);\n            const cross1 = ab.cross(ap);\n            const cross2 = bc.cross(bp);\n            const cross3 = ca.cross(cp);\n            if (cross1 > 0 || cross2 > 0 || cross3 > 0) {\n                return false;\n            }\n            return true;\n        }\n        /**\n         * Calculate the area of the triangle\n         */\n        // function triangleArea(a: Vector, b: Vector, c: Vector) {\n        //   return Math.abs(a.x * (b.y - c.y) + b.x * (c.y - a.y) + c.x * (a.y - c.y))/2;\n        // }\n        /**\n         * Find the next suitable ear tip\n         */\n        function findEarTip() {\n            for (let i = 0; i < vertexCount; i++) {\n                if (convexVertices[i]) {\n                    const prev = getPrevIndex(i);\n                    const next = getNextIndex(i);\n                    const va = vertices[prev];\n                    const vb = vertices[i];\n                    const vc = vertices[next];\n                    let isEar = true;\n                    // Check that if any vertices are in the triangle a, b, c\n                    for (let j = 0; j < vertexCount; j++) {\n                        // We can skip these verts because they are the triangle we are testing\n                        if (j === i || j === prev || j === next) {\n                            continue;\n                        }\n                        const point = vertices[j];\n                        if (isPointInTriangle(point, va, vb, vc)) {\n                            isEar = false;\n                            break;\n                        }\n                    }\n                    // Add ear to polygon list and remove from list\n                    if (isEar) {\n                        return i;\n                    }\n                }\n            }\n            // Fall back to any convex vertex\n            for (let i = 0; i < vertexCount; i++) {\n                if (convexVertices[i]) {\n                    return i;\n                }\n            }\n            // bail and return the first one?\n            return 0;\n        }\n        /**\n         * Cut the ear and produce a triangle, update internal state\n         */\n        function cutEarTip(index) {\n            const prev = getPrevIndex(index);\n            const next = getNextIndex(index);\n            const va = vertices[prev];\n            const vb = vertices[index];\n            const vc = vertices[next];\n            // Clockwise winding\n            // if (triangleArea(va, vb, vc) > 0) {\n            triangles.push([va, vb, vc]);\n            // }\n            vertices.splice(index, 1);\n            convexVertices.splice(index, 1);\n            vertexCount--;\n        }\n        // Loop over all the vertices finding ears\n        while (vertexCount > 3) {\n            const earIndex = findEarTip();\n            cutEarTip(earIndex);\n            // reclassify vertices\n            for (let i = 0; i < vertexCount; i++) {\n                convexVertices[i] = isConvex(i);\n            }\n        }\n        // Last triangle after the loop\n        triangles.push([vertices[0], vertices[1], vertices[2]]);\n        // FIXME: there is a colinear triangle that sneaks in here sometimes\n        return new CompositeCollider(triangles.map(points => Shape.Polygon(points, Vector.Zero, true)));\n    }\n    /**\n     * Returns a clone of this ConvexPolygon, not associated with any collider\n     */\n    clone() {\n        return new PolygonCollider({\n            offset: this.offset.clone(),\n            points: this.points.map((p) => p.clone())\n        });\n    }\n    /**\n     * Returns the world position of the collider, which is the current body transform plus any defined offset\n     */\n    get worldPos() {\n        if (this._transform) {\n            return this._transform.pos.add(this.offset);\n        }\n        return this.offset;\n    }\n    /**\n     * Get the center of the collider in world coordinates\n     */\n    get center() {\n        return this.bounds.center;\n    }\n    /**\n     * Calculates the underlying transformation from the body relative space to world space\n     */\n    _calculateTransformation() {\n        const points = this.points;\n        const len = points.length;\n        this._transformedPoints.length = 0; // clear out old transform\n        for (let i = 0; i < len; i++) {\n            this._transformedPoints[i] = this._globalMatrix.multiply(points[i].clone());\n        }\n    }\n    /**\n     * Gets the points that make up the polygon in world space, from actor relative space (if specified)\n     */\n    getTransformedPoints() {\n        if (this._transformedPointsDirty) {\n            this._calculateTransformation();\n            this._transformedPointsDirty = false;\n        }\n        return this._transformedPoints;\n    }\n    /**\n     * Gets the sides of the polygon in world space\n     */\n    getSides() {\n        if (this._sidesDirty) {\n            const lines = [];\n            const points = this.getTransformedPoints();\n            const len = points.length;\n            for (let i = 0; i < len; i++) {\n                // This winding is important\n                lines.push(new LineSegment(points[i], points[(i + 1) % len]));\n            }\n            this._sides = lines;\n            this._sidesDirty = false;\n        }\n        return this._sides;\n    }\n    /**\n     * Returns the local coordinate space sides\n     */\n    getLocalSides() {\n        if (this._localSidesDirty) {\n            const lines = [];\n            const points = this.points;\n            const len = points.length;\n            for (let i = 0; i < len; i++) {\n                // This winding is important\n                lines.push(new LineSegment(points[i], points[(i + 1) % len]));\n            }\n            this._localSides = lines;\n            this._localSidesDirty = false;\n        }\n        return this._localSides;\n    }\n    /**\n     * Given a direction vector find the world space side that is most in that direction\n     * @param direction\n     */\n    findSide(direction) {\n        const sides = this.getSides();\n        let bestSide = sides[0];\n        let maxDistance = -Number.MAX_VALUE;\n        for (let side = 0; side < sides.length; side++) {\n            const currentSide = sides[side];\n            const sideNormal = currentSide.normal();\n            const mostDirection = sideNormal.dot(direction);\n            if (mostDirection > maxDistance) {\n                bestSide = currentSide;\n                maxDistance = mostDirection;\n            }\n        }\n        return bestSide;\n    }\n    /**\n     * Given a direction vector find the local space side that is most in that direction\n     * @param direction\n     */\n    findLocalSide(direction) {\n        const sides = this.getLocalSides();\n        let bestSide = sides[0];\n        let maxDistance = -Number.MAX_VALUE;\n        for (let side = 0; side < sides.length; side++) {\n            const currentSide = sides[side];\n            const sideNormal = currentSide.normal();\n            const mostDirection = sideNormal.dot(direction);\n            if (mostDirection > maxDistance) {\n                bestSide = currentSide;\n                maxDistance = mostDirection;\n            }\n        }\n        return bestSide;\n    }\n    /**\n     * Get the axis associated with the convex polygon\n     */\n    get axes() {\n        const axes = [];\n        const sides = this.getSides();\n        for (let i = 0; i < sides.length; i++) {\n            axes.push(sides[i].normal());\n        }\n        return axes;\n    }\n    /**\n     * Updates the transform for the collision geometry\n     *\n     * Collision geometry (points/bounds) will not change until this is called.\n     * @param transform\n     */\n    update(transform) {\n        var _a;\n        if (transform) {\n            this._transform = transform;\n            this._transformedPointsDirty = true;\n            this._sidesDirty = true;\n            // This change means an update must be performed in order for geometry to update\n            const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\n            globalMat.clone(this._globalMatrix);\n            this._globalMatrix.translate(this.offset.x, this.offset.y);\n        }\n    }\n    /**\n     * Tests if a point is contained in this collider in world space\n     */\n    contains(point) {\n        // Always cast to the right, as long as we cast in a consistent fixed direction we\n        // will be fine\n        const testRay = new Ray(point, new Vector(1, 0));\n        const intersectCount = this.getSides().reduce(function (accum, side) {\n            if (testRay.intersect(side) >= 0) {\n                return accum + 1;\n            }\n            return accum;\n        }, 0);\n        if (intersectCount % 2 === 0) {\n            return false;\n        }\n        return true;\n    }\n    getClosestLineBetween(collider) {\n        if (collider instanceof CircleCollider) {\n            return ClosestLineJumpTable.PolygonCircleClosestLine(this, collider);\n        }\n        else if (collider instanceof PolygonCollider) {\n            return ClosestLineJumpTable.PolygonPolygonClosestLine(this, collider);\n        }\n        else if (collider instanceof EdgeCollider) {\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(this, collider);\n        }\n        else {\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\n        }\n    }\n    /**\n     * Returns a collision contact if the 2 colliders collide, otherwise collide will\n     * return null.\n     * @param collider\n     */\n    collide(collider) {\n        if (collider instanceof CircleCollider) {\n            return CollisionJumpTable.CollideCirclePolygon(collider, this);\n        }\n        else if (collider instanceof PolygonCollider) {\n            return CollisionJumpTable.CollidePolygonPolygon(this, collider);\n        }\n        else if (collider instanceof EdgeCollider) {\n            return CollisionJumpTable.CollidePolygonEdge(this, collider);\n        }\n        else {\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\n        }\n    }\n    /**\n     * Find the point on the collider furthest in the direction specified\n     */\n    getFurthestPoint(direction) {\n        const pts = this.getTransformedPoints();\n        let furthestPoint = null;\n        let maxDistance = -Number.MAX_VALUE;\n        for (let i = 0; i < pts.length; i++) {\n            const distance = direction.dot(pts[i]);\n            if (distance > maxDistance) {\n                maxDistance = distance;\n                furthestPoint = pts[i];\n            }\n        }\n        return furthestPoint;\n    }\n    /**\n     * Find the local point on the collider furthest in the direction specified\n     * @param direction\n     */\n    getFurthestLocalPoint(direction) {\n        const pts = this.points;\n        let furthestPoint = pts[0];\n        let maxDistance = -Number.MAX_VALUE;\n        for (let i = 0; i < pts.length; i++) {\n            const distance = direction.dot(pts[i]);\n            if (distance > maxDistance) {\n                maxDistance = distance;\n                furthestPoint = pts[i];\n            }\n        }\n        return furthestPoint;\n    }\n    /**\n     * Finds the closes face to the point using perpendicular distance\n     * @param point point to test against polygon\n     */\n    getClosestFace(point) {\n        const sides = this.getSides();\n        let min = Number.POSITIVE_INFINITY;\n        let faceIndex = -1;\n        let distance = -1;\n        for (let i = 0; i < sides.length; i++) {\n            const dist = sides[i].distanceToPoint(point);\n            if (dist < min) {\n                min = dist;\n                faceIndex = i;\n                distance = dist;\n            }\n        }\n        if (faceIndex !== -1) {\n            return {\n                distance: sides[faceIndex].normal().scale(distance),\n                face: sides[faceIndex]\n            };\n        }\n        return null;\n    }\n    /**\n     * Get the axis aligned bounding box for the polygon collider in world coordinates\n     */\n    get bounds() {\n        return this.localBounds.transform(this._globalMatrix);\n    }\n    /**\n     * Get the axis aligned bounding box for the polygon collider in local coordinates\n     */\n    get localBounds() {\n        if (this._localBoundsDirty) {\n            this._localBounds = BoundingBox.fromPoints(this.points);\n            this._localBoundsDirty = false;\n        }\n        return this._localBounds;\n    }\n    /**\n     * Get the moment of inertia for an arbitrary polygon\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n     */\n    getInertia(mass) {\n        if (this._cachedMass === mass && this._cachedInertia) {\n            return this._cachedInertia;\n        }\n        let numerator = 0;\n        let denominator = 0;\n        const points = this.points;\n        for (let i = 0; i < points.length; i++) {\n            const iplusone = (i + 1) % points.length;\n            const crossTerm = points[iplusone].cross(points[i]);\n            numerator +=\n                crossTerm *\n                    (points[i].dot(points[i]) + points[i].dot(points[iplusone]) + points[iplusone].dot(points[iplusone]));\n            denominator += crossTerm;\n        }\n        this._cachedMass = mass;\n        return this._cachedInertia = (mass / 6) * (numerator / denominator);\n    }\n    /**\n     * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.\n     */\n    rayCast(ray, max = Infinity) {\n        var _a;\n        // find the minimum contact time greater than 0\n        // contact times less than 0 are behind the ray and we don't want those\n        const sides = this.getSides();\n        const len = sides.length;\n        let minContactTime = Number.MAX_VALUE;\n        let contactSide;\n        let contactIndex = -1;\n        for (let i = 0; i < len; i++) {\n            const contactTime = ray.intersect(sides[i]);\n            if (contactTime >= 0 && contactTime < minContactTime && contactTime <= max) {\n                minContactTime = contactTime;\n                contactSide = sides[i];\n                contactIndex = i;\n            }\n        }\n        // contact was found\n        if (contactIndex >= 0) {\n            return {\n                collider: this,\n                distance: minContactTime,\n                body: (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent),\n                point: ray.getPoint(minContactTime),\n                normal: contactSide.normal()\n            };\n        }\n        // no contact found\n        return null;\n    }\n    /**\n     * Project the edges of the polygon along a specified axis\n     */\n    project(axis) {\n        const points = this.getTransformedPoints();\n        const len = points.length;\n        let min = Number.MAX_VALUE;\n        let max = -Number.MAX_VALUE;\n        for (let i = 0; i < len; i++) {\n            const scalar = points[i].dot(axis);\n            min = Math.min(min, scalar);\n            max = Math.max(max, scalar);\n        }\n        return new Projection(min, max);\n    }\n    debug(ex, color, options) {\n        const points = this.getTransformedPoints();\n        Debug.drawPolygon(points, { color });\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Shape.ts\n\n\n\n\n\n\n\n/**\n * Excalibur helper for defining colliders quickly\n */\nclass Shape {\n    /**\n     * Creates a box collider, under the hood defines a [[PolygonCollider]] collider\n     * @param width Width of the box\n     * @param height Height of the box\n     * @param anchor Anchor of the box (default (.5, .5)) which positions the box relative to the center of the collider's position\n     * @param offset Optional offset relative to the collider in local coordinates\n     */\n    static Box(width, height, anchor = Vector.Half, offset = Vector.Zero) {\n        return new PolygonCollider({\n            points: new BoundingBox(-width * anchor.x, -height * anchor.y, width - width * anchor.x, height - height * anchor.y).getPoints(),\n            offset: offset\n        });\n    }\n    /**\n     * Creates a new [[PolygonCollider|arbitrary polygon]] collider\n     *\n     * PolygonColliders are useful for creating convex polygon shapes\n     * @param points Points specified in counter clockwise\n     * @param offset Optional offset relative to the collider in local coordinates\n     */\n    static Polygon(points, offset = Vector.Zero, suppressConvexWarning = false) {\n        return new PolygonCollider({\n            points: points,\n            offset: offset,\n            suppressConvexWarning\n        });\n    }\n    /**\n     * Creates a new [[CircleCollider|circle]] collider\n     *\n     * Circle colliders are useful for balls, or to make collisions more forgiving on sharp edges\n     * @param radius Radius of the circle collider\n     * @param offset Optional offset relative to the collider in local coordinates\n     */\n    static Circle(radius, offset = Vector.Zero) {\n        return new CircleCollider({\n            radius: radius,\n            offset: offset\n        });\n    }\n    /**\n     * Creates a new [[EdgeCollider|edge]] collider\n     *\n     * Edge colliders are useful for  floors, walls, and other barriers\n     * @param begin Beginning of the edge in local coordinates to the collider\n     * @param end Ending of the edge in local coordinates to the collider\n     */\n    static Edge(begin, end) {\n        return new EdgeCollider({\n            begin: begin,\n            end: end\n        });\n    }\n    /**\n     * Creates a new capsule shaped [[CompositeCollider]] using 2 circles and a box\n     *\n     * Capsule colliders are useful for platformers with incline or jagged floors to have a smooth\n     * player experience.\n     * @param width\n     * @param height\n     * @param offset Optional offset\n     */\n    static Capsule(width, height, offset = Vector.Zero) {\n        const logger = Logger.getInstance();\n        if (width === height) {\n            logger.warn('A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider');\n        }\n        const vertical = height >= width;\n        if (vertical) {\n            // height > width, if equal maybe use a circle\n            const capsule = new CompositeCollider([\n                Shape.Circle(width / 2, vec(0, -height / 2 + width / 2).add(offset)),\n                Shape.Box(width, height - width, Vector.Half, offset),\n                Shape.Circle(width / 2, vec(0, height / 2 - width / 2).add(offset))\n            ]);\n            return capsule;\n        }\n        else {\n            // width > height, if equal maybe use a circle\n            const capsule = new CompositeCollider([\n                Shape.Circle(height / 2, vec(-width / 2 + height / 2, 0).add(offset)),\n                Shape.Box(width - height, height, Vector.Half, offset),\n                Shape.Circle(height / 2, vec(width / 2 - height / 2, 0).add(offset))\n            ]);\n            return capsule;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/ColliderComponent.ts\n\n\n\n\n\n\n\n\n\n\nclass ColliderComponent extends Component {\n    constructor(collider) {\n        super();\n        this.events = new EventEmitter();\n        /**\n         * Observable that notifies when a collider is added to the body\n         */\n        this.$colliderAdded = new Observable();\n        /**\n         * Observable that notifies when a collider is removed from the body\n         */\n        this.$colliderRemoved = new Observable();\n        this._collidersToRemove = [];\n        this.set(collider);\n    }\n    /**\n     * Get the current collider geometry\n     */\n    get() {\n        return this._collider;\n    }\n    /**\n     * Set the collider geometry\n     * @param collider\n     * @returns the collider you set\n     */\n    set(collider) {\n        this.clear();\n        if (collider) {\n            this._collider = collider;\n            this._collider.owner = this.owner;\n            collider.events.pipe(this.events);\n            this.$colliderAdded.notifyAll(collider);\n            this.update();\n        }\n        return collider;\n    }\n    /**\n     * Remove collider geometry from collider component\n     */\n    clear() {\n        if (this._collider) {\n            this._collidersToRemove.push(this._collider);\n            this._collider = null;\n        }\n    }\n    processColliderRemoval() {\n        for (const collider of this._collidersToRemove) {\n            collider.events.unpipe(this.events);\n            this.$colliderRemoved.notifyAll(collider);\n            collider.owner = null;\n        }\n    }\n    clone() {\n        const clone = new ColliderComponent(this._collider.clone());\n        return clone;\n    }\n    /**\n     * Return world space bounds\n     */\n    get bounds() {\n        var _a, _b;\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox();\n    }\n    /**\n     * Return local space bounds\n     */\n    get localBounds() {\n        var _a, _b;\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox();\n    }\n    /**\n     * Update the collider's transformed geometry\n     */\n    update() {\n        var _a;\n        const tx = (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\n        if (this._collider) {\n            this._collider.owner = this.owner;\n            if (tx) {\n                this._collider.update(tx.get());\n            }\n        }\n    }\n    /**\n     * Collide component with another\n     * @param other\n     */\n    collide(other) {\n        let colliderA = this._collider;\n        let colliderB = other._collider;\n        if (!colliderA || !colliderB) {\n            return [];\n        }\n        // If we have a composite left hand side :(\n        // Might bite us, but to avoid updating all the handlers make composite always left side\n        let flipped = false;\n        if (colliderB instanceof CompositeCollider) {\n            colliderA = colliderB;\n            colliderB = this._collider;\n            flipped = true;\n        }\n        if (this._collider) {\n            const contacts = colliderA.collide(colliderB);\n            if (contacts) {\n                if (flipped) {\n                    contacts.forEach((contact) => {\n                        contact.mtv = contact.mtv.negate();\n                        contact.normal = contact.normal.negate();\n                        contact.tangent = contact.normal.perpendicular();\n                        contact.colliderA = this._collider;\n                        contact.colliderB = other._collider;\n                    });\n                }\n                return contacts;\n            }\n            return [];\n        }\n        return [];\n    }\n    onAdd(entity) {\n        if (this._collider) {\n            this.update();\n        }\n        // Wire up the collider events to the owning entity\n        this.events.on('precollision', (evt) => {\n            const precollision = evt;\n            entity.events.emit('precollision', new PreCollisionEvent(precollision.target.owner, precollision.other.owner, precollision.side, precollision.intersection, precollision.contact));\n            if (entity instanceof Actor) {\n                entity.onPreCollisionResolve(precollision.target, precollision.other, precollision.side, precollision.contact);\n            }\n        });\n        this.events.on('postcollision', (evt) => {\n            const postcollision = evt;\n            entity.events.emit('postcollision', new PostCollisionEvent(postcollision.target.owner, postcollision.other.owner, postcollision.side, postcollision.intersection, postcollision.contact));\n            if (entity instanceof Actor) {\n                entity.onPostCollisionResolve(postcollision.target, postcollision.other, postcollision.side, postcollision.contact);\n            }\n        });\n        this.events.on('collisionstart', (evt) => {\n            const start = evt;\n            entity.events.emit('collisionstart', new CollisionStartEvent(start.target.owner, start.other.owner, start.side, start.contact));\n            if (entity instanceof Actor) {\n                entity.onCollisionStart(start.target, start.other, start.side, start.contact);\n            }\n        });\n        this.events.on('collisionend', (evt) => {\n            const end = evt;\n            entity.events.emit('collisionend', new CollisionEndEvent(end.target.owner, end.other.owner, end.side, end.lastContact));\n            if (entity instanceof Actor) {\n                entity.onCollisionEnd(end.target, end.other, end.side, end.lastContact);\n            }\n        });\n    }\n    onRemove() {\n        this.events.clear();\n        this.$colliderRemoved.notifyAll(this._collider);\n    }\n    /**\n     * Sets up a box geometry based on the current bounds of the associated actor of this physics body.\n     *\n     * If no width/height are specified the body will attempt to use the associated actor's width/height.\n     *\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n     */\n    useBoxCollider(width, height, anchor = Vector.Half, center = Vector.Zero) {\n        const collider = Shape.Box(width, height, anchor, center);\n        return (this.set(collider));\n    }\n    /**\n     * Sets up a [[PolygonCollider|polygon]] collision geometry based on a list of of points relative\n     *  to the anchor of the associated actor\n     * of this physics body.\n     *\n     * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.\n     *\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n     */\n    usePolygonCollider(points, center = Vector.Zero) {\n        const poly = Shape.Polygon(points, center);\n        return (this.set(poly));\n    }\n    /**\n     * Sets up a [[Circle|circle collision geometry]] as the only collider with a specified radius in pixels.\n     *\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n     */\n    useCircleCollider(radius, center = Vector.Zero) {\n        const collider = Shape.Circle(radius, center);\n        return (this.set(collider));\n    }\n    /**\n     * Sets up an [[Edge|edge collision geometry]] with a start point and an end point relative to the anchor of the associated actor\n     * of this physics body.\n     *\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n     */\n    useEdgeCollider(begin, end) {\n        const collider = Shape.Edge(begin, end);\n        return (this.set(collider));\n    }\n    /**\n     * Setups up a [[CompositeCollider]] which can define any arbitrary set of excalibur colliders\n     * @param colliders\n     */\n    useCompositeCollider(colliders) {\n        return (this.set(new CompositeCollider(colliders)));\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/BodyComponent.ts\n\n\n\n\n\n\n\n\n\n\n\n\nvar DegreeOfFreedom;\n(function (DegreeOfFreedom) {\n    DegreeOfFreedom[\"Rotation\"] = \"rotation\";\n    DegreeOfFreedom[\"X\"] = \"x\";\n    DegreeOfFreedom[\"Y\"] = \"y\";\n})(DegreeOfFreedom || (DegreeOfFreedom = {}));\n/**\n * Body describes all the physical properties pos, vel, acc, rotation, angular velocity for the purpose of\n * of physics simulation.\n */\nclass BodyComponent extends Component {\n    constructor(options) {\n        var _a, _b, _c;\n        super();\n        this.dependencies = [TransformComponent, MotionComponent];\n        this.id = createId('body', BodyComponent._ID++);\n        this.events = new EventEmitter();\n        this.oldTransform = new transform_Transform();\n        /**\n         * Indicates whether the old transform has been captured at least once for interpolation\n         * @internal\n         */\n        this.__oldTransformCaptured = false;\n        /**\n         * Enable or disabled the fixed update interpolation, by default interpolation is on.\n         */\n        this.enableFixedUpdateInterpolate = true;\n        /**\n         * Collision type for the rigidbody physics simulation, by default [[CollisionType.PreventCollision]]\n         */\n        this.collisionType = CollisionType.PreventCollision;\n        /**\n         * The collision group for the body's colliders, by default body colliders collide with everything\n         */\n        this.group = CollisionGroup.All;\n        this._sleeping = false;\n        /**\n         * The also known as coefficient of restitution of this actor, represents the amount of energy preserved after collision or the\n         * bounciness. If 1, it is 100% bouncy, 0 it completely absorbs.\n         */\n        this.bounciness = 0.2;\n        /**\n         * The coefficient of friction on this actor\n         */\n        this.friction = 0.99;\n        /**\n         * Should use global gravity [[Physics.gravity]] in it's physics simulation, default is true\n         */\n        this.useGravity = true;\n        /**\n         * Degrees of freedom to limit\n         *\n         * Note: this only limits responses in the realistic solver, if velocity/angularVelocity is set the actor will still respond\n         */\n        this.limitDegreeOfFreedom = [];\n        /**\n         * The velocity of the actor last frame (vx, vy) in pixels/second\n         */\n        this.oldVel = new Vector(0, 0);\n        /**\n         * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\n         */\n        this.oldAcc = Vector.Zero;\n        if (options) {\n            this.collisionType = (_a = options.type) !== null && _a !== void 0 ? _a : this.collisionType;\n            this.group = (_b = options.group) !== null && _b !== void 0 ? _b : this.group;\n            this.useGravity = (_c = options.useGravity) !== null && _c !== void 0 ? _c : this.useGravity;\n            this._bodyConfig = {\n                ...DefaultPhysicsConfig.bodies,\n                ...options.config\n            };\n        }\n        else {\n            this._bodyConfig = {\n                ...DefaultPhysicsConfig.bodies\n            };\n        }\n        this.updatePhysicsConfig(this._bodyConfig);\n        this._mass = BodyComponent._DEFAULT_CONFIG.defaultMass;\n    }\n    get matrix() {\n        return this.transform.get().matrix;\n    }\n    /**\n     * Called by excalibur to update physics config defaults if they change\n     * @param config\n     */\n    updatePhysicsConfig(config) {\n        this._bodyConfig = {\n            ...DefaultPhysicsConfig.bodies,\n            ...config\n        };\n        this.canSleep = this._bodyConfig.canSleepByDefault;\n        this.sleepMotion = this._bodyConfig.sleepEpsilon * 5;\n        this.wakeThreshold = this._bodyConfig.wakeThreshold;\n    }\n    /**\n     * Called by excalibur to update defaults\n     * @param config\n     */\n    static updateDefaultPhysicsConfig(config) {\n        BodyComponent._DEFAULT_CONFIG = config;\n    }\n    get mass() {\n        return this._mass;\n    }\n    set mass(newMass) {\n        this._mass = newMass;\n        this._cachedInertia = undefined;\n        this._cachedInverseInertia = undefined;\n    }\n    /**\n     * The inverse mass (1/mass) of the body. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\n     */\n    get inverseMass() {\n        return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.mass;\n    }\n    ;\n    /**\n     * Whether this body is sleeping or not\n     */\n    get sleeping() {\n        return this._sleeping;\n    }\n    /**\n     * Set the sleep state of the body\n     * @param sleeping\n     */\n    setSleeping(sleeping) {\n        this._sleeping = sleeping;\n        if (!sleeping) {\n            // Give it a kick to keep it from falling asleep immediately\n            this.sleepMotion = this._bodyConfig.sleepEpsilon * 5;\n        }\n        else {\n            this.vel = Vector.Zero;\n            this.acc = Vector.Zero;\n            this.angularVelocity = 0;\n            this.sleepMotion = 0;\n        }\n    }\n    /**\n     * Update body's [[BodyComponent.sleepMotion]] for the purpose of sleeping\n     */\n    updateMotion() {\n        if (this._sleeping) {\n            this.setSleeping(true);\n        }\n        const currentMotion = this.vel.size * this.vel.size + Math.abs(this.angularVelocity * this.angularVelocity);\n        const bias = this._bodyConfig.sleepBias;\n        this.sleepMotion = bias * this.sleepMotion + (1 - bias) * currentMotion;\n        this.sleepMotion = clamp(this.sleepMotion, 0, 10 * this._bodyConfig.sleepEpsilon);\n        if (this.canSleep && this.sleepMotion < this._bodyConfig.sleepEpsilon) {\n            this.setSleeping(true);\n        }\n    }\n    /**\n     * Get the moment of inertia from the [[ColliderComponent]]\n     */\n    get inertia() {\n        if (this._cachedInertia) {\n            return this._cachedInertia;\n        }\n        // Inertia is a property of the geometry, so this is a little goofy but seems to be okay?\n        const collider = this.owner.get(ColliderComponent);\n        if (collider) {\n            collider.$colliderAdded.subscribe(() => {\n                this._cachedInertia = null;\n            });\n            collider.$colliderRemoved.subscribe(() => {\n                this._cachedInertia = null;\n            });\n            const maybeCollider = collider.get();\n            if (maybeCollider) {\n                return this._cachedInertia = maybeCollider.getInertia(this.mass);\n            }\n        }\n        return 0;\n    }\n    /**\n     * Get the inverse moment of inertial from the [[ColliderComponent]]. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\n     */\n    get inverseInertia() {\n        if (this._cachedInverseInertia) {\n            return this._cachedInverseInertia;\n        }\n        return this._cachedInverseInertia = this.collisionType === CollisionType.Fixed ? 0 : 1 / this.inertia;\n    }\n    /**\n     * Returns if the owner is active\n     */\n    get active() {\n        var _a;\n        return !!((_a = this.owner) === null || _a === void 0 ? void 0 : _a.active);\n    }\n    /**\n     * @deprecated Use globalP0s\n     */\n    get center() {\n        return this.globalPos;\n    }\n    get transform() {\n        var _a;\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\n    }\n    get motion() {\n        var _a;\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(MotionComponent);\n    }\n    get pos() {\n        return this.transform.pos;\n    }\n    set pos(val) {\n        this.transform.pos = val;\n    }\n    /**\n     * The (x, y) position of the actor this will be in the middle of the actor if the\n     * [[Actor.anchor]] is set to (0.5, 0.5) which is default.\n     * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).\n     */\n    get globalPos() {\n        return this.transform.globalPos;\n    }\n    set globalPos(val) {\n        this.transform.globalPos = val;\n    }\n    /**\n     * The position of the actor last frame (x, y) in pixels\n     */\n    get oldPos() {\n        return this.oldTransform.pos;\n    }\n    /**\n     * The current velocity vector (vx, vy) of the actor in pixels/second\n     */\n    get vel() {\n        return this.motion.vel;\n    }\n    set vel(val) {\n        this.motion.vel = val;\n    }\n    /**\n     * The current acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may\n     * be useful to simulate a gravitational effect.\n     */\n    get acc() {\n        return this.motion.acc;\n    }\n    set acc(val) {\n        this.motion.acc = val;\n    }\n    /**\n     * The current torque applied to the actor\n     */\n    get torque() {\n        return this.motion.torque;\n    }\n    set torque(val) {\n        this.motion.torque = val;\n    }\n    /**\n     * Gets/sets the rotation of the body from the last frame.\n     */\n    get oldRotation() {\n        return this.oldTransform.rotation;\n    }\n    /**\n     * The rotation of the body in radians\n     */\n    get rotation() {\n        return this.transform.globalRotation;\n    }\n    set rotation(val) {\n        this.transform.globalRotation = val;\n    }\n    /**\n     * The scale vector of the actor\n     */\n    get scale() {\n        return this.transform.globalScale;\n    }\n    set scale(val) {\n        this.transform.globalScale = val;\n    }\n    /**\n     * The scale of the actor last frame\n     */\n    get oldScale() {\n        return this.oldTransform.scale;\n    }\n    /**\n     * The scale rate of change of the actor in scale/second\n     */\n    get scaleFactor() {\n        return this.motion.scaleFactor;\n    }\n    set scaleFactor(scaleFactor) {\n        this.motion.scaleFactor = scaleFactor;\n    }\n    /**\n     * Get the angular velocity in radians/second\n     */\n    get angularVelocity() {\n        return this.motion.angularVelocity;\n    }\n    /**\n     * Set the angular velocity in radians/second\n     */\n    set angularVelocity(value) {\n        this.motion.angularVelocity = value;\n    }\n    /**\n     * Apply a specific impulse to the body\n     * @param point\n     * @param impulse\n     */\n    applyImpulse(point, impulse) {\n        if (this.collisionType !== CollisionType.Active) {\n            return; // only active objects participate in the simulation\n        }\n        const finalImpulse = impulse.scale(this.inverseMass);\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\n            finalImpulse.x = 0;\n        }\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\n            finalImpulse.y = 0;\n        }\n        this.vel.addEqual(finalImpulse);\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\n            const distanceFromCenter = point.sub(this.globalPos);\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\n        }\n    }\n    /**\n     * Apply only linear impulse to the body\n     * @param impulse\n     */\n    applyLinearImpulse(impulse) {\n        if (this.collisionType !== CollisionType.Active) {\n            return; // only active objects participate in the simulation\n        }\n        const finalImpulse = impulse.scale(this.inverseMass);\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\n            finalImpulse.x = 0;\n        }\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\n            finalImpulse.y = 0;\n        }\n        this.vel = this.vel.add(finalImpulse);\n    }\n    /**\n     * Apply only angular impulse to the body\n     * @param point\n     * @param impulse\n     */\n    applyAngularImpulse(point, impulse) {\n        if (this.collisionType !== CollisionType.Active) {\n            return; // only active objects participate in the simulation\n        }\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\n            const distanceFromCenter = point.sub(this.globalPos);\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\n        }\n    }\n    /**\n     * Sets the old versions of pos, vel, acc, and scale.\n     */\n    captureOldTransform() {\n        // Capture old values before integration step updates them\n        this.__oldTransformCaptured = true;\n        const tx = this.transform.get();\n        tx.clone(this.oldTransform);\n        this.oldTransform.parent = tx.parent; // also grab parent\n        this.oldVel.setTo(this.vel.x, this.vel.y);\n        this.oldAcc.setTo(this.acc.x, this.acc.y);\n    }\n    clone() {\n        const component = super.clone();\n        return component;\n    }\n}\nBodyComponent._ID = 0;\nBodyComponent._DEFAULT_CONFIG = {\n    ...DefaultPhysicsConfig.bodies\n};\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Entity.ts\n\n\n\n\n\n\n/**\n * AddedComponent message\n */\nclass AddedComponent {\n    constructor(data) {\n        this.data = data;\n        this.type = 'Component Added';\n    }\n}\n/**\n * Type guard to know if message is f an Added Component\n */\nfunction isAddedComponent(x) {\n    return !!x && x.type === 'Component Added';\n}\n/**\n * RemovedComponent message\n */\nclass RemovedComponent {\n    constructor(data) {\n        this.data = data;\n        this.type = 'Component Removed';\n    }\n}\n/**\n * Type guard to know if message is for a Removed Component\n */\nfunction isRemovedComponent(x) {\n    return !!x && x.type === 'Component Removed';\n}\nconst EntityEvents = {\n    Initialize: 'initialize',\n    PreUpdate: 'preupdate',\n    PostUpdate: 'postupdate',\n    Kill: 'kill'\n};\n/**\n * An Entity is the base type of anything that can have behavior in Excalibur, they are part of the built in entity component system\n *\n * Entities can be strongly typed with the components they contain\n *\n * ```typescript\n * const entity = new Entity<ComponentA | ComponentB>();\n * entity.components.a; // Type ComponentA\n * entity.components.b; // Type ComponentB\n * ```\n */\nclass Entity {\n    constructor(componentsOrOptions, name) {\n        /**\n         * The unique identifier for the entity\n         */\n        this.id = Entity._ID++;\n        this.name = `Entity#${this.id}`;\n        /**\n         * Listen to or emit events for an entity\n         */\n        this.events = new EventEmitter();\n        this._tags = new Set();\n        this.componentAdded$ = new Observable;\n        this.componentRemoved$ = new Observable;\n        this.tagAdded$ = new Observable;\n        this.tagRemoved$ = new Observable;\n        /**\n         * Current components on the entity\n         *\n         * **Do not modify**\n         *\n         * Use addComponent/removeComponent otherwise the ECS will not be notified of changes.\n         */\n        this.components = new Map();\n        this._componentsToRemove = [];\n        this._instanceOfComponentCacheDirty = true;\n        this._instanceOfComponentCache = new Map();\n        /**\n         * The current scene that the entity is in, if any\n         */\n        this.scene = null;\n        /**\n         * Whether this entity is active, if set to false it will be reclaimed\n         */\n        this.active = true;\n        this._parent = null;\n        this.childrenAdded$ = new Observable();\n        this.childrenRemoved$ = new Observable();\n        this._children = [];\n        this._isInitialized = false;\n        let componentsToAdd;\n        let nameToAdd;\n        if (Array.isArray(componentsOrOptions)) {\n            componentsToAdd = componentsOrOptions;\n            nameToAdd = name;\n        }\n        else if (componentsOrOptions && typeof componentsOrOptions === 'object') {\n            const { components, name } = componentsOrOptions;\n            componentsToAdd = components !== null && components !== void 0 ? components : [];\n            nameToAdd = name;\n        }\n        if (nameToAdd) {\n            this.name = nameToAdd;\n        }\n        if (componentsToAdd) {\n            for (const component of componentsToAdd) {\n                this.addComponent(component);\n            }\n        }\n        // this.addComponent(this.tagsComponent);\n    }\n    /**\n     * Kill the entity, means it will no longer be updated. Kills are deferred to the end of the update.\n     * If parented it will be removed from the parent when killed.\n     */\n    kill() {\n        if (this.active) {\n            this.active = false;\n            this.unparent();\n        }\n        this.emit('kill', new KillEvent(this));\n    }\n    isKilled() {\n        return !this.active;\n    }\n    /**\n     * Specifically get the tags on the entity from [[TagsComponent]]\n     */\n    get tags() {\n        return this._tags;\n    }\n    /**\n     * Check if a tag exists on the entity\n     * @param tag name to check for\n     */\n    hasTag(tag) {\n        return this._tags.has(tag);\n    }\n    /**\n     * Adds a tag to an entity\n     * @param tag\n     */\n    addTag(tag) {\n        this._tags.add(tag);\n        this.tagAdded$.notifyAll(tag);\n        return this;\n    }\n    /**\n     * Removes a tag on the entity\n     *\n     * Removals are deferred until the end of update\n     * @param tag\n     */\n    removeTag(tag) {\n        this._tags.delete(tag);\n        this.tagRemoved$.notifyAll(tag);\n        return this;\n    }\n    /**\n     * The types of the components on the Entity\n     */\n    get types() {\n        return Array.from(this.components.keys());\n    }\n    /**\n     * Returns all component instances on entity\n     */\n    getComponents() {\n        return Array.from(this.components.values());\n    }\n    /**\n     * Verifies that an entity has all the required types\n     * @param requiredTypes\n     */\n    hasAll(requiredTypes) {\n        for (let i = 0; i < requiredTypes.length; i++) {\n            if (!this.components.has(requiredTypes[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Verifies that an entity has all the required tags\n     * @param requiredTags\n     */\n    hasAllTags(requiredTags) {\n        for (let i = 0; i < requiredTags.length; i++) {\n            if (!this.tags.has(requiredTags[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    _getCachedInstanceOfType(type) {\n        if (this._instanceOfComponentCacheDirty) {\n            this._instanceOfComponentCacheDirty = false;\n            this._instanceOfComponentCache.clear();\n        }\n        if (this._instanceOfComponentCache.has(type)) {\n            return this._instanceOfComponentCache.get(type);\n        }\n        for (const instance of this.components.values()) {\n            if (instance instanceof type) {\n                this._instanceOfComponentCache.set(type, instance);\n                return instance;\n            }\n        }\n        return undefined;\n    }\n    get(type) {\n        const maybeComponent = this._getCachedInstanceOfType(type);\n        return maybeComponent !== null && maybeComponent !== void 0 ? maybeComponent : this.components.get(type);\n    }\n    get parent() {\n        return this._parent;\n    }\n    /**\n     * Get the direct children of this entity\n     */\n    get children() {\n        return this._children;\n    }\n    /**\n     * Unparents this entity, if there is a parent. Otherwise it does nothing.\n     */\n    unparent() {\n        if (this._parent) {\n            this._parent.removeChild(this);\n            this._parent = null;\n        }\n    }\n    /**\n     * Adds an entity to be a child of this entity\n     * @param entity\n     */\n    addChild(entity) {\n        if (entity.parent === null) {\n            if (this.getAncestors().includes(entity)) {\n                throw new Error('Cycle detected, cannot add entity');\n            }\n            this._children.push(entity);\n            entity._parent = this;\n            this.childrenAdded$.notifyAll(entity);\n        }\n        else {\n            throw new Error('Entity already has a parent, cannot add without unparenting');\n        }\n        return this;\n    }\n    /**\n     * Remove an entity from children if it exists\n     * @param entity\n     */\n    removeChild(entity) {\n        if (entity.parent === this) {\n            removeItemFromArray(entity, this._children);\n            entity._parent = null;\n            this.childrenRemoved$.notifyAll(entity);\n        }\n        return this;\n    }\n    /**\n     * Removes all children from this entity\n     */\n    removeAllChildren() {\n        // Avoid modifying the array issue by walking backwards\n        for (let i = this.children.length - 1; i >= 0; i--) {\n            this.removeChild(this.children[i]);\n        }\n        return this;\n    }\n    /**\n     * Returns a list of parent entities starting with the topmost parent. Includes the current entity.\n     */\n    getAncestors() {\n        const result = [this];\n        let current = this.parent;\n        while (current) {\n            result.push(current);\n            current = current.parent;\n        }\n        return result.reverse();\n    }\n    /**\n     * Returns a list of all the entities that descend from this entity. Includes the current entity.\n     */\n    getDescendants() {\n        let result = [this];\n        let queue = [this];\n        while (queue.length > 0) {\n            const curr = queue.pop();\n            if (curr) {\n                queue = queue.concat(curr.children);\n                result = result.concat(curr.children);\n            }\n        }\n        return result;\n    }\n    /**\n     * Creates a deep copy of the entity and a copy of all its components\n     */\n    clone() {\n        const newEntity = new Entity();\n        for (const c of this.types) {\n            const componentInstance = this.get(c);\n            if (componentInstance) {\n                newEntity.addComponent(componentInstance.clone());\n            }\n        }\n        for (const child of this.children) {\n            newEntity.addChild(child.clone());\n        }\n        return newEntity;\n    }\n    /**\n     * Adds a copy of all the components from another template entity as a \"prefab\"\n     * @param templateEntity Entity to use as a template\n     * @param force Force component replacement if it already exists on the target entity\n     */\n    addTemplate(templateEntity, force = false) {\n        for (const c of templateEntity.getComponents()) {\n            this.addComponent(c.clone(), force);\n        }\n        for (const child of templateEntity.children) {\n            this.addChild(child.clone().addTemplate(child));\n        }\n        return this;\n    }\n    /**\n     * Adds a component to the entity\n     * @param component Component or Entity to add copy of components from\n     * @param force Optionally overwrite any existing components of the same type\n     */\n    addComponent(component, force = false) {\n        this._instanceOfComponentCacheDirty = true;\n        // if component already exists, skip if not forced\n        if (this.has(component.constructor)) {\n            if (force) {\n                // Remove existing component type if exists when forced\n                this.removeComponent(component.constructor, true);\n            }\n            else {\n                // early exit component exits\n                return this;\n            }\n        }\n        // TODO circular dependencies will be a problem\n        if (component.dependencies && component.dependencies.length) {\n            for (const ctor of component.dependencies) {\n                this.addComponent(new ctor());\n            }\n        }\n        component.owner = this;\n        this.components.set(component.constructor, component);\n        if (component.onAdd) {\n            component.onAdd(this);\n        }\n        this.componentAdded$.notifyAll(component);\n        return this;\n    }\n    /**\n     * Removes a component from the entity, by default removals are deferred to the end of entity update to avoid consistency issues\n     *\n     * Components can be force removed with the `force` flag, the removal is not deferred and happens immediately\n     * @param typeOrInstance\n     * @param force\n     */\n    removeComponent(typeOrInstance, force = false) {\n        let type;\n        if (isComponentCtor(typeOrInstance)) {\n            type = typeOrInstance;\n        }\n        else {\n            type = typeOrInstance.constructor;\n        }\n        if (force) {\n            const componentToRemove = this.components.get(type);\n            if (componentToRemove) {\n                this.componentRemoved$.notifyAll(componentToRemove);\n                componentToRemove.owner = undefined;\n                if (componentToRemove.onRemove) {\n                    componentToRemove.onRemove(this);\n                }\n            }\n            this.components.delete(type); // remove after the notify to preserve typing\n            this._instanceOfComponentCacheDirty = true;\n        }\n        else {\n            this._componentsToRemove.push(type);\n        }\n        return this;\n    }\n    clearComponents() {\n        const components = this.types;\n        for (const c of components) {\n            this.removeComponent(c);\n        }\n    }\n    /**\n     * @hidden\n     * @internal\n     */\n    processComponentRemoval() {\n        for (const type of this._componentsToRemove) {\n            this.removeComponent(type, true);\n        }\n        this._componentsToRemove.length = 0;\n    }\n    /**\n     * Check if a component type exists\n     * @param type\n     */\n    has(type) {\n        return this.components.has(type);\n    }\n    /**\n     * Gets whether the actor is Initialized\n     */\n    get isInitialized() {\n        return this._isInitialized;\n    }\n    /**\n     * Initializes this entity, meant to be called by the Scene before first update not by users of Excalibur.\n     *\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     * @internal\n     */\n    _initialize(engine) {\n        if (!this.isInitialized) {\n            this.onInitialize(engine);\n            this.events.emit('initialize', new InitializeEvent(engine, this));\n            this._isInitialized = true;\n        }\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n     * @internal\n     */\n    _preupdate(engine, delta) {\n        this.events.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n        this.onPreUpdate(engine, delta);\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n     * @internal\n     */\n    _postupdate(engine, delta) {\n        this.events.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n        this.onPostUpdate(engine, delta);\n    }\n    /**\n     * `onInitialize` is called before the first update of the entity. This method is meant to be\n     * overridden.\n     *\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\n     */\n    onInitialize(engine) {\n        // Override me\n    }\n    /**\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPreUpdate` is called directly before an entity is updated.\n     */\n    onPreUpdate(engine, delta) {\n        // Override me\n    }\n    /**\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\n     *\n     * `onPostUpdate` is called directly after an entity is updated.\n     */\n    onPostUpdate(engine, delta) {\n        // Override me\n    }\n    /**\n     *\n     * Entity update lifecycle, called internally\n     * @internal\n     * @param engine\n     * @param delta\n     */\n    update(engine, delta) {\n        this._initialize(engine);\n        this._preupdate(engine, delta);\n        for (const child of this.children) {\n            child.update(engine, delta);\n        }\n        this._postupdate(engine, delta);\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        if (handler) {\n            this.events.off(eventName, handler);\n        }\n        else {\n            this.events.off(eventName);\n        }\n    }\n}\nEntity._ID = 0;\n\n;// CONCATENATED MODULE: ./Graphics/Animation.ts\n\n\n\n\nvar AnimationDirection;\n(function (AnimationDirection) {\n    /**\n     * Animation is playing forwards\n     */\n    AnimationDirection[\"Forward\"] = \"forward\";\n    /**\n     * Animation is playing backwards\n     */\n    AnimationDirection[\"Backward\"] = \"backward\";\n})(AnimationDirection || (AnimationDirection = {}));\nvar AnimationStrategy;\n(function (AnimationStrategy) {\n    /**\n     * Animation ends without displaying anything\n     */\n    AnimationStrategy[\"End\"] = \"end\";\n    /**\n     * Animation loops to the first frame after the last frame\n     */\n    AnimationStrategy[\"Loop\"] = \"loop\";\n    /**\n     * Animation plays to the last frame, then backwards to the first frame, then repeats\n     */\n    AnimationStrategy[\"PingPong\"] = \"pingpong\";\n    /**\n     * Animation ends stopping on the last frame\n     */\n    AnimationStrategy[\"Freeze\"] = \"freeze\";\n})(AnimationStrategy || (AnimationStrategy = {}));\nconst AnimationEvents = {\n    Frame: 'frame',\n    Loop: 'loop',\n    End: 'end'\n};\n/**\n * Create an Animation given a list of [[Frame|frames]] in [[AnimationOptions]]\n *\n * To create an Animation from a [[SpriteSheet]], use [[Animation.fromSpriteSheet]]\n */\nclass Animation extends Graphic {\n    constructor(options) {\n        var _a, _b, _c;\n        super(options);\n        this.events = new EventEmitter();\n        this.frames = [];\n        this.strategy = AnimationStrategy.Loop;\n        this.frameDuration = 100;\n        this._idempotencyToken = -1;\n        this._firstTick = true;\n        this._currentFrame = 0;\n        this._timeLeftInFrame = 0;\n        this._pingPongDirection = 1;\n        this._done = false;\n        this._playing = true;\n        this._speed = 1;\n        this._reversed = false;\n        this.frames = options.frames;\n        this.speed = (_a = options.speed) !== null && _a !== void 0 ? _a : this.speed;\n        this.strategy = (_b = options.strategy) !== null && _b !== void 0 ? _b : this.strategy;\n        this.frameDuration = options.totalDuration ? options.totalDuration / this.frames.length : (_c = options.frameDuration) !== null && _c !== void 0 ? _c : this.frameDuration;\n        if (options.reverse) {\n            this.reverse();\n        }\n        this.goToFrame(0);\n    }\n    clone() {\n        return new Animation({\n            frames: this.frames.map((f) => ({ ...f })),\n            frameDuration: this.frameDuration,\n            speed: this.speed,\n            reverse: this._reversed,\n            strategy: this.strategy,\n            ...this.cloneGraphicOptions()\n        });\n    }\n    get width() {\n        const maybeFrame = this.currentFrame;\n        if (maybeFrame) {\n            return Math.abs(maybeFrame.graphic.width * this.scale.x);\n        }\n        return 0;\n    }\n    get height() {\n        const maybeFrame = this.currentFrame;\n        if (maybeFrame) {\n            return Math.abs(maybeFrame.graphic.height * this.scale.y);\n        }\n        return 0;\n    }\n    /**\n     * Create an Animation from a [[SpriteSheet]], a list of indices into the sprite sheet, a duration per frame\n     * and optional [[AnimationStrategy]]\n     *\n     * Example:\n     * ```typescript\n     * const spriteSheet = SpriteSheet.fromImageSource({...});\n     *\n     * const anim = Animation.fromSpriteSheet(spriteSheet, range(0, 5), 200, AnimationStrategy.Loop);\n     * ```\n     * @param spriteSheet\n     * @param frameIndices\n     * @param durationPerFrameMs\n     * @param strategy\n     */\n    static fromSpriteSheet(spriteSheet, frameIndices, durationPerFrameMs, strategy = AnimationStrategy.Loop) {\n        const maxIndex = spriteSheet.sprites.length - 1;\n        const invalidIndices = frameIndices.filter((index) => index < 0 || index > maxIndex);\n        if (invalidIndices.length) {\n            Animation._LOGGER.warn(`Indices into SpriteSheet were provided that don\\'t exist: ${invalidIndices.join(',')} no frame will be shown`);\n        }\n        return new Animation({\n            frames: spriteSheet.sprites\n                .filter((_, index) => frameIndices.indexOf(index) > -1)\n                .map((f) => ({\n                graphic: f,\n                duration: durationPerFrameMs\n            })),\n            strategy: strategy\n        });\n    }\n    /**\n     * Create an [[Animation]] from a [[SpriteSheet]] given a list of coordinates\n     *\n     * Example:\n     * ```typescript\n     * const spriteSheet = SpriteSheet.fromImageSource({...});\n     *\n     * const anim = Animation.fromSpriteSheetCoordinates({\n     *  spriteSheet,\n     *  frameCoordinates: [\n     *    {x: 0, y: 5, duration: 100, options { flipHorizontal: true }},\n     *    {x: 1, y: 5, duration: 200},\n     *    {x: 2, y: 5, duration: 100},\n     *    {x: 3, y: 5, duration: 500}\n     *  ],\n     *  strategy: AnimationStrategy.PingPong\n     * });\n     * ```\n     * @param options\n     * @returns Animation\n     */\n    static fromSpriteSheetCoordinates(options) {\n        const { spriteSheet, frameCoordinates, durationPerFrameMs, speed, strategy, reverse } = options;\n        const defaultDuration = durationPerFrameMs !== null && durationPerFrameMs !== void 0 ? durationPerFrameMs : 100;\n        const frames = [];\n        for (const coord of frameCoordinates) {\n            const { x, y, duration, options } = coord;\n            const sprite = spriteSheet.getSprite(x, y, options);\n            if (sprite) {\n                frames.push({\n                    graphic: sprite,\n                    duration: duration !== null && duration !== void 0 ? duration : defaultDuration\n                });\n            }\n            else {\n                Animation._LOGGER.warn(`Skipping frame! SpriteSheet does not have coordinate (${x}, ${y}), please check your SpriteSheet to confirm that sprite exists`);\n            }\n        }\n        return new Animation({\n            frames,\n            strategy,\n            speed,\n            reverse\n        });\n    }\n    /**\n     * Current animation speed\n     *\n     * 1 meaning normal 1x speed.\n     * 2 meaning 2x speed and so on.\n     */\n    get speed() {\n        return this._speed;\n    }\n    /**\n     * Current animation speed\n     *\n     * 1 meaning normal 1x speed.\n     * 2 meaning 2x speed and so on.\n     */\n    set speed(val) {\n        this._speed = clamp(Math.abs(val), 0, Infinity);\n    }\n    /**\n     * Returns the current Frame of the animation\n     *\n     * Use [[Animation.currentFrameIndex]] to get the frame number and\n     * [[Animation.goToFrame]] to set the current frame index\n     */\n    get currentFrame() {\n        if (this._currentFrame >= 0 && this._currentFrame < this.frames.length) {\n            return this.frames[this._currentFrame];\n        }\n        return null;\n    }\n    /**\n     * Returns the current frame index of the animation\n     *\n     * Use [[Animation.currentFrame]] to grab the current [[Frame]] object\n     */\n    get currentFrameIndex() {\n        return this._currentFrame;\n    }\n    /**\n     * Returns the amount of time in milliseconds left in the current frame\n     */\n    get currentFrameTimeLeft() {\n        return this._timeLeftInFrame;\n    }\n    /**\n     * Returns `true` if the animation is playing\n     */\n    get isPlaying() {\n        return this._playing;\n    }\n    /**\n     * Reverses the play direction of the Animation, this preserves the current frame\n     */\n    reverse() {\n        // Don't mutate with the original frame list, create a copy\n        this.frames = this.frames.slice().reverse();\n        this._reversed = !this._reversed;\n    }\n    /**\n     * Returns the current play direction of the animation\n     */\n    get direction() {\n        // Keep logically consistent with ping-pong direction\n        // If ping-pong is forward = 1 and reversed is true then we are logically reversed\n        const reversed = (this._reversed && this._pingPongDirection === 1) ? true : false;\n        return reversed ? AnimationDirection.Backward : AnimationDirection.Forward;\n    }\n    /**\n     * Plays or resumes the animation from the current frame\n     */\n    play() {\n        this._playing = true;\n    }\n    /**\n     * Pauses the animation on the current frame\n     */\n    pause() {\n        this._playing = false;\n        this._firstTick = true; // firstTick must be set to emit the proper frame event\n    }\n    /**\n     * Reset the animation back to the beginning, including if the animation were done\n     */\n    reset() {\n        this._done = false;\n        this._firstTick = true;\n        this._currentFrame = 0;\n        this._timeLeftInFrame = this.frameDuration;\n        const maybeFrame = this.frames[this._currentFrame];\n        if (maybeFrame) {\n            this._timeLeftInFrame = ((maybeFrame === null || maybeFrame === void 0 ? void 0 : maybeFrame.duration) || this.frameDuration);\n        }\n    }\n    /**\n     * Returns `true` if the animation can end\n     */\n    get canFinish() {\n        switch (this.strategy) {\n            case AnimationStrategy.End:\n            case AnimationStrategy.Freeze: {\n                return true;\n            }\n            default: {\n                return false;\n            }\n        }\n    }\n    /**\n     * Returns `true` if the animation is done, for looping type animations\n     * `ex.AnimationStrategy.PingPong` and `ex.AnimationStrategy.Loop` this will always return `false`\n     *\n     * See the `ex.Animation.canFinish()` method to know if an animation type can end\n     */\n    get done() {\n        return this._done;\n    }\n    /**\n     * Jump the animation immediately to a specific frame if it exists\n     *\n     * Optionally specify an override for the duration of the frame, useful for\n     * keeping multiple animations in sync with one another.\n     * @param frameNumber\n     * @param duration\n     */\n    goToFrame(frameNumber, duration) {\n        this._currentFrame = frameNumber;\n        this._timeLeftInFrame = duration !== null && duration !== void 0 ? duration : this.frameDuration;\n        const maybeFrame = this.frames[this._currentFrame];\n        if (maybeFrame && !this._done) {\n            this._timeLeftInFrame = duration !== null && duration !== void 0 ? duration : ((maybeFrame === null || maybeFrame === void 0 ? void 0 : maybeFrame.duration) || this.frameDuration);\n            this.events.emit('frame', { ...maybeFrame, frameIndex: this.currentFrameIndex });\n        }\n    }\n    _nextFrame() {\n        const currentFrame = this._currentFrame;\n        if (this._done) {\n            return currentFrame;\n        }\n        let next = -1;\n        switch (this.strategy) {\n            case AnimationStrategy.Loop: {\n                next = (currentFrame + 1) % this.frames.length;\n                if (next === 0) {\n                    this.events.emit('loop', this);\n                }\n                break;\n            }\n            case AnimationStrategy.End: {\n                next = currentFrame + 1;\n                if (next >= this.frames.length) {\n                    this._done = true;\n                    this._currentFrame = this.frames.length;\n                    this.events.emit('end', this);\n                }\n                break;\n            }\n            case AnimationStrategy.Freeze: {\n                next = clamp(currentFrame + 1, 0, this.frames.length - 1);\n                if (next >= this.frames.length - 1) {\n                    this._done = true;\n                    this.events.emit('end', this);\n                }\n                break;\n            }\n            case AnimationStrategy.PingPong: {\n                if (currentFrame + this._pingPongDirection >= this.frames.length) {\n                    this._pingPongDirection = -1;\n                    this.events.emit('loop', this);\n                }\n                if (currentFrame + this._pingPongDirection < 0) {\n                    this._pingPongDirection = 1;\n                    this.events.emit('loop', this);\n                }\n                next = currentFrame + (this._pingPongDirection % this.frames.length);\n                break;\n            }\n        }\n        return next;\n    }\n    /**\n     * Called internally by Excalibur to update the state of the animation potential update the current frame\n     * @param elapsedMilliseconds Milliseconds elapsed\n     * @param idempotencyToken Prevents double ticking in a frame by passing a unique token to the frame\n     */\n    tick(elapsedMilliseconds, idempotencyToken = 0) {\n        if (this._idempotencyToken === idempotencyToken) {\n            return;\n        }\n        this._idempotencyToken = idempotencyToken;\n        if (!this._playing) {\n            return;\n        }\n        // if it's the first frame emit frame event\n        if (this._firstTick) {\n            this._firstTick = false;\n            this.events.emit('frame', { ...this.currentFrame, frameIndex: this.currentFrameIndex });\n        }\n        this._timeLeftInFrame -= elapsedMilliseconds * this._speed;\n        if (this._timeLeftInFrame <= 0) {\n            this.goToFrame(this._nextFrame());\n        }\n    }\n    _drawImage(ctx, x, y) {\n        if (this.currentFrame) {\n            this.currentFrame.graphic.draw(ctx, x, y);\n        }\n    }\n}\nAnimation._LOGGER = Logger.getInstance();\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsGroup.ts\n\n\n\n\n\nclass GraphicsGroup extends Graphic {\n    constructor(options) {\n        var _a;\n        super(options);\n        this._logger = Logger.getInstance();\n        this.useAnchor = true;\n        this.members = [];\n        this.members = options.members;\n        this.useAnchor = (_a = options.useAnchor) !== null && _a !== void 0 ? _a : this.useAnchor;\n        this._updateDimensions();\n    }\n    clone() {\n        return new GraphicsGroup({\n            members: [...this.members],\n            ...this.cloneGraphicOptions()\n        });\n    }\n    _updateDimensions() {\n        const bb = this.localBounds;\n        this.width = bb.width;\n        this.height = bb.height;\n        return bb;\n    }\n    get localBounds() {\n        let bb = new BoundingBox();\n        for (const member of this.members) {\n            if (member instanceof Graphic) {\n                bb = member.localBounds.combine(bb);\n            }\n            else {\n                const { graphic, offset: pos, useBounds } = member;\n                const shouldUseBounds = useBounds === undefined ? true : useBounds;\n                if (graphic) {\n                    if (shouldUseBounds) {\n                        bb = graphic.localBounds.translate(pos).combine(bb);\n                    }\n                }\n                else {\n                    this._logger.warnOnce(`Graphics group member has an null or undefined graphic, member definition: ${JSON.stringify(member)}.`);\n                }\n            }\n        }\n        return bb;\n    }\n    _isAnimationOrGroup(graphic) {\n        return graphic instanceof Animation || graphic instanceof GraphicsGroup;\n    }\n    tick(elapsedMilliseconds, idempotencyToken) {\n        for (const member of this.members) {\n            let graphic;\n            if (member instanceof Graphic) {\n                graphic = member;\n            }\n            else {\n                graphic = member.graphic;\n            }\n            if (this._isAnimationOrGroup(graphic)) {\n                graphic.tick(elapsedMilliseconds, idempotencyToken);\n            }\n        }\n    }\n    reset() {\n        for (const member of this.members) {\n            let graphic;\n            if (member instanceof Graphic) {\n                graphic = member;\n            }\n            else {\n                graphic = member.graphic;\n            }\n            if (this._isAnimationOrGroup(graphic)) {\n                graphic.reset();\n            }\n        }\n    }\n    _preDraw(ex, x, y) {\n        this._updateDimensions();\n        super._preDraw(ex, this.useAnchor ? x : 0, this.useAnchor ? y : 0);\n    }\n    _drawImage(ex, x, y) {\n        const pos = Vector.Zero;\n        for (const member of this.members) {\n            let graphic;\n            if (member instanceof Graphic) {\n                graphic = member;\n            }\n            else {\n                graphic = member.graphic;\n                member.offset.clone(pos);\n            }\n            if (!graphic) {\n                continue;\n            }\n            ex.save();\n            ex.translate(x, y);\n            graphic.draw(ex, pos.x, pos.y);\n            if (this.showDebug) {\n                /* istanbul ignore next */\n                ex.debug.drawRect(0, 0, this.width, this.height);\n            }\n            ex.restore();\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsComponent.ts\n\n\n\n\n\n\n\n\n/**\n * Type guard for checking if a Graphic HasTick (used for graphics that change over time like animations)\n * @param graphic\n */\nfunction hasGraphicsTick(graphic) {\n    return !!graphic.tick;\n}\n/**\n * Component to manage drawings, using with the position component\n */\nclass GraphicsComponent extends Component {\n    /**\n     * Offset to apply to graphics by default\n     */\n    get offset() {\n        return new WatchVector(this._offset, () => {\n            this.recalculateBounds();\n        });\n    }\n    set offset(value) {\n        this._offset = value;\n        this.recalculateBounds();\n    }\n    /**\n     * Anchor to apply to graphics by default\n     */\n    get anchor() {\n        return new WatchVector(this._anchor, () => {\n            this.recalculateBounds();\n        });\n    }\n    set anchor(value) {\n        this._anchor = value;\n        this.recalculateBounds();\n    }\n    constructor(options) {\n        super();\n        this._logger = Logger.getInstance();\n        this._current = 'default';\n        this._graphics = {};\n        this._options = {};\n        this.material = null;\n        /**\n         * Sets or gets wether any drawing should be visible in this component\n         */\n        this.visible = true;\n        /**\n         * Sets or gets wither all drawings should have an opacity applied\n         */\n        this.opacity = 1;\n        this._offset = Vector.Zero;\n        this._anchor = Vector.Half;\n        /**\n         * Flip all graphics horizontally along the y-axis\n         */\n        this.flipHorizontal = false;\n        /**\n         * Flip all graphics vertically along the x-axis\n         */\n        this.flipVertical = false;\n        /**\n         * If set to true graphics added to the component will be copied. This can effect performance, but is useful if you don't want\n         * changes to a graphic to effect all the places it is used.\n         */\n        this.copyGraphics = false;\n        this._localBounds = null;\n        // Defaults\n        options = {\n            visible: this.visible,\n            graphics: {},\n            ...options\n        };\n        const { current, anchor, opacity, visible, graphics, offset, copyGraphics, onPreDraw, onPostDraw, onPreTransformDraw, onPostTransformDraw } = options;\n        for (const [key, graphicOrOptions] of Object.entries(graphics)) {\n            if (graphicOrOptions instanceof Graphic) {\n                this._graphics[key] = graphicOrOptions;\n            }\n            else {\n                this._graphics[key] = graphicOrOptions.graphic;\n                this._options[key] = graphicOrOptions.options;\n            }\n        }\n        this.offset = offset !== null && offset !== void 0 ? offset : this.offset;\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : this.anchor;\n        this.copyGraphics = copyGraphics !== null && copyGraphics !== void 0 ? copyGraphics : this.copyGraphics;\n        this.onPreDraw = onPreDraw !== null && onPreDraw !== void 0 ? onPreDraw : this.onPreDraw;\n        this.onPostDraw = onPostDraw !== null && onPostDraw !== void 0 ? onPostDraw : this.onPostDraw;\n        this.onPreDraw = onPreTransformDraw !== null && onPreTransformDraw !== void 0 ? onPreTransformDraw : this.onPreTransformDraw;\n        this.onPostTransformDraw = onPostTransformDraw !== null && onPostTransformDraw !== void 0 ? onPostTransformDraw : this.onPostTransformDraw;\n        this.visible = !!visible;\n        this._current = current !== null && current !== void 0 ? current : this._current;\n        if (current && this._graphics[current]) {\n            this.use(current);\n        }\n    }\n    getGraphic(name) {\n        return this._graphics[name];\n    }\n    getOptions(name) {\n        return this._options[name];\n    }\n    /**\n     * Get registered graphics names\n     */\n    getNames() {\n        return Object.keys(this._graphics);\n    }\n    /**\n     * Returns the currently displayed graphic\n     */\n    get current() {\n        return this._graphics[this._current];\n    }\n    /**\n     * Returns the currently displayed graphic offsets\n     */\n    get currentOptions() {\n        return this._options[this._current];\n    }\n    /**\n     * Returns all graphics associated with this component\n     */\n    get graphics() {\n        return this._graphics;\n    }\n    /**\n     * Returns all graphics options associated with this component\n     */\n    get options() {\n        return this._options;\n    }\n    add(nameOrGraphic, graphicOrOptions, options) {\n        let name = 'default';\n        let graphicToSet = null;\n        let optionsToSet = undefined;\n        if (typeof nameOrGraphic === 'string' && graphicOrOptions instanceof Graphic) {\n            name = nameOrGraphic;\n            graphicToSet = graphicOrOptions;\n            optionsToSet = options;\n        }\n        if (nameOrGraphic instanceof Graphic && !(graphicOrOptions instanceof Graphic)) {\n            graphicToSet = nameOrGraphic;\n            optionsToSet = graphicOrOptions;\n        }\n        this._graphics[name] = this.copyGraphics ? graphicToSet.clone() : graphicToSet;\n        this._options[name] = this.copyGraphics ? { ...optionsToSet } : optionsToSet;\n        if (name === 'default') {\n            this.use('default');\n        }\n        return graphicToSet;\n    }\n    /**\n     * Removes a registered graphic, if the removed graphic is the current it will switch to the default\n     * @param name\n     */\n    remove(name) {\n        delete this._graphics[name];\n        delete this._options[name];\n        if (this._current === name) {\n            this._current = 'default';\n            this.recalculateBounds();\n        }\n    }\n    /**\n     * Shows a graphic, will be removed\n     * @param nameOrGraphic\n     * @param options\n     * @deprecated will be removed in v0.30.0, use `graphics.use(...)`\n     */\n    show(nameOrGraphic, options) {\n        return this.use(nameOrGraphic, options);\n    }\n    /**\n     * Use a graphic only, will set the default graphic. Returns the new [[Graphic]]\n     *\n     * Optionally override the stored options\n     * @param nameOrGraphic\n     * @param options\n     */\n    use(nameOrGraphic, options) {\n        var _a;\n        if (nameOrGraphic instanceof Graphic) {\n            let graphic = nameOrGraphic;\n            if (this.copyGraphics) {\n                graphic = nameOrGraphic.clone();\n            }\n            this._current = 'default';\n            this._graphics[this._current] = graphic;\n            this._options[this._current] = options;\n        }\n        else {\n            this._current = nameOrGraphic;\n            this._options[this._current] = options;\n            if (!(this._current in this._graphics)) {\n                this._logger.warn(`Graphic ${this._current} is not registered with the graphics component owned by ${(_a = this.owner) === null || _a === void 0 ? void 0 : _a.name}. Nothing will be drawn.`);\n            }\n        }\n        this.recalculateBounds();\n        return this.current;\n    }\n    /**\n     * Hide currently shown graphic\n     */\n    hide() {\n        this._current = 'ex.none';\n    }\n    set localBounds(bounds) {\n        this._localBounds = bounds;\n    }\n    recalculateBounds() {\n        let bb = new BoundingBox();\n        const graphic = this._graphics[this._current];\n        const options = this._options[this._current];\n        if (!graphic) {\n            this._localBounds = bb;\n            return;\n        }\n        let anchor = this.anchor;\n        let offset = this.offset;\n        if (options === null || options === void 0 ? void 0 : options.anchor) {\n            anchor = options.anchor;\n        }\n        if (options === null || options === void 0 ? void 0 : options.offset) {\n            offset = options.offset;\n        }\n        const bounds = graphic.localBounds;\n        const offsetX = -bounds.width * anchor.x + offset.x;\n        const offsetY = -bounds.height * anchor.y + offset.y;\n        if (graphic instanceof GraphicsGroup && !graphic.useAnchor) {\n            bb = graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.combine(bb);\n        }\n        else {\n            bb = graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(vec(offsetX, offsetY)).combine(bb);\n        }\n        this._localBounds = bb;\n    }\n    /**\n     * Get local bounds of graphics component\n     */\n    get localBounds() {\n        if (!this._localBounds || this._localBounds.hasZeroDimensions()) {\n            this.recalculateBounds();\n        }\n        return this._localBounds;\n    }\n    /**\n     * Get world bounds of graphics component\n     */\n    get bounds() {\n        let bounds = this.localBounds;\n        if (this.owner) {\n            const tx = this.owner.get(TransformComponent);\n            if (tx) {\n                bounds = bounds.transform(tx.get().matrix);\n            }\n        }\n        return bounds;\n    }\n    /**\n     * Update underlying graphics if necessary, called internally\n     * @param elapsed\n     * @internal\n     */\n    update(elapsed, idempotencyToken = 0) {\n        const graphic = this.current;\n        if (graphic && hasGraphicsTick(graphic)) {\n            graphic.tick(elapsed, idempotencyToken);\n        }\n    }\n    clone() {\n        const graphics = new GraphicsComponent();\n        graphics._graphics = { ...this._graphics };\n        graphics._options = { ...this._options };\n        graphics.offset = this.offset.clone();\n        graphics.opacity = this.opacity;\n        graphics.anchor = this.anchor.clone();\n        graphics.copyGraphics = this.copyGraphics;\n        graphics.onPreDraw = this.onPreDraw;\n        graphics.onPostDraw = this.onPostDraw;\n        graphics.visible = this.visible;\n        return graphics;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Rectangle.ts\n\n/**\n * A Rectangle [[Graphic]] for drawing rectangles to the [[ExcaliburGraphicsContext]]\n */\nclass Rectangle extends Raster {\n    constructor(options) {\n        super(options);\n        this.width = options.width;\n        this.height = options.height;\n        this.rasterize();\n    }\n    clone() {\n        return new Rectangle({\n            width: this.width,\n            height: this.height,\n            ...this.cloneGraphicOptions(),\n            ...this.cloneRasterOptions()\n        });\n    }\n    execute(ctx) {\n        if (this.color) {\n            ctx.fillRect(0, 0, this.width, this.height);\n        }\n        if (this.strokeColor) {\n            ctx.strokeRect(0, 0, this.width, this.height);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Circle.ts\n\n\n/**\n * A circle [[Graphic]] for drawing circles to the [[ExcaliburGraphicsContext]]\n *\n * Circles default to [[ImageFiltering.Blended]]\n */\nclass Circle extends Raster {\n    get radius() {\n        return this._radius;\n    }\n    set radius(value) {\n        this._radius = value;\n        this.width = this._radius * 2;\n        this.height = this._radius * 2;\n        this.flagDirty();\n    }\n    constructor(options) {\n        var _a, _b, _c;\n        super(options);\n        this._radius = 0;\n        const lineWidth = (_a = options.lineWidth) !== null && _a !== void 0 ? _a : (options.strokeColor ? 1 : 0); // default lineWidth in canvas is 1px\n        this.padding = (_b = options.padding) !== null && _b !== void 0 ? _b : 2 + (lineWidth / 2); // default 2 padding for circles looks nice\n        this.radius = options.radius;\n        this.filtering = (_c = options.filtering) !== null && _c !== void 0 ? _c : ImageFiltering.Blended;\n        this.rasterize();\n    }\n    clone() {\n        return new Circle({\n            radius: this.radius,\n            ...this.cloneGraphicOptions(),\n            ...this.cloneRasterOptions()\n        });\n    }\n    execute(ctx) {\n        if (this.radius > 0) {\n            ctx.beginPath();\n            ctx.arc(this.radius, this.radius, this.radius, 0, Math.PI * 2);\n            if (this.color) {\n                ctx.fill();\n            }\n            if (this.strokeColor) {\n                ctx.stroke();\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/PointerComponent.ts\n\n/**\n * Add this component to optionally configure how the pointer\n * system detects pointer events.\n *\n * By default the collider shape is used and graphics bounds is not.\n *\n * If both collider shape and graphics bounds are enabled it will fire events if either or\n * are intersecting the pointer.\n */\nclass PointerComponent extends Component {\n    constructor(options) {\n        var _a, _b;\n        super();\n        /**\n         * Use any existing Collider component geometry for pointer events. This is useful if you want\n         * user pointer events only to trigger on the same collision geometry used in the collider component\n         * for collision resolution. Default is `true`.\n         */\n        this.useColliderShape = true;\n        /**\n         * Use any existing Graphics component bounds for pointers. This is useful if you want the axis aligned\n         * bounds around the graphic to trigger pointer events. Default is `true`.\n         */\n        this.useGraphicsBounds = true;\n        this.useColliderShape = (_a = options === null || options === void 0 ? void 0 : options.useColliderShape) !== null && _a !== void 0 ? _a : this.useColliderShape;\n        this.useGraphicsBounds = (_b = options === null || options === void 0 ? void 0 : options.useGraphicsBounds) !== null && _b !== void 0 ? _b : this.useGraphicsBounds;\n        this.localBounds = options === null || options === void 0 ? void 0 : options.localBounds;\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/EasingFunctions.ts\n\n/**\n * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]\n * Given a time, the function will return a value from positive startValue to positive endValue.\n *\n * ```js\n * function Linear (t) {\n *    return t * t;\n * }\n *\n * // accelerating from zero velocity\n * function EaseInQuad (t) {\n *    return t * t;\n * }\n *\n * // decelerating to zero velocity\n * function EaseOutQuad (t) {\n *    return t * (2 - t);\n * }\n *\n * // acceleration until halfway, then deceleration\n * function EaseInOutQuad (t) {\n *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n * }\n *\n * // accelerating from zero velocity\n * function EaseInCubic (t) {\n *    return t * t * t;\n * }\n *\n * // decelerating to zero velocity\n * function EaseOutCubic (t) {\n *    return (--t) * t * t + 1;\n * }\n *\n * // acceleration until halfway, then deceleration\n * function EaseInOutCubic (t) {\n *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n * }\n * ```\n */\nclass EasingFunctions {\n    static CreateReversibleEasingFunction(easing) {\n        return (time, start, end, duration) => {\n            if (end < start) {\n                return start - (easing(time, end, start, duration) - end);\n            }\n            else {\n                return easing(time, start, end, duration);\n            }\n        };\n    }\n    static CreateVectorEasingFunction(easing) {\n        return (time, start, end, duration) => {\n            return new Vector(easing(time, start.x, end.x, duration), easing(time, start.y, end.y, duration));\n        };\n    }\n}\nEasingFunctions.Linear = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\n    endValue = endValue - startValue;\n    return (endValue * currentTime) / duration + startValue;\n});\nEasingFunctions.EaseInQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\n    endValue = endValue - startValue;\n    currentTime /= duration;\n    return endValue * currentTime * currentTime + startValue;\n});\nEasingFunctions.EaseOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\n    endValue = endValue - startValue;\n    currentTime /= duration;\n    return -endValue * currentTime * (currentTime - 2) + startValue;\n});\nEasingFunctions.EaseInOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\n    endValue = endValue - startValue;\n    currentTime /= duration / 2;\n    if (currentTime < 1) {\n        return (endValue / 2) * currentTime * currentTime + startValue;\n    }\n    currentTime--;\n    return (-endValue / 2) * (currentTime * (currentTime - 2) - 1) + startValue;\n});\nEasingFunctions.EaseInCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\n    endValue = endValue - startValue;\n    currentTime /= duration;\n    return endValue * currentTime * currentTime * currentTime + startValue;\n});\nEasingFunctions.EaseOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\n    endValue = endValue - startValue;\n    currentTime /= duration;\n    currentTime--;\n    return endValue * (currentTime * currentTime * currentTime + 1) + startValue;\n});\nEasingFunctions.EaseInOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\n    endValue = endValue - startValue;\n    currentTime /= duration / 2;\n    if (currentTime < 1) {\n        return (endValue / 2) * currentTime * currentTime * currentTime + startValue;\n    }\n    currentTime -= 2;\n    return (endValue / 2) * (currentTime * currentTime * currentTime + 2) + startValue;\n});\n\n;// CONCATENATED MODULE: ./Actions/ActionQueue.ts\n\n/**\n * Action Queues represent an ordered sequence of actions\n *\n * Action queues are part of the [[ActionContext|Action API]] and\n * store the list of actions to be executed for an [[Actor]].\n *\n * Actors implement [[Actor.actions]] which can be manipulated by\n * advanced users to adjust the actions currently being executed in the\n * queue.\n */\nclass ActionQueue {\n    constructor(entity) {\n        this._actions = [];\n        this._currentAction = null;\n        this._completedActions = [];\n        this._entity = entity;\n    }\n    /**\n     * Add an action to the sequence\n     * @param action\n     */\n    add(action) {\n        this._actions.push(action);\n    }\n    /**\n     * Remove an action by reference from the sequence\n     * @param action\n     */\n    remove(action) {\n        const index = this._actions.indexOf(action);\n        this._actions.splice(index, 1);\n    }\n    /**\n     * Removes all actions from this sequence\n     */\n    clearActions() {\n        this._actions.length = 0;\n        this._completedActions.length = 0;\n        if (this._currentAction) {\n            this._currentAction.stop();\n        }\n    }\n    /**\n     *\n     * @returns The total list of actions in this sequence complete or not\n     */\n    getActions() {\n        return this._actions.concat(this._completedActions);\n    }\n    /**\n     *\n     * @returns `true` if there are more actions to process in the sequence\n     */\n    hasNext() {\n        return this._actions.length > 0;\n    }\n    /**\n     * @returns `true` if the current sequence of actions is done\n     */\n    isComplete() {\n        return this._actions.length === 0;\n    }\n    /**\n     * Resets the sequence of actions, this is used to restart a sequence from the beginning\n     */\n    reset() {\n        this._actions = this.getActions();\n        const len = this._actions.length;\n        for (let i = 0; i < len; i++) {\n            this._actions[i].reset();\n        }\n        this._completedActions = [];\n    }\n    /**\n     * Update the queue which updates actions and handles completing actions\n     * @param elapsedMs\n     */\n    update(elapsedMs) {\n        if (this._actions.length > 0) {\n            if (this._currentAction !== this._actions[0]) {\n                this._currentAction = this._actions[0];\n                this._entity.emit('actionstart', new ActionStartEvent(this._currentAction, this._entity));\n            }\n            this._currentAction.update(elapsedMs);\n            if (this._currentAction.isComplete(this._entity)) {\n                this._entity.emit('actioncomplete', new ActionCompleteEvent(this._currentAction, this._entity));\n                const complete = this._actions.shift();\n                if (complete) {\n                    this._completedActions.push(complete);\n                }\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/Repeat.ts\n\nclass Repeat {\n    constructor(entity, repeatBuilder, repeat) {\n        this._stopped = false;\n        this._repeatBuilder = repeatBuilder;\n        this._repeatContext = new ActionContext(entity);\n        this._actionQueue = this._repeatContext.getQueue();\n        this._repeat = repeat;\n        this._originalRepeat = repeat;\n        this._repeatBuilder(this._repeatContext);\n        this._repeat--; // current execution is the first repeat\n    }\n    update(delta) {\n        if (this._actionQueue.isComplete()) {\n            this._actionQueue.clearActions();\n            this._repeatBuilder(this._repeatContext);\n            this._repeat--;\n        }\n        this._actionQueue.update(delta);\n    }\n    isComplete() {\n        return this._stopped || (this._repeat <= 0 && this._actionQueue.isComplete());\n    }\n    stop() {\n        this._stopped = true;\n    }\n    reset() {\n        this._repeat = this._originalRepeat;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/RepeatForever.ts\n\n/**\n * RepeatForever Action implementation, it is recommended you use the fluent action\n * context API.\n *\n *\n */\nclass RepeatForever {\n    constructor(entity, repeatBuilder) {\n        this._stopped = false;\n        this._repeatBuilder = repeatBuilder;\n        this._repeatContext = new ActionContext(entity);\n        this._actionQueue = this._repeatContext.getQueue();\n        this._repeatBuilder(this._repeatContext);\n    }\n    update(delta) {\n        if (this._stopped) {\n            return;\n        }\n        if (this._actionQueue.isComplete()) {\n            this._actionQueue.clearActions();\n            this._repeatBuilder(this._repeatContext);\n        }\n        this._actionQueue.update(delta);\n    }\n    isComplete() {\n        return this._stopped;\n    }\n    stop() {\n        this._stopped = true;\n        this._actionQueue.clearActions();\n    }\n    reset() {\n        return;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveBy.ts\n\n\n\n\nclass MoveBy {\n    constructor(entity, offsetX, offsetY, speed) {\n        this._started = false;\n        this._stopped = false;\n        this._entity = entity;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._speed = speed;\n        this._offset = new Vector(offsetX, offsetY);\n        if (speed <= 0) {\n            Logger.getInstance().error('Attempted to moveBy with speed less than or equal to zero : ' + speed);\n            throw new Error('Speed must be greater than 0 pixels per second');\n        }\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\n            this._end = this._start.add(this._offset);\n            this._distance = this._offset.size;\n            this._dir = this._end.sub(this._start).normalize();\n        }\n        if (this.isComplete(this._entity)) {\n            this._tx.pos = vec(this._end.x, this._end.y);\n            this._motion.vel = vec(0, 0);\n        }\n        else {\n            this._motion.vel = this._dir.scale(this._speed);\n        }\n    }\n    isComplete(entity) {\n        const tx = entity.get(TransformComponent);\n        return this._stopped || tx.pos.distance(this._start) >= this._distance;\n    }\n    stop() {\n        this._motion.vel = vec(0, 0);\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveTo.ts\n\n\n\nclass MoveTo {\n    constructor(entity, destx, desty, speed) {\n        this.entity = entity;\n        this._started = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._end = new Vector(destx, desty);\n        this._speed = speed;\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\n            this._distance = this._start.distance(this._end);\n            this._dir = this._end.sub(this._start).normalize();\n        }\n        const m = this._dir.scale(this._speed);\n        this._motion.vel = vec(m.x, m.y);\n        if (this.isComplete(this.entity)) {\n            this._tx.pos = vec(this._end.x, this._end.y);\n            this._motion.vel = vec(0, 0);\n        }\n    }\n    isComplete(entity) {\n        const tx = entity.get(TransformComponent);\n        return this._stopped || new Vector(tx.pos.x, tx.pos.y).distance(this._start) >= this._distance;\n    }\n    stop() {\n        this._motion.vel = vec(0, 0);\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/RotationType.ts\n/**\n * An enum that describes the strategies that rotation actions can use\n */\nvar RotationType;\n(function (RotationType) {\n    /**\n     * Rotation via `ShortestPath` will use the smallest angle\n     * between the starting and ending points. This strategy is the default behavior.\n     */\n    RotationType[RotationType[\"ShortestPath\"] = 0] = \"ShortestPath\";\n    /**\n     * Rotation via `LongestPath` will use the largest angle\n     * between the starting and ending points.\n     */\n    RotationType[RotationType[\"LongestPath\"] = 1] = \"LongestPath\";\n    /**\n     * Rotation via `Clockwise` will travel in a clockwise direction,\n     * regardless of the starting and ending points.\n     */\n    RotationType[RotationType[\"Clockwise\"] = 2] = \"Clockwise\";\n    /**\n     * Rotation via `CounterClockwise` will travel in a counterclockwise direction,\n     * regardless of the starting and ending points.\n     */\n    RotationType[RotationType[\"CounterClockwise\"] = 3] = \"CounterClockwise\";\n})(RotationType || (RotationType = {}));\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateTo.ts\n\n\n\n\nclass RotateTo {\n    constructor(entity, angleRadians, speed, rotationType) {\n        this._started = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._end = angleRadians;\n        this._speed = speed;\n        this._rotationType = rotationType || RotationType.ShortestPath;\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._start = this._tx.rotation;\n            this._currentNonCannonAngle = this._tx.rotation;\n            const distance1 = Math.abs(this._end - this._start);\n            const distance2 = TwoPI - distance1;\n            if (distance1 > distance2) {\n                this._shortDistance = distance2;\n                this._longDistance = distance1;\n            }\n            else {\n                this._shortDistance = distance1;\n                this._longDistance = distance2;\n            }\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\n            switch (this._rotationType) {\n                case RotationType.ShortestPath:\n                    this._distance = this._shortDistance;\n                    if (this._shortestPathIsPositive) {\n                        this._direction = 1;\n                    }\n                    else {\n                        this._direction = -1;\n                    }\n                    break;\n                case RotationType.LongestPath:\n                    this._distance = this._longDistance;\n                    if (this._shortestPathIsPositive) {\n                        this._direction = -1;\n                    }\n                    else {\n                        this._direction = 1;\n                    }\n                    break;\n                case RotationType.Clockwise:\n                    this._direction = 1;\n                    if (this._shortestPathIsPositive) {\n                        this._distance = this._shortDistance;\n                    }\n                    else {\n                        this._distance = this._longDistance;\n                    }\n                    break;\n                case RotationType.CounterClockwise:\n                    this._direction = -1;\n                    if (!this._shortestPathIsPositive) {\n                        this._distance = this._shortDistance;\n                    }\n                    else {\n                        this._distance = this._longDistance;\n                    }\n                    break;\n            }\n        }\n        this._motion.angularVelocity = this._direction * this._speed;\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\n        if (this.isComplete()) {\n            this._tx.rotation = this._end;\n            this._motion.angularVelocity = 0;\n            this._stopped = true;\n        }\n    }\n    isComplete() {\n        const distanceTraveled = Math.abs(this._currentNonCannonAngle - this._start);\n        return this._stopped || distanceTraveled >= Math.abs(this._distance);\n    }\n    stop() {\n        this._motion.angularVelocity = 0;\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateBy.ts\n\n\n\n\nclass RotateBy {\n    constructor(entity, angleRadiansOffset, speed, rotationType) {\n        this._started = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._speed = speed;\n        this._offset = angleRadiansOffset;\n        this._rotationType = rotationType || RotationType.ShortestPath;\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._start = this._tx.rotation;\n            this._currentNonCannonAngle = this._tx.rotation;\n            this._end = this._start + this._offset;\n            const distance1 = Math.abs(this._end - this._start);\n            const distance2 = TwoPI - distance1;\n            if (distance1 > distance2) {\n                this._shortDistance = distance2;\n                this._longDistance = distance1;\n            }\n            else {\n                this._shortDistance = distance1;\n                this._longDistance = distance2;\n            }\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\n            switch (this._rotationType) {\n                case RotationType.ShortestPath:\n                    this._distance = this._shortDistance;\n                    if (this._shortestPathIsPositive) {\n                        this._direction = 1;\n                    }\n                    else {\n                        this._direction = -1;\n                    }\n                    break;\n                case RotationType.LongestPath:\n                    this._distance = this._longDistance;\n                    if (this._shortestPathIsPositive) {\n                        this._direction = -1;\n                    }\n                    else {\n                        this._direction = 1;\n                    }\n                    break;\n                case RotationType.Clockwise:\n                    this._direction = 1;\n                    if (this._shortDistance >= 0) {\n                        this._distance = this._shortDistance;\n                    }\n                    else {\n                        this._distance = this._longDistance;\n                    }\n                    break;\n                case RotationType.CounterClockwise:\n                    this._direction = -1;\n                    if (this._shortDistance <= 0) {\n                        this._distance = this._shortDistance;\n                    }\n                    else {\n                        this._distance = this._longDistance;\n                    }\n                    break;\n            }\n        }\n        this._motion.angularVelocity = this._direction * this._speed;\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\n        if (this.isComplete()) {\n            this._tx.rotation = this._end;\n            this._motion.angularVelocity = 0;\n            this._stopped = true;\n        }\n    }\n    isComplete() {\n        const distanceTraveled = Math.abs(this._currentNonCannonAngle - this._start);\n        return this._stopped || distanceTraveled >= Math.abs(this._distance);\n    }\n    stop() {\n        this._motion.angularVelocity = 0;\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n        this._start = undefined;\n        this._currentNonCannonAngle = undefined;\n        this._distance = undefined;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleTo.ts\n\n\n\nclass ScaleTo {\n    constructor(entity, scaleX, scaleY, speedX, speedY) {\n        this._started = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._endX = scaleX;\n        this._endY = scaleY;\n        this._speedX = speedX;\n        this._speedY = speedY;\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._startX = this._tx.scale.x;\n            this._startY = this._tx.scale.y;\n            this._distanceX = Math.abs(this._endX - this._startX);\n            this._distanceY = Math.abs(this._endY - this._startY);\n        }\n        if (!(Math.abs(this._tx.scale.x - this._startX) >= this._distanceX)) {\n            const directionX = this._endY < this._startY ? -1 : 1;\n            this._motion.scaleFactor.x = this._speedX * directionX;\n        }\n        else {\n            this._motion.scaleFactor.x = 0;\n        }\n        if (!(Math.abs(this._tx.scale.y - this._startY) >= this._distanceY)) {\n            const directionY = this._endY < this._startY ? -1 : 1;\n            this._motion.scaleFactor.y = this._speedY * directionY;\n        }\n        else {\n            this._motion.scaleFactor.y = 0;\n        }\n        if (this.isComplete()) {\n            this._tx.scale = vec(this._endX, this._endY);\n            this._motion.scaleFactor.x = 0;\n            this._motion.scaleFactor.y = 0;\n        }\n    }\n    isComplete() {\n        return (this._stopped ||\n            (Math.abs(this._tx.scale.x - this._startX) >= (this._distanceX - 0.01) &&\n                Math.abs(this._tx.scale.y - this._startY) >= (this._distanceY - 0.01)));\n    }\n    stop() {\n        this._motion.scaleFactor.x = 0;\n        this._motion.scaleFactor.y = 0;\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleBy.ts\n\n\n\nclass ScaleBy {\n    constructor(entity, scaleOffsetX, scaleOffsetY, speed) {\n        this._started = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._offset = new Vector(scaleOffsetX, scaleOffsetY);\n        this._speedX = this._speedY = speed;\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._startScale = this._tx.scale.clone();\n            this._endScale = this._startScale.add(this._offset);\n            this._distanceX = Math.abs(this._endScale.x - this._startScale.x);\n            this._distanceY = Math.abs(this._endScale.y - this._startScale.y);\n            this._directionX = this._endScale.x < this._startScale.x ? -1 : 1;\n            this._directionY = this._endScale.y < this._startScale.y ? -1 : 1;\n        }\n        this._motion.scaleFactor.x = this._speedX * this._directionX;\n        this._motion.scaleFactor.y = this._speedY * this._directionY;\n        if (this.isComplete()) {\n            this._tx.scale = this._endScale;\n            this._motion.scaleFactor.x = 0;\n            this._motion.scaleFactor.y = 0;\n        }\n    }\n    isComplete() {\n        return (this._stopped ||\n            (Math.abs(this._tx.scale.x - this._startScale.x) >= (this._distanceX - 0.01) &&\n                Math.abs(this._tx.scale.y - this._startScale.y) >= (this._distanceY - 0.01)));\n    }\n    stop() {\n        this._motion.scaleFactor.x = 0;\n        this._motion.scaleFactor.y = 0;\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/CallMethod.ts\nclass CallMethod {\n    constructor(method) {\n        this._method = null;\n        this._hasBeenCalled = false;\n        this._method = method;\n    }\n    update(_delta) {\n        this._method();\n        this._hasBeenCalled = true;\n    }\n    isComplete() {\n        return this._hasBeenCalled;\n    }\n    reset() {\n        this._hasBeenCalled = false;\n    }\n    stop() {\n        this._hasBeenCalled = true;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseTo.ts\n\n\n\nclass EaseTo {\n    constructor(entity, x, y, duration, easingFcn) {\n        this.easingFcn = easingFcn;\n        this._currentLerpTime = 0;\n        this._lerpDuration = 1 * 1000; // 1 second\n        this._lerpStart = new Vector(0, 0);\n        this._lerpEnd = new Vector(0, 0);\n        this._initialized = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._lerpDuration = duration;\n        this._lerpEnd = new Vector(x, y);\n    }\n    _initialize() {\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\n        this._currentLerpTime = 0;\n    }\n    update(delta) {\n        if (!this._initialized) {\n            this._initialize();\n            this._initialized = true;\n        }\n        // Need to update lerp time first, otherwise the first update will always be zero\n        this._currentLerpTime += delta;\n        let newX = this._tx.pos.x;\n        let newY = this._tx.pos.y;\n        if (this._currentLerpTime < this._lerpDuration) {\n            if (this._lerpEnd.x < this._lerpStart.x) {\n                newX =\n                    this._lerpStart.x -\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\n            }\n            else {\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\n            }\n            if (this._lerpEnd.y < this._lerpStart.y) {\n                newY =\n                    this._lerpStart.y -\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\n            }\n            else {\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\n            }\n            // Given the lerp position figure out the velocity in pixels per second\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\n        }\n        else {\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\n            this._motion.vel = Vector.Zero;\n        }\n    }\n    isComplete() {\n        return this._stopped || this._currentLerpTime >= this._lerpDuration;\n    }\n    reset() {\n        this._initialized = false;\n        this._stopped = false;\n        this._currentLerpTime = 0;\n    }\n    stop() {\n        this._motion.vel = vec(0, 0);\n        this._stopped = true;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseBy.ts\n\n\n\nclass EaseBy {\n    constructor(entity, offsetX, offsetY, duration, easingFcn) {\n        this.easingFcn = easingFcn;\n        this._currentLerpTime = 0;\n        this._lerpDuration = 1 * 1000; // 1 second\n        this._lerpStart = new Vector(0, 0);\n        this._lerpEnd = new Vector(0, 0);\n        this._initialized = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._lerpDuration = duration;\n        this._offset = new Vector(offsetX, offsetY);\n    }\n    _initialize() {\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\n        this._currentLerpTime = 0;\n        this._lerpEnd = this._lerpStart.add(this._offset);\n    }\n    update(delta) {\n        if (!this._initialized) {\n            this._initialize();\n            this._initialized = true;\n        }\n        // Need to update lerp time first, otherwise the first update will always be zero\n        this._currentLerpTime += delta;\n        let newX = this._tx.pos.x;\n        let newY = this._tx.pos.y;\n        if (this._currentLerpTime < this._lerpDuration) {\n            if (this._lerpEnd.x < this._lerpStart.x) {\n                newX =\n                    this._lerpStart.x -\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\n            }\n            else {\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\n            }\n            if (this._lerpEnd.y < this._lerpStart.y) {\n                newY =\n                    this._lerpStart.y -\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\n            }\n            else {\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\n            }\n            // Given the lerp position figure out the velocity in pixels per second\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\n        }\n        else {\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\n            this._motion.vel = Vector.Zero;\n        }\n    }\n    isComplete() {\n        return this._stopped || this._currentLerpTime >= this._lerpDuration;\n    }\n    reset() {\n        this._initialized = false;\n        this._stopped = false;\n        this._currentLerpTime = 0;\n    }\n    stop() {\n        this._motion.vel = vec(0, 0);\n        this._stopped = true;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/Blink.ts\n\nclass Blink {\n    constructor(entity, timeVisible, timeNotVisible, numBlinks = 1) {\n        this._timeVisible = 0;\n        this._timeNotVisible = 0;\n        this._elapsedTime = 0;\n        this._totalTime = 0;\n        this._stopped = false;\n        this._started = false;\n        this._graphics = entity.get(GraphicsComponent);\n        this._timeVisible = timeVisible;\n        this._timeNotVisible = timeNotVisible;\n        this._duration = (timeVisible + timeNotVisible) * numBlinks;\n    }\n    update(delta) {\n        if (!this._started) {\n            this._started = true;\n            this._elapsedTime = 0;\n            this._totalTime = 0;\n        }\n        if (!this._graphics) {\n            return;\n        }\n        this._elapsedTime += delta;\n        this._totalTime += delta;\n        if (this._graphics.visible && this._elapsedTime >= this._timeVisible) {\n            this._graphics.visible = false;\n            this._elapsedTime = 0;\n        }\n        if (!this._graphics.visible && this._elapsedTime >= this._timeNotVisible) {\n            this._graphics.visible = true;\n            this._elapsedTime = 0;\n        }\n        if (this.isComplete()) {\n            this._graphics.visible = true;\n        }\n    }\n    isComplete() {\n        return this._stopped || this._totalTime >= this._duration;\n    }\n    stop() {\n        if (this._graphics) {\n            this._graphics.visible = true;\n        }\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n        this._elapsedTime = 0;\n        this._totalTime = 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/Fade.ts\n\n\nclass Fade {\n    constructor(entity, endOpacity, speed) {\n        this._multiplier = 1;\n        this._started = false;\n        this._stopped = false;\n        this._graphics = entity.get(GraphicsComponent);\n        this._endOpacity = endOpacity;\n        this._speed = this._ogspeed = speed;\n    }\n    update(delta) {\n        if (!this._graphics) {\n            return;\n        }\n        if (!this._started) {\n            this._started = true;\n            this._speed = this._ogspeed;\n            // determine direction when we start\n            if (this._endOpacity < this._graphics.opacity) {\n                this._multiplier = -1;\n            }\n            else {\n                this._multiplier = 1;\n            }\n        }\n        if (this._speed > 0) {\n            this._graphics.opacity += (this._multiplier *\n                (Math.abs(this._graphics.opacity - this._endOpacity) * delta)) / this._speed;\n        }\n        this._speed -= delta;\n        if (this.isComplete()) {\n            this._graphics.opacity = this._endOpacity;\n        }\n        Logger.getInstance().debug('[Action fade] Actor opacity:', this._graphics.opacity);\n    }\n    isComplete() {\n        return this._stopped || Math.abs(this._graphics.opacity - this._endOpacity) < 0.05;\n    }\n    stop() {\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/Delay.ts\nclass Delay {\n    constructor(delay) {\n        this._elapsedTime = 0;\n        this._started = false;\n        this._stopped = false;\n        this._delay = delay;\n    }\n    update(delta) {\n        if (!this._started) {\n            this._started = true;\n        }\n        this._elapsedTime += delta;\n    }\n    isComplete() {\n        return this._stopped || this._elapsedTime >= this._delay;\n    }\n    stop() {\n        this._stopped = true;\n    }\n    reset() {\n        this._elapsedTime = 0;\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/Die.ts\n\nclass Die {\n    constructor(entity) {\n        this._stopped = false;\n        this._entity = entity;\n    }\n    update(_delta) {\n        this._entity.get(ActionsComponent).clearActions();\n        this._entity.kill();\n        this._stopped = true;\n    }\n    isComplete() {\n        return this._stopped;\n    }\n    stop() {\n        return;\n    }\n    reset() {\n        return;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/Follow.ts\n\n\n\nclass Follow {\n    constructor(entity, entityToFollow, followDistance) {\n        this._started = false;\n        this._stopped = false;\n        this._tx = entity.get(TransformComponent);\n        this._motion = entity.get(MotionComponent);\n        this._followTx = entityToFollow.get(TransformComponent);\n        this._followMotion = entityToFollow.get(MotionComponent);\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\n        this._end = new Vector(this._followTx.pos.x, this._followTx.pos.y);\n        this._maximumDistance = followDistance !== undefined ? followDistance : this._current.distance(this._end);\n        this._speed = 0;\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._distanceBetween = this._current.distance(this._end);\n            this._dir = this._end.sub(this._current).normalize();\n        }\n        const actorToFollowSpeed = Math.sqrt(Math.pow(this._followMotion.vel.x, 2) + Math.pow(this._followMotion.vel.y, 2));\n        if (actorToFollowSpeed !== 0) {\n            this._speed = actorToFollowSpeed;\n        }\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\n        this._end = vec(this._followTx.pos.x, this._followTx.pos.y);\n        this._distanceBetween = this._current.distance(this._end);\n        this._dir = this._end.sub(this._current).normalize();\n        if (this._distanceBetween >= this._maximumDistance) {\n            const m = this._dir.scale(this._speed);\n            this._motion.vel = vec(m.x, m.y);\n        }\n        else {\n            this._motion.vel = vec(0, 0);\n        }\n        if (this.isComplete()) {\n            this._tx.pos = vec(this._end.x, this._end.y);\n            this._motion.vel = vec(0, 0);\n        }\n    }\n    stop() {\n        this._motion.vel = vec(0, 0);\n        this._stopped = true;\n    }\n    isComplete() {\n        // the actor following should never stop unless specified to do so\n        return this._stopped;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/Meet.ts\n\n\n\nclass Meet {\n    constructor(actor, actorToMeet, speed) {\n        this._started = false;\n        this._stopped = false;\n        this._speedWasSpecified = false;\n        this._tx = actor.get(TransformComponent);\n        this._motion = actor.get(MotionComponent);\n        this._meetTx = actorToMeet.get(TransformComponent);\n        this._meetMotion = actorToMeet.get(MotionComponent);\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\n        this._end = new Vector(this._meetTx.pos.x, this._meetTx.pos.y);\n        this._speed = speed || 0;\n        if (speed !== undefined) {\n            this._speedWasSpecified = true;\n        }\n    }\n    update(_delta) {\n        if (!this._started) {\n            this._started = true;\n            this._distanceBetween = this._current.distance(this._end);\n            this._dir = this._end.sub(this._current).normalize();\n        }\n        const actorToMeetSpeed = Math.sqrt(Math.pow(this._meetMotion.vel.x, 2) + Math.pow(this._meetMotion.vel.y, 2));\n        if (actorToMeetSpeed !== 0 && !this._speedWasSpecified) {\n            this._speed = actorToMeetSpeed;\n        }\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\n        this._end = vec(this._meetTx.pos.x, this._meetTx.pos.y);\n        this._distanceBetween = this._current.distance(this._end);\n        this._dir = this._end.sub(this._current).normalize();\n        const m = this._dir.scale(this._speed);\n        this._motion.vel = vec(m.x, m.y);\n        if (this.isComplete()) {\n            this._tx.pos = vec(this._end.x, this._end.y);\n            this._motion.vel = vec(0, 0);\n        }\n    }\n    isComplete() {\n        return this._stopped || this._distanceBetween <= 1;\n    }\n    stop() {\n        this._motion.vel = vec(0, 0);\n        this._stopped = true;\n    }\n    reset() {\n        this._started = false;\n        this._stopped = false;\n        this._distanceBetween = undefined;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/ActionContext.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * The fluent Action API allows you to perform \"actions\" on\n * [[Actor|Actors]] such as following, moving, rotating, and\n * more. You can implement your own actions by implementing\n * the [[Action]] interface.\n */\nclass ActionContext {\n    constructor(entity) {\n        this._entity = entity;\n        this._queue = new ActionQueue(entity);\n    }\n    getQueue() {\n        return this._queue;\n    }\n    update(elapsedMs) {\n        this._queue.update(elapsedMs);\n    }\n    /**\n     * Clears all queued actions from the Actor\n     */\n    clearActions() {\n        this._queue.clearActions();\n    }\n    runAction(action) {\n        action.reset();\n        this._queue.add(action);\n        return this;\n    }\n    easeTo(...args) {\n        var _a, _b;\n        let x = 0;\n        let y = 0;\n        let duration = 0;\n        let easingFcn = EasingFunctions.Linear;\n        if (args[0] instanceof Vector) {\n            x = args[0].x;\n            y = args[0].y;\n            duration = args[1];\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\n        }\n        else {\n            x = args[0];\n            y = args[1];\n            duration = args[2];\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\n        }\n        this._queue.add(new EaseTo(this._entity, x, y, duration, easingFcn));\n        return this;\n    }\n    easeBy(...args) {\n        var _a, _b;\n        let offsetX = 0;\n        let offsetY = 0;\n        let duration = 0;\n        let easingFcn = EasingFunctions.Linear;\n        if (args[0] instanceof Vector) {\n            offsetX = args[0].x;\n            offsetY = args[0].y;\n            duration = args[1];\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\n        }\n        else {\n            offsetX = args[0];\n            offsetY = args[1];\n            duration = args[2];\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\n        }\n        this._queue.add(new EaseBy(this._entity, offsetX, offsetY, duration, easingFcn));\n        return this;\n    }\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\n        let x = 0;\n        let y = 0;\n        let speed = 0;\n        if (xOrPos instanceof Vector) {\n            x = xOrPos.x;\n            y = xOrPos.y;\n            speed = yOrSpeed;\n        }\n        else {\n            x = xOrPos;\n            y = yOrSpeed;\n            speed = speedOrUndefined;\n        }\n        this._queue.add(new MoveTo(this._entity, x, y, speed));\n        return this;\n    }\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\n        let xOffset = 0;\n        let yOffset = 0;\n        let speed = 0;\n        if (xOffsetOrVector instanceof Vector) {\n            xOffset = xOffsetOrVector.x;\n            yOffset = xOffsetOrVector.y;\n            speed = yOffsetOrSpeed;\n        }\n        else {\n            xOffset = xOffsetOrVector;\n            yOffset = yOffsetOrSpeed;\n            speed = speedOrUndefined;\n        }\n        this._queue.add(new MoveBy(this._entity, xOffset, yOffset, speed));\n        return this;\n    }\n    /**\n     * This method will rotate an actor to the specified angle at the speed\n     * specified (in radians per second) and return back the actor. This\n     * method is part of the actor 'Action' fluent API allowing action chaining.\n     * @param angleRadians  The angle to rotate to in radians\n     * @param speed         The angular velocity of the rotation specified in radians per second\n     * @param rotationType  The [[RotationType]] to use for this rotation\n     */\n    rotateTo(angleRadians, speed, rotationType) {\n        this._queue.add(new RotateTo(this._entity, angleRadians, speed, rotationType));\n        return this;\n    }\n    /**\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\n     * in radians/sec and return back the actor. This method is part\n     * of the actor 'Action' fluent API allowing action chaining.\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\n     * @param speed          The speed in radians/sec the actor should rotate at\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\n     */\n    rotateBy(angleRadiansOffset, speed, rotationType) {\n        this._queue.add(new RotateBy(this._entity, angleRadiansOffset, speed, rotationType));\n        return this;\n    }\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\n        let sizeX = 1;\n        let sizeY = 1;\n        let speedX = 0;\n        let speedY = 0;\n        if (sizeXOrVector instanceof Vector && sizeYOrSpeed instanceof Vector) {\n            sizeX = sizeXOrVector.x;\n            sizeY = sizeXOrVector.y;\n            speedX = sizeYOrSpeed.x;\n            speedY = sizeYOrSpeed.y;\n        }\n        if (typeof sizeXOrVector === 'number' && typeof sizeYOrSpeed === 'number') {\n            sizeX = sizeXOrVector;\n            sizeY = sizeYOrSpeed;\n            speedX = speedXOrUndefined;\n            speedY = speedYOrUndefined;\n        }\n        this._queue.add(new ScaleTo(this._entity, sizeX, sizeY, speedX, speedY));\n        return this;\n    }\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\n        let sizeOffsetX = 1;\n        let sizeOffsetY = 1;\n        if (sizeOffsetXOrVector instanceof Vector) {\n            sizeOffsetX = sizeOffsetXOrVector.x;\n            sizeOffsetY = sizeOffsetXOrVector.y;\n            speed = sizeOffsetYOrSpeed;\n        }\n        if (typeof sizeOffsetXOrVector === 'number' && typeof sizeOffsetYOrSpeed === 'number') {\n            sizeOffsetX = sizeOffsetXOrVector;\n            sizeOffsetY = sizeOffsetYOrSpeed;\n        }\n        this._queue.add(new ScaleBy(this._entity, sizeOffsetX, sizeOffsetY, speed));\n        return this;\n    }\n    /**\n     * This method will cause an actor to blink (become visible and not\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\n     * the actor should be visible per blink, and the amount of time not visible.\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\n     * @param numBlinks       The number of times to blink\n     */\n    blink(timeVisible, timeNotVisible, numBlinks = 1) {\n        this._queue.add(new Blink(this._entity, timeVisible, timeNotVisible, numBlinks));\n        return this;\n    }\n    /**\n     * This method will cause an actor's opacity to change from its current value\n     * to the provided value by a specified time (in milliseconds). This method is\n     * part of the actor 'Action' fluent API allowing action chaining.\n     * @param opacity  The ending opacity\n     * @param time     The time it should take to fade the actor (in milliseconds)\n     */\n    fade(opacity, time) {\n        this._queue.add(new Fade(this._entity, opacity, time));\n        return this;\n    }\n    /**\n     * This method will delay the next action from executing for a certain\n     * amount of time (in milliseconds). This method is part of the actor\n     * 'Action' fluent API allowing action chaining.\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\n     */\n    delay(time) {\n        this._queue.add(new Delay(time));\n        return this;\n    }\n    /**\n     * This method will add an action to the queue that will remove the actor from the\n     * scene once it has completed its previous  Any actions on the\n     * action queue after this action will not be executed.\n     */\n    die() {\n        this._queue.add(new Die(this._entity));\n        return this;\n    }\n    /**\n     * This method allows you to call an arbitrary method as the next action in the\n     * action queue. This is useful if you want to execute code in after a specific\n     * action, i.e An actor arrives at a destination after traversing a path\n     */\n    callMethod(method) {\n        this._queue.add(new CallMethod(method));\n        return this;\n    }\n    /**\n     * This method will cause the actor to repeat all of the actions built in\n     * the `repeatBuilder` callback. If the number of repeats\n     * is not specified it will repeat forever. This method is part of\n     * the actor 'Action' fluent API allowing action chaining\n     *\n     * ```typescript\n     * // Move up in a zig-zag by repeated moveBy's\n     * actor.actions.repeat(repeatCtx => {\n     * repeatCtx.moveBy(10, 0, 10);\n     * repeatCtx.moveBy(0, 10, 10);\n     * }, 5);\n     * ```\n     * @param repeatBuilder The builder to specify the repeatable list of actions\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\n     * will repeat forever\n     */\n    repeat(repeatBuilder, times) {\n        if (!times) {\n            this.repeatForever(repeatBuilder);\n            return this;\n        }\n        this._queue.add(new Repeat(this._entity, repeatBuilder, times));\n        return this;\n    }\n    /**\n     * This method will cause the actor to repeat all of the actions built in\n     * the `repeatBuilder` callback. If the number of repeats\n     * is not specified it will repeat forever. This method is part of\n     * the actor 'Action' fluent API allowing action chaining\n     *\n     * ```typescript\n     * // Move up in a zig-zag by repeated moveBy's\n     * actor.actions.repeat(repeatCtx => {\n     * repeatCtx.moveBy(10, 0, 10);\n     * repeatCtx.moveBy(0, 10, 10);\n     * }, 5);\n     * ```\n     * @param repeatBuilder The builder to specify the repeatable list of actions\n     */\n    repeatForever(repeatBuilder) {\n        this._queue.add(new RepeatForever(this._entity, repeatBuilder));\n        return this;\n    }\n    /**\n     * This method will cause the entity to follow another at a specified distance\n     * @param entity           The entity to follow\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\n     */\n    follow(entity, followDistance) {\n        if (followDistance === undefined) {\n            this._queue.add(new Follow(this._entity, entity));\n        }\n        else {\n            this._queue.add(new Follow(this._entity, entity, followDistance));\n        }\n        return this;\n    }\n    /**\n     * This method will cause the entity to move towards another until they\n     * collide \"meet\" at a specified speed.\n     * @param entity  The entity to meet\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\n     */\n    meet(entity, speed) {\n        if (speed === undefined) {\n            this._queue.add(new Meet(this._entity, entity));\n        }\n        else {\n            this._queue.add(new Meet(this._entity, entity, speed));\n        }\n        return this;\n    }\n    /**\n     * Returns a promise that resolves when the current action queue up to now\n     * is finished.\n     */\n    toPromise() {\n        const temp = new Promise((resolve) => {\n            this._queue.add(new CallMethod(() => {\n                resolve();\n            }));\n        });\n        return temp;\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/ActionsComponent.ts\n\n\n\n\n;\nclass ActionsComponent extends Component {\n    constructor() {\n        super(...arguments);\n        this.dependencies = [TransformComponent, MotionComponent];\n        this._ctx = null;\n    }\n    onAdd(entity) {\n        this._ctx = new ActionContext(entity);\n    }\n    onRemove() {\n        this._ctx = null;\n    }\n    _getCtx() {\n        if (!this._ctx) {\n            throw new Error('Actions component not attached to an entity, no context available');\n        }\n        return this._ctx;\n    }\n    /**\n     * Returns the internal action queue\n     * @returns action queue\n     */\n    getQueue() {\n        if (!this._ctx) {\n            throw new Error('Actions component not attached to an entity, no queue available');\n        }\n        return this._ctx.getQueue();\n    }\n    runAction(action) {\n        if (!this._ctx) {\n            throw new Error('Actions component not attached to an entity, cannot run action');\n        }\n        return this._ctx.runAction(action);\n    }\n    /**\n     * Updates the internal action context, performing action and moving through the internal queue\n     * @param elapsedMs\n     */\n    update(elapsedMs) {\n        var _a;\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.update(elapsedMs);\n    }\n    /**\n     * Clears all queued actions from the Actor\n     */\n    clearActions() {\n        var _a;\n        (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.clearActions();\n    }\n    easeTo(...args) {\n        return this._getCtx().easeTo.apply(this._ctx, args);\n    }\n    easeBy(...args) {\n        return this._getCtx().easeBy.apply(this._ctx, args);\n    }\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\n        return this._getCtx().moveTo.apply(this._ctx, [xOrPos, yOrSpeed, speedOrUndefined]);\n    }\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\n        return this._getCtx().moveBy.apply(this._ctx, [xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined]);\n    }\n    /**\n     * This method will rotate an actor to the specified angle at the speed\n     * specified (in radians per second) and return back the actor. This\n     * method is part of the actor 'Action' fluent API allowing action chaining.\n     * @param angleRadians  The angle to rotate to in radians\n     * @param speed         The angular velocity of the rotation specified in radians per second\n     * @param rotationType  The [[RotationType]] to use for this rotation\n     */\n    rotateTo(angleRadians, speed, rotationType) {\n        return this._getCtx().rotateTo(angleRadians, speed, rotationType);\n    }\n    /**\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\n     * in radians/sec and return back the actor. This method is part\n     * of the actor 'Action' fluent API allowing action chaining.\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\n     * @param speed          The speed in radians/sec the actor should rotate at\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\n     */\n    rotateBy(angleRadiansOffset, speed, rotationType) {\n        return this._getCtx().rotateBy(angleRadiansOffset, speed, rotationType);\n    }\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\n        return this._getCtx().scaleTo.apply(this._ctx, [sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined]);\n    }\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\n        return this._getCtx().scaleBy.apply(this._ctx, [sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed]);\n    }\n    /**\n     * This method will cause an actor to blink (become visible and not\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\n     * the actor should be visible per blink, and the amount of time not visible.\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\n     * @param numBlinks       The number of times to blink\n     */\n    blink(timeVisible, timeNotVisible, numBlinks) {\n        return this._getCtx().blink(timeVisible, timeNotVisible, numBlinks);\n    }\n    /**\n     * This method will cause an actor's opacity to change from its current value\n     * to the provided value by a specified time (in milliseconds). This method is\n     * part of the actor 'Action' fluent API allowing action chaining.\n     * @param opacity  The ending opacity\n     * @param time     The time it should take to fade the actor (in milliseconds)\n     */\n    fade(opacity, time) {\n        return this._getCtx().fade(opacity, time);\n    }\n    /**\n     * This method will delay the next action from executing for a certain\n     * amount of time (in milliseconds). This method is part of the actor\n     * 'Action' fluent API allowing action chaining.\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\n     */\n    delay(time) {\n        return this._getCtx().delay(time);\n    }\n    /**\n     * This method will add an action to the queue that will remove the actor from the\n     * scene once it has completed its previous  Any actions on the\n     * action queue after this action will not be executed.\n     */\n    die() {\n        return this._getCtx().die();\n    }\n    /**\n     * This method allows you to call an arbitrary method as the next action in the\n     * action queue. This is useful if you want to execute code in after a specific\n     * action, i.e An actor arrives at a destination after traversing a path\n     */\n    callMethod(method) {\n        return this._getCtx().callMethod(method);\n    }\n    /**\n     * This method will cause the actor to repeat all of the actions built in\n     * the `repeatBuilder` callback. If the number of repeats\n     * is not specified it will repeat forever. This method is part of\n     * the actor 'Action' fluent API allowing action chaining\n     *\n     * ```typescript\n     * // Move up in a zig-zag by repeated moveBy's\n     * actor.actions.repeat(repeatCtx => {\n     * repeatCtx.moveBy(10, 0, 10);\n     * repeatCtx.moveBy(0, 10, 10);\n     * }, 5);\n     * ```\n     * @param repeatBuilder The builder to specify the repeatable list of actions\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\n     * will repeat forever\n     */\n    repeat(repeatBuilder, times) {\n        return this._getCtx().repeat(repeatBuilder, times);\n    }\n    /**\n     * This method will cause the actor to repeat all of the actions built in\n     * the `repeatBuilder` callback. If the number of repeats\n     * is not specified it will repeat forever. This method is part of\n     * the actor 'Action' fluent API allowing action chaining\n     *\n     * ```typescript\n     * // Move up in a zig-zag by repeated moveBy's\n     * actor.actions.repeat(repeatCtx => {\n     * repeatCtx.moveBy(10, 0, 10);\n     * repeatCtx.moveBy(0, 10, 10);\n     * }, 5);\n     * ```\n     * @param repeatBuilder The builder to specify the repeatable list of actions\n     */\n    repeatForever(repeatBuilder) {\n        return this._getCtx().repeatForever(repeatBuilder);\n    }\n    /**\n     * This method will cause the entity to follow another at a specified distance\n     * @param entity           The entity to follow\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\n     */\n    follow(entity, followDistance) {\n        return this._getCtx().follow(entity, followDistance);\n    }\n    /**\n     * This method will cause the entity to move towards another until they\n     * collide \"meet\" at a specified speed.\n     * @param entity  The entity to meet\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\n     */\n    meet(entity, speed) {\n        return this._getCtx().meet(entity, speed);\n    }\n    /**\n     * Returns a promise that resolves when the current action queue up to now\n     * is finished.\n     */\n    toPromise() {\n        return this._getCtx().toPromise();\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/FontCommon.ts\n/**\n * Enum representing the different font size units\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\n */\nvar FontUnit;\n(function (FontUnit) {\n    /**\n     * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values\n     */\n    FontUnit[\"Em\"] = \"em\";\n    /**\n     * Rem is similar to the Em, it is a scalable unit. 1 rem is equal to the font size of the root element\n     */\n    FontUnit[\"Rem\"] = \"rem\";\n    /**\n     * Pixel is a unit of length in screen pixels\n     */\n    FontUnit[\"Px\"] = \"px\";\n    /**\n     * Point is a physical unit length (1/72 of an inch)\n     */\n    FontUnit[\"Pt\"] = \"pt\";\n    /**\n     * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff\n     */\n    FontUnit[\"Percent\"] = \"%\";\n})(FontUnit || (FontUnit = {}));\n/**\n * Enum representing the different horizontal text alignments\n */\nvar TextAlign;\n(function (TextAlign) {\n    /**\n     * The text is left-aligned.\n     */\n    TextAlign[\"Left\"] = \"left\";\n    /**\n     * The text is right-aligned.\n     */\n    TextAlign[\"Right\"] = \"right\";\n    /**\n     * The text is centered.\n     */\n    TextAlign[\"Center\"] = \"center\";\n    /**\n     * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,\n     * right-aligned for right-to-left locales).\n     */\n    TextAlign[\"Start\"] = \"start\";\n    /**\n     * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,\n     * left-aligned for right-to-left locales).\n     */\n    TextAlign[\"End\"] = \"end\";\n})(TextAlign || (TextAlign = {}));\n/**\n * Enum representing the different baseline text alignments\n */\nvar BaseAlign;\n(function (BaseAlign) {\n    /**\n     * The text baseline is the top of the em square.\n     */\n    BaseAlign[\"Top\"] = \"top\";\n    /**\n     * The text baseline is the hanging baseline.  Currently unsupported; this will act like\n     * alphabetic.\n     */\n    BaseAlign[\"Hanging\"] = \"hanging\";\n    /**\n     * The text baseline is the middle of the em square.\n     */\n    BaseAlign[\"Middle\"] = \"middle\";\n    /**\n     * The text baseline is the normal alphabetic baseline.\n     */\n    BaseAlign[\"Alphabetic\"] = \"alphabetic\";\n    /**\n     * The text baseline is the ideographic baseline; this is the bottom of\n     * the body of the characters, if the main body of characters protrudes\n     * beneath the alphabetic baseline.  Currently unsupported; this will\n     * act like alphabetic.\n     */\n    BaseAlign[\"Ideographic\"] = \"ideographic\";\n    /**\n     * The text baseline is the bottom of the bounding box.  This differs\n     * from the ideographic baseline in that the ideographic baseline\n     * doesn't consider descenders.\n     */\n    BaseAlign[\"Bottom\"] = \"bottom\";\n})(BaseAlign || (BaseAlign = {}));\n/**\n * Enum representing the different possible font styles\n */\nvar FontStyle;\n(function (FontStyle) {\n    FontStyle[\"Normal\"] = \"normal\";\n    FontStyle[\"Italic\"] = \"italic\";\n    FontStyle[\"Oblique\"] = \"oblique\";\n})(FontStyle || (FontStyle = {}));\n/**\n * Enum representing the text direction, useful for other languages, or writing text in reverse\n */\nvar Direction;\n(function (Direction) {\n    Direction[\"LeftToRight\"] = \"ltr\";\n    Direction[\"RightToLeft\"] = \"rtl\";\n})(Direction || (Direction = {}));\n\n;// CONCATENATED MODULE: ./Graphics/FontTextInstance.ts\n\n\n\n\nclass FontTextInstance {\n    constructor(font, text, color, maxWidth) {\n        this.font = font;\n        this.text = text;\n        this.color = color;\n        this.maxWidth = maxWidth;\n        this._textFragments = [];\n        this.disposed = false;\n        this._dirty = true;\n        this.canvas = document.createElement('canvas');\n        this.ctx = this.canvas.getContext('2d');\n        this.dimensions = this.measureText(text);\n        this._setDimension(this.dimensions, this.ctx);\n        this._lastHashCode = this.getHashCode();\n    }\n    measureText(text, maxWidth) {\n        if (this.disposed) {\n            throw Error('Accessing disposed text instance! ' + this.text);\n        }\n        let lines = null;\n        if (maxWidth != null) {\n            lines = this._getLinesFromText(text, maxWidth);\n        }\n        else {\n            lines = text.split('\\n');\n        }\n        const maxWidthLine = lines.reduce((a, b) => {\n            return a.length > b.length ? a : b;\n        });\n        this._applyFont(this.ctx); // font must be applied to the context to measure it\n        const metrics = this.ctx.measureText(maxWidthLine);\n        let textHeight = Math.abs(metrics.actualBoundingBoxAscent) + Math.abs(metrics.actualBoundingBoxDescent);\n        // TODO line height makes the text bounds wonky\n        const lineAdjustedHeight = textHeight * lines.length;\n        textHeight = lineAdjustedHeight;\n        const bottomBounds = lineAdjustedHeight - Math.abs(metrics.actualBoundingBoxAscent);\n        const x = 0;\n        const y = 0;\n        const measurement = new BoundingBox({\n            left: x - Math.abs(metrics.actualBoundingBoxLeft) - this.font.padding,\n            top: y - Math.abs(metrics.actualBoundingBoxAscent) - this.font.padding,\n            bottom: y + bottomBounds + this.font.padding,\n            right: x + Math.abs(metrics.actualBoundingBoxRight) + this.font.padding\n        });\n        return measurement;\n    }\n    _setDimension(textBounds, bitmap) {\n        let lineHeightRatio = 1;\n        if (this.font.lineHeight) {\n            lineHeightRatio = (this.font.lineHeight / this.font.size);\n        }\n        // Changing the width and height clears the context properties\n        // We double the bitmap width to account for all possible alignment\n        // We scale by \"quality\" so we render text without jaggies\n        bitmap.canvas.width = (textBounds.width + this.font.padding * 2) * 2 * this.font.quality;\n        bitmap.canvas.height = (textBounds.height + this.font.padding * 2) * 2 * this.font.quality * lineHeightRatio;\n    }\n    static getHashCode(font, text, color) {\n        var _a;\n        const hash = text +\n            '__hashcode__' +\n            font.fontString +\n            font.showDebug +\n            font.textAlign +\n            font.baseAlign +\n            font.direction +\n            font.lineHeight +\n            JSON.stringify(font.shadow) +\n            (font.padding.toString() +\n                font.smoothing.toString() +\n                font.lineWidth.toString() +\n                font.lineDash.toString() +\n                ((_a = font.strokeColor) === null || _a === void 0 ? void 0 : _a.toString()) +\n                (color ? color.toString() : font.color.toString()));\n        return hash;\n    }\n    getHashCode(includeColor = true) {\n        return FontTextInstance.getHashCode(this.font, this.text, includeColor ? this.color : undefined);\n    }\n    _applyRasterProperties(ctx) {\n        var _a, _b;\n        ctx.translate(this.font.padding, this.font.padding);\n        ctx.imageSmoothingEnabled = this.font.smoothing;\n        ctx.lineWidth = this.font.lineWidth;\n        ctx.setLineDash((_a = this.font.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\n        ctx.strokeStyle = (_b = this.font.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\n        ctx.fillStyle = this.color.toString();\n    }\n    _applyFont(ctx) {\n        ctx.resetTransform();\n        ctx.translate(this.font.padding + ctx.canvas.width / 2, this.font.padding + ctx.canvas.height / 2);\n        ctx.scale(this.font.quality, this.font.quality);\n        ctx.textAlign = this.font.textAlign;\n        ctx.textBaseline = this.font.baseAlign;\n        ctx.font = this.font.fontString;\n        ctx.direction = this.font.direction;\n        if (this.font.shadow) {\n            ctx.shadowColor = this.font.shadow.color.toString();\n            ctx.shadowBlur = this.font.shadow.blur;\n            ctx.shadowOffsetX = this.font.shadow.offset.x;\n            ctx.shadowOffsetY = this.font.shadow.offset.y;\n        }\n    }\n    _drawText(ctx, lines, lineHeight) {\n        this._applyRasterProperties(ctx);\n        this._applyFont(ctx);\n        for (let i = 0; i < lines.length; i++) {\n            const line = lines[i];\n            if (this.color) {\n                ctx.fillText(line, 0, i * lineHeight);\n            }\n            if (this.font.strokeColor) {\n                ctx.strokeText(line, 0, i * lineHeight);\n            }\n        }\n        if (this.font.showDebug) {\n            // Horizontal line\n            /* istanbul ignore next */\n            line(ctx, Color.Green, -ctx.canvas.width / 2, 0, ctx.canvas.width / 2, 0, 2);\n            // Vertical line\n            /* istanbul ignore next */\n            line(ctx, Color.Red, 0, -ctx.canvas.height / 2, 0, ctx.canvas.height / 2, 2);\n        }\n    }\n    _splitTextBitmap(bitmap) {\n        const textImages = [];\n        let currentX = 0;\n        let currentY = 0;\n        // 4k is the max for mobile devices\n        const width = Math.min(4096, bitmap.canvas.width);\n        const height = Math.min(4096, bitmap.canvas.height);\n        // Splits the original bitmap into 4k max chunks\n        while (currentX < bitmap.canvas.width) {\n            while (currentY < bitmap.canvas.height) {\n                // create new bitmap\n                const canvas = document.createElement('canvas');\n                canvas.width = width;\n                canvas.height = height;\n                const ctx = canvas.getContext('2d');\n                // draw current slice to new bitmap in < 4k chunks\n                ctx.drawImage(bitmap.canvas, currentX, currentY, width, height, 0, 0, width, height);\n                textImages.push({ x: currentX, y: currentY, canvas });\n                currentY += height;\n            }\n            currentX += width;\n            currentY = 0;\n        }\n        return textImages;\n    }\n    flagDirty() {\n        this._dirty = true;\n    }\n    render(ex, x, y, maxWidth) {\n        var _a;\n        if (this.disposed) {\n            throw Error('Accessing disposed text instance! ' + this.text);\n        }\n        this._ex = ex;\n        const hashCode = this.getHashCode();\n        if (this._lastHashCode !== hashCode) {\n            this._dirty = true;\n        }\n        // Calculate image chunks\n        if (this._dirty) {\n            this.dimensions = this.measureText(this.text, maxWidth);\n            this._setDimension(this.dimensions, this.ctx);\n            const lines = this._getLinesFromText(this.text, maxWidth);\n            const lineHeight = (_a = this.font.lineHeight) !== null && _a !== void 0 ? _a : this.dimensions.height / lines.length;\n            // draws the text to the main bitmap\n            this._drawText(this.ctx, lines, lineHeight);\n            // clear any out old fragments\n            if (ex instanceof ExcaliburGraphicsContextWebGL) {\n                for (const frag of this._textFragments) {\n                    ex.textureLoader.delete(frag.canvas);\n                }\n            }\n            // splits to < 4k fragments for large text\n            this._textFragments = this._splitTextBitmap(this.ctx);\n            if (ex instanceof ExcaliburGraphicsContextWebGL) {\n                for (const frag of this._textFragments) {\n                    ex.textureLoader.load(frag.canvas, { filtering: this.font.filtering }, true);\n                }\n            }\n            this._lastHashCode = hashCode;\n            this._dirty = false;\n        }\n        // draws the bitmap fragments to excalibur graphics context\n        for (const frag of this._textFragments) {\n            ex.drawImage(frag.canvas, 0, 0, frag.canvas.width, frag.canvas.height, frag.x / this.font.quality + x - this.ctx.canvas.width / this.font.quality / 2, frag.y / this.font.quality + y - this.ctx.canvas.height / this.font.quality / 2, frag.canvas.width / this.font.quality, frag.canvas.height / this.font.quality);\n        }\n    }\n    dispose() {\n        this.disposed = true;\n        this.dimensions = undefined;\n        this.canvas = undefined;\n        this.ctx = undefined;\n        if (this._ex instanceof ExcaliburGraphicsContextWebGL) {\n            for (const frag of this._textFragments) {\n                this._ex.textureLoader.delete(frag.canvas);\n            }\n        }\n        this._textFragments.length = 0;\n    }\n    _getLinesFromText(text, maxWidth) {\n        if (this._cachedText === text && this._cachedRenderWidth === maxWidth) {\n            return this._cachedLines;\n        }\n        const lines = text.split('\\n');\n        if (maxWidth == null) {\n            return lines;\n        }\n        // If the current line goes past the maxWidth, append a new line without modifying the underlying text.\n        for (let i = 0; i < lines.length; i++) {\n            let line = lines[i];\n            let newLine = '';\n            if (this.measureText(line).width > maxWidth) {\n                while (this.measureText(line).width > maxWidth) {\n                    newLine = line[line.length - 1] + newLine;\n                    line = line.slice(0, -1); // Remove last character from line\n                }\n                // Update the array with our new values\n                lines[i] = line;\n                lines[i + 1] = newLine;\n            }\n        }\n        this._cachedText = text;\n        this._cachedLines = lines;\n        this._cachedRenderWidth = maxWidth;\n        return lines;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/FontCache.ts\n\n\nclass FontCache {\n    static measureText(text, font, maxWidth) {\n        const hash = FontTextInstance.getHashCode(font, text);\n        if (FontCache._MEASURE_CACHE.has(hash)) {\n            return FontCache._MEASURE_CACHE.get(hash);\n        }\n        FontCache._LOGGER.debug('Font text measurement cache miss');\n        const measurement = font.measureTextWithoutCache(text, maxWidth);\n        FontCache._MEASURE_CACHE.set(hash, measurement);\n        return measurement;\n    }\n    static getTextInstance(text, font, color) {\n        const hash = FontTextInstance.getHashCode(font, text, color);\n        let textInstance = FontCache._TEXT_CACHE.get(hash);\n        if (!textInstance) {\n            textInstance = new FontTextInstance(font, text, color);\n            FontCache._TEXT_CACHE.set(hash, textInstance);\n            FontCache._LOGGER.debug('Font text instance cache miss');\n        }\n        // Cache the bitmap for certain amount of time\n        FontCache._TEXT_USAGE.set(textInstance, performance.now());\n        return textInstance;\n    }\n    static checkAndClearCache() {\n        const deferred = [];\n        const currentHashCodes = new Set();\n        for (const [textInstance, time] of FontCache._TEXT_USAGE.entries()) {\n            // if bitmap hasn't been used in 100 ms clear it\n            if (time + FontCache.FONT_TIMEOUT < performance.now()) {\n                FontCache._LOGGER.debug(`Text cache entry timed out ${textInstance.text}`);\n                deferred.push(textInstance);\n                textInstance.dispose();\n            }\n            else {\n                const hash = textInstance.getHashCode(false);\n                currentHashCodes.add(hash);\n            }\n        }\n        // Deferred removal of text instances\n        deferred.forEach((t) => {\n            FontCache._TEXT_USAGE.delete(t);\n        });\n        // Regenerate text instance cache\n        this._TEXT_CACHE.clear();\n        for (const [textInstance] of this._TEXT_USAGE.entries()) {\n            this._TEXT_CACHE.set(textInstance.getHashCode(), textInstance);\n        }\n        // Regenerated measurement cache\n        const newTextMeasurementCache = new Map();\n        for (const current of currentHashCodes) {\n            if (FontCache._MEASURE_CACHE.has(current)) {\n                newTextMeasurementCache.set(current, FontCache._MEASURE_CACHE.get(current));\n            }\n        }\n        this._MEASURE_CACHE.clear();\n        this._MEASURE_CACHE = newTextMeasurementCache;\n    }\n    static get cacheSize() {\n        return FontCache._TEXT_USAGE.size;\n    }\n    /**\n     * Force clear all cached text bitmaps\n     */\n    static clearCache() {\n        for (const [textInstance] of FontCache._TEXT_USAGE.entries()) {\n            textInstance.dispose();\n        }\n        FontCache._TEXT_USAGE.clear();\n        FontCache._TEXT_CACHE.clear();\n        FontCache._MEASURE_CACHE.clear();\n    }\n}\nFontCache.FONT_TIMEOUT = 500;\nFontCache._LOGGER = Logger.getInstance();\nFontCache._TEXT_USAGE = new Map();\nFontCache._TEXT_CACHE = new Map();\nFontCache._MEASURE_CACHE = new Map();\n\n;// CONCATENATED MODULE: ./Graphics/Font.ts\n\n\n\n\n\n\n\n/**\n * Represents a system or web font in Excalibur\n *\n * If no options specified, the system sans-serif 10 pixel is used\n *\n * If loading a custom web font be sure to have the font loaded before you use it https://erikonarheim.com/posts/dont-test-fonts/\n */\nclass Font extends Graphic {\n    constructor(options = {}) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v;\n        super(options); // <- Graphics properties\n        /**\n         * Set the font filtering mode, by default set to [[ImageFiltering.Blended]] regardless of the engine default smoothing\n         *\n         * If you have a pixel style font that may be a reason to switch this to [[ImageFiltering.Pixel]]\n         */\n        this.filtering = ImageFiltering.Blended;\n        /**\n         * Font quality determines the size of the underlying raster text, higher quality means less jagged edges.\n         * If quality is set to 1, then just enough raster bitmap is generated to render the text.\n         *\n         * You can think of quality as how zoomed in to the text you can get before seeing jagged edges.\n         *\n         * (Default 2)\n         */\n        this.quality = 2;\n        // Raster properties for fonts\n        this.padding = 2;\n        this.smoothing = false;\n        this.lineWidth = 1;\n        this.lineDash = [];\n        this.color = Color.Black;\n        this.family = 'sans-serif';\n        this.style = FontStyle.Normal;\n        this.bold = false;\n        this.unit = FontUnit.Px;\n        this.textAlign = TextAlign.Left;\n        this.baseAlign = BaseAlign.Top;\n        this.direction = Direction.LeftToRight;\n        /**\n         * Font line height in pixels, default line height if unset\n         */\n        this.lineHeight = undefined;\n        this.size = 10;\n        this.shadow = null;\n        this._textBounds = new BoundingBox();\n        this._textMeasurement = new FontTextInstance(this, '', Color.Black);\n        // Raster properties\n        this.smoothing = (_a = options === null || options === void 0 ? void 0 : options.smoothing) !== null && _a !== void 0 ? _a : this.smoothing;\n        this.padding = (_b = options === null || options === void 0 ? void 0 : options.padding) !== null && _b !== void 0 ? _b : this.padding;\n        this.color = (_c = options === null || options === void 0 ? void 0 : options.color) !== null && _c !== void 0 ? _c : this.color;\n        this.strokeColor = (_d = options === null || options === void 0 ? void 0 : options.strokeColor) !== null && _d !== void 0 ? _d : this.strokeColor;\n        this.lineDash = (_e = options === null || options === void 0 ? void 0 : options.lineDash) !== null && _e !== void 0 ? _e : this.lineDash;\n        this.lineWidth = (_f = options === null || options === void 0 ? void 0 : options.lineWidth) !== null && _f !== void 0 ? _f : this.lineWidth;\n        this.filtering = (_g = options === null || options === void 0 ? void 0 : options.filtering) !== null && _g !== void 0 ? _g : this.filtering;\n        // Font specific properties\n        this.family = (_h = options === null || options === void 0 ? void 0 : options.family) !== null && _h !== void 0 ? _h : this.family;\n        this.style = (_j = options === null || options === void 0 ? void 0 : options.style) !== null && _j !== void 0 ? _j : this.style;\n        this.bold = (_k = options === null || options === void 0 ? void 0 : options.bold) !== null && _k !== void 0 ? _k : this.bold;\n        this.size = (_l = options === null || options === void 0 ? void 0 : options.size) !== null && _l !== void 0 ? _l : this.size;\n        this.unit = (_m = options === null || options === void 0 ? void 0 : options.unit) !== null && _m !== void 0 ? _m : this.unit;\n        this.textAlign = (_o = options === null || options === void 0 ? void 0 : options.textAlign) !== null && _o !== void 0 ? _o : this.textAlign;\n        this.baseAlign = (_p = options === null || options === void 0 ? void 0 : options.baseAlign) !== null && _p !== void 0 ? _p : this.baseAlign;\n        this.direction = (_q = options === null || options === void 0 ? void 0 : options.direction) !== null && _q !== void 0 ? _q : this.direction;\n        this.lineHeight = (_r = options === null || options === void 0 ? void 0 : options.lineHeight) !== null && _r !== void 0 ? _r : this.lineHeight;\n        this.quality = (_s = options === null || options === void 0 ? void 0 : options.quality) !== null && _s !== void 0 ? _s : this.quality;\n        if (options === null || options === void 0 ? void 0 : options.shadow) {\n            this.shadow = {};\n            this.shadow.blur = (_t = options.shadow.blur) !== null && _t !== void 0 ? _t : this.shadow.blur;\n            this.shadow.offset = (_u = options.shadow.offset) !== null && _u !== void 0 ? _u : this.shadow.offset;\n            this.shadow.color = (_v = options.shadow.color) !== null && _v !== void 0 ? _v : this.shadow.color;\n        }\n    }\n    clone() {\n        return new Font({\n            ...this.cloneGraphicOptions(),\n            size: this.size,\n            unit: this.unit,\n            family: this.family,\n            style: this.style,\n            bold: this.bold,\n            textAlign: this.textAlign,\n            baseAlign: this.baseAlign,\n            direction: this.direction,\n            shadow: this.shadow\n                ? {\n                    blur: this.shadow.blur,\n                    offset: this.shadow.offset,\n                    color: this.shadow.color\n                }\n                : null\n        });\n    }\n    get fontString() {\n        return `${this.style} ${this.bold ? 'bold' : ''} ${this.size}${this.unit} ${this.family}`;\n    }\n    get localBounds() {\n        return this._textBounds;\n    }\n    _drawImage(_ex, _x, _y) {\n        // TODO weird vestigial drawimage\n    }\n    _rotate(ex) {\n        var _a;\n        // TODO this needs to change depending on the bounding box...\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : this._textBounds.center;\n        ex.translate(origin.x, origin.y);\n        ex.rotate(this.rotation);\n        ex.translate(-origin.x, -origin.y);\n    }\n    _flip(ex) {\n        if (this.flipHorizontal) {\n            ex.translate(this._textBounds.width / this.scale.x, 0);\n            ex.scale(-1, 1);\n        }\n        if (this.flipVertical) {\n            ex.translate(0, -this._textBounds.height / 2 / this.scale.y);\n            ex.scale(1, -1);\n        }\n    }\n    measureTextWithoutCache(text, maxWidth) {\n        return this._textMeasurement.measureText(text, maxWidth);\n    }\n    /**\n     * Returns a BoundingBox that is the total size of the text including multiple lines\n     *\n     * Does not include any padding or adjustment\n     * @param text\n     * @returns BoundingBox\n     */\n    measureText(text, maxWidth) {\n        return FontCache.measureText(text, this, maxWidth);\n    }\n    _postDraw(ex) {\n        ex.restore();\n    }\n    render(ex, text, colorOverride, x, y, maxWidth) {\n        const textInstance = FontCache.getTextInstance(text, this, colorOverride);\n        // Apply affine transformations\n        this._textBounds = textInstance.dimensions;\n        this._preDraw(ex, x, y);\n        textInstance.render(ex, x, y, maxWidth);\n        this._postDraw(ex);\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Text.ts\n\n\n\n/**\n * Represent Text graphics in excalibur\n *\n * Useful for in game labels, ui, or overlays\n */\nclass Text extends Graphic {\n    constructor(options) {\n        var _a, _b;\n        super(options);\n        this._text = '';\n        this._textWidth = 0;\n        this._textHeight = 0;\n        // This order is important font, color, then text\n        this.font = (_a = options.font) !== null && _a !== void 0 ? _a : new Font();\n        this.color = (_b = options.color) !== null && _b !== void 0 ? _b : this.color;\n        this.text = options.text;\n        this.maxWidth = options.maxWidth;\n    }\n    clone() {\n        var _a, _b;\n        return new Text({\n            text: this.text.slice(),\n            color: (_b = (_a = this.color) === null || _a === void 0 ? void 0 : _a.clone()) !== null && _b !== void 0 ? _b : Color.Black,\n            font: this.font.clone(),\n            maxWidth: this.maxWidth\n        });\n    }\n    get text() {\n        return this._text;\n    }\n    set text(value) {\n        this._text = value;\n        this._calculateDimension();\n    }\n    get font() {\n        return this._font;\n    }\n    set font(font) {\n        this._font = font;\n    }\n    get width() {\n        if (this._textWidth === 0) {\n            this._calculateDimension();\n        }\n        return this._textWidth * this.scale.x;\n    }\n    get height() {\n        if (this._textHeight === 0) {\n            this._calculateDimension();\n        }\n        return this._textHeight * this.scale.y;\n    }\n    _calculateDimension() {\n        const { width, height } = this.font.measureText(this._text, this.maxWidth);\n        this._textWidth = width;\n        this._textHeight = height;\n    }\n    get localBounds() {\n        return this.font.measureText(this._text, this.maxWidth).scale(this.scale);\n    }\n    _rotate(_ex) {\n        // None this is delegated to font\n        // This override erases the default behavior\n    }\n    _flip(_ex) {\n        // None this is delegated to font\n        // This override erases the default behavior\n    }\n    _preDraw(ex, x, y) {\n        if (this.isStale() || this.font.isStale()) {\n            this.font.flipHorizontal = this.flipHorizontal;\n            this.font.flipVertical = this.flipVertical;\n            this.font.rotation = this.rotation;\n            this.font.origin = this.origin;\n            this.font.opacity = this.opacity;\n        }\n        this.font.tint = this.tint;\n        super._preDraw(ex, x, y);\n    }\n    _drawImage(ex, x, y) {\n        var _a;\n        let color = Color.Black;\n        if (this.font instanceof Font) {\n            color = (_a = this.color) !== null && _a !== void 0 ? _a : this.font.color;\n        }\n        const { width, height } = this.font.measureText(this._text, this.maxWidth);\n        this._textWidth = width;\n        this._textHeight = height;\n        this.font.render(ex, this._text, color, x, y, this.maxWidth);\n        if (this.font.showDebug) {\n            ex.debug.drawRect(x - width, y - height, width * 2, height * 2);\n            if (this.maxWidth != null) {\n                ex.debug.drawRect(x, y, this.maxWidth, this.height, {\n                    color: Color.Yellow\n                });\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Actor.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Type guard for checking if something is an Actor\n * @param x\n */\nfunction isActor(x) {\n    return x instanceof Actor;\n}\nconst ActorEvents = {\n    CollisionStart: 'collisionstart',\n    CollisionEnd: 'collisionend',\n    PreCollision: 'precollision',\n    PostCollision: 'postcollision',\n    Kill: 'kill',\n    PreKill: 'prekill',\n    PostKill: 'postkill',\n    PreDraw: 'predraw',\n    PostDraw: 'postdraw',\n    PreTransformDraw: 'pretransformdraw',\n    PostTransformDraw: 'posttransformdraw',\n    PreDebugDraw: 'predebugdraw',\n    PostDebugDraw: 'postdebugdraw',\n    PointerUp: 'pointerup',\n    PointerDown: 'pointerdown',\n    PointerEnter: 'pointerenter',\n    PointerLeave: 'pointerleave',\n    PointerMove: 'pointermove',\n    PointerCancel: 'pointercancel',\n    Wheel: 'pointerwheel',\n    PointerDrag: 'pointerdragstart',\n    PointerDragEnd: 'pointerdragend',\n    PointerDragEnter: 'pointerdragenter',\n    PointerDragLeave: 'pointerdragleave',\n    PointerDragMove: 'pointerdragmove',\n    EnterViewPort: 'enterviewport',\n    ExitViewPort: 'exitviewport',\n    ActionStart: 'actionstart',\n    ActionComplete: 'actioncomplete'\n};\n/**\n * The most important primitive in Excalibur is an `Actor`. Anything that\n * can move on the screen, collide with another `Actor`, respond to events,\n * or interact with the current scene, must be an actor. An `Actor` **must**\n * be part of a [[Scene]] for it to be drawn to the screen.\n */\nclass Actor extends Entity {\n    /**\n     * Gets the position vector of the actor in pixels\n     */\n    get pos() {\n        return this.transform.pos;\n    }\n    /**\n     * Sets the position vector of the actor in pixels\n     */\n    set pos(thePos) {\n        this.transform.pos = thePos.clone();\n    }\n    /**\n     * Gets the position vector of the actor from the last frame\n     */\n    get oldPos() {\n        return this.body.oldPos;\n    }\n    /**\n     * Sets the position vector of the actor in the last frame\n     */\n    set oldPos(thePos) {\n        this.body.oldPos.setTo(thePos.x, thePos.y);\n    }\n    /**\n     * Gets the velocity vector of the actor in pixels/sec\n     */\n    get vel() {\n        return this.motion.vel;\n    }\n    /**\n     * Sets the velocity vector of the actor in pixels/sec\n     */\n    set vel(theVel) {\n        this.motion.vel = theVel.clone();\n    }\n    /**\n     * Gets the velocity vector of the actor from the last frame\n     */\n    get oldVel() {\n        return this.body.oldVel;\n    }\n    /**\n     * Sets the velocity vector of the actor from the last frame\n     */\n    set oldVel(theVel) {\n        this.body.oldVel.setTo(theVel.x, theVel.y);\n    }\n    /**\n     * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be\n     * useful to simulate a gravitational effect.\n     */\n    get acc() {\n        return this.motion.acc;\n    }\n    /**\n     * Sets the acceleration vector of teh actor in pixels/second/second\n     */\n    set acc(theAcc) {\n        this.motion.acc = theAcc.clone();\n    }\n    /**\n     * Sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\n     */\n    set oldAcc(theAcc) {\n        this.body.oldAcc.setTo(theAcc.x, theAcc.y);\n    }\n    /**\n     * Gets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\n     */\n    get oldAcc() {\n        return this.body.oldAcc;\n    }\n    /**\n     * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\n     */\n    get rotation() {\n        return this.transform.rotation;\n    }\n    /**\n     * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\n     */\n    set rotation(theAngle) {\n        this.transform.rotation = theAngle;\n    }\n    /**\n     * Gets the rotational velocity of the actor in radians/second\n     */\n    get angularVelocity() {\n        return this.motion.angularVelocity;\n    }\n    /**\n     * Sets the rotational velocity of the actor in radians/sec\n     */\n    set angularVelocity(angularVelocity) {\n        this.motion.angularVelocity = angularVelocity;\n    }\n    get scale() {\n        return this.get(TransformComponent).scale;\n    }\n    set scale(scale) {\n        this.get(TransformComponent).scale = scale;\n    }\n    /**\n     * The anchor to apply all actor related transformations like rotation,\n     * translation, and scaling. By default the anchor is in the center of\n     * the actor. By default it is set to the center of the actor (.5, .5)\n     *\n     * An anchor of (.5, .5) will ensure that drawings are centered.\n     *\n     * Use `anchor.setTo` to set the anchor to a different point using\n     * values between 0 and 1. For example, anchoring to the top-left would be\n     * `Actor.anchor.setTo(0, 0)` and top-right would be `Actor.anchor.setTo(0, 1)`.\n     */\n    get anchor() {\n        return this._anchor;\n    }\n    set anchor(vec) {\n        this._anchor = watch(vec, (v) => this._handleAnchorChange(v));\n        this._handleAnchorChange(vec);\n    }\n    _handleAnchorChange(v) {\n        if (this.graphics) {\n            this.graphics.anchor = v;\n        }\n    }\n    /**\n     * The offset in pixels to apply to all actor graphics\n     *\n     * Default offset of (0, 0)\n     */\n    get offset() {\n        return this._offset;\n    }\n    set offset(vec) {\n        this._offset = watch(vec, (v) => this._handleOffsetChange(v));\n        this._handleOffsetChange(vec);\n    }\n    _handleOffsetChange(v) {\n        if (this.graphics) {\n            this.graphics.offset = v;\n        }\n    }\n    /**\n     * Indicates whether the actor is physically in the viewport\n     */\n    get isOffScreen() {\n        return this.hasTag('ex.offscreen');\n    }\n    get draggable() {\n        return this._draggable;\n    }\n    set draggable(isDraggable) {\n        if (isDraggable) {\n            if (isDraggable && !this._draggable) {\n                this.events.on('pointerdragstart', this._pointerDragStartHandler);\n                this.events.on('pointerdragend', this._pointerDragEndHandler);\n                this.events.on('pointerdragmove', this._pointerDragMoveHandler);\n                this.events.on('pointerdragleave', this._pointerDragLeaveHandler);\n            }\n            else if (!isDraggable && this._draggable) {\n                this.events.off('pointerdragstart', this._pointerDragStartHandler);\n                this.events.off('pointerdragend', this._pointerDragEndHandler);\n                this.events.off('pointerdragmove', this._pointerDragMoveHandler);\n                this.events.off('pointerdragleave', this._pointerDragLeaveHandler);\n            }\n            this._draggable = isDraggable;\n        }\n    }\n    /**\n     * Sets the color of the actor's current graphic\n     */\n    get color() {\n        return this._color;\n    }\n    set color(v) {\n        this._color = v.clone();\n        const currentGraphic = this.graphics.current;\n        if (currentGraphic instanceof Raster || currentGraphic instanceof Text) {\n            currentGraphic.color = this._color;\n        }\n    }\n    // #endregion\n    /**\n     *\n     * @param config\n     */\n    constructor(config) {\n        super();\n        this.events = new EventEmitter();\n        this._anchor = watch(Vector.Half, (v) => this._handleAnchorChange(v));\n        this._offset = watch(Vector.Zero, (v) => this._handleOffsetChange(v));\n        /**\n         * Convenience reference to the global logger\n         */\n        this.logger = Logger.getInstance();\n        /**\n         * Draggable helper\n         */\n        this._draggable = false;\n        this._dragging = false;\n        this._pointerDragStartHandler = () => {\n            this._dragging = true;\n        };\n        this._pointerDragEndHandler = () => {\n            this._dragging = false;\n        };\n        this._pointerDragMoveHandler = (pe) => {\n            if (this._dragging) {\n                this.pos = pe.worldPos;\n            }\n        };\n        this._pointerDragLeaveHandler = (pe) => {\n            if (this._dragging) {\n                this.pos = pe.worldPos;\n            }\n        };\n        const { name, x, y, pos, coordPlane, scale, width, height, radius, collider, vel, acc, rotation, angularVelocity, z, color, visible, opacity, anchor, offset, collisionType, collisionGroup } = {\n            ...config\n        };\n        this.name = name !== null && name !== void 0 ? name : this.name;\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : Actor.defaults.anchor.clone();\n        this.offset = offset !== null && offset !== void 0 ? offset : Vector.Zero;\n        this.transform = new TransformComponent();\n        this.addComponent(this.transform);\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\n        this.rotation = rotation !== null && rotation !== void 0 ? rotation : 0;\n        this.scale = scale !== null && scale !== void 0 ? scale : vec(1, 1);\n        this.z = z !== null && z !== void 0 ? z : 0;\n        this.transform.coordPlane = coordPlane !== null && coordPlane !== void 0 ? coordPlane : CoordPlane.World;\n        this.pointer = new PointerComponent;\n        this.addComponent(this.pointer);\n        this.graphics = new GraphicsComponent({\n            anchor: this.anchor,\n            offset: this.offset,\n            opacity: opacity\n        });\n        this.addComponent(this.graphics);\n        this.motion = new MotionComponent;\n        this.addComponent(this.motion);\n        this.vel = vel !== null && vel !== void 0 ? vel : Vector.Zero;\n        this.acc = acc !== null && acc !== void 0 ? acc : Vector.Zero;\n        this.angularVelocity = angularVelocity !== null && angularVelocity !== void 0 ? angularVelocity : 0;\n        this.actions = new ActionsComponent;\n        this.addComponent(this.actions);\n        this.body = new BodyComponent;\n        this.addComponent(this.body);\n        this.body.collisionType = collisionType !== null && collisionType !== void 0 ? collisionType : CollisionType.Passive;\n        if (collisionGroup) {\n            this.body.group = collisionGroup;\n        }\n        if (collider) {\n            this.collider = new ColliderComponent(collider);\n            this.addComponent(this.collider);\n        }\n        else if (radius) {\n            this.collider = new ColliderComponent(Shape.Circle(radius));\n            this.addComponent(this.collider);\n        }\n        else {\n            if (width > 0 && height > 0) {\n                this.collider = new ColliderComponent(Shape.Box(width, height, this.anchor));\n                this.addComponent(this.collider);\n            }\n            else {\n                this.collider = new ColliderComponent();\n                this.addComponent(this.collider); // no collider\n            }\n        }\n        this.graphics.visible = visible !== null && visible !== void 0 ? visible : true;\n        if (color) {\n            this.color = color;\n            if (width && height) {\n                this.graphics.add(new Rectangle({\n                    color: color,\n                    width,\n                    height\n                }));\n            }\n            else if (radius) {\n                this.graphics.add(new Circle({\n                    color: color,\n                    radius\n                }));\n            }\n        }\n    }\n    clone() {\n        const clone = new Actor({\n            color: this.color.clone(),\n            anchor: this.anchor.clone(),\n            offset: this.offset.clone()\n        });\n        clone.clearComponents();\n        clone.processComponentRemoval();\n        // Clone builtins, order is important, same as ctor\n        clone.addComponent(clone.transform = this.transform.clone(), true);\n        clone.addComponent(clone.pointer = this.pointer.clone(), true);\n        clone.addComponent(clone.graphics = this.graphics.clone(), true);\n        clone.addComponent(clone.motion = this.motion.clone(), true);\n        clone.addComponent(clone.actions = this.actions.clone(), true);\n        clone.addComponent(clone.body = this.body.clone(), true);\n        clone.addComponent(clone.collider = this.collider.clone(), true);\n        const builtInComponents = [\n            this.transform,\n            this.pointer,\n            this.graphics,\n            this.motion,\n            this.actions,\n            this.body,\n            this.collider\n        ];\n        // Clone non-builtin the current actors components\n        const components = this.getComponents();\n        for (const c of components) {\n            if (!builtInComponents.includes(c)) {\n                clone.addComponent(c.clone(), true);\n            }\n        }\n        return clone;\n    }\n    /**\n     * `onInitialize` is called before the first update of the actor. This method is meant to be\n     * overridden. This is where initialization of child actors should take place.\n     *\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\n     */\n    onInitialize(engine) {\n        // Override me\n    }\n    /**\n     * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.\n     *\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     * @internal\n     */\n    _initialize(engine) {\n        super._initialize(engine);\n        for (const child of this.children) {\n            child._initialize(engine);\n        }\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n    // #endregion\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _prekill handler for [[onPreKill]] lifecycle event\n     * @internal\n     */\n    _prekill(scene) {\n        this.events.emit('prekill', new PreKillEvent(this));\n        this.onPreKill(scene);\n    }\n    /**\n     * Safe to override onPreKill lifecycle event handler. Synonymous with `.on('prekill', (evt) =>{...})`\n     *\n     * `onPreKill` is called directly before an actor is killed and removed from its current [[Scene]].\n     */\n    onPreKill(scene) {\n        // Override me\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _prekill handler for [[onPostKill]] lifecycle event\n     * @internal\n     */\n    _postkill(scene) {\n        this.events.emit('postkill', new PostKillEvent(this));\n        this.onPostKill(scene);\n    }\n    /**\n     * Safe to override onPostKill lifecycle event handler. Synonymous with `.on('postkill', (evt) => {...})`\n     *\n     * `onPostKill` is called directly after an actor is killed and remove from its current [[Scene]].\n     */\n    onPostKill(scene) {\n        // Override me\n    }\n    /**\n     * If the current actor is a member of the scene, this will remove\n     * it from the scene graph. It will no longer be drawn or updated.\n     */\n    kill() {\n        if (this.scene) {\n            this._prekill(this.scene);\n            this.events.emit('kill', new KillEvent(this));\n            super.kill();\n            this._postkill(this.scene);\n        }\n        else {\n            this.logger.warn(`Cannot kill actor named \"${this.name}\", it was never added to the Scene`);\n        }\n    }\n    /**\n     * If the current actor is killed, it will now not be killed.\n     */\n    unkill() {\n        this.active = true;\n    }\n    /**\n     * Indicates wether the actor has been killed.\n     */\n    isKilled() {\n        return !this.active;\n    }\n    /**\n     * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\n     */\n    get z() {\n        return this.get(TransformComponent).z;\n    }\n    /**\n     * Sets the z-index of an actor and updates it in the drawing list for the scene.\n     * The z-index determines the relative order an actor is drawn in.\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\n     * @param newZ new z-index to assign\n     */\n    set z(newZ) {\n        this.get(TransformComponent).z = newZ;\n    }\n    /**\n     * Get the center point of an actor (global position)\n     */\n    get center() {\n        const globalPos = this.getGlobalPos();\n        return new Vector(globalPos.x + this.width / 2 - this.anchor.x * this.width, globalPos.y + this.height / 2 - this.anchor.y * this.height);\n    }\n    /**\n     * Get the local center point of an actor\n     */\n    get localCenter() {\n        return new Vector(this.pos.x + this.width / 2 - this.anchor.x * this.width, this.pos.y + this.height / 2 - this.anchor.y * this.height);\n    }\n    get width() {\n        return this.collider.localBounds.width * this.getGlobalScale().x;\n    }\n    get height() {\n        return this.collider.localBounds.height * this.getGlobalScale().y;\n    }\n    /**\n     * Gets this actor's rotation taking into account any parent relationships\n     * @returns Rotation angle in radians\n     */\n    getGlobalRotation() {\n        return this.get(TransformComponent).globalRotation;\n    }\n    /**\n     * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation\n     * @returns Position in world coordinates\n     */\n    getGlobalPos() {\n        return this.get(TransformComponent).globalPos;\n    }\n    /**\n     * Gets the global scale of the Actor\n     */\n    getGlobalScale() {\n        return this.get(TransformComponent).globalScale;\n    }\n    // #region Collision\n    /**\n     * Tests whether the x/y specified are contained in the actor\n     * @param x  X coordinate to test (in world coordinates)\n     * @param y  Y coordinate to test (in world coordinates)\n     * @param recurse checks whether the x/y are contained in any child actors (if they exist).\n     */\n    contains(x, y, recurse = false) {\n        const point = vec(x, y);\n        const collider = this.get(ColliderComponent);\n        collider.update();\n        const geom = collider.get();\n        if (!geom) {\n            return false;\n        }\n        const containment = geom.contains(point);\n        if (recurse) {\n            return (containment ||\n                this.children.some((child) => {\n                    return child.contains(x, y, true);\n                }));\n        }\n        return containment;\n    }\n    /**\n     * Returns true if the two actor.collider's surfaces are less than or equal to the distance specified from each other\n     * @param actor     Actor to test\n     * @param distance  Distance in pixels to test\n     */\n    within(actor, distance) {\n        const collider = this.get(ColliderComponent);\n        const otherCollider = actor.get(ColliderComponent);\n        const me = collider.get();\n        const other = otherCollider.get();\n        if (me && other) {\n            return me.getClosestLineBetween(other).getLength() <= distance;\n        }\n        return false;\n    }\n    // #endregion\n    // #region Update\n    /**\n     * Called by the Engine, updates the state of the actor\n     * @internal\n     * @param engine The reference to the current game engine\n     * @param delta  The time elapsed since the last update in milliseconds\n     */\n    update(engine, delta) {\n        this._initialize(engine);\n        this._preupdate(engine, delta);\n        this._postupdate(engine, delta);\n    }\n    /**\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPreUpdate` is called directly before an actor is updated.\n     */\n    onPreUpdate(engine, delta) {\n        // Override me\n    }\n    /**\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\n     *\n     * `onPostUpdate` is called directly after an actor is updated.\n     */\n    onPostUpdate(engine, delta) {\n        // Override me\n    }\n    /**\n     * Fires before every collision resolution for a confirmed contact\n     * @param self\n     * @param other\n     * @param side\n     * @param contact\n     */\n    onPreCollisionResolve(self, other, side, contact) {\n        // Override me\n    }\n    /**\n     * Fires after every resolution for a confirmed contact.\n     * @param self\n     * @param other\n     * @param side\n     * @param contact\n     */\n    onPostCollisionResolve(self, other, side, contact) {\n        // Override me\n    }\n    /**\n     * Fires once when 2 entities with a ColliderComponent first start colliding or touching, if the Colliders stay in contact this\n     * does not continue firing until they separate and re-collide.\n     * @param self\n     * @param other\n     * @param side\n     * @param contact\n     */\n    onCollisionStart(self, other, side, contact) {\n        // Override me\n    }\n    /**\n     * Fires once when 2 entities with a ColliderComponent separate after having been in contact.\n     * @param self\n     * @param other\n     * @param side\n     * @param lastContact\n     */\n    onCollisionEnd(self, other, side, lastContact) {\n        // Override me\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n     * @internal\n     */\n    _preupdate(engine, delta) {\n        this.events.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n        this.onPreUpdate(engine, delta);\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n     * @internal\n     */\n    _postupdate(engine, delta) {\n        this.events.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n        this.onPostUpdate(engine, delta);\n    }\n}\n// #region Properties\n/**\n * Set defaults for all Actors\n */\nActor.defaults = {\n    anchor: Vector.Half\n};\n\n;// CONCATENATED MODULE: ./ScreenElement.ts\n\n\n\n\n\n/**\n * Type guard to detect a screen element\n */\nfunction isScreenElement(actor) {\n    return actor instanceof ScreenElement;\n}\n/**\n * Helper [[Actor]] primitive for drawing UI's, optimized for UI drawing. Does\n * not participate in collisions. Drawn on top of all other actors.\n */\nclass ScreenElement extends Actor {\n    constructor(config) {\n        var _a, _b;\n        super({ ...config });\n        this.get(TransformComponent).coordPlane = CoordPlane.Screen;\n        this.anchor = (_a = config === null || config === void 0 ? void 0 : config.anchor) !== null && _a !== void 0 ? _a : vec(0, 0);\n        this.body.collisionType = (_b = config === null || config === void 0 ? void 0 : config.collisionType) !== null && _b !== void 0 ? _b : CollisionType.PreventCollision;\n        this.pointer.useGraphicsBounds = true;\n        this.pointer.useColliderShape = false;\n        if (!(config === null || config === void 0 ? void 0 : config.collider) &&\n            (config === null || config === void 0 ? void 0 : config.width) > 0 &&\n            (config === null || config === void 0 ? void 0 : config.height) > 0) {\n            this.collider.useBoxCollider(this.width, this.height, this.anchor);\n        }\n    }\n    _initialize(engine) {\n        this._engine = engine;\n        super._initialize(engine);\n    }\n    contains(x, y, useWorld = true) {\n        if (useWorld) {\n            return super.contains(x, y);\n        }\n        const coords = this._engine.worldToScreenCoordinates(new Vector(x, y));\n        return super.contains(coords.x, coords.y);\n    }\n}\n\n;// CONCATENATED MODULE: ./Timer.ts\n\n\n/**\n * The Excalibur timer hooks into the internal timer and fires callbacks,\n * after a certain interval, optionally repeating.\n */\nclass Timer {\n    get complete() {\n        return this._complete;\n    }\n    constructor(fcn, interval, repeats, numberOfRepeats, randomRange, random) {\n        this._logger = Logger.getInstance();\n        this.id = 0;\n        this._elapsedTime = 0;\n        this._totalTimeAlive = 0;\n        this._running = false;\n        this._numberOfTicks = 0;\n        this.interval = 10;\n        this.repeats = false;\n        this.maxNumberOfRepeats = -1;\n        this.randomRange = [0, 0];\n        this._baseInterval = 10;\n        this._generateRandomInterval = () => {\n            return this._baseInterval + this.random.integer(this.randomRange[0], this.randomRange[1]);\n        };\n        this._complete = false;\n        this.scene = null;\n        if (typeof fcn !== 'function') {\n            const options = fcn;\n            fcn = options.fcn;\n            interval = options.interval;\n            repeats = options.repeats;\n            numberOfRepeats = options.numberOfRepeats;\n            randomRange = options.randomRange;\n            random = options.random;\n        }\n        if (!!numberOfRepeats && numberOfRepeats >= 0) {\n            this.maxNumberOfRepeats = numberOfRepeats;\n            if (!repeats) {\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\n            }\n        }\n        this.id = Timer._MAX_ID++;\n        this._callbacks = [];\n        this._baseInterval = this.interval = interval;\n        if (!!randomRange) {\n            if (randomRange[0] > randomRange[1]) {\n                throw new Error('min value must be lower than max value for range');\n            }\n            //We use the instance of ex.Random to generate the range\n            this.random = random !== null && random !== void 0 ? random : new Random();\n            this.randomRange = randomRange;\n            this.interval = this._generateRandomInterval();\n            this.on(() => {\n                this.interval = this._generateRandomInterval();\n            });\n        }\n        ;\n        this.repeats = repeats || this.repeats;\n        if (fcn) {\n            this.on(fcn);\n        }\n    }\n    /**\n     * Adds a new callback to be fired after the interval is complete\n     * @param fcn The callback to be added to the callback list, to be fired after the interval is complete.\n     */\n    on(fcn) {\n        this._callbacks.push(fcn);\n    }\n    /**\n     * Removes a callback from the callback list to be fired after the interval is complete.\n     * @param fcn The callback to be removed from the callback list, to be fired after the interval is complete.\n     */\n    off(fcn) {\n        const index = this._callbacks.indexOf(fcn);\n        this._callbacks.splice(index, 1);\n    }\n    /**\n     * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.\n     * @param delta  Number of elapsed milliseconds since the last update.\n     */\n    update(delta) {\n        if (this._running) {\n            this._totalTimeAlive += delta;\n            this._elapsedTime += delta;\n            if (this.maxNumberOfRepeats > -1 && this._numberOfTicks >= this.maxNumberOfRepeats) {\n                this._complete = true;\n                this._running = false;\n                this._elapsedTime = 0;\n            }\n            if (!this.complete && this._elapsedTime >= this.interval) {\n                this._callbacks.forEach((c) => {\n                    c.call(this);\n                });\n                this._numberOfTicks++;\n                if (this.repeats) {\n                    this._elapsedTime = 0;\n                }\n                else {\n                    this._complete = true;\n                    this._running = false;\n                    this._elapsedTime = 0;\n                }\n            }\n        }\n    }\n    /**\n     * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.\n     *\n     * Warning** you may need to call `timer.start()` again if the timer had completed\n     * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback\n     * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes\n     */\n    reset(newInterval, newNumberOfRepeats) {\n        if (!!newInterval && newInterval >= 0) {\n            this._baseInterval = this.interval = newInterval;\n        }\n        if (!!this.maxNumberOfRepeats && this.maxNumberOfRepeats >= 0) {\n            this.maxNumberOfRepeats = newNumberOfRepeats;\n            if (!this.repeats) {\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\n            }\n        }\n        this._complete = false;\n        this._elapsedTime = 0;\n        this._numberOfTicks = 0;\n    }\n    get timesRepeated() {\n        return this._numberOfTicks;\n    }\n    getTimeRunning() {\n        return this._totalTimeAlive;\n    }\n    /**\n     * @returns milliseconds until the next action callback, if complete will return 0\n     */\n    get timeToNextAction() {\n        if (this.complete) {\n            return 0;\n        }\n        return this.interval - this._elapsedTime;\n    }\n    /**\n     * @returns milliseconds elapsed toward the next action\n     */\n    get timeElapsedTowardNextAction() {\n        return this._elapsedTime;\n    }\n    get isRunning() {\n        return this._running;\n    }\n    /**\n     * Pauses the timer, time will no longer increment towards the next call\n     */\n    pause() {\n        this._running = false;\n        return this;\n    }\n    /**\n     * Resumes the timer, time will now increment towards the next call.\n     */\n    resume() {\n        this._running = true;\n        return this;\n    }\n    /**\n     * Starts the timer, if the timer was complete it will restart the timer and reset the elapsed time counter\n     */\n    start() {\n        if (!this.scene) {\n            this._logger.warn('Cannot start a timer not part of a scene, timer wont start until added');\n        }\n        this._running = true;\n        if (this.complete) {\n            this._complete = false;\n            this._elapsedTime = 0;\n            this._numberOfTicks = 0;\n        }\n        return this;\n    }\n    /**\n     * Stops the timer and resets the elapsed time counter towards the next action invocation\n     */\n    stop() {\n        this._running = false;\n        this._elapsedTime = 0;\n        this._numberOfTicks = 0;\n        return this;\n    }\n    /**\n     * Cancels the timer, preventing any further executions.\n     */\n    cancel() {\n        this.pause();\n        if (this.scene) {\n            this.scene.cancelTimer(this);\n        }\n    }\n}\nTimer._MAX_ID = 0;\n\n;// CONCATENATED MODULE: ./Graphics/ParallaxComponent.ts\n\n\nclass ParallaxComponent extends Component {\n    constructor(parallaxFactor) {\n        super();\n        this.parallaxFactor = vec(1.0, 1.0);\n        this.parallaxFactor = parallaxFactor !== null && parallaxFactor !== void 0 ? parallaxFactor : this.parallaxFactor;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/DebugGraphicsComponent.ts\n\n/**\n * Provide arbitrary drawing for the purposes of debugging your game\n *\n * Will only show when the Engine is set to debug mode [[Engine.showDebug]] or [[Engine.toggleDebug]]\n *\n */\nclass DebugGraphicsComponent extends Component {\n    constructor(draw, useTransform = true) {\n        super();\n        this.draw = draw;\n        this.useTransform = useTransform;\n    }\n}\n\n;// CONCATENATED MODULE: ./TileMap/TileMap.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst TileMapEvents = {\n    PreUpdate: 'preupdate',\n    PostUpdate: 'postupdate',\n    PreDraw: 'predraw',\n    PostDraw: 'postdraw',\n    PointerUp: 'pointerup',\n    PointerDown: 'pointerdown',\n    PointerMove: 'pointermove',\n    PointerCancel: 'pointercancel'\n};\n/**\n * The TileMap provides a mechanism for doing flat 2D tiles rendered in a grid.\n *\n * TileMaps are useful for top down or side scrolling grid oriented games.\n */\nclass TileMap extends Entity {\n    flagCollidersDirty() {\n        this._collidersDirty = true;\n    }\n    flagTilesDirty() {\n        for (let i = 0; i < this.tiles.length; i++) {\n            if (this.tiles[i]) {\n                this.tiles[i].flagDirty();\n            }\n        }\n    }\n    get x() {\n        var _a;\n        return (_a = this.transform.pos.x) !== null && _a !== void 0 ? _a : 0;\n    }\n    set x(val) {\n        var _a;\n        if ((_a = this.transform) === null || _a === void 0 ? void 0 : _a.pos) {\n            this.get(TransformComponent).pos = vec(val, this.y);\n        }\n    }\n    get y() {\n        var _a, _b;\n        return (_b = (_a = this.transform) === null || _a === void 0 ? void 0 : _a.pos.y) !== null && _b !== void 0 ? _b : 0;\n    }\n    set y(val) {\n        var _a;\n        if ((_a = this.transform) === null || _a === void 0 ? void 0 : _a.pos) {\n            this.transform.pos = vec(this.x, val);\n        }\n    }\n    get z() {\n        var _a;\n        return (_a = this.transform.z) !== null && _a !== void 0 ? _a : 0;\n    }\n    set z(val) {\n        if (this.transform) {\n            this.transform.z = val;\n        }\n    }\n    get rotation() {\n        var _a, _b;\n        return (_b = (_a = this.transform) === null || _a === void 0 ? void 0 : _a.rotation) !== null && _b !== void 0 ? _b : 0;\n    }\n    set rotation(val) {\n        if (this.transform) {\n            this.transform.rotation = val;\n        }\n    }\n    get scale() {\n        var _a, _b;\n        return (_b = (_a = this.transform) === null || _a === void 0 ? void 0 : _a.scale) !== null && _b !== void 0 ? _b : Vector.One;\n    }\n    set scale(val) {\n        var _a;\n        if ((_a = this.transform) === null || _a === void 0 ? void 0 : _a.scale) {\n            this.transform.scale = val;\n        }\n    }\n    get pos() {\n        return this.transform.pos;\n    }\n    set pos(val) {\n        this.transform.pos = val;\n    }\n    get vel() {\n        return this._motion.vel;\n    }\n    set vel(val) {\n        this._motion.vel = val;\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n    /**\n     * @param options\n     */\n    constructor(options) {\n        var _a, _b, _c;\n        super([], options.name);\n        this.events = new EventEmitter();\n        this._token = 0;\n        this.logger = Logger.getInstance();\n        this.tiles = [];\n        this._rows = [];\n        this._cols = [];\n        this.renderFromTopOfGraphic = false;\n        this.meshingLookBehind = 10;\n        this._collidersDirty = true;\n        this._forwardPointerEventToTile = (eventType) => (evt) => {\n            const tile = this.getTileByPoint(evt.worldPos);\n            if (tile) {\n                tile.events.emit(eventType, evt);\n            }\n        };\n        this._originalOffsets = new WeakMap();\n        this.meshingLookBehind = (_a = options.meshingLookBehind) !== null && _a !== void 0 ? _a : this.meshingLookBehind;\n        this.addComponent(new TransformComponent());\n        this.addComponent(new MotionComponent());\n        this.addComponent(new BodyComponent({\n            type: CollisionType.Fixed\n        }));\n        this.addComponent(new GraphicsComponent({\n            onPostDraw: (ctx, delta) => this.draw(ctx, delta)\n        }));\n        this.addComponent(new DebugGraphicsComponent((ctx, debugFlags) => this.debug(ctx, debugFlags), false));\n        this.addComponent(new ColliderComponent());\n        this.addComponent(new PointerComponent);\n        this.pointer = this.get(PointerComponent);\n        this._graphics = this.get(GraphicsComponent);\n        this.transform = this.get(TransformComponent);\n        this._motion = this.get(MotionComponent);\n        this.collider = this.get(ColliderComponent);\n        this._composite = this.collider.useCompositeCollider([]);\n        this.transform.pos = (_b = options.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\n        this._oldPos = this.transform.pos.clone();\n        this._oldScale = this.transform.scale.clone();\n        this.renderFromTopOfGraphic = (_c = options.renderFromTopOfGraphic) !== null && _c !== void 0 ? _c : this.renderFromTopOfGraphic;\n        this.tileWidth = options.tileWidth;\n        this.tileHeight = options.tileHeight;\n        this.rows = options.rows;\n        this.columns = options.columns;\n        this.tiles = new Array(this.rows * this.columns);\n        this._rows = new Array(this.rows);\n        this._cols = new Array(this.columns);\n        let currentCol = [];\n        for (let i = 0; i < this.columns; i++) {\n            for (let j = 0; j < this.rows; j++) {\n                const tile = new Tile({\n                    x: i,\n                    y: j,\n                    map: this\n                });\n                tile.map = this;\n                this.tiles[i + j * this.columns] = tile;\n                currentCol.push(tile);\n                if (!this._rows[j]) {\n                    this._rows[j] = [];\n                }\n                this._rows[j].push(tile);\n            }\n            this._cols[i] = currentCol;\n            currentCol = [];\n        }\n        this._setupPointerToTile();\n        this._graphics.localBounds = new BoundingBox({\n            left: 0,\n            top: 0,\n            right: this.columns * this.tileWidth * this.scale.x,\n            bottom: this.rows * this.tileHeight * this.scale.y\n        });\n    }\n    _initialize(engine) {\n        super._initialize(engine);\n        this._engine = engine;\n    }\n    _setupPointerToTile() {\n        this.events.on('pointerup', this._forwardPointerEventToTile('pointerup'));\n        this.events.on('pointerdown', this._forwardPointerEventToTile('pointerdown'));\n        this.events.on('pointermove', this._forwardPointerEventToTile('pointermove'));\n        this.events.on('pointercancel', this._forwardPointerEventToTile('pointercancel'));\n    }\n    _getOrSetColliderOriginalOffset(collider) {\n        if (!this._originalOffsets.has(collider)) {\n            const originalOffset = collider.offset;\n            this._originalOffsets.set(collider, originalOffset);\n            return originalOffset;\n        }\n        else {\n            return this._originalOffsets.get(collider);\n        }\n    }\n    /**\n     * Tiles colliders based on the solid tiles in the tilemap.\n     */\n    _updateColliders() {\n        this.collider.$colliderRemoved.notifyAll(this._composite);\n        this._composite.clearColliders();\n        const colliders = [];\n        this._composite = this.collider.useCompositeCollider([]);\n        let current;\n        /**\n         * Returns wether or not the 2 boxes share an edge and are the same height\n         * @param prev\n         * @param next\n         * @returns true if they share and edge, false if not\n         */\n        const shareEdges = (prev, next) => {\n            if (prev && next) {\n                // same top/bottom\n                return prev.top === next.top &&\n                    prev.bottom === next.bottom &&\n                    // Shared right/left edge\n                    prev.right === next.left;\n            }\n            return false;\n        };\n        /**\n         * Potentially merges the current collider into a list of previous ones, mutating the list\n         * If checkAndCombine returns true, the collider was successfully merged and should be thrown away\n         * @param current current collider to test\n         * @param colliders List of colliders to consider merging with\n         * @param maxLookBack The amount of colliders to look back for combination\n         * @returns false when no combination found, true when successfully combined\n         */\n        const checkAndCombine = (current, colliders, maxLookBack = this.meshingLookBehind) => {\n            if (!current) {\n                return false;\n            }\n            // walk backwards through the list of colliders and combine with the first that shares an edge\n            for (let i = colliders.length - 1; i >= 0; i--) {\n                if (maxLookBack-- < 0) {\n                    // blunt the O(n^2) algorithm a bit\n                    return false;\n                }\n                const prev = colliders[i];\n                if (shareEdges(prev, current)) {\n                    colliders[i] = prev.combine(current);\n                    return true;\n                }\n            }\n            return false;\n        };\n        // ? configurable bias perhaps, horizontal strips vs. vertical ones\n        // Bad tile collider packing algorithm\n        for (let i = 0; i < this.columns; i++) {\n            // Scan column for colliders\n            for (let j = 0; j < this.rows; j++) {\n                const tile = this.tiles[i + j * this.columns];\n                // Current tile in column is solid build up current collider\n                if (tile.solid) {\n                    // Use custom collider otherwise bounding box\n                    if (tile.getColliders().length > 0) {\n                        // tile with custom collider interrupting the current run\n                        for (const collider of tile.getColliders()) {\n                            const originalOffset = this._getOrSetColliderOriginalOffset(collider);\n                            collider.offset = vec(tile.x * this.tileWidth * this.scale.x, tile.y * this.tileHeight * this.scale.y).add(originalOffset);\n                            collider.owner = this;\n                            this._composite.addCollider(collider);\n                        }\n                        //we push any current collider before nulling the current run\n                        if (current && !checkAndCombine(current, colliders)) {\n                            colliders.push(current);\n                        }\n                        current = null;\n                        // Use the bounding box\n                    }\n                    else {\n                        if (!current) {\n                            // no current run, start one\n                            current = tile.defaultGeometry;\n                        }\n                        else {\n                            // combine with current run\n                            current = current.combine(tile.defaultGeometry);\n                        }\n                    }\n                }\n                else {\n                    // Not solid skip and cut off the current collider\n                    // End of run check and combine\n                    if (current && !checkAndCombine(current, colliders)) {\n                        colliders.push(current);\n                    }\n                    current = null;\n                }\n            }\n            // After a column is complete check to see if it can be merged into the last one\n            // Eno of run check and combine\n            if (current && !checkAndCombine(current, colliders)) {\n                // else new collider if no combination\n                colliders.push(current);\n            }\n            current = null;\n        }\n        for (const c of colliders) {\n            const collider = Shape.Box(c.width, c.height, Vector.Zero, vec(c.left - this.pos.x, c.top - this.pos.y));\n            collider.owner = this;\n            this._composite.addCollider(collider);\n        }\n        this.collider.update();\n        // Notify that colliders have been updated\n        this.collider.$colliderAdded.notifyAll(this._composite);\n    }\n    /**\n     * Returns the [[Tile]] by index (row major order)\n     */\n    getTileByIndex(index) {\n        return this.tiles[index];\n    }\n    /**\n     * Returns the [[Tile]] by its x and y integer coordinates\n     *\n     * For example, if I want the tile in fifth column (x), and second row (y):\n     * `getTile(4, 1)` 0 based, so 0 is the first in row/column\n     */\n    getTile(x, y) {\n        if (x < 0 || y < 0 || x >= this.columns || y >= this.rows) {\n            return null;\n        }\n        return this.tiles[x + y * this.columns];\n    }\n    /**\n     * Returns the [[Tile]] by testing a point in world coordinates,\n     * returns `null` if no Tile was found.\n     */\n    getTileByPoint(point) {\n        const { x, y } = this._getTileCoordinates(point);\n        const tile = this.getTile(x, y);\n        if (x >= 0 && y >= 0 && x < this.columns && y < this.rows && tile) {\n            return tile;\n        }\n        return null;\n    }\n    _getTileCoordinates(point) {\n        // Convert to Tile Space point\n        point = this.transform.applyInverse(point);\n        const x = Math.floor(point.x / this.tileWidth);\n        const y = Math.floor(point.y / this.tileHeight);\n        return { x, y };\n    }\n    getRows() {\n        return this._rows;\n    }\n    getColumns() {\n        return this._cols;\n    }\n    /**\n     * Returns the on screen tiles for a tilemap, this will overshoot by a small amount because of the internal quad tree data structure.\n     *\n     * Useful if you need to perform specific logic on onscreen tiles\n     */\n    getOnScreenTiles() {\n        let worldBounds = this._engine.screen.getWorldBounds();\n        const maybeParallax = this.get(ParallaxComponent);\n        if (maybeParallax && this.isInitialized) {\n            let pos = this.pos;\n            const oneMinusFactor = Vector.One.sub(maybeParallax.parallaxFactor);\n            const parallaxOffset = this._engine.currentScene.camera.pos.scale(oneMinusFactor);\n            pos = pos.sub(parallaxOffset);\n            // adjust world bounds by parallax factor\n            worldBounds = worldBounds.translate(pos);\n        }\n        const bounds = this.transform.coordPlane === CoordPlane.Screen ?\n            this._engine.screen.getScreenBounds() :\n            worldBounds;\n        const topLeft = this._getTileCoordinates(bounds.topLeft);\n        const topRight = this._getTileCoordinates(bounds.topRight);\n        const bottomRight = this._getTileCoordinates(bounds.bottomRight);\n        const bottomLeft = this._getTileCoordinates(bounds.bottomLeft);\n        const tileStartX = Math.min(clamp(topLeft.x, 0, this.columns - 1), clamp(topRight.x, 0, this.columns - 1));\n        const tileStartY = Math.min(clamp(topLeft.y, 0, this.rows - 1), clamp(topRight.y, 0, this.rows - 1));\n        const tileEndX = Math.max(clamp(bottomRight.x, 0, this.columns - 1), clamp(bottomLeft.x, 0, this.columns - 1));\n        const tileEndY = Math.max(clamp(bottomRight.y, 0, this.rows - 1), clamp(bottomLeft.y, 0, this.rows - 1));\n        const tiles = [];\n        for (let x = tileStartX; x <= tileEndX; x++) {\n            for (let y = tileStartY; y <= tileEndY; y++) {\n                tiles.push(this.getTile(x, y));\n            }\n        }\n        return tiles;\n    }\n    update(engine, delta) {\n        this._initialize(engine);\n        this.onPreUpdate(engine, delta);\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n        if (!this._oldPos.equals(this.pos) ||\n            this._oldRotation !== this.rotation ||\n            !this._oldScale.equals(this.scale)) {\n            this.flagCollidersDirty();\n            this.flagTilesDirty();\n        }\n        if (this._collidersDirty) {\n            this._collidersDirty = false;\n            this._updateColliders();\n        }\n        this._token++;\n        this.pos.clone(this._oldPos);\n        this._oldRotation = this.rotation;\n        this.scale.clone(this._oldScale);\n        this.transform.pos = this.pos;\n        this.onPostUpdate(engine, delta);\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n    }\n    /**\n     * Draws the tile map to the screen. Called by the [[Scene]].\n     * @param ctx ExcaliburGraphicsContext\n     * @param delta  The number of milliseconds since the last draw\n     */\n    draw(ctx, delta) {\n        if (!this.isInitialized) {\n            return;\n        }\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this)); // TODO fix event\n        let graphics, graphicsIndex, graphicsLen;\n        const tiles = this.getOnScreenTiles();\n        for (let i = 0; i < tiles.length; i++) {\n            const tile = tiles[i];\n            // get non-negative tile sprites\n            const offsets = tile.getGraphicsOffsets();\n            graphics = tile.getGraphics();\n            for (graphicsIndex = 0, graphicsLen = graphics.length; graphicsIndex < graphicsLen; graphicsIndex++) {\n                // draw sprite, warning if sprite doesn't exist\n                const graphic = graphics[graphicsIndex];\n                const offset = offsets[graphicsIndex];\n                if (graphic) {\n                    if (hasGraphicsTick(graphic)) {\n                        graphic === null || graphic === void 0 ? void 0 : graphic.tick(delta, this._token);\n                    }\n                    const offsetY = this.renderFromTopOfGraphic ? 0 : (graphic.height - this.tileHeight);\n                    graphic.draw(ctx, tile.x * this.tileWidth + offset.x, tile.y * this.tileHeight - offsetY + offset.y);\n                }\n            }\n        }\n        this.emit('postdraw', new PostDrawEvent(ctx, delta, this));\n    }\n    debug(gfx, debugFlags) {\n        const { showAll, showGrid, gridColor, gridWidth, showSolidBounds: showColliderBounds, solidBoundsColor: colliderBoundsColor, showColliderGeometry } = debugFlags.tilemap;\n        const { geometryColor, geometryLineWidth, geometryPointSize } = debugFlags.collider;\n        const width = this.tileWidth * this.columns * this.scale.x;\n        const height = this.tileHeight * this.rows * this.scale.y;\n        const pos = this.pos;\n        if (showGrid || showAll) {\n            for (let r = 0; r < this.rows + 1; r++) {\n                const yOffset = vec(0, r * this.tileHeight * this.scale.y);\n                gfx.drawLine(pos.add(yOffset), pos.add(vec(width, yOffset.y)), gridColor, gridWidth);\n            }\n            for (let c = 0; c < this.columns + 1; c++) {\n                const xOffset = vec(c * this.tileWidth * this.scale.x, 0);\n                gfx.drawLine(pos.add(xOffset), pos.add(vec(xOffset.x, height)), gridColor, gridWidth);\n            }\n        }\n        if (showAll || showColliderBounds || showColliderGeometry) {\n            const colliders = this._composite.getColliders();\n            gfx.save();\n            gfx.translate(this.pos.x, this.pos.y);\n            gfx.scale(this.scale.x, this.scale.y);\n            for (const collider of colliders) {\n                const bounds = collider.localBounds;\n                const pos = collider.worldPos.sub(this.pos);\n                if (showColliderBounds) {\n                    gfx.drawRectangle(pos, bounds.width, bounds.height, colliderBoundsColor);\n                }\n            }\n            gfx.restore();\n            if (showColliderGeometry) {\n                for (const collider of colliders) {\n                    collider.debug(gfx, geometryColor, { lineWidth: geometryLineWidth, pointSize: geometryPointSize });\n                }\n            }\n        }\n        if (showAll || showColliderBounds) {\n            gfx.save();\n            gfx.z = 999;\n            if (showColliderBounds) {\n                for (let i = 0; i < this.tiles.length; i++) {\n                    this.tiles[i].bounds.draw(gfx);\n                }\n            }\n            gfx.restore();\n        }\n    }\n}\n/**\n * TileMap Tile\n *\n * A light-weight object that occupies a space in a collision map. Generally\n * created by a [[TileMap]].\n *\n * Tiles can draw multiple sprites. Note that the order of drawing is the order\n * of the sprites in the array so the last one will be drawn on top. You can\n * use transparency to create layers this way.\n */\nclass Tile {\n    /**\n     * Return the world position of the top left corner of the tile\n     */\n    get pos() {\n        if (this._posDirty) {\n            this._recalculate();\n            this._posDirty = false;\n        }\n        return this._pos;\n    }\n    /**\n     * Width of the tile in pixels\n     */\n    get width() {\n        return this._width;\n    }\n    /**\n     * Height of the tile in pixels\n     */\n    get height() {\n        return this._height;\n    }\n    /**\n     * Wether this tile should be treated as solid by the tilemap\n     */\n    get solid() {\n        return this._solid;\n    }\n    /**\n     * Wether this tile should be treated as solid by the tilemap\n     */\n    set solid(val) {\n        var _a;\n        (_a = this.map) === null || _a === void 0 ? void 0 : _a.flagCollidersDirty();\n        this._solid = val;\n    }\n    /**\n     * Current list of graphics for this tile\n     */\n    getGraphics() {\n        return this._graphics;\n    }\n    /**\n     * Current list of offsets for this tile's graphics\n     */\n    getGraphicsOffsets() {\n        return this._offsets;\n    }\n    /**\n     * Add another [[Graphic]] to this TileMap tile\n     * @param graphic\n     */\n    addGraphic(graphic, options) {\n        this._graphics.push(graphic);\n        if (options === null || options === void 0 ? void 0 : options.offset) {\n            this._offsets.push(options.offset);\n        }\n        else {\n            this._offsets.push(Vector.Zero);\n        }\n    }\n    /**\n     * Remove an instance of a [[Graphic]] from this tile\n     */\n    removeGraphic(graphic) {\n        const index = this._graphics.indexOf(graphic);\n        if (index > -1) {\n            this._graphics.splice(index, 1);\n            this._offsets.splice(index, 1);\n        }\n    }\n    /**\n     * Clear all graphics from this tile\n     */\n    clearGraphics() {\n        this._graphics.length = 0;\n        this._offsets.length = 0;\n    }\n    /**\n     * Returns the list of colliders\n     */\n    getColliders() {\n        return this._colliders;\n    }\n    /**\n     * Adds a custom collider to the [[Tile]] to use instead of it's bounds\n     *\n     * If no collider is set but [[Tile.solid]] is set, the tile bounds are used as a collider.\n     *\n     * **Note!** the [[Tile.solid]] must be set to true for it to act as a \"fixed\" collider\n     * @param collider\n     */\n    addCollider(collider) {\n        this._colliders.push(collider);\n        this.map.flagCollidersDirty();\n    }\n    /**\n     * Removes a collider from the [[Tile]]\n     * @param collider\n     */\n    removeCollider(collider) {\n        const index = this._colliders.indexOf(collider);\n        if (index > -1) {\n            this._colliders.splice(index, 1);\n        }\n        this.map.flagCollidersDirty();\n    }\n    /**\n     * Clears all colliders from the [[Tile]]\n     */\n    clearColliders() {\n        this._colliders.length = 0;\n        this.map.flagCollidersDirty();\n    }\n    constructor(options) {\n        var _a, _b;\n        this._posDirty = false;\n        this.events = new EventEmitter();\n        this._solid = false;\n        this._graphics = [];\n        this._offsets = [];\n        /**\n         * Current list of colliders for this tile\n         */\n        this._colliders = [];\n        /**\n         * Arbitrary data storage per tile, useful for any game specific data\n         */\n        this.data = new Map();\n        this.x = options.x;\n        this.y = options.y;\n        this.map = options.map;\n        this._width = options.map.tileWidth * this.map.scale.x;\n        this._height = options.map.tileHeight * this.map.scale.y;\n        this.solid = (_a = options.solid) !== null && _a !== void 0 ? _a : this.solid;\n        this._graphics = (_b = options.graphics) !== null && _b !== void 0 ? _b : [];\n        this._recalculate();\n    }\n    flagDirty() {\n        return this._posDirty = true;\n    }\n    _recalculate() {\n        const geometryPos = this.map.pos.add(vec(this.x * this.map.tileWidth, this.y * this.map.tileHeight));\n        this._geometry = new BoundingBox(geometryPos.x, geometryPos.y, geometryPos.x + this.map.tileWidth, geometryPos.y + this.map.tileHeight);\n        this._width = this.map.tileWidth * this.map.scale.x;\n        this._height = this.map.tileHeight * this.map.scale.y;\n        this._pos = this.map.pos.add(vec(this.x * this._width, this.y * this._height));\n        this._bounds = new BoundingBox(this._pos.x, this._pos.y, this._pos.x + this._width, this._pos.y + this._height);\n        if (this.map.rotation) {\n            this._bounds = this._bounds.rotate(this.map.rotation, this.map.pos);\n        }\n        this._posDirty = false;\n    }\n    /**\n     * Tile bounds in world space\n     */\n    get bounds() {\n        if (this._posDirty) {\n            this._recalculate();\n        }\n        return this._bounds;\n    }\n    get defaultGeometry() {\n        return this._geometry;\n    }\n    /**\n     * Tile position in world space\n     */\n    get center() {\n        if (this._posDirty) {\n            this._recalculate();\n        }\n        return new Vector(this._pos.x + this._width / 2, this._pos.y + this._height / 2);\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        if (handler) {\n            this.events.off(eventName, handler);\n        }\n        else {\n            this.events.off(eventName);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Camera.ts\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Container to house convenience strategy methods\n * @internal\n */\nclass StrategyContainer {\n    constructor(camera) {\n        this.camera = camera;\n    }\n    /**\n     * Creates and adds the [[LockCameraToActorStrategy]] on the current camera.\n     * @param actor The actor to lock the camera to\n     */\n    lockToActor(actor) {\n        this.camera.addStrategy(new LockCameraToActorStrategy(actor));\n    }\n    /**\n     * Creates and adds the [[LockCameraToActorAxisStrategy]] on the current camera\n     * @param actor The actor to lock the camera to\n     * @param axis The axis to follow the actor on\n     */\n    lockToActorAxis(actor, axis) {\n        this.camera.addStrategy(new LockCameraToActorAxisStrategy(actor, axis));\n    }\n    /**\n     * Creates and adds the [[ElasticToActorStrategy]] on the current camera\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\n     * correct and bounce around the target\n     * @param actor Target actor to elastically follow\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\n     */\n    elasticToActor(actor, cameraElasticity, cameraFriction) {\n        this.camera.addStrategy(new ElasticToActorStrategy(actor, cameraElasticity, cameraFriction));\n    }\n    /**\n     * Creates and adds the [[RadiusAroundActorStrategy]] on the current camera\n     * @param actor Target actor to follow when it is \"radius\" pixels away\n     * @param radius Number of pixels away before the camera will follow\n     */\n    radiusAroundActor(actor, radius) {\n        this.camera.addStrategy(new RadiusAroundActorStrategy(actor, radius));\n    }\n    /**\n     * Creates and adds the [[LimitCameraBoundsStrategy]] on the current camera\n     * @param box The bounding box to limit the camera to.\n     */\n    limitCameraBounds(box) {\n        this.camera.addStrategy(new LimitCameraBoundsStrategy(box));\n    }\n}\n/**\n * Camera axis enum\n */\nvar Axis;\n(function (Axis) {\n    Axis[Axis[\"X\"] = 0] = \"X\";\n    Axis[Axis[\"Y\"] = 1] = \"Y\";\n})(Axis || (Axis = {}));\n/**\n * Lock a camera to the exact x/y position of an actor.\n */\nclass LockCameraToActorStrategy {\n    constructor(target) {\n        this.target = target;\n        this.action = (target, camera, engine, delta) => {\n            const center = target.center;\n            return center;\n        };\n    }\n}\n/**\n * Lock a camera to a specific axis around an actor.\n */\nclass LockCameraToActorAxisStrategy {\n    constructor(target, axis) {\n        this.target = target;\n        this.axis = axis;\n        this.action = (target, cam, _eng, _delta) => {\n            const center = target.center;\n            const currentFocus = cam.getFocus();\n            if (this.axis === Axis.X) {\n                return new Vector(center.x, currentFocus.y);\n            }\n            else {\n                return new Vector(currentFocus.x, center.y);\n            }\n        };\n    }\n}\n/**\n * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.\n */\nclass ElasticToActorStrategy {\n    /**\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\n     * correct and bounce around the target\n     * @param target Target actor to elastically follow\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\n     */\n    constructor(target, cameraElasticity, cameraFriction) {\n        this.target = target;\n        this.cameraElasticity = cameraElasticity;\n        this.cameraFriction = cameraFriction;\n        this.action = (target, cam, _eng, _delta) => {\n            const position = target.center;\n            let focus = cam.getFocus();\n            let cameraVel = cam.vel.clone();\n            // Calculate the stretch vector, using the spring equation\n            // F = kX\n            // https://en.wikipedia.org/wiki/Hooke's_law\n            // Apply to the current camera velocity\n            const stretch = position.sub(focus).scale(this.cameraElasticity); // stretch is X\n            cameraVel = cameraVel.add(stretch);\n            // Calculate the friction (-1 to apply a force in the opposition of motion)\n            // Apply to the current camera velocity\n            const friction = cameraVel.scale(-1).scale(this.cameraFriction);\n            cameraVel = cameraVel.add(friction);\n            // Update position by velocity deltas\n            focus = focus.add(cameraVel);\n            return focus;\n        };\n    }\n}\nclass RadiusAroundActorStrategy {\n    /**\n     *\n     * @param target Target actor to follow when it is \"radius\" pixels away\n     * @param radius Number of pixels away before the camera will follow\n     */\n    constructor(target, radius) {\n        this.target = target;\n        this.radius = radius;\n        this.action = (target, cam, _eng, _delta) => {\n            const position = target.center;\n            const focus = cam.getFocus();\n            const direction = position.sub(focus);\n            const distance = direction.size;\n            if (distance >= this.radius) {\n                const offset = distance - this.radius;\n                return focus.add(direction.normalize().scale(offset));\n            }\n            return focus;\n        };\n    }\n}\n/**\n * Prevent a camera from going beyond the given camera dimensions.\n */\nclass LimitCameraBoundsStrategy {\n    constructor(target) {\n        this.target = target;\n        /**\n         * Useful for limiting the camera to a [[TileMap]]'s dimensions, or a specific area inside the map.\n         *\n         * Note that this strategy does not perform any movement by itself.\n         * It only sets the camera position to within the given bounds when the camera has gone beyond them.\n         * Thus, it is a good idea to combine it with other camera strategies and set this strategy as the last one.\n         *\n         * Make sure that the camera bounds are at least as large as the viewport size.\n         * @param target The bounding box to limit the camera to\n         */\n        this.boundSizeChecked = false; // Check and warn only once\n        this.action = (target, cam, _eng, _delta) => {\n            const focus = cam.getFocus();\n            if (!this.boundSizeChecked) {\n                if (target.bottom - target.top < _eng.drawHeight || target.right - target.left < _eng.drawWidth) {\n                    Logger.getInstance().warn('Camera bounds should not be smaller than the engine viewport');\n                }\n                this.boundSizeChecked = true;\n            }\n            let focusX = focus.x;\n            let focusY = focus.y;\n            if (focus.x < target.left + _eng.halfDrawWidth) {\n                focusX = target.left + _eng.halfDrawWidth;\n            }\n            else if (focus.x > target.right - _eng.halfDrawWidth) {\n                focusX = target.right - _eng.halfDrawWidth;\n            }\n            if (focus.y < target.top + _eng.halfDrawHeight) {\n                focusY = target.top + _eng.halfDrawHeight;\n            }\n            else if (focus.y > target.bottom - _eng.halfDrawHeight) {\n                focusY = target.bottom - _eng.halfDrawHeight;\n            }\n            return vec(focusX, focusY);\n        };\n    }\n}\nconst CameraEvents = {\n    Initialize: 'initialize',\n    PreUpdate: 'preupdate',\n    PostUpdate: 'postupdate'\n};\n/**\n * Cameras\n *\n * [[Camera]] is the base class for all Excalibur cameras. Cameras are used\n * to move around your game and set focus. They are used to determine\n * what is \"off screen\" and can be used to scale the game.\n *\n */\nclass Camera {\n    constructor() {\n        this.events = new EventEmitter();\n        this.transform = AffineMatrix.identity();\n        this.inverse = AffineMatrix.identity();\n        this._cameraStrategies = [];\n        this.strategy = new StrategyContainer(this);\n        /**\n         * Get or set current zoom of the camera, defaults to 1\n         */\n        this._z = 1;\n        /**\n         * Get or set rate of change in zoom, defaults to 0\n         */\n        this.dz = 0;\n        /**\n         * Get or set zoom acceleration\n         */\n        this.az = 0;\n        /**\n         * Current rotation of the camera\n         */\n        this.rotation = 0;\n        this._angularVelocity = 0;\n        /**\n         * Get or set the camera's position\n         */\n        this._posChanged = false;\n        this._pos = watchAny(Vector.Zero, () => (this._posChanged = true));\n        /**\n         * Interpolated camera position if more draws are running than updates\n         *\n         * Enabled when `Engine.fixedUpdateFps` is enabled, in all other cases this will be the same as pos\n         */\n        this.drawPos = this.pos.clone();\n        this._oldPos = this.pos.clone();\n        /**\n         * Get or set the camera's velocity\n         */\n        this.vel = Vector.Zero;\n        /**\n         * Get or set the camera's acceleration\n         */\n        this.acc = Vector.Zero;\n        this._cameraMoving = false;\n        this._currentLerpTime = 0;\n        this._lerpDuration = 1000; // 1 second\n        this._lerpStart = null;\n        this._lerpEnd = null;\n        //camera effects\n        this._isShaking = false;\n        this._shakeMagnitudeX = 0;\n        this._shakeMagnitudeY = 0;\n        this._shakeDuration = 0;\n        this._elapsedShakeTime = 0;\n        this._xShake = 0;\n        this._yShake = 0;\n        this._isZooming = false;\n        this._zoomStart = 1;\n        this._zoomEnd = 1;\n        this._currentZoomTime = 0;\n        this._zoomDuration = 0;\n        this._zoomEasing = EasingFunctions.EaseInOutCubic;\n        this._easing = EasingFunctions.EaseInOutCubic;\n        this._halfWidth = 0;\n        this._halfHeight = 0;\n        this._viewport = null;\n        this._isInitialized = false;\n        this._snapPos = vec(0, 0);\n    }\n    get zoom() {\n        return this._z;\n    }\n    set zoom(val) {\n        this._z = val;\n        if (this._engine) {\n            this._halfWidth = this._engine.halfDrawWidth;\n            this._halfHeight = this._engine.halfDrawHeight;\n        }\n    }\n    /**\n     * Get or set the camera's angular velocity\n     */\n    get angularVelocity() {\n        return this._angularVelocity;\n    }\n    set angularVelocity(value) {\n        this._angularVelocity = value;\n    }\n    get pos() {\n        return this._pos;\n    }\n    set pos(vec) {\n        this._pos = watchAny(vec, () => (this._posChanged = true));\n        this._posChanged = true;\n    }\n    /**\n     * Get the camera's x position\n     */\n    get x() {\n        return this.pos.x;\n    }\n    /**\n     * Set the camera's x position (cannot be set when following an [[Actor]] or when moving)\n     */\n    set x(value) {\n        if (!this._follow && !this._cameraMoving) {\n            this.pos = vec(value, this.pos.y);\n        }\n    }\n    /**\n     * Get the camera's y position\n     */\n    get y() {\n        return this.pos.y;\n    }\n    /**\n     * Set the camera's y position (cannot be set when following an [[Actor]] or when moving)\n     */\n    set y(value) {\n        if (!this._follow && !this._cameraMoving) {\n            this.pos = vec(this.pos.x, value);\n        }\n    }\n    /**\n     * Get or set the camera's x velocity\n     */\n    get dx() {\n        return this.vel.x;\n    }\n    set dx(value) {\n        this.vel = vec(value, this.vel.y);\n    }\n    /**\n     * Get or set the camera's y velocity\n     */\n    get dy() {\n        return this.vel.y;\n    }\n    set dy(value) {\n        this.vel = vec(this.vel.x, value);\n    }\n    /**\n     * Get or set the camera's x acceleration\n     */\n    get ax() {\n        return this.acc.x;\n    }\n    set ax(value) {\n        this.acc = vec(value, this.acc.y);\n    }\n    /**\n     * Get or set the camera's y acceleration\n     */\n    get ay() {\n        return this.acc.y;\n    }\n    set ay(value) {\n        this.acc = vec(this.acc.x, value);\n    }\n    /**\n     * Returns the focal point of the camera, a new point giving the x and y position of the camera\n     */\n    getFocus() {\n        return this.pos;\n    }\n    /**\n     * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.\n     * @param pos The target position to move to\n     * @param duration The duration in milliseconds the move should last\n     * @param [easingFn] An optional easing function ([[ex.EasingFunctions.EaseInOutCubic]] by default)\n     * @returns A [[Promise]] that resolves when movement is finished, including if it's interrupted.\n     *          The [[Promise]] value is the [[Vector]] of the target position. It will be rejected if a move cannot be made.\n     */\n    move(pos, duration, easingFn = EasingFunctions.EaseInOutCubic) {\n        if (typeof easingFn !== 'function') {\n            throw 'Please specify an EasingFunction';\n        }\n        // cannot move when following an actor\n        if (this._follow) {\n            return Promise.reject(pos);\n        }\n        // resolve existing promise, if any\n        if (this._lerpPromise && this._lerpResolve) {\n            this._lerpResolve(pos);\n        }\n        this._lerpPromise = new Promise((resolve) => {\n            this._lerpResolve = resolve;\n        });\n        this._lerpStart = this.getFocus().clone();\n        this._lerpDuration = duration;\n        this._lerpEnd = pos;\n        this._currentLerpTime = 0;\n        this._cameraMoving = true;\n        this._easing = easingFn;\n        return this._lerpPromise;\n    }\n    /**\n     * Sets the camera to shake at the specified magnitudes for the specified duration\n     * @param magnitudeX  The x magnitude of the shake\n     * @param magnitudeY  The y magnitude of the shake\n     * @param duration    The duration of the shake in milliseconds\n     */\n    shake(magnitudeX, magnitudeY, duration) {\n        this._isShaking = true;\n        this._shakeMagnitudeX = magnitudeX;\n        this._shakeMagnitudeY = magnitudeY;\n        this._shakeDuration = duration;\n    }\n    /**\n     * Zooms the camera in or out by the specified scale over the specified duration.\n     * If no duration is specified, it take effect immediately.\n     * @param scale    The scale of the zoom\n     * @param duration The duration of the zoom in milliseconds\n     */\n    zoomOverTime(scale, duration = 0, easingFn = EasingFunctions.EaseInOutCubic) {\n        this._zoomPromise = new Promise((resolve) => {\n            this._zoomResolve = resolve;\n        });\n        if (duration) {\n            this._isZooming = true;\n            this._zoomEasing = easingFn;\n            this._currentZoomTime = 0;\n            this._zoomDuration = duration;\n            this._zoomStart = this.zoom;\n            this._zoomEnd = scale;\n        }\n        else {\n            this._isZooming = false;\n            this.zoom = scale;\n            return Promise.resolve(true);\n        }\n        return this._zoomPromise;\n    }\n    /**\n     * Gets the bounding box of the viewport of this camera in world coordinates\n     */\n    get viewport() {\n        if (this._viewport) {\n            return this._viewport;\n        }\n        return new BoundingBox(0, 0, 0, 0);\n    }\n    /**\n     * Adds a new camera strategy to this camera\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\n     */\n    addStrategy(cameraStrategy) {\n        this._cameraStrategies.push(cameraStrategy);\n    }\n    /**\n     * Removes a camera strategy by reference\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\n     */\n    removeStrategy(cameraStrategy) {\n        removeItemFromArray(cameraStrategy, this._cameraStrategies);\n    }\n    /**\n     * Clears all camera strategies from the camera\n     */\n    clearAllStrategies() {\n        this._cameraStrategies.length = 0;\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n     * @internal\n     */\n    _preupdate(engine, delta) {\n        this.events.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n        this.onPreUpdate(engine, delta);\n    }\n    /**\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPreUpdate` is called directly before a scene is updated.\n     */\n    onPreUpdate(engine, delta) {\n        // Overridable\n    }\n    /**\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n     * @internal\n     */\n    _postupdate(engine, delta) {\n        this.events.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n        this.onPostUpdate(engine, delta);\n    }\n    /**\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPostUpdate` is called directly after a scene is updated.\n     */\n    onPostUpdate(engine, delta) {\n        // Overridable\n    }\n    get isInitialized() {\n        return this._isInitialized;\n    }\n    _initialize(engine) {\n        if (!this.isInitialized) {\n            this._engine = engine;\n            this._screen = engine.screen;\n            const currentRes = this._screen.contentArea;\n            let center = vec(currentRes.width / 2, currentRes.height / 2);\n            if (!this._engine.loadingComplete) {\n                // If there was a loading screen, we peek the configured resolution\n                const res = this._screen.peekResolution();\n                if (res) {\n                    center = vec(res.width / 2, res.height / 2);\n                }\n            }\n            this._halfWidth = center.x;\n            this._halfHeight = center.y;\n            // If the user has not set the camera pos, apply default center screen position\n            if (!this._posChanged) {\n                this.pos = center;\n            }\n            this.pos.clone(this.drawPos);\n            // First frame bootstrap\n            // Ensure camera tx is correct\n            // Run update twice to ensure properties are init'd\n            this.updateTransform(this.pos);\n            // Run strategies for first frame\n            this.runStrategies(engine, engine.clock.elapsed());\n            // Setup the first frame viewport\n            this.updateViewport();\n            // It's important to update the camera after strategies\n            // This prevents jitter\n            this.updateTransform(this.pos);\n            this.pos.clone(this._oldPos);\n            this.onInitialize(engine);\n            this.events.emit('initialize', new InitializeEvent(engine, this));\n            this._isInitialized = true;\n        }\n    }\n    /**\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPostUpdate` is called directly after a scene is updated.\n     */\n    onInitialize(engine) {\n        // Overridable\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n    runStrategies(engine, delta) {\n        for (const s of this._cameraStrategies) {\n            this.pos = s.action.call(s, s.target, this, engine, delta);\n        }\n    }\n    updateViewport() {\n        // recalculate viewport\n        this._viewport = new BoundingBox(this.x - this._halfWidth, this.y - this._halfHeight, this.x + this._halfWidth, this.y + this._halfHeight);\n    }\n    update(engine, delta) {\n        this._initialize(engine);\n        this._preupdate(engine, delta);\n        this.pos.clone(this._oldPos);\n        // Update placements based on linear algebra\n        this.pos = this.pos.add(this.vel.scale(delta / 1000));\n        this.zoom += (this.dz * delta) / 1000;\n        this.vel = this.vel.add(this.acc.scale(delta / 1000));\n        this.dz += (this.az * delta) / 1000;\n        this.rotation += (this.angularVelocity * delta) / 1000;\n        if (this._isZooming) {\n            if (this._currentZoomTime < this._zoomDuration) {\n                const zoomEasing = this._zoomEasing;\n                const newZoom = zoomEasing(this._currentZoomTime, this._zoomStart, this._zoomEnd, this._zoomDuration);\n                this.zoom = newZoom;\n                this._currentZoomTime += delta;\n            }\n            else {\n                this._isZooming = false;\n                this.zoom = this._zoomEnd;\n                this._currentZoomTime = 0;\n                this._zoomResolve(true);\n            }\n        }\n        if (this._cameraMoving) {\n            if (this._currentLerpTime < this._lerpDuration) {\n                const moveEasing = EasingFunctions.CreateVectorEasingFunction(this._easing);\n                const lerpPoint = moveEasing(this._currentLerpTime, this._lerpStart, this._lerpEnd, this._lerpDuration);\n                this.pos = lerpPoint;\n                this._currentLerpTime += delta;\n            }\n            else {\n                this.pos = this._lerpEnd;\n                const end = this._lerpEnd.clone();\n                this._lerpStart = null;\n                this._lerpEnd = null;\n                this._currentLerpTime = 0;\n                this._cameraMoving = false;\n                // Order matters here, resolve should be last so any chain promises have a clean slate\n                this._lerpResolve(end);\n            }\n        }\n        if (this._isDoneShaking()) {\n            this._isShaking = false;\n            this._elapsedShakeTime = 0;\n            this._shakeMagnitudeX = 0;\n            this._shakeMagnitudeY = 0;\n            this._shakeDuration = 0;\n            this._xShake = 0;\n            this._yShake = 0;\n        }\n        else {\n            this._elapsedShakeTime += delta;\n            this._xShake = ((Math.random() * this._shakeMagnitudeX) | 0) + 1;\n            this._yShake = ((Math.random() * this._shakeMagnitudeY) | 0) + 1;\n        }\n        this.runStrategies(engine, delta);\n        this.updateViewport();\n        // It's important to update the camera after strategies\n        // This prevents jitter\n        this.updateTransform(this.pos);\n        this._postupdate(engine, delta);\n    }\n    /**\n     * Applies the relevant transformations to the game canvas to \"move\" or apply effects to the Camera\n     * @param ctx Canvas context to apply transformations\n     */\n    draw(ctx) {\n        // default to the current position\n        this.pos.clone(this.drawPos);\n        // interpolation if fixed update is on\n        // must happen on the draw, because more draws are potentially happening than updates\n        if (this._engine.fixedUpdateFps) {\n            const blend = this._engine.currentFrameLagMs / (1000 / this._engine.fixedUpdateFps);\n            const interpolatedPos = this.pos.scale(blend).add(this._oldPos.scale(1.0 - blend));\n            interpolatedPos.clone(this.drawPos);\n            this.updateTransform(interpolatedPos);\n        }\n        // Snap camera to pixel\n        if (ctx.snapToPixel) {\n            const snapPos = this.drawPos.clone(this._snapPos);\n            snapPos.x = ~~(snapPos.x + pixelSnapEpsilon * sign(snapPos.x));\n            snapPos.y = ~~(snapPos.y + pixelSnapEpsilon * sign(snapPos.y));\n            snapPos.clone(this.drawPos);\n            this.updateTransform(snapPos);\n        }\n        ctx.multiply(this.transform);\n    }\n    updateTransform(pos) {\n        // center the camera\n        const newCanvasWidth = this._screen.resolution.width / this.zoom;\n        const newCanvasHeight = this._screen.resolution.height / this.zoom;\n        const cameraPos = vec(-pos.x + newCanvasWidth / 2 + this._xShake, -pos.y + newCanvasHeight / 2 + this._yShake);\n        // Calculate camera transform\n        this.transform.reset();\n        this.transform.scale(this.zoom, this.zoom);\n        // rotate about the focus\n        this.transform.translate(newCanvasWidth / 2, newCanvasHeight / 2);\n        this.transform.rotate(this.rotation);\n        this.transform.translate(-newCanvasWidth / 2, -newCanvasHeight / 2);\n        this.transform.translate(cameraPos.x, cameraPos.y);\n        this.transform.inverse(this.inverse);\n    }\n    _isDoneShaking() {\n        return !this._isShaking || this._elapsedShakeTime >= this._shakeDuration;\n    }\n}\n\n;// CONCATENATED MODULE: ./Trigger.ts\n\n\n\n\n\nconst TriggerEvents = {\n    ExitTrigger: 'exit',\n    EnterTrigger: 'enter'\n};\nconst triggerDefaults = {\n    pos: Vector.Zero,\n    width: 10,\n    height: 10,\n    visible: false,\n    action: () => {\n        return;\n    },\n    filter: () => true,\n    repeat: -1\n};\n/**\n * Triggers are a method of firing arbitrary code on collision. These are useful\n * as 'buttons', 'switches', or to trigger effects in a game. By default triggers\n * are invisible, and can only be seen when [[Trigger.visible]] is set to `true`.\n */\nclass Trigger extends Actor {\n    /**\n     *\n     * @param opts Trigger options\n     */\n    constructor(opts) {\n        super({ x: opts.pos.x, y: opts.pos.y, width: opts.width, height: opts.height });\n        this.events = new EventEmitter();\n        /**\n         * Action to fire when triggered by collision\n         */\n        this.action = () => {\n            return;\n        };\n        /**\n         * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when\n         * filter return true for the collided actor.\n         */\n        this.filter = () => true;\n        /**\n         * Number of times to repeat before killing the trigger,\n         */\n        this.repeat = -1;\n        opts = {\n            ...triggerDefaults,\n            ...opts\n        };\n        this.filter = opts.filter || this.filter;\n        this.repeat = opts.repeat || this.repeat;\n        this.action = opts.action || this.action;\n        if (opts.target) {\n            this.target = opts.target;\n        }\n        this.graphics.visible = opts.visible;\n        this.body.collisionType = CollisionType.Passive;\n        this.events.on('collisionstart', (evt) => {\n            if (this.filter(evt.other)) {\n                this.events.emit('enter', new EnterTriggerEvent(this, evt.other));\n                this._dispatchAction();\n                // remove trigger if its done, -1 repeat forever\n                if (this.repeat === 0) {\n                    this.kill();\n                }\n            }\n        });\n        this.events.on('collisionend', (evt) => {\n            if (this.filter(evt.other)) {\n                this.events.emit('exit', new ExitTriggerEvent(this, evt.other));\n            }\n        });\n    }\n    set target(target) {\n        this._target = target;\n        this.filter = (actor) => actor === target;\n    }\n    get target() {\n        return this._target;\n    }\n    _initialize(engine) {\n        super._initialize(engine);\n    }\n    _dispatchAction() {\n        if (this.repeat !== 0) {\n            this.action.call(this);\n            this.repeat--;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Priority.ts\n/**\n * Higher priorities run earlier than others in the system update\n */\nconst SystemPriority = {\n    Highest: -Infinity,\n    Higher: -5,\n    Average: 0,\n    Lower: 5,\n    Lowest: Infinity\n};\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/System.ts\n\n/**\n * Enum that determines whether to run the system in the update or draw phase\n */\nvar SystemType;\n(function (SystemType) {\n    SystemType[\"Update\"] = \"update\";\n    SystemType[\"Draw\"] = \"draw\";\n})(SystemType || (SystemType = {}));\n/**\n * An Excalibur [[System]] that updates entities of certain types.\n * Systems are scene specific\n *\n *\n *\n * Excalibur Systems currently require at least 1 Component type to operated\n *\n * Multiple types are declared as a type union\n * For example:\n *\n * ```typescript\n * class MySystem extends System<ComponentA | ComponentB> {\n *   public readonly types = ['a', 'b'] as const;\n *   public readonly systemType = SystemType.Update;\n *   public update(entities: Entity<ComponentA | ComponentB>) {\n *      ...\n *   }\n * }\n * ```\n */\nclass System {\n    constructor() {\n        /**\n         * System can execute in priority order, by default all systems are priority 0. Lower values indicated higher priority.\n         * For a system to execute before all other a lower priority value (-1 for example) must be set.\n         * For a system to execute after all other a higher priority value (10 for example) must be set.\n         */\n        this.priority = SystemPriority.Average;\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/EntityManager.ts\n\n\n// Add/Remove entities and components\nclass EntityManager {\n    constructor(_world) {\n        this._world = _world;\n        this.entities = [];\n        this._entityIndex = {};\n        this._entitiesToRemove = [];\n    }\n    /**\n     * Runs the entity lifecycle\n     * @param scene\n     * @param elapsed\n     */\n    updateEntities(scene, elapsed) {\n        for (const entity of this.entities) {\n            entity.update(scene.engine, elapsed);\n            if (!entity.active) {\n                this.removeEntity(entity);\n            }\n        }\n    }\n    findEntitiesForRemoval() {\n        for (const entity of this.entities) {\n            if (!entity.active) {\n                this.removeEntity(entity);\n            }\n        }\n    }\n    /**\n     * Adds an entity to be tracked by the EntityManager\n     * @param entity\n     */\n    addEntity(entity) {\n        entity.active = true;\n        entity.scene = this._world.scene;\n        if (entity && !this._entityIndex[entity.id]) {\n            this._entityIndex[entity.id] = entity;\n            this.entities.push(entity);\n            this._world.queryManager.addEntity(entity);\n            // if entity has children\n            entity.children.forEach((c) => {\n                c.scene = entity.scene;\n                this.addEntity(c);\n            });\n            entity.childrenAdded$.register({\n                notify: (e) => {\n                    this.addEntity(e);\n                }\n            });\n            entity.childrenRemoved$.register({\n                notify: (e) => {\n                    this.removeEntity(e, false);\n                }\n            });\n        }\n    }\n    removeEntity(idOrEntity, deferred = true) {\n        var _a, _b;\n        let id = 0;\n        if (idOrEntity instanceof Entity) {\n            id = idOrEntity.id;\n        }\n        else {\n            id = idOrEntity;\n        }\n        const entity = this._entityIndex[id];\n        if (entity && entity.active) {\n            entity.active = false;\n        }\n        if (entity && deferred) {\n            this._entitiesToRemove.push(entity);\n            return;\n        }\n        delete this._entityIndex[id];\n        if (entity) {\n            entity.scene = null;\n            removeItemFromArray(entity, this.entities);\n            this._world.queryManager.removeEntity(entity);\n            // if entity has children\n            entity.children.forEach((c) => {\n                c.scene = null;\n                this.removeEntity(c, deferred);\n            });\n            entity.childrenAdded$.clear();\n            entity.childrenRemoved$.clear();\n            // stats\n            if ((_b = (_a = this._world) === null || _a === void 0 ? void 0 : _a.scene) === null || _b === void 0 ? void 0 : _b.engine) {\n                this._world.scene.engine.stats.currFrame.actors.killed++;\n            }\n        }\n    }\n    processEntityRemovals() {\n        for (const entity of this._entitiesToRemove) {\n            if (entity.active) {\n                continue;\n            }\n            this.removeEntity(entity, false);\n        }\n        this._entitiesToRemove.length = 0;\n    }\n    processComponentRemovals() {\n        for (const entity of this.entities) {\n            entity.processComponentRemoval();\n        }\n    }\n    getById(id) {\n        return this._entityIndex[id];\n    }\n    getByName(name) {\n        return this.entities.filter(e => e.name === name);\n    }\n    clear() {\n        for (let i = this.entities.length - 1; i >= 0; i--) {\n            this.removeEntity(this.entities[i]);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Query.ts\n\n/**\n * Represents query for entities that match a list of types that is cached and observable\n *\n * Queries can be strongly typed by supplying a type union in the optional type parameter\n * ```typescript\n * const queryAB = new ex.Query<ComponentTypeA | ComponentTypeB>(['A', 'B']);\n * ```\n */\nclass Query {\n    constructor(requiredComponents) {\n        this.requiredComponents = requiredComponents;\n        this.components = new Set();\n        this.entities = [];\n        /**\n         * This fires right after the component is added\n         */\n        this.entityAdded$ = new Observable();\n        /**\n         * This fires right before the component is actually removed from the entity, it will still be available for cleanup purposes\n         */\n        this.entityRemoved$ = new Observable();\n        if (requiredComponents.length === 0) {\n            throw new Error('Cannot create query without components');\n        }\n        for (const type of requiredComponents) {\n            this.components.add(type);\n        }\n        this.id = Query.createId(requiredComponents);\n    }\n    static createId(requiredComponents) {\n        // TODO what happens if a user defines the same type name as a built in type\n        // ! TODO this could be dangerous depending on the bundler's settings for names\n        // Maybe some kind of hash function is better here?\n        return requiredComponents.slice().map(c => c.name).sort().join('-');\n    }\n    /**\n     * Potentially adds an entity to a query index, returns true if added, false if not\n     * @param entity\n     */\n    checkAndAdd(entity) {\n        if (!this.entities.includes(entity) && entity.hasAll(Array.from(this.components))) {\n            this.entities.push(entity);\n            this.entityAdded$.notifyAll(entity);\n            return true;\n        }\n        return false;\n    }\n    removeEntity(entity) {\n        const index = this.entities.indexOf(entity);\n        if (index > -1) {\n            this.entities.splice(index, 1);\n            this.entityRemoved$.notifyAll(entity);\n        }\n    }\n    /**\n     * Returns a list of entities that match the query\n     * @param sort Optional sorting function to sort entities returned from the query\n     */\n    getEntities(sort) {\n        if (sort) {\n            this.entities.sort(sort);\n        }\n        return this.entities;\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/TagQuery.ts\n\nclass TagQuery {\n    constructor(requiredTags) {\n        this.requiredTags = requiredTags;\n        this.tags = new Set();\n        this.entities = [];\n        /**\n         * This fires right after the component is added\n         */\n        this.entityAdded$ = new Observable();\n        /**\n         * This fires right before the component is actually removed from the entity, it will still be available for cleanup purposes\n         */\n        this.entityRemoved$ = new Observable();\n        if (requiredTags.length === 0) {\n            throw new Error('Cannot create tag query without tags');\n        }\n        for (const tag of requiredTags) {\n            this.tags.add(tag);\n        }\n        this.id = TagQuery.createId(requiredTags);\n    }\n    static createId(requiredComponents) {\n        return requiredComponents.slice().sort().join('-');\n    }\n    checkAndAdd(entity) {\n        if (!this.entities.includes(entity) && entity.hasAllTags(Array.from(this.tags))) {\n            this.entities.push(entity);\n            this.entityAdded$.notifyAll(entity);\n            return true;\n        }\n        return false;\n    }\n    removeEntity(entity) {\n        const index = this.entities.indexOf(entity);\n        if (index > -1) {\n            this.entities.splice(index, 1);\n            this.entityRemoved$.notifyAll(entity);\n        }\n    }\n    /**\n     * Returns a list of entities that match the query\n     * @param sort Optional sorting function to sort entities returned from the query\n     */\n    getEntities(sort) {\n        if (sort) {\n            this.entities.sort(sort);\n        }\n        return this.entities;\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/QueryManager.ts\n\n\n/**\n * The query manager is responsible for updating all queries when entities/components change\n */\nclass QueryManager {\n    constructor(_world) {\n        this._world = _world;\n        this._queries = new Map();\n        this._addComponentHandlers = new Map();\n        this._removeComponentHandlers = new Map();\n        this._componentToQueriesIndex = new Map();\n        this._tagQueries = new Map();\n        this._addTagHandlers = new Map();\n        this._removeTagHandlers = new Map();\n        this._tagToQueriesIndex = new Map();\n        this._createAddComponentHandler = (entity) => (c) => {\n            this.addComponent(entity, c);\n        };\n        this._createRemoveComponentHandler = (entity) => (c) => {\n            this.removeComponent(entity, c);\n        };\n        this._createAddTagHandler = (entity) => (tag) => {\n            this.addTag(entity, tag);\n        };\n        this._createRemoveTagHandler = (entity) => (tag) => {\n            this.removeTag(entity, tag);\n        };\n    }\n    createQuery(requiredComponents) {\n        const id = Query.createId(requiredComponents);\n        if (this._queries.has(id)) {\n            // short circuit if query is already created\n            return this._queries.get(id);\n        }\n        const query = new Query(requiredComponents);\n        this._queries.set(query.id, query);\n        // index maintenance\n        for (const component of requiredComponents) {\n            const queries = this._componentToQueriesIndex.get(component);\n            if (!queries) {\n                this._componentToQueriesIndex.set(component, [query]);\n            }\n            else {\n                queries.push(query);\n            }\n        }\n        for (const entity of this._world.entities) {\n            this.addEntity(entity);\n        }\n        return query;\n    }\n    createTagQuery(requiredTags) {\n        const id = TagQuery.createId(requiredTags);\n        if (this._tagQueries.has(id)) {\n            // short circuit if query is already created\n            return this._tagQueries.get(id);\n        }\n        const query = new TagQuery(requiredTags);\n        this._tagQueries.set(query.id, query);\n        // index maintenance\n        for (const tag of requiredTags) {\n            const queries = this._tagToQueriesIndex.get(tag);\n            if (!queries) {\n                this._tagToQueriesIndex.set(tag, [query]);\n            }\n            else {\n                queries.push(query);\n            }\n        }\n        for (const entity of this._world.entities) {\n            this.addEntity(entity);\n        }\n        return query;\n    }\n    /**\n     * Scans queries and locates any that need this entity added\n     * @param entity\n     */\n    addEntity(entity) {\n        const maybeAddComponent = this._addComponentHandlers.get(entity);\n        const maybeRemoveComponent = this._removeComponentHandlers.get(entity);\n        const addComponent = maybeAddComponent !== null && maybeAddComponent !== void 0 ? maybeAddComponent : this._createAddComponentHandler(entity);\n        const removeComponent = maybeRemoveComponent !== null && maybeRemoveComponent !== void 0 ? maybeRemoveComponent : this._createRemoveComponentHandler(entity);\n        this._addComponentHandlers.set(entity, addComponent);\n        this._removeComponentHandlers.set(entity, removeComponent);\n        const maybeAddTag = this._addTagHandlers.get(entity);\n        const maybeRemoveTag = this._removeTagHandlers.get(entity);\n        const addTag = maybeAddTag !== null && maybeAddTag !== void 0 ? maybeAddTag : this._createAddTagHandler(entity);\n        const removeTag = maybeRemoveTag !== null && maybeRemoveTag !== void 0 ? maybeRemoveTag : this._createRemoveTagHandler(entity);\n        this._addTagHandlers.set(entity, addTag);\n        this._removeTagHandlers.set(entity, removeTag);\n        for (const query of this._queries.values()) {\n            query.checkAndAdd(entity);\n        }\n        for (const tagQuery of this._tagQueries.values()) {\n            tagQuery.checkAndAdd(entity);\n        }\n        entity.componentAdded$.subscribe(addComponent);\n        entity.componentRemoved$.subscribe(removeComponent);\n        entity.tagAdded$.subscribe(addTag);\n        entity.tagRemoved$.subscribe(removeTag);\n    }\n    /**\n     * Scans queries and locates any that need this entity removed\n     * @param entity\n     */\n    removeEntity(entity) {\n        // Handle components\n        const addComponent = this._addComponentHandlers.get(entity);\n        const removeComponent = this._removeComponentHandlers.get(entity);\n        for (const query of this._queries.values()) {\n            query.removeEntity(entity);\n        }\n        if (addComponent) {\n            entity.componentAdded$.unsubscribe(addComponent);\n        }\n        if (removeComponent) {\n            entity.componentRemoved$.unsubscribe(removeComponent);\n        }\n        // Handle tags\n        const addTag = this._addTagHandlers.get(entity);\n        const removeTag = this._removeTagHandlers.get(entity);\n        for (const tagQuery of this._tagQueries.values()) {\n            tagQuery.removeEntity(entity);\n        }\n        if (addTag) {\n            entity.tagAdded$.unsubscribe(addTag);\n        }\n        if (removeTag) {\n            entity.tagRemoved$.unsubscribe(removeTag);\n        }\n    }\n    /**\n     * Updates any queries when a component is added to an entity\n     * @param entity\n     * @param component\n     */\n    addComponent(entity, component) {\n        var _a;\n        const queries = (_a = this._componentToQueriesIndex.get(component.constructor)) !== null && _a !== void 0 ? _a : [];\n        for (const query of queries) {\n            query.checkAndAdd(entity);\n        }\n    }\n    /**\n     * Updates any queries when a component is removed from an entity\n     * @param entity\n     * @param component\n     */\n    removeComponent(entity, component) {\n        var _a;\n        const queries = (_a = this._componentToQueriesIndex.get(component.constructor)) !== null && _a !== void 0 ? _a : [];\n        for (const query of queries) {\n            query.removeEntity(entity);\n        }\n    }\n    /**\n     * Updates any queries when a tag is added to an entity\n     * @param entity\n     * @param tag\n     */\n    addTag(entity, tag) {\n        var _a;\n        const queries = (_a = this._tagToQueriesIndex.get(tag)) !== null && _a !== void 0 ? _a : [];\n        for (const query of queries) {\n            query.checkAndAdd(entity);\n        }\n    }\n    /**\n     * Updates any queries when a component is removed from an entity\n     * @param entity\n     * @param tag\n     */\n    removeTag(entity, tag) {\n        var _a;\n        const queries = (_a = this._tagToQueriesIndex.get(tag)) !== null && _a !== void 0 ? _a : [];\n        for (const query of queries) {\n            query.removeEntity(entity);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/SystemManager.ts\n\n\n/**\n *\n */\nfunction isSystemConstructor(x) {\n    var _a, _b;\n    return !!(x === null || x === void 0 ? void 0 : x.prototype) && !!((_b = (_a = x === null || x === void 0 ? void 0 : x.prototype) === null || _a === void 0 ? void 0 : _a.constructor) === null || _b === void 0 ? void 0 : _b.name);\n}\n/**\n * The SystemManager is responsible for keeping track of all systems in a scene.\n * Systems are scene specific\n */\nclass SystemManager {\n    constructor(_world) {\n        this._world = _world;\n        /**\n         * List of systems, to add a new system call [[SystemManager.addSystem]]\n         */\n        this.systems = [];\n        this.initialized = false;\n    }\n    /**\n     * Get a system registered in the manager by type\n     * @param systemType\n     */\n    get(systemType) {\n        return this.systems.find((s) => s instanceof systemType);\n    }\n    /**\n     * Adds a system to the manager, it will now be updated every frame\n     * @param systemOrCtor\n     */\n    addSystem(systemOrCtor) {\n        let system;\n        if (systemOrCtor instanceof System) {\n            system = systemOrCtor;\n        }\n        else {\n            system = new systemOrCtor(this._world);\n        }\n        this.systems.push(system);\n        this.systems.sort((a, b) => a.priority - b.priority);\n        // If systems are added and the manager has already been init'd\n        // then immediately init the system\n        if (this.initialized && system.initialize) {\n            system.initialize(this._world, this._world.scene);\n        }\n    }\n    /**\n     * Removes a system from the manager, it will no longer be updated\n     * @param system\n     */\n    removeSystem(system) {\n        removeItemFromArray(system, this.systems);\n    }\n    /**\n     * Initialize all systems in the manager\n     *\n     * Systems added after initialize() will be initialized on add\n     */\n    initialize() {\n        if (!this.initialized) {\n            this.initialized = true;\n            for (const s of this.systems) {\n                if (s.initialize) {\n                    s.initialize(this._world, this._world.scene);\n                }\n            }\n        }\n    }\n    /**\n     * Updates all systems\n     * @param type whether this is an update or draw system\n     * @param scene context reference\n     * @param delta time in milliseconds\n     */\n    updateSystems(type, scene, delta) {\n        const systems = this.systems.filter((s) => s.systemType === type);\n        for (const s of systems) {\n            if (s.preupdate) {\n                s.preupdate(scene, delta);\n            }\n        }\n        for (const s of systems) {\n            s.update(delta);\n        }\n        for (const s of systems) {\n            if (s.postupdate) {\n                s.postupdate(scene, delta);\n            }\n        }\n    }\n    clear() {\n        for (let i = this.systems.length - 1; i >= 0; i--) {\n            this.removeSystem(this.systems[i]);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/World.ts\n\n\n\n\n\n/**\n * The World is a self-contained entity component system for a particular context.\n */\nclass World {\n    /**\n     * The context type is passed to the system updates\n     * @param scene\n     */\n    constructor(scene) {\n        this.scene = scene;\n        this.queryManager = new QueryManager(this);\n        this.entityManager = new EntityManager(this);\n        this.systemManager = new SystemManager(this);\n    }\n    /**\n     * Query the ECS world for entities that match your components\n     * @param requiredTypes\n     */\n    query(requiredTypes) {\n        return this.queryManager.createQuery(requiredTypes);\n    }\n    queryTags(requiredTags) {\n        return this.queryManager.createTagQuery(requiredTags);\n    }\n    /**\n     * Update systems by type and time elapsed in milliseconds\n     */\n    update(type, delta) {\n        if (type === SystemType.Update) {\n            this.entityManager.updateEntities(this.scene, delta);\n        }\n        this.systemManager.updateSystems(type, this.scene, delta);\n        this.entityManager.findEntitiesForRemoval();\n        this.entityManager.processComponentRemovals();\n        this.entityManager.processEntityRemovals();\n    }\n    add(entityOrSystem) {\n        if (entityOrSystem instanceof Entity) {\n            this.entityManager.addEntity(entityOrSystem);\n        }\n        if (entityOrSystem instanceof System || isSystemConstructor(entityOrSystem)) {\n            this.systemManager.addSystem(entityOrSystem);\n        }\n    }\n    /**\n     * Get a system out of the ECS world\n     */\n    get(system) {\n        return this.systemManager.get(system);\n    }\n    remove(entityOrSystem, deferred = true) {\n        if (entityOrSystem instanceof Entity) {\n            this.entityManager.removeEntity(entityOrSystem, deferred);\n        }\n        if (entityOrSystem instanceof System) {\n            this.systemManager.removeSystem(entityOrSystem);\n        }\n    }\n    get entities() {\n        return this.entityManager.entities;\n    }\n    clearEntities() {\n        this.entityManager.clear();\n    }\n    clearSystems() {\n        this.systemManager.clear();\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Integrator.ts\n\nclass EulerIntegrator {\n    static integrate(transform, motion, totalAcc, elapsedMs) {\n        const seconds = elapsedMs / 1000;\n        // This code looks a little wild, but it's to avoid creating any new Vector instances\n        // integration is done in a tight loop so this is key to avoid GC'ing\n        motion.vel.addEqual(totalAcc.scale(seconds, EulerIntegrator._ACC));\n        transform.pos\n            .add(motion.vel.scale(seconds, EulerIntegrator._VEL), EulerIntegrator._POS)\n            .addEqual(totalAcc.scale(0.5 * seconds * seconds, EulerIntegrator._VEL_ACC));\n        motion.angularVelocity += motion.torque * (1.0 / motion.inertia) * seconds;\n        const rotation = transform.rotation + motion.angularVelocity * seconds;\n        transform.scale.add(motion.scaleFactor.scale(seconds, this._SCALE_FACTOR), EulerIntegrator._SCALE);\n        const tx = transform.get();\n        tx.setTransform(EulerIntegrator._POS, rotation, EulerIntegrator._SCALE);\n    }\n}\n// Scratch vectors to avoid allocation\nEulerIntegrator._POS = new Vector(0, 0);\nEulerIntegrator._SCALE = new Vector(1, 1);\nEulerIntegrator._ACC = new Vector(0, 0);\nEulerIntegrator._VEL = new Vector(0, 0);\nEulerIntegrator._VEL_ACC = new Vector(0, 0);\nEulerIntegrator._SCALE_FACTOR = new Vector(0, 0);\n\n;// CONCATENATED MODULE: ./Collision/MotionSystem.ts\n\n\n\n\n\n\n\nclass MotionSystem extends System {\n    constructor(world, physics) {\n        super();\n        this.world = world;\n        this.physics = physics;\n        this.systemType = SystemType.Update;\n        this.priority = SystemPriority.Higher;\n        this._physicsConfigDirty = false;\n        physics.$configUpdate.subscribe(() => this._physicsConfigDirty = true);\n        this.query = this.world.query([TransformComponent, MotionComponent]);\n    }\n    update(elapsedMs) {\n        let transform;\n        let motion;\n        const entities = this.query.entities;\n        for (let i = 0; i < entities.length; i++) {\n            transform = entities[i].get(TransformComponent);\n            motion = entities[i].get(MotionComponent);\n            const optionalBody = entities[i].get(BodyComponent);\n            if (this._physicsConfigDirty && optionalBody) {\n                optionalBody.updatePhysicsConfig(this.physics.config.bodies);\n            }\n            if (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.sleeping) {\n                continue;\n            }\n            const totalAcc = motion.acc.clone();\n            if ((optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.collisionType) === CollisionType.Active && (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.useGravity)) {\n                totalAcc.addEqual(this.physics.config.gravity);\n            }\n            optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.captureOldTransform();\n            // Update transform and motion based on Euler linear algebra\n            EulerIntegrator.integrate(transform, motion, totalAcc, elapsedMs);\n        }\n        this._physicsConfigDirty = false;\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Solver/ArcadeSolver.ts\n\n\n\n\n\n/**\n * ArcadeSolver is the default in Excalibur. It solves collisions so that there is no overlap between contacts,\n * and negates velocity along the collision normal.\n *\n * This is usually the type of collisions used for 2D games that don't need a more realistic collision simulation.\n *\n */\nclass ArcadeSolver {\n    constructor(config) {\n        this.config = config;\n        this.directionMap = new Map();\n        this.distanceMap = new Map();\n    }\n    solve(contacts) {\n        // Events and init\n        this.preSolve(contacts);\n        // Remove any canceled contacts\n        contacts = contacts.filter(c => !c.isCanceled());\n        // Locate collision bias order\n        let bias;\n        switch (this.config.contactSolveBias) {\n            case ContactSolveBias.HorizontalFirst: {\n                bias = HorizontalFirst;\n                break;\n            }\n            case ContactSolveBias.VerticalFirst: {\n                bias = VerticalFirst;\n                break;\n            }\n            default: {\n                bias = None;\n            }\n        }\n        // Sort by bias (None, VerticalFirst, HorizontalFirst) to avoid artifacts with seams\n        // Sort contacts by distance to avoid artifacts with seams\n        // It's important to solve in a specific order\n        contacts.sort((a, b) => {\n            const aDir = this.directionMap.get(a.id);\n            const bDir = this.directionMap.get(b.id);\n            const aDist = this.distanceMap.get(a.id);\n            const bDist = this.distanceMap.get(b.id);\n            return (bias[aDir] - bias[bDir]) || (aDist - bDist);\n        });\n        for (const contact of contacts) {\n            // Solve position first in arcade\n            this.solvePosition(contact);\n            // Solve velocity second in arcade\n            this.solveVelocity(contact);\n        }\n        // Events and any contact house-keeping the solver needs\n        this.postSolve(contacts);\n        return contacts;\n    }\n    preSolve(contacts) {\n        const epsilon = .0001;\n        for (const contact of contacts) {\n            if (Math.abs(contact.mtv.x) < epsilon && Math.abs(contact.mtv.y) < epsilon) {\n                // Cancel near 0 mtv collisions\n                contact.cancel();\n                continue;\n            }\n            const side = Side.fromDirection(contact.mtv);\n            const mtv = contact.mtv.negate();\n            const distance = contact.colliderA.worldPos.squareDistance(contact.colliderB.worldPos);\n            this.distanceMap.set(contact.id, distance);\n            this.directionMap.set(contact.id, side === Side.Left || side === Side.Right ? 'horizontal' : 'vertical');\n            // Publish collision events on both participants\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, mtv, contact));\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate(), contact));\n        }\n    }\n    postSolve(contacts) {\n        var _a, _b;\n        for (const contact of contacts) {\n            if (contact.isCanceled()) {\n                continue;\n            }\n            const colliderA = contact.colliderA;\n            const colliderB = contact.colliderB;\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n            if (bodyA && bodyB) {\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n                    continue;\n                }\n            }\n            const side = Side.fromDirection(contact.mtv);\n            const mtv = contact.mtv.negate();\n            // Publish collision events on both participants\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, mtv, contact));\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate(), contact));\n        }\n    }\n    solvePosition(contact) {\n        var _a, _b;\n        const epsilon = .0001;\n        // if bounds no longer intersect skip to the next\n        // this removes jitter from overlapping/stacked solid tiles or a wall of solid tiles\n        if (!contact.colliderA.bounds.overlaps(contact.colliderB.bounds, epsilon)) {\n            // Cancel the contact to prevent and solving\n            contact.cancel();\n            return;\n        }\n        if (Math.abs(contact.mtv.x) < epsilon && Math.abs(contact.mtv.y) < epsilon) {\n            // Cancel near 0 mtv collisions\n            contact.cancel();\n            return;\n        }\n        let mtv = contact.mtv;\n        const colliderA = contact.colliderA;\n        const colliderB = contact.colliderB;\n        const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n        const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n        if (bodyA && bodyB) {\n            if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n                return;\n            }\n            if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType === CollisionType.Active) {\n                // split overlaps if both are Active\n                mtv = mtv.scale(0.5);\n            }\n            // Resolve overlaps\n            if (bodyA.collisionType === CollisionType.Active) {\n                bodyA.globalPos.x -= mtv.x;\n                bodyA.globalPos.y -= mtv.y;\n                colliderA.update(bodyA.transform.get());\n            }\n            if (bodyB.collisionType === CollisionType.Active) {\n                bodyB.globalPos.x += mtv.x;\n                bodyB.globalPos.y += mtv.y;\n                colliderB.update(bodyB.transform.get());\n            }\n        }\n    }\n    solveVelocity(contact) {\n        var _a, _b;\n        if (contact.isCanceled()) {\n            return;\n        }\n        const colliderA = contact.colliderA;\n        const colliderB = contact.colliderB;\n        const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n        const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n        if (bodyA && bodyB) {\n            if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n                return;\n            }\n            const normal = contact.normal;\n            const opposite = normal.negate();\n            if (bodyA.collisionType === CollisionType.Active) {\n                // only adjust velocity if the contact normal is opposite to the current velocity\n                // this avoids catching edges on a platform when sliding off\n                if (bodyA.vel.normalize().dot(opposite) < 0) {\n                    // Cancel out velocity opposite direction of collision normal\n                    const velAdj = normal.scale(normal.dot(bodyA.vel.negate()));\n                    bodyA.vel = bodyA.vel.add(velAdj);\n                }\n            }\n            if (bodyB.collisionType === CollisionType.Active) {\n                // only adjust velocity if the contact normal is opposite to the current velocity\n                // this avoids catching edges on a platform\n                if (bodyB.vel.normalize().dot(normal) < 0) {\n                    const velAdj = opposite.scale(opposite.dot(bodyB.vel.negate()));\n                    bodyB.vel = bodyB.vel.add(velAdj);\n                }\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Solver/ContactConstraintPoint.ts\n\n\n/**\n * Holds information about contact points, meant to be reused over multiple frames of contact\n */\nclass ContactConstraintPoint {\n    constructor(point, local, contact) {\n        this.point = point;\n        this.local = local;\n        this.contact = contact;\n        /**\n         * Impulse accumulated over time in normal direction\n         */\n        this.normalImpulse = 0;\n        /**\n         * Impulse accumulated over time in the tangent direction\n         */\n        this.tangentImpulse = 0;\n        /**\n         * Effective mass seen in the normal direction\n         */\n        this.normalMass = 0;\n        /**\n         * Effective mass seen in the tangent direction\n         */\n        this.tangentMass = 0;\n        /**\n         * Direction from center of mass of bodyA to contact point\n         */\n        this.aToContact = new Vector(0, 0);\n        /**\n         * Direction from center of mass of bodyB to contact point\n         */\n        this.bToContact = new Vector(0, 0);\n        /**\n         * Original contact velocity combined with bounciness\n         */\n        this.originalVelocityAndRestitution = 0;\n        this.update();\n    }\n    /**\n     * Updates the contact information\n     */\n    update() {\n        var _a, _b;\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n        if (bodyA && bodyB) {\n            const normal = this.contact.normal;\n            const tangent = this.contact.tangent;\n            this.aToContact = this.point.sub(bodyA.globalPos);\n            this.bToContact = this.point.sub(bodyB.globalPos);\n            const aToContactNormal = this.aToContact.cross(normal);\n            const bToContactNormal = this.bToContact.cross(normal);\n            this.normalMass =\n                bodyA.inverseMass +\n                    bodyB.inverseMass +\n                    bodyA.inverseInertia * aToContactNormal * aToContactNormal +\n                    bodyB.inverseInertia * bToContactNormal * bToContactNormal;\n            const aToContactTangent = this.aToContact.cross(tangent);\n            const bToContactTangent = this.bToContact.cross(tangent);\n            this.tangentMass =\n                bodyA.inverseMass +\n                    bodyB.inverseMass +\n                    bodyA.inverseInertia * aToContactTangent * aToContactTangent +\n                    bodyB.inverseInertia * bToContactTangent * bToContactTangent;\n        }\n        return this;\n    }\n    /**\n     * Returns the relative velocity between bodyA and bodyB\n     */\n    getRelativeVelocity() {\n        var _a, _b;\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n        if (bodyA && bodyB) {\n            // Relative velocity in linear terms\n            // Angular to linear velocity formula -> omega = velocity/radius so omega x radius = velocity\n            const velA = bodyA.vel.add(Vector.cross(bodyA.angularVelocity, this.aToContact));\n            const velB = bodyB.vel.add(Vector.cross(bodyB.angularVelocity, this.bToContact));\n            return velB.sub(velA);\n        }\n        return Vector.Zero;\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Solver/RealisticSolver.ts\n\n\n\n\n\n\n\nclass RealisticSolver {\n    constructor(config) {\n        this.config = config;\n        this.lastFrameContacts = new Map();\n        // map contact id to contact points\n        this.idToContactConstraint = new Map();\n    }\n    getContactConstraints(id) {\n        var _a;\n        return (_a = this.idToContactConstraint.get(id)) !== null && _a !== void 0 ? _a : [];\n    }\n    solve(contacts) {\n        // Events and init\n        this.preSolve(contacts);\n        // Remove any canceled contacts\n        contacts = contacts.filter(c => !c.isCanceled());\n        // Solve velocity first\n        this.solveVelocity(contacts);\n        // Solve position last because non-overlap is the most important\n        this.solvePosition(contacts);\n        // Events and any contact house-keeping the solver needs\n        this.postSolve(contacts);\n        return contacts;\n    }\n    preSolve(contacts) {\n        var _a, _b, _c;\n        const epsilon = .0001;\n        for (const contact of contacts) {\n            if (Math.abs(contact.mtv.x) < epsilon && Math.abs(contact.mtv.y) < epsilon) {\n                // Cancel near 0 mtv collisions\n                contact.cancel();\n                continue;\n            }\n            // Publish collision events on both participants\n            const side = Side.fromDirection(contact.mtv);\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\n            contact.colliderA.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\n            contact.colliderB.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\n            // Match awake state for sleeping\n            contact.matchAwake();\n        }\n        // Keep track of contacts that done\n        const finishedContactIds = Array.from(this.idToContactConstraint.keys());\n        for (const contact of contacts) {\n            // Remove all current contacts that are not done\n            const index = finishedContactIds.indexOf(contact.id);\n            if (index > -1) {\n                finishedContactIds.splice(index, 1);\n            }\n            const contactPoints = (_a = this.idToContactConstraint.get(contact.id)) !== null && _a !== void 0 ? _a : [];\n            let pointIndex = 0;\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\n            if (bodyA && bodyB) {\n                for (const point of contact.points) {\n                    const normal = contact.normal;\n                    const tangent = contact.tangent;\n                    const aToContact = point.sub(bodyA.globalPos);\n                    const bToContact = point.sub(bodyB.globalPos);\n                    const aToContactNormal = aToContact.cross(normal);\n                    const bToContactNormal = bToContact.cross(normal);\n                    const normalMass = bodyA.inverseMass +\n                        bodyB.inverseMass +\n                        bodyA.inverseInertia * aToContactNormal * aToContactNormal +\n                        bodyB.inverseInertia * bToContactNormal * bToContactNormal;\n                    const aToContactTangent = aToContact.cross(tangent);\n                    const bToContactTangent = bToContact.cross(tangent);\n                    const tangentMass = bodyA.inverseMass +\n                        bodyB.inverseMass +\n                        bodyA.inverseInertia * aToContactTangent * aToContactTangent +\n                        bodyB.inverseInertia * bToContactTangent * bToContactTangent;\n                    // Preserve normal/tangent impulse by re-using the contact point if it's close\n                    if (contactPoints[pointIndex] && ((_c = (_b = contactPoints[pointIndex]) === null || _b === void 0 ? void 0 : _b.point) === null || _c === void 0 ? void 0 : _c.squareDistance(point)) < 4) {\n                        contactPoints[pointIndex].point = point;\n                        contactPoints[pointIndex].local = contact.localPoints[pointIndex];\n                    }\n                    else {\n                        // new contact if it's not close or doesn't exist\n                        contactPoints[pointIndex] = new ContactConstraintPoint(point, contact.localPoints[pointIndex], contact);\n                    }\n                    // Update contact point calculations\n                    contactPoints[pointIndex].aToContact = aToContact;\n                    contactPoints[pointIndex].bToContact = bToContact;\n                    contactPoints[pointIndex].normalMass = 1.0 / normalMass;\n                    contactPoints[pointIndex].tangentMass = 1.0 / tangentMass;\n                    // Calculate relative velocity before solving to accurately do restitution\n                    const restitution = bodyA.bounciness > bodyB.bounciness ? bodyA.bounciness : bodyB.bounciness;\n                    const relativeVelocity = contact.normal.dot(contactPoints[pointIndex].getRelativeVelocity());\n                    contactPoints[pointIndex].originalVelocityAndRestitution = 0;\n                    if (relativeVelocity < -0.1) { // TODO what's a good threshold here?\n                        contactPoints[pointIndex].originalVelocityAndRestitution = -restitution * relativeVelocity;\n                    }\n                    pointIndex++;\n                }\n            }\n            this.idToContactConstraint.set(contact.id, contactPoints);\n        }\n        // Clean up any contacts that did not occur last frame\n        for (const id of finishedContactIds) {\n            this.idToContactConstraint.delete(id);\n        }\n        // Warm contacts with accumulated impulse\n        // Useful for tall stacks\n        if (this.config.warmStart) {\n            this.warmStart(contacts);\n        }\n        else {\n            for (const contact of contacts) {\n                const contactPoints = this.getContactConstraints(contact.id);\n                for (const point of contactPoints) {\n                    point.normalImpulse = 0;\n                    point.tangentImpulse = 0;\n                }\n            }\n        }\n    }\n    postSolve(contacts) {\n        for (const contact of contacts) {\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\n            if (bodyA && bodyB) {\n                // Skip post solve for active+passive collisions\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n                    continue;\n                }\n                // Update motion values for sleeping\n                bodyA.updateMotion();\n                bodyB.updateMotion();\n            }\n            // Publish collision events on both participants\n            const side = Side.fromDirection(contact.mtv);\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\n            contact.colliderA.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\n            contact.colliderB.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\n        }\n        // Store contacts\n        this.lastFrameContacts.clear();\n        for (const c of contacts) {\n            this.lastFrameContacts.set(c.id, c);\n        }\n    }\n    /**\n     * Warm up body's based on previous frame contact points\n     * @param contacts\n     */\n    warmStart(contacts) {\n        var _a, _b, _c;\n        for (const contact of contacts) {\n            const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n            const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n            if (bodyA && bodyB) {\n                const contactPoints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\n                for (const point of contactPoints) {\n                    if (this.config.warmStart) {\n                        const normalImpulse = contact.normal.scale(point.normalImpulse);\n                        const tangentImpulse = contact.tangent.scale(point.tangentImpulse);\n                        const impulse = normalImpulse.add(tangentImpulse);\n                        bodyA.applyImpulse(point.point, impulse.negate());\n                        bodyB.applyImpulse(point.point, impulse);\n                    }\n                    else {\n                        point.normalImpulse = 0;\n                        point.tangentImpulse = 0;\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * Iteratively solve the position overlap constraint\n     * @param contacts\n     */\n    solvePosition(contacts) {\n        var _a, _b, _c;\n        for (let i = 0; i < this.config.positionIterations; i++) {\n            for (const contact of contacts) {\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n                if (bodyA && bodyB) {\n                    // Skip solving active+passive\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n                        continue;\n                    }\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\n                    for (const point of constraints) {\n                        const normal = contact.normal;\n                        const separation = CollisionJumpTable.FindContactSeparation(contact, point.local);\n                        const steeringConstant = this.config.steeringFactor; //0.2;\n                        const maxCorrection = -5;\n                        const slop = this.config.slop; //1;\n                        // Clamp to avoid over-correction\n                        // Remember that we are shooting for 0 overlap in the end\n                        const steeringForce = clamp(steeringConstant * (separation + slop), maxCorrection, 0);\n                        const impulse = normal.scale(-steeringForce * point.normalMass);\n                        // This is a pseudo impulse, meaning we aren't doing a real impulse calculation\n                        // We adjust position and rotation instead of doing the velocity\n                        if (bodyA.collisionType === CollisionType.Active) {\n                            // TODO make applyPseudoImpulse function?\n                            const impulseForce = impulse.negate().scale(bodyA.inverseMass);\n                            if (bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\n                                impulseForce.x = 0;\n                            }\n                            if (bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\n                                impulseForce.y = 0;\n                            }\n                            bodyA.globalPos = bodyA.globalPos.add(impulseForce);\n                            if (!bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\n                                bodyA.rotation -= point.aToContact.cross(impulse) * bodyA.inverseInertia;\n                            }\n                        }\n                        if (bodyB.collisionType === CollisionType.Active) {\n                            const impulseForce = impulse.scale(bodyB.inverseMass);\n                            if (bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\n                                impulseForce.x = 0;\n                            }\n                            if (bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\n                                impulseForce.y = 0;\n                            }\n                            bodyB.globalPos = bodyB.globalPos.add(impulseForce);\n                            if (!bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\n                                bodyB.rotation += point.bToContact.cross(impulse) * bodyB.inverseInertia;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    solveVelocity(contacts) {\n        var _a, _b, _c;\n        for (let i = 0; i < this.config.velocityIterations; i++) {\n            for (const contact of contacts) {\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\n                if (bodyA && bodyB) {\n                    // Skip solving active+passive\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\n                        continue;\n                    }\n                    const friction = Math.min(bodyA.friction, bodyB.friction);\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\n                    // Friction constraint\n                    for (const point of constraints) {\n                        const relativeVelocity = point.getRelativeVelocity();\n                        // Negate velocity in tangent direction to simulate friction\n                        const tangentVelocity = -relativeVelocity.dot(contact.tangent);\n                        let impulseDelta = tangentVelocity * point.tangentMass;\n                        // Clamping based in Erin Catto's GDC 2006 talk\n                        // Correct clamping https://github.com/erincatto/box2d-lite/blob/master/docs/GDC2006_Catto_Erin_PhysicsTutorial.pdf\n                        // Accumulated fiction impulse is always between -uMaxFriction < dT < uMaxFriction\n                        // But deltas can vary\n                        const maxFriction = friction * point.normalImpulse;\n                        const newImpulse = clamp(point.tangentImpulse + impulseDelta, -maxFriction, maxFriction);\n                        impulseDelta = newImpulse - point.tangentImpulse;\n                        point.tangentImpulse = newImpulse;\n                        const impulse = contact.tangent.scale(impulseDelta);\n                        bodyA.applyImpulse(point.point, impulse.negate());\n                        bodyB.applyImpulse(point.point, impulse);\n                    }\n                    // Bounce constraint\n                    for (const point of constraints) {\n                        // Need to recalc relative velocity because the previous step could have changed vel\n                        const relativeVelocity = point.getRelativeVelocity();\n                        // Compute impulse in normal direction\n                        const normalVelocity = relativeVelocity.dot(contact.normal);\n                        // Per Erin it is a mistake to apply the restitution inside the iteration\n                        // From Erin Catto's Box2D we keep original contact velocity and adjust by small impulses\n                        let impulseDelta = -point.normalMass * (normalVelocity - point.originalVelocityAndRestitution);\n                        // Clamping based in Erin Catto's GDC 2014 talk\n                        // Accumulated impulse stored in the contact is always positive (dV > 0)\n                        // But deltas can be negative\n                        const newImpulse = Math.max(point.normalImpulse + impulseDelta, 0);\n                        impulseDelta = newImpulse - point.normalImpulse;\n                        point.normalImpulse = newImpulse;\n                        const impulse = contact.normal.scale(impulseDelta);\n                        bodyA.applyImpulse(point.point, impulse.negate());\n                        bodyB.applyImpulse(point.point, impulse);\n                    }\n                }\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/CollisionSystem.ts\n\n\n\n\n\n\n\n\n\n\n\nclass CollisionSystem extends System {\n    get _processor() {\n        return this._physics.collisionProcessor;\n    }\n    ;\n    constructor(world, _physics) {\n        super();\n        this._physics = _physics;\n        this.systemType = SystemType.Update;\n        this.priority = SystemPriority.Higher;\n        this._configDirty = false;\n        this._lastFrameContacts = new Map();\n        this._currentFrameContacts = new Map();\n        this._arcadeSolver = new ArcadeSolver(_physics.config.arcade);\n        this._realisticSolver = new RealisticSolver(_physics.config.realistic);\n        this._physics.$configUpdate.subscribe(() => this._configDirty = true);\n        this._trackCollider = (c) => this._processor.track(c);\n        this._untrackCollider = (c) => this._processor.untrack(c);\n        this.query = world.query([TransformComponent, MotionComponent, ColliderComponent]);\n        this.query.entityAdded$.subscribe(e => {\n            const colliderComponent = e.get(ColliderComponent);\n            colliderComponent.$colliderAdded.subscribe(this._trackCollider);\n            colliderComponent.$colliderRemoved.subscribe(this._untrackCollider);\n            const collider = colliderComponent.get();\n            if (collider) {\n                this._processor.track(collider);\n            }\n        });\n        this.query.entityRemoved$.subscribe(e => {\n            const colliderComponent = e.get(ColliderComponent);\n            const collider = colliderComponent.get();\n            if (colliderComponent && collider) {\n                this._processor.untrack(collider);\n            }\n        });\n    }\n    initialize(world, scene) {\n        this._engine = scene.engine;\n    }\n    update(elapsedMs) {\n        var _a, _b, _c, _d;\n        if (!this._physics.config.enabled) {\n            return;\n        }\n        // Collect up all the colliders and update them\n        let colliders = [];\n        for (const entity of this.query.entities) {\n            const colliderComp = entity.get(ColliderComponent);\n            const collider = colliderComp === null || colliderComp === void 0 ? void 0 : colliderComp.get();\n            if (colliderComp && ((_a = colliderComp.owner) === null || _a === void 0 ? void 0 : _a.active) && collider) {\n                colliderComp.update();\n                if (collider instanceof CompositeCollider) {\n                    const compositeColliders = collider.getColliders();\n                    if (!collider.compositeStrategy) {\n                        collider.compositeStrategy = this._physics.config.colliders.compositeStrategy;\n                    }\n                    colliders = colliders.concat(compositeColliders);\n                }\n                else {\n                    colliders.push(collider);\n                }\n            }\n        }\n        // Update the spatial partitioning data structures\n        // TODO if collider invalid it will break the processor\n        // TODO rename \"update\" to something more specific\n        this._processor.update(colliders);\n        // Run broadphase on all colliders and locates potential collisions\n        const pairs = this._processor.broadphase(colliders, elapsedMs);\n        this._currentFrameContacts.clear();\n        // Given possible pairs find actual contacts\n        let contacts = this._processor.narrowphase(pairs, (_d = (_c = (_b = this._engine) === null || _b === void 0 ? void 0 : _b.debug) === null || _c === void 0 ? void 0 : _c.stats) === null || _d === void 0 ? void 0 : _d.currFrame);\n        const solver = this.getSolver();\n        // Solve, this resolves the position/velocity so entities aren't overlapping\n        contacts = solver.solve(contacts);\n        // Record contacts for start/end\n        for (const contact of contacts) {\n            if (contact.isCanceled()) {\n                continue;\n            }\n            // Process composite ids, things with the same composite id are treated as the same collider for start/end\n            const index = contact.id.indexOf('|');\n            if (index > 0) {\n                const compositeId = contact.id.substring(index + 1);\n                this._currentFrameContacts.set(compositeId, contact);\n            }\n            else {\n                this._currentFrameContacts.set(contact.id, contact);\n            }\n        }\n        // Emit contact start/end events\n        this.runContactStartEnd();\n        // reset the last frame cache\n        this._lastFrameContacts.clear();\n        // Keep track of collisions contacts that have started or ended\n        this._lastFrameContacts = new Map(this._currentFrameContacts);\n        // Process deferred collider removals\n        for (const entity of this.query.entities) {\n            const collider = entity.get(ColliderComponent);\n            if (collider) {\n                collider.processColliderRemoval();\n            }\n        }\n    }\n    getSolver() {\n        if (this._configDirty) {\n            this._configDirty = false;\n            this._arcadeSolver = new ArcadeSolver(this._physics.config.arcade);\n            this._realisticSolver = new RealisticSolver(this._physics.config.realistic);\n        }\n        return this._physics.config.solver === SolverStrategy.Realistic ? this._realisticSolver : this._arcadeSolver;\n    }\n    debug(ex) {\n        this._processor.debug(ex);\n    }\n    runContactStartEnd() {\n        // If composite colliders are 'together' collisions may have a duplicate id because we want to treat those as a singular start/end\n        for (const [id, c] of this._currentFrameContacts) {\n            // find all new contacts\n            if (!this._lastFrameContacts.has(id)) {\n                const colliderA = c.colliderA;\n                const colliderB = c.colliderB;\n                const side = Side.fromDirection(c.mtv);\n                const opposite = Side.getOpposite(side);\n                colliderA.events.emit('collisionstart', new CollisionStartEvent(colliderA, colliderB, side, c));\n                colliderA.events.emit('contactstart', new ContactStartEvent(colliderA, colliderB, side, c));\n                colliderB.events.emit('collisionstart', new CollisionStartEvent(colliderB, colliderA, opposite, c));\n                colliderB.events.emit('contactstart', new ContactStartEvent(colliderB, colliderA, opposite, c));\n            }\n        }\n        // find all contacts that have ceased\n        for (const [id, c] of this._lastFrameContacts) {\n            if (!this._currentFrameContacts.has(id)) {\n                const colliderA = c.colliderA;\n                const colliderB = c.colliderB;\n                const side = Side.fromDirection(c.mtv);\n                const opposite = Side.getOpposite(side);\n                colliderA.events.emit('collisionend', new CollisionEndEvent(colliderA, colliderB, side, c));\n                colliderA.events.emit('contactend', new ContactEndEvent(colliderA, colliderB, side, c));\n                colliderB.events.emit('collisionend', new CollisionEndEvent(colliderB, colliderA, opposite, c));\n                colliderB.events.emit('contactend', new ContactEndEvent(colliderB, colliderA, opposite, c));\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Configurable.ts\n/**\n * Configurable helper extends base type and makes all properties available as option bag arguments\n * @internal\n * @param base\n */\nfunction Configurable(base) {\n    return class extends base {\n        assign(props) {\n            //set the value of every property that was passed in,\n            //if the constructor previously set this value, it will be overridden here\n            for (const k in props) {\n                // eslint-disable-next-line\n                if (typeof this[k] !== 'function') {\n                    // eslint-disable-next-line\n                    this[k] = props[k];\n                }\n            }\n        }\n        constructor(...args) {\n            super(...args);\n            //get the number of arguments that aren't undefined. TS passes a value to all parameters\n            //of whatever ctor is the implementation, so args.length doesn't work here.\n            const size = args.filter(function (value) {\n                return value !== undefined;\n            }).length;\n            if (size === 1 && args[0] && typeof args[0] === 'object' && !(args[0] instanceof Array)) {\n                this.assign(args[0]);\n            }\n        }\n    };\n}\n\n;// CONCATENATED MODULE: ./Particles.ts\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * An enum that represents the types of emitter nozzles\n */\nvar EmitterType;\n(function (EmitterType) {\n    /**\n     * Constant for the circular emitter type\n     */\n    EmitterType[EmitterType[\"Circle\"] = 0] = \"Circle\";\n    /**\n     * Constant for the rectangular emitter type\n     */\n    EmitterType[EmitterType[\"Rectangle\"] = 1] = \"Rectangle\";\n})(EmitterType || (EmitterType = {}));\n/**\n * @hidden\n */\nclass ParticleImpl extends Entity {\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize, particleSprite) {\n        super();\n        this.position = new Vector(0, 0);\n        this.velocity = new Vector(0, 0);\n        this.acceleration = new Vector(0, 0);\n        this.particleRotationalVelocity = 0;\n        this.currentRotation = 0;\n        this.focus = null;\n        this.focusAccel = 0;\n        this.opacity = 1;\n        this.beginColor = Color.White;\n        this.endColor = Color.White;\n        // Life is counted in ms\n        this.life = 300;\n        this.fadeFlag = false;\n        // Color transitions\n        this._rRate = 1;\n        this._gRate = 1;\n        this._bRate = 1;\n        this._aRate = 0;\n        this._currentColor = Color.White;\n        this.emitter = null;\n        this.particleSize = 5;\n        this.particleSprite = null;\n        this.sizeRate = 0;\n        this.elapsedMultiplier = 0;\n        this.visible = true;\n        this.isOffscreen = false;\n        let emitter = emitterOrConfig;\n        if (emitter && !(emitterOrConfig instanceof ParticleEmitter)) {\n            const config = emitterOrConfig;\n            emitter = config.emitter;\n            life = config.life;\n            opacity = config.opacity;\n            endColor = config.endColor;\n            beginColor = config.beginColor;\n            position = config.position;\n            velocity = config.velocity;\n            acceleration = config.acceleration;\n            startSize = config.startSize;\n            endSize = config.endSize;\n            particleSprite = config.particleSprite;\n        }\n        this.emitter = emitter;\n        this.life = life || this.life;\n        this.opacity = opacity || this.opacity;\n        this.endColor = endColor || this.endColor.clone();\n        this.beginColor = beginColor || this.beginColor.clone();\n        this._currentColor = this.beginColor.clone();\n        this.particleSprite = particleSprite;\n        if (this.emitter.particleTransform === ParticleTransform.Global) {\n            const globalPos = this.emitter.transform.globalPos;\n            this.position = (position || this.position).add(globalPos);\n            this.velocity = (velocity || this.velocity).rotate(this.emitter.transform.globalRotation);\n        }\n        else {\n            this.velocity = velocity || this.velocity;\n            this.position = (position || this.position);\n        }\n        this.acceleration = acceleration || this.acceleration;\n        this._rRate = (this.endColor.r - this.beginColor.r) / this.life;\n        this._gRate = (this.endColor.g - this.beginColor.g) / this.life;\n        this._bRate = (this.endColor.b - this.beginColor.b) / this.life;\n        this._aRate = this.opacity / this.life;\n        this.startSize = startSize || 0;\n        this.endSize = endSize || 0;\n        if (this.endSize > 0 && this.startSize > 0) {\n            this.sizeRate = (this.endSize - this.startSize) / this.life;\n            this.particleSize = this.startSize;\n        }\n        this.addComponent((this.transform = new TransformComponent()));\n        this.addComponent((this.graphics = new GraphicsComponent()));\n        this.transform.pos = this.position;\n        this.transform.rotation = this.currentRotation;\n        this.transform.scale = vec(1, 1); // TODO wut\n        this.transform.z = this.emitter.z;\n        if (this.particleSprite) {\n            this.graphics.opacity = this.opacity;\n            this.graphics.use(this.particleSprite);\n        }\n        else {\n            this.graphics.localBounds = BoundingBox.fromDimension(this.particleSize, this.particleSize, Vector.Half);\n            this.graphics.onPostDraw = (ctx) => {\n                ctx.save();\n                this.graphics.opacity = this.opacity;\n                const tmpColor = this._currentColor.clone();\n                tmpColor.a = 1;\n                ctx.debug.drawPoint(vec(0, 0), { color: tmpColor, size: this.particleSize });\n                ctx.restore();\n            };\n        }\n    }\n    kill() {\n        this.emitter.removeParticle(this);\n    }\n    update(engine, delta) {\n        this.life = this.life - delta;\n        this.elapsedMultiplier = this.elapsedMultiplier + delta;\n        if (this.life < 0) {\n            this.kill();\n        }\n        if (this.fadeFlag) {\n            this.opacity = clamp(this._aRate * this.life, 0.0001, 1);\n        }\n        if (this.startSize > 0 && this.endSize > 0) {\n            this.particleSize = clamp(this.sizeRate * delta + this.particleSize, Math.min(this.startSize, this.endSize), Math.max(this.startSize, this.endSize));\n        }\n        this._currentColor.r = clamp(this._currentColor.r + this._rRate * delta, 0, 255);\n        this._currentColor.g = clamp(this._currentColor.g + this._gRate * delta, 0, 255);\n        this._currentColor.b = clamp(this._currentColor.b + this._bRate * delta, 0, 255);\n        this._currentColor.a = clamp(this.opacity, 0.0001, 1);\n        if (this.focus) {\n            const accel = this.focus\n                .sub(this.position)\n                .normalize()\n                .scale(this.focusAccel)\n                .scale(delta / 1000);\n            this.velocity = this.velocity.add(accel);\n        }\n        else {\n            this.velocity = this.velocity.add(this.acceleration.scale(delta / 1000));\n        }\n        this.position = this.position.add(this.velocity.scale(delta / 1000));\n        if (this.particleRotationalVelocity) {\n            this.currentRotation = (this.currentRotation + (this.particleRotationalVelocity * delta) / 1000) % (2 * Math.PI);\n        }\n        this.transform.pos = this.position;\n        this.transform.rotation = this.currentRotation;\n        this.transform.scale = vec(1, 1); // todo wut\n        this.graphics.opacity = this.opacity;\n    }\n}\n/**\n * Particle is used in a [[ParticleEmitter]]\n */\nclass Particle extends Configurable(ParticleImpl) {\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize, particleSprite) {\n        super(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize, particleSprite);\n    }\n}\nvar ParticleTransform;\n(function (ParticleTransform) {\n    /**\n     * [[ParticleTransform.Global]] is the default and emits particles as if\n     * they were world space objects, useful for most effects.\n     */\n    ParticleTransform[\"Global\"] = \"global\";\n    /**\n     * [[ParticleTransform.Local]] particles are children of the emitter and move relative to the emitter\n     * as they would in a parent/child actor relationship.\n     */\n    ParticleTransform[\"Local\"] = \"local\";\n})(ParticleTransform || (ParticleTransform = {}));\n/**\n * Using a particle emitter is a great way to create interesting effects\n * in your game, like smoke, fire, water, explosions, etc. `ParticleEmitter`\n * extend [[Actor]] allowing you to use all of the features that come with.\n */\nclass ParticleEmitter extends Actor {\n    /**\n     * Gets the opacity of each particle from 0 to 1.0\n     */\n    get opacity() {\n        return this.graphics.opacity;\n    }\n    /**\n     * Gets the opacity of each particle from 0 to 1.0\n     */\n    set opacity(opacity) {\n        this.graphics.opacity = opacity;\n    }\n    /**\n     * Gets or sets the sprite that a particle should use\n     */\n    get particleSprite() {\n        return this._sprite;\n    }\n    set particleSprite(val) {\n        if (val) {\n            this._sprite = val;\n        }\n    }\n    /**\n     * @param config particle emitter options bag\n     */\n    constructor(config) {\n        var _a, _b;\n        super({ width: (_a = config.width) !== null && _a !== void 0 ? _a : 0, height: (_b = config.height) !== null && _b !== void 0 ? _b : 0 });\n        this._particlesToEmit = 0;\n        this.numParticles = 0;\n        /**\n         * Gets or sets the isEmitting flag\n         */\n        this.isEmitting = true;\n        /**\n         * Gets or sets the backing particle collection\n         */\n        this.particles = [];\n        /**\n         * Gets or sets the backing deadParticle collection\n         */\n        this.deadParticles = [];\n        /**\n         * Gets or sets the minimum particle velocity\n         */\n        this.minVel = 0;\n        /**\n         * Gets or sets the maximum particle velocity\n         */\n        this.maxVel = 0;\n        /**\n         * Gets or sets the acceleration vector for all particles\n         */\n        this.acceleration = new Vector(0, 0);\n        /**\n         * Gets or sets the minimum angle in radians\n         */\n        this.minAngle = 0;\n        /**\n         * Gets or sets the maximum angle in radians\n         */\n        this.maxAngle = 0;\n        /**\n         * Gets or sets the emission rate for particles (particles/sec)\n         */\n        this.emitRate = 1; //particles/sec\n        /**\n         * Gets or sets the life of each particle in milliseconds\n         */\n        this.particleLife = 2000;\n        /**\n         * Gets or sets the fade flag which causes particles to gradually fade out over the course of their life.\n         */\n        this.fadeFlag = false;\n        /**\n         * Gets or sets the optional focus where all particles should accelerate towards\n         */\n        this.focus = null;\n        /**\n         * Gets or sets the acceleration for focusing particles if a focus has been specified\n         */\n        this.focusAccel = null;\n        /**\n         * Gets or sets the optional starting size for the particles\n         */\n        this.startSize = null;\n        /**\n         * Gets or sets the optional ending size for the particles\n         */\n        this.endSize = null;\n        /**\n         * Gets or sets the minimum size of all particles\n         */\n        this.minSize = 5;\n        /**\n         * Gets or sets the maximum size of all particles\n         */\n        this.maxSize = 5;\n        /**\n         * Gets or sets the beginning color of all particles\n         */\n        this.beginColor = Color.White;\n        /**\n         * Gets or sets the ending color of all particles\n         */\n        this.endColor = Color.White;\n        this._sprite = null;\n        /**\n         * Gets or sets the emitter type for the particle emitter\n         */\n        this.emitterType = EmitterType.Rectangle;\n        /**\n         * Gets or sets the emitter radius, only takes effect when the [[emitterType]] is [[EmitterType.Circle]]\n         */\n        this.radius = 0;\n        /**\n         * Gets or sets the particle rotational speed velocity\n         */\n        this.particleRotationalVelocity = 0;\n        /**\n         * Indicates whether particles should start with a random rotation\n         */\n        this.randomRotation = false;\n        /**\n         * Gets or sets the emitted particle transform style, [[ParticleTransform.Global]] is the default and emits particles as if\n         * they were world space objects, useful for most effects.\n         *\n         * If set to [[ParticleTransform.Local]] particles are children of the emitter and move relative to the emitter\n         * as they would in a parent/child actor relationship.\n         */\n        this.particleTransform = ParticleTransform.Global;\n        const { x, y, z, pos, isEmitting, minVel, maxVel, acceleration, minAngle, maxAngle, emitRate, particleLife, opacity, fadeFlag, focus, focusAccel, startSize, endSize, minSize, maxSize, beginColor, endColor, particleSprite, emitterType, radius, particleRotationalVelocity, particleTransform, randomRotation, random } = { ...config };\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\n        this.z = z !== null && z !== void 0 ? z : 0;\n        this.isEmitting = isEmitting !== null && isEmitting !== void 0 ? isEmitting : this.isEmitting;\n        this.minVel = minVel !== null && minVel !== void 0 ? minVel : this.minVel;\n        this.maxVel = maxVel !== null && maxVel !== void 0 ? maxVel : this.maxVel;\n        this.acceleration = acceleration !== null && acceleration !== void 0 ? acceleration : this.acceleration;\n        this.minAngle = minAngle !== null && minAngle !== void 0 ? minAngle : this.minAngle;\n        this.maxAngle = maxAngle !== null && maxAngle !== void 0 ? maxAngle : this.maxAngle;\n        this.emitRate = emitRate !== null && emitRate !== void 0 ? emitRate : this.emitRate;\n        this.particleLife = particleLife !== null && particleLife !== void 0 ? particleLife : this.particleLife;\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\n        this.fadeFlag = fadeFlag !== null && fadeFlag !== void 0 ? fadeFlag : this.fadeFlag;\n        this.focus = focus !== null && focus !== void 0 ? focus : this.focus;\n        this.focusAccel = focusAccel !== null && focusAccel !== void 0 ? focusAccel : this.focusAccel;\n        this.startSize = startSize !== null && startSize !== void 0 ? startSize : this.startSize;\n        this.endSize = endSize !== null && endSize !== void 0 ? endSize : this.endSize;\n        this.minSize = minSize !== null && minSize !== void 0 ? minSize : this.minSize;\n        this.maxSize = maxSize !== null && maxSize !== void 0 ? maxSize : this.maxSize;\n        this.beginColor = beginColor !== null && beginColor !== void 0 ? beginColor : this.beginColor;\n        this.endColor = endColor !== null && endColor !== void 0 ? endColor : this.endColor;\n        this.particleSprite = particleSprite !== null && particleSprite !== void 0 ? particleSprite : this.particleSprite;\n        this.emitterType = emitterType !== null && emitterType !== void 0 ? emitterType : this.emitterType;\n        this.radius = radius !== null && radius !== void 0 ? radius : this.radius;\n        this.particleRotationalVelocity = particleRotationalVelocity !== null && particleRotationalVelocity !== void 0 ? particleRotationalVelocity : this.particleRotationalVelocity;\n        this.randomRotation = randomRotation !== null && randomRotation !== void 0 ? randomRotation : this.randomRotation;\n        this.particleTransform = particleTransform !== null && particleTransform !== void 0 ? particleTransform : this.particleTransform;\n        this.body.collisionType = CollisionType.PreventCollision;\n        this.random = random !== null && random !== void 0 ? random : new Random();\n    }\n    removeParticle(particle) {\n        this.deadParticles.push(particle);\n    }\n    /**\n     * Causes the emitter to emit particles\n     * @param particleCount  Number of particles to emit right now\n     */\n    emitParticles(particleCount) {\n        var _a;\n        for (let i = 0; i < particleCount; i++) {\n            const p = this._createParticle();\n            this.particles.push(p);\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\n                if (this.particleTransform === ParticleTransform.Global) {\n                    this.scene.world.add(p);\n                }\n                else {\n                    this.addChild(p);\n                }\n            }\n        }\n    }\n    clearParticles() {\n        this.particles.length = 0;\n    }\n    // Creates a new particle given the constraints of the emitter\n    _createParticle() {\n        // todo implement emitter constraints;\n        let ranX = 0;\n        let ranY = 0;\n        const angle = randomInRange(this.minAngle, this.maxAngle, this.random);\n        const vel = randomInRange(this.minVel, this.maxVel, this.random);\n        const size = this.startSize || randomInRange(this.minSize, this.maxSize, this.random);\n        const dx = vel * Math.cos(angle);\n        const dy = vel * Math.sin(angle);\n        if (this.emitterType === EmitterType.Rectangle) {\n            ranX = randomInRange(0, this.width, this.random);\n            ranY = randomInRange(0, this.height, this.random);\n        }\n        else if (this.emitterType === EmitterType.Circle) {\n            const radius = randomInRange(0, this.radius, this.random);\n            ranX = radius * Math.cos(angle);\n            ranY = radius * Math.sin(angle);\n        }\n        const p = new Particle(this, this.particleLife, this.opacity, this.beginColor, this.endColor, new Vector(ranX, ranY), new Vector(dx, dy), this.acceleration, this.startSize, this.endSize, this.particleSprite);\n        p.fadeFlag = this.fadeFlag;\n        p.particleSize = size;\n        p.particleRotationalVelocity = this.particleRotationalVelocity;\n        if (this.randomRotation) {\n            p.currentRotation = randomInRange(0, Math.PI * 2, this.random);\n        }\n        if (this.focus) {\n            p.focus = this.focus.add(new Vector(this.pos.x, this.pos.y));\n            p.focusAccel = this.focusAccel;\n        }\n        return p;\n    }\n    update(engine, delta) {\n        var _a;\n        super.update(engine, delta);\n        if (this.isEmitting) {\n            this._particlesToEmit += this.emitRate * (delta / 1000);\n            if (this._particlesToEmit > 1.0) {\n                this.emitParticles(Math.floor(this._particlesToEmit));\n                this._particlesToEmit = this._particlesToEmit - Math.floor(this._particlesToEmit);\n            }\n        }\n        // deferred removal\n        for (let i = 0; i < this.deadParticles.length; i++) {\n            removeItemFromArray(this.deadParticles[i], this.particles);\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\n                this.scene.world.remove(this.deadParticles[i], false);\n            }\n        }\n        this.deadParticles.length = 0;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/TransformInterpolation.ts\n\n/**\n * Blend 2 transforms for interpolation, will interpolate from the context of newTx's parent if it exists\n */\nfunction blendTransform(oldTx, newTx, blend, target) {\n    if (oldTx.parent !== newTx.parent) {\n        // Caller expects a local transform\n        // Adjust old tx to be local to the new parent whatever that is\n        const oldTxWithNewParent = oldTx.clone();\n        const oldGlobalPos = oldTx.globalPos.clone();\n        const oldGlobalScale = oldTx.globalScale.clone();\n        const oldGlobalRotation = oldTx.globalRotation;\n        oldTxWithNewParent.parent = newTx.parent;\n        oldTxWithNewParent.globalPos = oldGlobalPos;\n        oldTxWithNewParent.globalScale = oldGlobalScale;\n        oldTxWithNewParent.globalRotation = oldGlobalRotation;\n        oldTx = oldTxWithNewParent;\n    }\n    let interpolatedPos = newTx.pos;\n    let interpolatedScale = newTx.scale;\n    let interpolatedRotation = newTx.rotation;\n    interpolatedPos = newTx.pos.scale(blend).add(oldTx.pos.scale(1.0 - blend));\n    interpolatedScale = newTx.scale.scale(blend).add(oldTx.scale.scale(1.0 - blend));\n    // Rotational lerp https://stackoverflow.com/a/30129248\n    const cosine = (1.0 - blend) * Math.cos(oldTx.rotation) + blend * Math.cos(newTx.rotation);\n    const sine = (1.0 - blend) * Math.sin(oldTx.rotation) + blend * Math.sin(newTx.rotation);\n    interpolatedRotation = Math.atan2(sine, cosine);\n    const tx = target !== null && target !== void 0 ? target : new transform_Transform();\n    tx.setTransform(interpolatedPos, interpolatedRotation, interpolatedScale);\n    return tx;\n}\n/**\n *\n */\nfunction blendGlobalTransform(oldTx, newTx, blend, target) {\n    let interpolatedPos = newTx.globalPos;\n    let interpolatedScale = newTx.globalScale;\n    let interpolatedRotation = newTx.globalRotation;\n    interpolatedPos = newTx.globalPos.scale(blend).add(oldTx.globalPos.scale(1.0 - blend));\n    interpolatedScale = newTx.globalScale.scale(blend).add(oldTx.globalScale.scale(1.0 - blend));\n    // Rotational lerp https://stackoverflow.com/a/30129248\n    const cosine = (1.0 - blend) * Math.cos(oldTx.globalRotation) + blend * Math.cos(newTx.globalRotation);\n    const sine = (1.0 - blend) * Math.sin(oldTx.globalRotation) + blend * Math.sin(newTx.globalRotation);\n    interpolatedRotation = Math.atan2(sine, cosine);\n    const tx = target !== null && target !== void 0 ? target : new Transform();\n    tx.setTransform(interpolatedPos, interpolatedRotation, interpolatedScale);\n    return tx;\n}\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsSystem.ts\n\n\n\n\n\n // this import seems to bomb wallaby\n\n\n\n\n\n\n\n\nclass GraphicsSystem extends System {\n    get sortedTransforms() {\n        return this._sortedTransforms;\n    }\n    constructor(world) {\n        super();\n        this.world = world;\n        this.systemType = SystemType.Draw;\n        this.priority = SystemPriority.Average;\n        this._token = 0;\n        this._sortedTransforms = [];\n        this._zHasChanged = false;\n        this._zIndexUpdate = () => {\n            this._zHasChanged = true;\n        };\n        this._targetInterpolationTransform = new transform_Transform();\n        this.query = this.world.query([TransformComponent, GraphicsComponent]);\n        this.query.entityAdded$.subscribe(e => {\n            const tx = e.get(TransformComponent);\n            this._sortedTransforms.push(tx);\n            tx.zIndexChanged$.subscribe(this._zIndexUpdate);\n            this._zHasChanged = true;\n        });\n        this.query.entityRemoved$.subscribe(e => {\n            const tx = e.get(TransformComponent);\n            tx.zIndexChanged$.unsubscribe(this._zIndexUpdate);\n            const index = this._sortedTransforms.indexOf(tx);\n            if (index > -1) {\n                this._sortedTransforms.splice(index, 1);\n            }\n        });\n    }\n    initialize(world, scene) {\n        this._camera = scene.camera;\n        this._engine = scene.engine;\n    }\n    preupdate() {\n        // Graphics context could be switched to fallback in a new frame\n        this._graphicsContext = this._engine.graphicsContext;\n        if (this._zHasChanged) {\n            this._sortedTransforms.sort((a, b) => {\n                return a.z - b.z;\n            });\n            this._zHasChanged = false;\n        }\n    }\n    update(delta) {\n        this._token++;\n        let graphics;\n        FontCache.checkAndClearCache();\n        // This is a performance enhancement, most things are in world space\n        // so if we can only do this once saves a ton of transform updates\n        this._graphicsContext.save();\n        if (this._camera) {\n            this._camera.draw(this._graphicsContext);\n        }\n        for (const transform of this._sortedTransforms) {\n            const entity = transform.owner;\n            // If the entity is offscreen skip\n            if (entity.hasTag('ex.offscreen')) {\n                continue;\n            }\n            graphics = entity.get(GraphicsComponent);\n            // Exit if graphics set to not visible\n            if (!graphics.visible) {\n                continue;\n            }\n            // Optionally run the onPreTransformDraw graphics lifecycle draw\n            if (graphics.onPreTransformDraw) {\n                graphics.onPreTransformDraw(this._graphicsContext, delta);\n            }\n            entity.events.emit('pretransformdraw', new PreTransformDrawEvent(this._graphicsContext, delta, entity));\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\n            if (transform.coordPlane === CoordPlane.Screen) {\n                this._graphicsContext.restore();\n            }\n            this._graphicsContext.save();\n            if (transform.coordPlane === CoordPlane.Screen) {\n                this._graphicsContext.translate(this._engine.screen.contentArea.left, this._engine.screen.contentArea.top);\n            }\n            // Tick any graphics state (but only once) for animations and graphics groups\n            graphics.update(delta, this._token);\n            // Apply parallax\n            const parallax = entity.get(ParallaxComponent);\n            if (parallax) {\n                // We use the Tiled formula\n                // https://doc.mapeditor.org/en/latest/manual/layers/#parallax-scrolling-factor\n                // cameraPos * (1 - parallaxFactor)\n                const oneMinusFactor = Vector.One.sub(parallax.parallaxFactor);\n                const parallaxOffset = this._camera.drawPos.scale(oneMinusFactor);\n                this._graphicsContext.translate(parallaxOffset.x, parallaxOffset.y);\n            }\n            // Position the entity + estimate lag\n            this._applyTransform(entity);\n            // If there is a material enable it on the context\n            if (graphics.material) {\n                this._graphicsContext.material = graphics.material;\n            }\n            // Optionally run the onPreDraw graphics lifecycle draw\n            if (graphics.onPreDraw) {\n                graphics.onPreDraw(this._graphicsContext, delta);\n            }\n            entity.events.emit('predraw', new PreDrawEvent(this._graphicsContext, delta, entity));\n            // TODO remove this hack on the particle redo\n            // Remove this line after removing the wallaby import\n            const particleOpacity = (entity instanceof Particle) ? entity.opacity : 1;\n            this._graphicsContext.opacity *= graphics.opacity * particleOpacity;\n            // Draw the graphics component\n            this._drawGraphicsComponent(graphics, transform);\n            // Optionally run the onPostDraw graphics lifecycle draw\n            if (graphics.onPostDraw) {\n                graphics.onPostDraw(this._graphicsContext, delta);\n            }\n            entity.events.emit('postdraw', new PostDrawEvent(this._graphicsContext, delta, entity));\n            this._graphicsContext.restore();\n            // Reset the transform back to the original world space\n            if (transform.coordPlane === CoordPlane.Screen) {\n                this._graphicsContext.save();\n                if (this._camera) {\n                    this._camera.draw(this._graphicsContext);\n                }\n            }\n            // Optionally run the onPreTransformDraw graphics lifecycle draw\n            if (graphics.onPostTransformDraw) {\n                graphics.onPostTransformDraw(this._graphicsContext, delta);\n            }\n            entity.events.emit('posttransformdraw', new PostTransformDrawEvent(this._graphicsContext, delta, entity));\n        }\n        this._graphicsContext.restore();\n    }\n    _drawGraphicsComponent(graphicsComponent, transformComponent) {\n        var _a, _b;\n        if (graphicsComponent.visible) {\n            const flipHorizontal = graphicsComponent.flipHorizontal;\n            const flipVertical = graphicsComponent.flipVertical;\n            const graphic = graphicsComponent.current;\n            const options = (_a = graphicsComponent.currentOptions) !== null && _a !== void 0 ? _a : {};\n            if (graphic) {\n                let anchor = graphicsComponent.anchor;\n                let offset = graphicsComponent.offset;\n                let scaleX = 1;\n                let scaleY = 1;\n                // handle specific overrides\n                if (options === null || options === void 0 ? void 0 : options.anchor) {\n                    anchor = options.anchor;\n                }\n                if (options === null || options === void 0 ? void 0 : options.offset) {\n                    offset = options.offset;\n                }\n                const globalScale = transformComponent.globalScale;\n                scaleX *= graphic.scale.x * globalScale.x;\n                scaleY *= graphic.scale.y * globalScale.y;\n                // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\n                const offsetX = -graphic.width * anchor.x + offset.x * scaleX;\n                const offsetY = -graphic.height * anchor.y + offset.y * scaleY;\n                const oldFlipHorizontal = graphic.flipHorizontal;\n                const oldFlipVertical = graphic.flipVertical;\n                if (flipHorizontal || flipVertical) {\n                    // flip any currently flipped graphics\n                    graphic.flipHorizontal = flipHorizontal ? !oldFlipHorizontal : oldFlipHorizontal;\n                    graphic.flipVertical = flipVertical ? !oldFlipVertical : oldFlipVertical;\n                }\n                graphic === null || graphic === void 0 ? void 0 : graphic.draw(this._graphicsContext, offsetX, offsetY);\n                if (flipHorizontal || flipVertical) {\n                    graphic.flipHorizontal = oldFlipHorizontal;\n                    graphic.flipVertical = oldFlipVertical;\n                }\n                // TODO move debug code out?\n                if (((_b = this._engine) === null || _b === void 0 ? void 0 : _b.isDebug) && this._engine.debug.graphics.showBounds) {\n                    const offset = vec(offsetX, offsetY);\n                    if (graphic instanceof GraphicsGroup) {\n                        for (const member of graphic.members) {\n                            let g;\n                            let pos = Vector.Zero;\n                            if (member instanceof Graphic) {\n                                g = member;\n                            }\n                            else {\n                                g = member.graphic;\n                                pos = member.offset;\n                            }\n                            if (graphic.useAnchor) {\n                                g === null || g === void 0 ? void 0 : g.localBounds.translate(offset.add(pos)).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\n                            }\n                            else {\n                                g === null || g === void 0 ? void 0 : g.localBounds.translate(pos).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\n                            }\n                        }\n                    }\n                    else {\n                        /* istanbul ignore next */\n                        graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(offset).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * This applies the current entity transform to the graphics context\n     * @param entity\n     */\n    _applyTransform(entity) {\n        const ancestors = entity.getAncestors();\n        for (const ancestor of ancestors) {\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\n            const optionalBody = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(BodyComponent);\n            let tx = transform.get();\n            if (optionalBody) {\n                if (this._engine.fixedUpdateFps &&\n                    optionalBody.__oldTransformCaptured &&\n                    optionalBody.enableFixedUpdateInterpolate) {\n                    // Interpolate graphics if needed\n                    const blend = this._engine.currentFrameLagMs / (1000 / this._engine.fixedUpdateFps);\n                    tx = blendTransform(optionalBody.oldTransform, transform.get(), blend, this._targetInterpolationTransform);\n                }\n            }\n            if (transform) {\n                this._graphicsContext.z = transform.z;\n                this._graphicsContext.translate(tx.pos.x, tx.pos.y);\n                this._graphicsContext.scale(tx.scale.x, tx.scale.y);\n                this._graphicsContext.rotate(tx.rotation);\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Debug/DebugSystem.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass DebugSystem extends System {\n    constructor(world) {\n        super();\n        this.world = world;\n        this.systemType = SystemType.Draw;\n        this.priority = SystemPriority.Lowest;\n        this.query = this.world.query([TransformComponent]);\n    }\n    initialize(world, scene) {\n        this._graphicsContext = scene.engine.graphicsContext;\n        this._camera = scene.camera;\n        this._engine = scene.engine;\n        this._collisionSystem = world.systemManager.get(CollisionSystem);\n    }\n    update() {\n        var _a;\n        if (!this._engine.isDebug) {\n            return;\n        }\n        const filterSettings = this._engine.debug.filter;\n        let id;\n        let name;\n        const entitySettings = this._engine.debug.entity;\n        let tx;\n        const txSettings = this._engine.debug.transform;\n        let motion;\n        const motionSettings = this._engine.debug.motion;\n        let colliderComp;\n        const colliderSettings = this._engine.debug.collider;\n        const physicsSettings = this._engine.debug.physics;\n        let graphics;\n        const graphicsSettings = this._engine.debug.graphics;\n        let debugDraw;\n        let body;\n        const bodySettings = this._engine.debug.body;\n        const cameraSettings = this._engine.debug.camera;\n        for (const entity of this.query.entities) {\n            if (entity.hasTag('offscreen')) {\n                // skip offscreen entities\n                continue;\n            }\n            if (entity instanceof Particle) {\n                // Particles crush the renderer :(\n                continue;\n            }\n            if (filterSettings.useFilter) {\n                const allIds = filterSettings.ids.length === 0;\n                const idMatch = allIds || filterSettings.ids.includes(entity.id);\n                if (!idMatch) {\n                    continue;\n                }\n                const allNames = filterSettings.nameQuery === '';\n                const nameMatch = allNames || entity.name.includes(filterSettings.nameQuery);\n                if (!nameMatch) {\n                    continue;\n                }\n            }\n            let cursor = Vector.Zero;\n            const lineHeight = vec(0, 16);\n            id = entity.id;\n            name = entity.name;\n            tx = entity.get(TransformComponent);\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\n            this._pushCameraTransform(tx);\n            this._graphicsContext.save();\n            if (tx.coordPlane === CoordPlane.Screen) {\n                this._graphicsContext.translate(this._engine.screen.contentArea.left, this._engine.screen.contentArea.top);\n            }\n            this._graphicsContext.z = txSettings.debugZIndex;\n            this._applyTransform(entity);\n            if (tx) {\n                if (txSettings.showAll || txSettings.showPosition) {\n                    this._graphicsContext.debug.drawPoint(Vector.Zero, { size: 4, color: txSettings.positionColor });\n                }\n                if (txSettings.showAll || txSettings.showPositionLabel) {\n                    this._graphicsContext.debug.drawText(`pos${tx.pos.toString(2)}`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (txSettings.showAll || txSettings.showZIndex) {\n                    this._graphicsContext.debug.drawText(`z(${tx.z.toFixed(1)})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (entitySettings.showAll || entitySettings.showId) {\n                    this._graphicsContext.debug.drawText(`id(${id}) ${entity.parent ? 'child of id(' + ((_a = entity.parent) === null || _a === void 0 ? void 0 : _a.id) + ')' : ''}`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (entitySettings.showAll || entitySettings.showName) {\n                    this._graphicsContext.debug.drawText(`name(${name})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (txSettings.showAll || txSettings.showRotation) {\n                    this._graphicsContext.drawLine(Vector.Zero, Vector.fromAngle(tx.rotation).scale(50).add(Vector.Zero), txSettings.rotationColor, 2);\n                    this._graphicsContext.debug.drawText(`rot deg(${toDegrees(tx.rotation).toFixed(2)})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (txSettings.showAll || txSettings.showScale) {\n                    this._graphicsContext.drawLine(Vector.Zero, tx.scale.add(Vector.Zero), txSettings.scaleColor, 2);\n                }\n            }\n            graphics = entity.get(GraphicsComponent);\n            if (graphics) {\n                if (graphicsSettings.showAll || graphicsSettings.showBounds) {\n                    const bounds = graphics.localBounds;\n                    bounds.draw(this._graphicsContext, graphicsSettings.boundsColor);\n                }\n            }\n            debugDraw = entity.get(DebugGraphicsComponent);\n            if (debugDraw) {\n                if (!debugDraw.useTransform) {\n                    this._graphicsContext.restore();\n                }\n                debugDraw.draw(this._graphicsContext, this._engine.debug);\n                if (!debugDraw.useTransform) {\n                    this._graphicsContext.save();\n                    this._applyTransform(entity);\n                }\n            }\n            body = entity.get(BodyComponent);\n            if (body) {\n                if (bodySettings.showAll || bodySettings.showCollisionGroup) {\n                    this._graphicsContext.debug.drawText(`collision group(${body.group.name})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (bodySettings.showAll || bodySettings.showCollisionType) {\n                    this._graphicsContext.debug.drawText(`collision type(${body.collisionType})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (bodySettings.showAll || bodySettings.showMass) {\n                    this._graphicsContext.debug.drawText(`mass(${body.mass})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (bodySettings.showAll || bodySettings.showMotion) {\n                    this._graphicsContext.debug.drawText(`motion(${body.sleepMotion})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (bodySettings.showAll || bodySettings.showSleeping) {\n                    this._graphicsContext.debug.drawText(`sleeping(${body.canSleep ? body.sleeping : 'cant sleep'})`, cursor);\n                    cursor = cursor.add(lineHeight);\n                }\n            }\n            this._graphicsContext.restore();\n            // World space\n            this._graphicsContext.save();\n            if (tx.coordPlane === CoordPlane.Screen) {\n                this._graphicsContext.translate(this._engine.screen.contentArea.left, this._engine.screen.contentArea.top);\n            }\n            this._graphicsContext.z = txSettings.debugZIndex;\n            motion = entity.get(MotionComponent);\n            if (motion) {\n                if (motionSettings.showAll || motionSettings.showVelocity) {\n                    this._graphicsContext.debug.drawText(`vel${motion.vel.toString(2)}`, cursor.add(tx.globalPos));\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.vel), motionSettings.velocityColor, 2);\n                    cursor = cursor.add(lineHeight);\n                }\n                if (motionSettings.showAll || motionSettings.showAcceleration) {\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.acc), motionSettings.accelerationColor, 2);\n                }\n            }\n            // Colliders live in world space already so after the restore()\n            colliderComp = entity.get(ColliderComponent);\n            if (colliderComp) {\n                const collider = colliderComp.get();\n                if ((colliderSettings.showAll || colliderSettings.showGeometry) && collider) {\n                    collider.debug(this._graphicsContext, colliderSettings.geometryColor, {\n                        lineWidth: colliderSettings.geometryLineWidth,\n                        pointSize: colliderSettings.geometryPointSize\n                    });\n                }\n                if (colliderSettings.showAll || colliderSettings.showBounds) {\n                    if (collider instanceof CompositeCollider) {\n                        const colliders = collider.getColliders();\n                        for (const collider of colliders) {\n                            const bounds = collider.bounds;\n                            const pos = vec(bounds.left, bounds.top);\n                            this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\n                            if (colliderSettings.showAll || colliderSettings.showOwner) {\n                                this._graphicsContext.debug.drawText(`owner id(${collider.owner.id})`, pos);\n                            }\n                        }\n                        colliderComp.bounds.draw(this._graphicsContext, colliderSettings.boundsColor);\n                    }\n                    else if (collider) {\n                        const bounds = colliderComp.bounds;\n                        const pos = vec(bounds.left, bounds.top);\n                        this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\n                        if (colliderSettings.showAll || colliderSettings.showOwner) {\n                            this._graphicsContext.debug.drawText(`owner id(${colliderComp.owner.id})`, pos);\n                        }\n                    }\n                }\n            }\n            this._graphicsContext.restore();\n            this._popCameraTransform(tx);\n        }\n        this._graphicsContext.save();\n        this._camera.draw(this._graphicsContext);\n        if (physicsSettings.showAll || physicsSettings.showBroadphaseSpacePartitionDebug) {\n            this._collisionSystem.debug(this._graphicsContext);\n        }\n        if (physicsSettings.showAll || physicsSettings.showCollisionContacts || physicsSettings.showCollisionNormals) {\n            for (const [_, contact] of this._engine.debug.stats.currFrame.physics.contacts) {\n                if (physicsSettings.showAll || physicsSettings.showCollisionContacts) {\n                    for (const point of contact.points) {\n                        this._graphicsContext.debug.drawPoint(point, {\n                            size: physicsSettings.contactSize,\n                            color: physicsSettings.collisionContactColor\n                        });\n                    }\n                }\n                if (physicsSettings.showAll || physicsSettings.showCollisionNormals) {\n                    for (const point of contact.points) {\n                        this._graphicsContext.debug.drawLine(point, contact.normal.scale(30).add(point), {\n                            color: physicsSettings.collisionNormalColor\n                        });\n                    }\n                }\n            }\n        }\n        this._graphicsContext.restore();\n        if (cameraSettings) {\n            this._graphicsContext.save();\n            this._camera.draw(this._graphicsContext);\n            if (cameraSettings.showAll || cameraSettings.showFocus) {\n                this._graphicsContext.drawCircle(this._camera.pos, 4, cameraSettings.focusColor);\n            }\n            if (cameraSettings.showAll || cameraSettings.showZoom) {\n                this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`, this._camera.pos);\n            }\n            this._graphicsContext.restore();\n        }\n        this._graphicsContext.flush();\n    }\n    postupdate(engine, elapsedMs) {\n        if (this._engine.isDebug) {\n            this._graphicsContext.save();\n            if (this._camera) {\n                this._camera.draw(this._graphicsContext);\n            }\n            Debug.flush(this._graphicsContext);\n            this._graphicsContext.restore();\n        }\n    }\n    /**\n     * This applies the current entity transform to the graphics context\n     * @param entity\n     */\n    _applyTransform(entity) {\n        const ancestors = entity.getAncestors();\n        for (const ancestor of ancestors) {\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\n            if (transform) {\n                this._graphicsContext.translate(transform.pos.x, transform.pos.y);\n                this._graphicsContext.scale(transform.scale.x, transform.scale.y);\n                this._graphicsContext.rotate(transform.rotation);\n            }\n        }\n    }\n    /**\n     * Applies the current camera transform if in world coordinates\n     * @param transform\n     */\n    _pushCameraTransform(transform) {\n        // Establish camera offset per entity\n        if (transform.coordPlane === CoordPlane.World) {\n            this._graphicsContext.save();\n            if (this._camera) {\n                this._camera.draw(this._graphicsContext);\n            }\n        }\n    }\n    /**\n     * Resets the current camera transform if in world coordinates\n     * @param transform\n     */\n    _popCameraTransform(transform) {\n        if (transform.coordPlane === CoordPlane.World) {\n            // Apply camera world offset\n            this._graphicsContext.restore();\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/PointerSystem.ts\n\n\n\n\n\n/**\n * The PointerSystem is responsible for dispatching pointer events to entities\n * that need them.\n *\n * The PointerSystem can be optionally configured by the [[PointerComponent]], by default Entities use\n * the [[Collider]]'s shape for pointer events.\n */\nclass PointerSystem extends System {\n    constructor(world) {\n        super();\n        this.world = world;\n        this.systemType = SystemType.Update;\n        this.priority = SystemPriority.Higher;\n        /**\n         * Optionally override component configuration for all entities\n         */\n        this.overrideUseColliderShape = false;\n        /**\n         * Optionally override component configuration for all entities\n         */\n        this.overrideUseGraphicsBounds = false;\n        this.lastFrameEntityToPointers = new Map();\n        this.currentFrameEntityToPointers = new Map();\n        this._sortedTransforms = [];\n        this._sortedEntities = [];\n        this._zHasChanged = false;\n        this._zIndexUpdate = () => {\n            this._zHasChanged = true;\n        };\n        this.query = this.world.query([TransformComponent, PointerComponent]);\n        this.query.entityAdded$.subscribe(e => {\n            const tx = e.get(TransformComponent);\n            this._sortedTransforms.push(tx);\n            this._sortedEntities.push(tx.owner);\n            tx.zIndexChanged$.subscribe(this._zIndexUpdate);\n            this._zHasChanged = true;\n        });\n        this.query.entityRemoved$.subscribe(e => {\n            const tx = e.get(TransformComponent);\n            tx.zIndexChanged$.unsubscribe(this._zIndexUpdate);\n            const index = this._sortedTransforms.indexOf(tx);\n            if (index > -1) {\n                this._sortedTransforms.splice(index, 1);\n                this._sortedEntities.splice(index, 1);\n            }\n        });\n    }\n    initialize(world, scene) {\n        this._engine = scene.engine;\n        this._scene = scene;\n    }\n    preupdate() {\n        // event receiver might change per frame\n        this._receivers = [this._engine.input.pointers, this._scene.input.pointers];\n        this._engineReceiver = this._engine.input.pointers;\n        if (this._zHasChanged) {\n            this._sortedTransforms.sort((a, b) => {\n                return b.z - a.z;\n            });\n            this._sortedEntities = this._sortedTransforms.map(t => t.owner);\n            this._zHasChanged = false;\n        }\n    }\n    entityCurrentlyUnderPointer(entity, pointerId) {\n        return this.currentFrameEntityToPointers.has(entity.id) &&\n            this.currentFrameEntityToPointers.get(entity.id).includes(pointerId);\n    }\n    entityWasUnderPointer(entity, pointerId) {\n        return this.lastFrameEntityToPointers.has(entity.id) &&\n            this.lastFrameEntityToPointers.get(entity.id).includes(pointerId);\n    }\n    entered(entity, pointerId) {\n        return this.entityCurrentlyUnderPointer(entity, pointerId) &&\n            !this.lastFrameEntityToPointers.has(entity.id);\n    }\n    left(entity, pointerId) {\n        return !this.currentFrameEntityToPointers.has(entity.id) &&\n            this.entityWasUnderPointer(entity, pointerId);\n    }\n    addPointerToEntity(entity, pointerId) {\n        if (!this.currentFrameEntityToPointers.has(entity.id)) {\n            this.currentFrameEntityToPointers.set(entity.id, [pointerId]);\n            return;\n        }\n        const pointers = this.currentFrameEntityToPointers.get(entity.id);\n        this.currentFrameEntityToPointers.set(entity.id, pointers.concat(pointerId));\n    }\n    update() {\n        // Locate all the pointer/entity mappings\n        this._processPointerToEntity(this._sortedEntities);\n        // Dispatch pointer events on entities\n        this._dispatchEvents(this._sortedEntities);\n        // Clear last frame's events\n        this._receivers.forEach(r => r.update());\n        this.lastFrameEntityToPointers.clear();\n        this.lastFrameEntityToPointers = new Map(this.currentFrameEntityToPointers);\n        this.currentFrameEntityToPointers.clear();\n        this._receivers.forEach(r => r.clear());\n    }\n    _processPointerToEntity(entities) {\n        var _a;\n        let transform;\n        let collider;\n        let graphics;\n        let pointer;\n        const receiver = this._engineReceiver;\n        // TODO probably a spatial partition optimization here to quickly query bounds for pointer\n        // doesn't seem to cause issues tho for perf\n        // Pre-process find entities under pointers\n        for (const entity of entities) {\n            transform = entity.get(TransformComponent);\n            pointer = (_a = entity.get(PointerComponent)) !== null && _a !== void 0 ? _a : new PointerComponent;\n            // If pointer bounds defined\n            if (pointer.localBounds) {\n                const pointerBounds = pointer.localBounds.transform(transform.get().matrix);\n                for (const [pointerId, pos] of receiver.currentFramePointerCoords.entries()) {\n                    if (pointerBounds.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\n                        this.addPointerToEntity(entity, pointerId);\n                    }\n                }\n            }\n            // Check collider contains pointer\n            collider = entity.get(ColliderComponent);\n            if (collider && (pointer.useColliderShape || this.overrideUseColliderShape)) {\n                collider.update();\n                const geom = collider.get();\n                if (geom) {\n                    for (const [pointerId, pos] of receiver.currentFramePointerCoords.entries()) {\n                        if (geom.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\n                            this.addPointerToEntity(entity, pointerId);\n                        }\n                    }\n                }\n            }\n            // Check graphics contains pointer\n            graphics = entity.get(GraphicsComponent);\n            if (graphics && (pointer.useGraphicsBounds || this.overrideUseGraphicsBounds)) {\n                const graphicBounds = graphics.localBounds.transform(transform.get().matrix);\n                for (const [pointerId, pos] of receiver.currentFramePointerCoords.entries()) {\n                    if (graphicBounds.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\n                        this.addPointerToEntity(entity, pointerId);\n                    }\n                }\n            }\n        }\n    }\n    _processDownAndEmit(entity) {\n        const receiver = this._engineReceiver;\n        const lastDownPerPointer = new Map(); // TODO will this get confused between receivers?\n        // Loop through down and dispatch to entities\n        for (const event of receiver.currentFrameDown) {\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\n                entity.events.emit('pointerdown', event);\n                if (receiver.isDragStart(event.pointerId)) {\n                    entity.events.emit('pointerdragstart', event);\n                }\n            }\n            lastDownPerPointer.set(event.pointerId, event);\n        }\n        return lastDownPerPointer;\n    }\n    _processUpAndEmit(entity) {\n        const receiver = this._engineReceiver;\n        const lastUpPerPointer = new Map();\n        // Loop through up and dispatch to entities\n        for (const event of receiver.currentFrameUp) {\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\n                entity.events.emit('pointerup', event);\n                if (receiver.isDragEnd(event.pointerId)) {\n                    entity.events.emit('pointerdragend', event);\n                }\n            }\n            lastUpPerPointer.set(event.pointerId, event);\n        }\n        return lastUpPerPointer;\n    }\n    _processMoveAndEmit(entity) {\n        const receiver = this._engineReceiver;\n        const lastMovePerPointer = new Map();\n        // Loop through move and dispatch to entities\n        for (const event of receiver.currentFrameMove) {\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\n                // move\n                entity.events.emit('pointermove', event);\n                if (receiver.isDragging(event.pointerId)) {\n                    entity.events.emit('pointerdragmove', event);\n                }\n            }\n            lastMovePerPointer.set(event.pointerId, event);\n        }\n        return lastMovePerPointer;\n    }\n    _processEnterLeaveAndEmit(entity, lastUpDownMoveEvents) {\n        const receiver = this._engineReceiver;\n        // up, down, and move are considered for enter and leave\n        for (const event of lastUpDownMoveEvents) {\n            // enter\n            if (event.active && entity.active && this.entered(entity, event.pointerId)) {\n                entity.events.emit('pointerenter', event);\n                if (receiver.isDragging(event.pointerId)) {\n                    entity.events.emit('pointerdragenter', event);\n                }\n                break;\n            }\n            if (event.active && entity.active &&\n                // leave can happen on move\n                (this.left(entity, event.pointerId) ||\n                    // or leave can happen on pointer up\n                    (this.entityCurrentlyUnderPointer(entity, event.pointerId) && event.type === 'up'))) {\n                entity.events.emit('pointerleave', event);\n                if (receiver.isDragging(event.pointerId)) {\n                    entity.events.emit('pointerdragleave', event);\n                }\n                break;\n            }\n        }\n    }\n    _processCancelAndEmit(entity) {\n        const receiver = this._engineReceiver;\n        // cancel\n        for (const event of receiver.currentFrameCancel) {\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\n                entity.events.emit('pointercancel', event);\n            }\n        }\n    }\n    _processWheelAndEmit(entity) {\n        const receiver = this._engineReceiver;\n        // wheel\n        for (const event of receiver.currentFrameWheel) {\n            // Currently the wheel only fires under the primary pointer '0'\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, 0)) {\n                entity.events.emit('pointerwheel', event);\n            }\n        }\n    }\n    _dispatchEvents(entities) {\n        const lastFrameEntities = new Set(this.lastFrameEntityToPointers.keys());\n        const currentFrameEntities = new Set(this.currentFrameEntityToPointers.keys());\n        // Filter preserves z order\n        const entitiesWithEvents = entities.filter(e => lastFrameEntities.has(e.id) || currentFrameEntities.has(e.id));\n        let lastMovePerPointer;\n        let lastUpPerPointer;\n        let lastDownPerPointer;\n        // Dispatch events in entity z order\n        for (const entity of entitiesWithEvents) {\n            lastDownPerPointer = this._processDownAndEmit(entity);\n            lastUpPerPointer = this._processUpAndEmit(entity);\n            lastMovePerPointer = this._processMoveAndEmit(entity);\n            const lastUpDownMoveEvents = [\n                ...lastMovePerPointer.values(),\n                ...lastDownPerPointer.values(),\n                ...lastUpPerPointer.values()\n            ];\n            this._processEnterLeaveAndEmit(entity, lastUpDownMoveEvents);\n            this._processCancelAndEmit(entity);\n            this._processWheelAndEmit(entity);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/ActionsSystem.ts\n\n\n\nclass ActionsSystem extends System {\n    constructor(world) {\n        super();\n        this.world = world;\n        this.systemType = SystemType.Update;\n        this.priority = SystemPriority.Higher;\n        this._actions = [];\n        this.query = this.world.query([ActionsComponent]);\n        this.query.entityAdded$.subscribe(e => this._actions.push(e.get(ActionsComponent)));\n        this.query.entityRemoved$.subscribe(e => {\n            const action = e.get(ActionsComponent);\n            const index = this._actions.indexOf(action);\n            if (index > -1) {\n                this._actions.splice(index, 1);\n            }\n        });\n    }\n    update(delta) {\n        for (const actions of this._actions) {\n            actions.update(delta);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./TileMap/IsometricEntityComponent.ts\n\nclass IsometricEntityComponent extends Component {\n    /**\n     * Specify the isometric map to use to position this entity's z-index\n     * @param mapOrOptions\n     */\n    constructor(mapOrOptions) {\n        super();\n        /**\n         * Vertical \"height\" in the isometric world\n         */\n        this.elevation = 0;\n        this.columns = mapOrOptions.columns;\n        this.rows = mapOrOptions.rows;\n        this.tileWidth = mapOrOptions.tileWidth;\n        this.tileHeight = mapOrOptions.tileHeight;\n    }\n}\n\n;// CONCATENATED MODULE: ./TileMap/IsometricEntitySystem.ts\n\n\n\n\nclass IsometricEntitySystem extends System {\n    constructor(world) {\n        super();\n        this.world = world;\n        this.systemType = SystemType.Update;\n        this.priority = SystemPriority.Lower;\n        this.query = this.world.query([TransformComponent, IsometricEntityComponent]);\n    }\n    update() {\n        let transform;\n        let iso;\n        for (const entity of this.query.entities) {\n            transform = entity.get(TransformComponent);\n            iso = entity.get(IsometricEntityComponent);\n            const maxZindexPerElevation = Math.max(iso.columns * iso.tileWidth, iso.rows * iso.tileHeight);\n            const newZ = maxZindexPerElevation * iso.elevation + transform.pos.y;\n            transform.z = newZ;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/OffscreenSystem.ts\n\n\n\n\n\n\n\n\nclass OffscreenSystem extends System {\n    constructor(world) {\n        super();\n        this.world = world;\n        this.systemType = SystemType.Draw;\n        this.priority = SystemPriority.Higher;\n        this.query = this.world.query([TransformComponent, GraphicsComponent]);\n    }\n    initialize(world, scene) {\n        this._camera = scene.camera;\n        this._screen = scene.engine.screen;\n    }\n    update() {\n        this._worldBounds = this._screen.getWorldBounds();\n        let transform;\n        let graphics;\n        let maybeParallax;\n        for (const entity of this.query.entities) {\n            graphics = entity.get(GraphicsComponent);\n            transform = entity.get(TransformComponent);\n            maybeParallax = entity.get(ParallaxComponent);\n            let parallaxOffset;\n            if (maybeParallax) {\n                // We use the Tiled formula\n                // https://doc.mapeditor.org/en/latest/manual/layers/#parallax-scrolling-factor\n                // cameraPos * (1 - parallaxFactor)\n                const oneMinusFactor = Vector.One.sub(maybeParallax.parallaxFactor);\n                parallaxOffset = this._camera.pos.scale(oneMinusFactor);\n            }\n            // Figure out if entities are offscreen\n            const entityOffscreen = this._isOffscreen(transform, graphics, parallaxOffset);\n            if (entityOffscreen && !entity.hasTag('ex.offscreen')) {\n                entity.events.emit('exitviewport', new ExitViewPortEvent(entity));\n                entity.addTag('ex.offscreen');\n            }\n            if (!entityOffscreen && entity.hasTag('ex.offscreen')) {\n                entity.events.emit('enterviewport', new EnterViewPortEvent(entity));\n                entity.removeTag('ex.offscreen');\n            }\n        }\n    }\n    _isOffscreen(transform, graphics, parallaxOffset) {\n        if (transform.coordPlane === CoordPlane.World) {\n            let bounds = graphics.localBounds;\n            if (parallaxOffset) {\n                bounds = bounds.translate(parallaxOffset);\n            }\n            const transformedBounds = bounds.transform(transform.get().matrix);\n            const graphicsOffscreen = !this._worldBounds.overlaps(transformedBounds);\n            return graphicsOffscreen;\n        }\n        else {\n            // TODO screen coordinates\n            return false;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/PhysicsWorld.ts\n\n\n\n\nclass PhysicsWorld {\n    get config() {\n        return watchDeep(this._config, change => {\n            this.$configUpdate.notifyAll(change);\n        });\n    }\n    set config(newConfig) {\n        this._config = newConfig;\n        this.$configUpdate.notifyAll(newConfig);\n    }\n    /**\n     * Spatial data structure for locating potential collision pairs and ray casts\n     */\n    get collisionProcessor() {\n        if (this._configDirty) {\n            this._configDirty = false;\n            // preserve tracked colliders if config updates\n            const colliders = this._collisionProcessor.getColliders();\n            this._collisionProcessor = new DynamicTreeCollisionProcessor(this._config);\n            for (const collider of colliders) {\n                this._collisionProcessor.track(collider);\n            }\n        }\n        return this._collisionProcessor;\n    }\n    constructor(config) {\n        this.$configUpdate = new Observable;\n        this._configDirty = false;\n        this.config = config;\n        this.$configUpdate.subscribe((config) => {\n            this._configDirty = true;\n            BodyComponent.updateDefaultPhysicsConfig(config.bodies);\n        });\n        this._collisionProcessor = new DynamicTreeCollisionProcessor(this.config);\n    }\n    /**\n     * Raycast into the scene's physics world\n     * @param ray\n     * @param options\n     */\n    rayCast(ray, options) {\n        return this.collisionProcessor.rayCast(ray, options);\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/Gamepad.ts\n\n\nconst GamepadEvents = {\n    GamepadConnect: 'connect',\n    GamepadDisconnect: 'disconnect',\n    GamepadButton: 'button',\n    GamepadAxis: 'axis'\n};\n/**\n * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)\n * to provide controller support for your games.\n */\nclass Gamepads {\n    constructor() {\n        this.events = new EventEmitter();\n        /**\n         * Whether or not to poll for Gamepad input (default: `false`)\n         */\n        this.enabled = false;\n        /**\n         * Whether or not Gamepad API is supported\n         */\n        this.supported = !!navigator.getGamepads;\n        this._gamePadTimeStamps = [0, 0, 0, 0];\n        this._oldPads = [];\n        this._pads = [];\n        this._initSuccess = false;\n        this._navigator = navigator;\n        this._minimumConfiguration = null;\n        this._enabled = true;\n    }\n    init() {\n        if (!this.supported) {\n            return;\n        }\n        if (this._initSuccess) {\n            return;\n        }\n        // In Chrome, this will return 4 undefined items until a button is pressed\n        // In FF, this will not return any items until a button is pressed\n        this._oldPads = this._clonePads(this._navigator.getGamepads());\n        if (this._oldPads.length && this._oldPads[0]) {\n            this._initSuccess = true;\n        }\n    }\n    toggleEnabled(enabled) {\n        this._enabled = enabled;\n    }\n    /**\n     * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means\n     * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive\n     * all other controllers with more axis or buttons are valid as well. If no minimum\n     * configuration is set all pads are valid.\n     */\n    setMinimumGamepadConfiguration(config) {\n        this._enableAndUpdate(); // if config is used, implicitly enable\n        this._minimumConfiguration = config;\n    }\n    /**\n     * When implicitly enabled, set the enabled flag and run an update so information is updated\n     */\n    _enableAndUpdate() {\n        if (!this.enabled) {\n            this.enabled = true;\n            this.update();\n        }\n    }\n    /**\n     * Checks a navigator gamepad against the minimum configuration if present.\n     */\n    _isGamepadValid(pad) {\n        if (!this._minimumConfiguration) {\n            return true;\n        }\n        if (!pad) {\n            return false;\n        }\n        const axesLength = pad.axes.filter((value) => {\n            return typeof value !== undefined;\n        }).length;\n        const buttonLength = pad.buttons.filter((value) => {\n            return typeof value !== undefined;\n        }).length;\n        return axesLength >= this._minimumConfiguration.axis && buttonLength >= this._minimumConfiguration.buttons && pad.connected;\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        this._enableAndUpdate(); // implicitly enable\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this._enableAndUpdate(); // implicitly enable\n        this.events.off(eventName, handler);\n    }\n    /**\n     * Updates Gamepad state and publishes Gamepad events\n     */\n    update() {\n        if (!this.enabled || !this.supported) {\n            return;\n        }\n        if (!this._enabled) {\n            return;\n        }\n        this.init();\n        const gamepads = this._navigator.getGamepads();\n        for (let i = 0; i < gamepads.length; i++) {\n            if (!gamepads[i]) {\n                const gamepad = this.at(i);\n                // If was connected, but now isn't emit the disconnect event\n                if (gamepad.connected) {\n                    this.events.emit('disconnect', new GamepadDisconnectEvent(i, gamepad));\n                }\n                // Reset connection status\n                gamepad.connected = false;\n                continue;\n            }\n            else {\n                if (!this.at(i).connected && this._isGamepadValid(gamepads[i])) {\n                    this.events.emit('connect', new GamepadConnectEvent(i, this.at(i)));\n                }\n                // Set connection status\n                this.at(i).connected = true;\n            }\n            this.at(i).update();\n            // Only supported in Chrome\n            if (gamepads[i].timestamp && gamepads[i].timestamp === this._gamePadTimeStamps[i]) {\n                continue;\n            }\n            this._gamePadTimeStamps[i] = gamepads[i].timestamp;\n            // Add reference to navigator gamepad\n            this.at(i).navigatorGamepad = gamepads[i];\n            // Buttons\n            let b, bi, a, ai, value;\n            for (b in Buttons) {\n                bi = Buttons[b];\n                if (typeof bi === 'number') {\n                    if (gamepads[i].buttons[bi]) {\n                        value = gamepads[i].buttons[bi].value;\n                        if (value !== this._oldPads[i].getButton(bi)) {\n                            if (gamepads[i].buttons[bi].pressed) {\n                                this.at(i).updateButton(bi, value);\n                                this.at(i).events.emit('button', new GamepadButtonEvent(bi, value, this.at(i)));\n                            }\n                            else {\n                                this.at(i).updateButton(bi, 0);\n                            }\n                        }\n                    }\n                }\n            }\n            // Axes\n            for (a in Axes) {\n                ai = Axes[a];\n                if (typeof ai === 'number') {\n                    value = gamepads[i].axes[ai];\n                    if (value !== this._oldPads[i].getAxes(ai)) {\n                        this.at(i).updateAxes(ai, value);\n                        this.at(i).events.emit('axis', new GamepadAxisEvent(ai, value, this.at(i)));\n                    }\n                }\n            }\n            this._oldPads[i] = this._clonePad(gamepads[i]);\n        }\n    }\n    /**\n     * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist\n     */\n    at(index) {\n        this._enableAndUpdate(); // implicitly enable gamepads when at() is called\n        if (index >= this._pads.length) {\n            // Ensure there is a pad to retrieve\n            for (let i = this._pads.length - 1, max = index; i < max; i++) {\n                this._pads.push(new Gamepad());\n                this._oldPads.push(new Gamepad());\n            }\n        }\n        return this._pads[index];\n    }\n    /**\n     * Returns a list of all valid gamepads that meet the minimum configuration requirement.\n     */\n    getValidGamepads() {\n        this._enableAndUpdate();\n        const result = [];\n        for (let i = 0; i < this._pads.length; i++) {\n            if (this._isGamepadValid(this.at(i).navigatorGamepad) && this.at(i).connected) {\n                result.push(this.at(i));\n            }\n        }\n        return result;\n    }\n    /**\n     * Gets the number of connected gamepads\n     */\n    count() {\n        return this._pads.filter((p) => p.connected).length;\n    }\n    _clonePads(pads) {\n        const arr = [];\n        for (let i = 0, len = pads.length; i < len; i++) {\n            arr.push(this._clonePad(pads[i]));\n        }\n        return arr;\n    }\n    /**\n     * Fastest way to clone a known object is to do it yourself\n     */\n    _clonePad(pad) {\n        let i, len;\n        const clonedPad = new Gamepad();\n        if (!pad) {\n            return clonedPad;\n        }\n        for (i = 0, len = pad.buttons.length; i < len; i++) {\n            if (pad.buttons[i]) {\n                clonedPad.updateButton(i, pad.buttons[i].value);\n            }\n        }\n        for (i = 0, len = pad.axes.length; i < len; i++) {\n            clonedPad.updateAxes(i, pad.axes[i]);\n        }\n        return clonedPad;\n    }\n}\n/**\n * The minimum value an axis has to move before considering it a change\n */\nGamepads.MinAxisMoveThreshold = 0.05;\n/**\n * Gamepad holds state information for a connected controller. See [[Gamepads]]\n * for more information on handling controller input.\n */\nclass Gamepad {\n    constructor() {\n        this.events = new EventEmitter();\n        this.connected = false;\n        this._axes = new Array(4);\n        this._buttons = new Array(16);\n        this._buttonsUp = new Array(16);\n        this._buttonsDown = new Array(16);\n        for (let i = 0; i < this._buttons.length; i++) {\n            this._buttons[i] = 0;\n        }\n        for (let i = 0; i < this._axes.length; i++) {\n            this._axes[i] = 0;\n        }\n    }\n    update() {\n        // Reset buttonsDown and buttonsUp after update is complete\n        this._buttonsDown = new Array(16);\n        this._buttonsUp = new Array(16);\n    }\n    /**\n     * Whether or not the given button is pressed\n     * @deprecated will be removed in v0.28.0. Use isButtonHeld instead\n     * @param button     The button to query\n     * @param threshold  The threshold over which the button is considered to be pressed\n     */\n    isButtonPressed(button, threshold = 1) {\n        return this._buttons[button] >= threshold;\n    }\n    /**\n     * Tests if a certain button is held down. This is persisted between frames.\n     * @param button     The button to query\n     * @param threshold  The threshold over which the button is considered to be pressed\n     */\n    isButtonHeld(button, threshold = 1) {\n        return this._buttons[button] >= threshold;\n    }\n    /**\n     * Tests if a certain button was just pressed this frame. This is cleared at the end of the update frame.\n     * @param button Test whether a button was just pressed\n     * @param threshold  The threshold over which the button is considered to be pressed\n     */\n    wasButtonPressed(button, threshold = 1) {\n        return this._buttonsDown[button] >= threshold;\n    }\n    /**\n     * Tests if a certain button was just released this frame. This is cleared at the end of the update frame.\n     * @param button  Test whether a button was just released\n     */\n    wasButtonReleased(button) {\n        return Boolean(this._buttonsUp[button]);\n    }\n    /**\n     * Gets the given button value between 0 and 1\n     */\n    getButton(button) {\n        return this._buttons[button];\n    }\n    /**\n     * Gets the given axis value between -1 and 1. Values below\n     * [[MinAxisMoveThreshold]] are considered 0.\n     */\n    getAxes(axes) {\n        const value = this._axes[axes];\n        if (Math.abs(value) < Gamepads.MinAxisMoveThreshold) {\n            return 0;\n        }\n        else {\n            return value;\n        }\n    }\n    updateButton(buttonIndex, value) {\n        // button was just released\n        if (value === 0 && this._buttons[buttonIndex]) {\n            this._buttonsUp[buttonIndex] = 1;\n            // button was just pressed\n        }\n        else {\n            this._buttonsDown[buttonIndex] = value;\n        }\n        this._buttons[buttonIndex] = value;\n    }\n    updateAxes(axesIndex, value) {\n        this._axes[axesIndex] = value;\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n}\n/**\n * Gamepad Buttons enumeration\n */\nvar Buttons;\n(function (Buttons) {\n    /**\n     * Face 1 button (e.g. A)\n     */\n    Buttons[Buttons[\"Face1\"] = 0] = \"Face1\";\n    /**\n     * Face 2 button (e.g. B)\n     */\n    Buttons[Buttons[\"Face2\"] = 1] = \"Face2\";\n    /**\n     * Face 3 button (e.g. X)\n     */\n    Buttons[Buttons[\"Face3\"] = 2] = \"Face3\";\n    /**\n     * Face 4 button (e.g. Y)\n     */\n    Buttons[Buttons[\"Face4\"] = 3] = \"Face4\";\n    /**\n     * Left bumper button\n     */\n    Buttons[Buttons[\"LeftBumper\"] = 4] = \"LeftBumper\";\n    /**\n     * Right bumper button\n     */\n    Buttons[Buttons[\"RightBumper\"] = 5] = \"RightBumper\";\n    /**\n     * Left trigger button\n     */\n    Buttons[Buttons[\"LeftTrigger\"] = 6] = \"LeftTrigger\";\n    /**\n     * Right trigger button\n     */\n    Buttons[Buttons[\"RightTrigger\"] = 7] = \"RightTrigger\";\n    /**\n     * Select button\n     */\n    Buttons[Buttons[\"Select\"] = 8] = \"Select\";\n    /**\n     * Start button\n     */\n    Buttons[Buttons[\"Start\"] = 9] = \"Start\";\n    /**\n     * Left analog stick press (e.g. L3)\n     */\n    Buttons[Buttons[\"LeftStick\"] = 10] = \"LeftStick\";\n    /**\n     * Right analog stick press (e.g. R3)\n     */\n    Buttons[Buttons[\"RightStick\"] = 11] = \"RightStick\";\n    /**\n     * D-pad up\n     */\n    Buttons[Buttons[\"DpadUp\"] = 12] = \"DpadUp\";\n    /**\n     * D-pad down\n     */\n    Buttons[Buttons[\"DpadDown\"] = 13] = \"DpadDown\";\n    /**\n     * D-pad left\n     */\n    Buttons[Buttons[\"DpadLeft\"] = 14] = \"DpadLeft\";\n    /**\n     * D-pad right\n     */\n    Buttons[Buttons[\"DpadRight\"] = 15] = \"DpadRight\";\n})(Buttons || (Buttons = {}));\n/**\n * Gamepad Axes enumeration\n */\nvar Axes;\n(function (Axes) {\n    /**\n     * Left analogue stick X direction\n     */\n    Axes[Axes[\"LeftStickX\"] = 0] = \"LeftStickX\";\n    /**\n     * Left analogue stick Y direction\n     */\n    Axes[Axes[\"LeftStickY\"] = 1] = \"LeftStickY\";\n    /**\n     * Right analogue stick X direction\n     */\n    Axes[Axes[\"RightStickX\"] = 2] = \"RightStickX\";\n    /**\n     * Right analogue stick Y direction\n     */\n    Axes[Axes[\"RightStickY\"] = 3] = \"RightStickY\";\n})(Axes || (Axes = {}));\n\n;// CONCATENATED MODULE: ./Input/InputMapper.ts\n/**\n * This allows you to map multiple inputs to specific commands! This is especially useful when\n * you need to allow multiple input sources to control a specific action.\n */\nclass InputMapper {\n    constructor(inputs) {\n        this.inputs = inputs;\n        this._handlers = new Map();\n    }\n    /**\n     * Executes the input map, called internally by Excalibur\n     */\n    execute() {\n        for (const [input, command] of this._handlers.entries()) {\n            const results = input(this.inputs);\n            if (results) {\n                command(results);\n            }\n        }\n    }\n    /**\n     * This allows you to map multiple inputs to specific commands! This is useful\n     *\n     * The inputHandler should return a truthy value if you wish the commandHandler to fire.\n     *\n     * Example:\n     * ```typescript\n     * const moveRight = (amount: number) => { actor.vel.x = 100 * amount }\n     * const moveLeft = (amount: number) => { actor.vel.x = -100 * amount }\n     * const moveUp = (amount: number) => { actor.vel.y = -100 * amount }\n     * const moveDown = (amount: number) => { actor.vel.y = 100 * amount }\n     *\n     * engine.inputMapper.on(({keyboard}) => keyboard.isHeld(ex.Keys.ArrowRight) ? 1 : 0, moveRight);\n     * engine.inputMapper.on(({gamepads}) => gamepads.at(0).isButtonPressed(ex.Buttons.DpadRight) ? 1 : 0, moveRight);\n     * engine.inputMapper.on(({gamepads}) => gamepads.at(0).getAxes(ex.Axes.LeftStickX) > 0 ?\n     *  gamepads.at(0).getAxes(ex.Axes.LeftStickX) : 0, moveRight);\n     * ```\n     * @param inputHandler\n     * @param commandHandler\n     */\n    on(inputHandler, commandHandler) {\n        this._handlers.set(inputHandler, commandHandler);\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/IFrame.ts\n/**\n * Checks if excalibur is in a x-origin iframe\n */\nfunction isCrossOriginIframe() {\n    try {\n        // Try and listen to events on top window frame if within an iframe.\n        //\n        // See https://github.com/excaliburjs/Excalibur/issues/1294\n        //\n        // Attempt to add an event listener, which triggers a DOMException on\n        // cross-origin iframes\n        const noop = () => {\n            return;\n        };\n        window.top.addEventListener('blur', noop);\n        window.top.removeEventListener('blur', noop);\n    }\n    catch (_a) {\n        return true;\n    }\n    return false;\n}\n\n;// CONCATENATED MODULE: ./Input/Keyboard.ts\n\n\n\n\n/**\n * Enum representing physical input key codes\n */\nvar Keys;\n(function (Keys) {\n    // NUMPAD\n    Keys[\"Num0\"] = \"Numpad0\";\n    Keys[\"Num1\"] = \"Numpad1\";\n    Keys[\"Num2\"] = \"Numpad2\";\n    Keys[\"Num3\"] = \"Numpad3\";\n    Keys[\"Num4\"] = \"Numpad4\";\n    Keys[\"Num5\"] = \"Numpad5\";\n    Keys[\"Num6\"] = \"Numpad6\";\n    Keys[\"Num7\"] = \"Numpad7\";\n    Keys[\"Num8\"] = \"Numpad8\";\n    Keys[\"Num9\"] = \"Numpad9\";\n    Keys[\"NumAdd\"] = \"NumpadAdd\";\n    Keys[\"NumSubtract\"] = \"NumpadSubtract\";\n    Keys[\"NumMultiply\"] = \"NumpadMultiply\";\n    Keys[\"NumDivide\"] = \"NumpadDivide\";\n    // NumComma = 'NumpadComma', // not x-browser\n    Keys[\"NumDecimal\"] = \"NumpadDecimal\";\n    Keys[\"Numpad0\"] = \"Numpad0\";\n    Keys[\"Numpad1\"] = \"Numpad1\";\n    Keys[\"Numpad2\"] = \"Numpad2\";\n    Keys[\"Numpad3\"] = \"Numpad3\";\n    Keys[\"Numpad4\"] = \"Numpad4\";\n    Keys[\"Numpad5\"] = \"Numpad5\";\n    Keys[\"Numpad6\"] = \"Numpad6\";\n    Keys[\"Numpad7\"] = \"Numpad7\";\n    Keys[\"Numpad8\"] = \"Numpad8\";\n    Keys[\"Numpad9\"] = \"Numpad9\";\n    Keys[\"NumpadAdd\"] = \"NumpadAdd\";\n    Keys[\"NumpadSubtract\"] = \"NumpadSubtract\";\n    Keys[\"NumpadMultiply\"] = \"NumpadMultiply\";\n    Keys[\"NumpadDivide\"] = \"NumpadDivide\";\n    // NumpadComma = 'NumpadComma', // not x-browser\n    Keys[\"NumpadDecimal\"] = \"NumpadDecimal\";\n    // MODIFIERS\n    Keys[\"NumLock\"] = \"NumLock\";\n    Keys[\"ShiftLeft\"] = \"ShiftLeft\";\n    Keys[\"ShiftRight\"] = \"ShiftRight\";\n    Keys[\"AltLeft\"] = \"AltLeft\";\n    Keys[\"AltRight\"] = \"AltRight\";\n    Keys[\"ControlLeft\"] = \"ControlLeft\";\n    Keys[\"ControlRight\"] = \"ControlRight\";\n    Keys[\"MetaLeft\"] = \"MetaLeft\";\n    Keys[\"MetaRight\"] = \"MetaRight\";\n    // NUMBERS\n    Keys[\"Key0\"] = \"Digit0\";\n    Keys[\"Key1\"] = \"Digit1\";\n    Keys[\"Key2\"] = \"Digit2\";\n    Keys[\"Key3\"] = \"Digit3\";\n    Keys[\"Key4\"] = \"Digit4\";\n    Keys[\"Key5\"] = \"Digit5\";\n    Keys[\"Key6\"] = \"Digit6\";\n    Keys[\"Key7\"] = \"Digit7\";\n    Keys[\"Key8\"] = \"Digit8\";\n    Keys[\"Key9\"] = \"Digit9\";\n    Keys[\"Digit0\"] = \"Digit0\";\n    Keys[\"Digit1\"] = \"Digit1\";\n    Keys[\"Digit2\"] = \"Digit2\";\n    Keys[\"Digit3\"] = \"Digit3\";\n    Keys[\"Digit4\"] = \"Digit4\";\n    Keys[\"Digit5\"] = \"Digit5\";\n    Keys[\"Digit6\"] = \"Digit6\";\n    Keys[\"Digit7\"] = \"Digit7\";\n    Keys[\"Digit8\"] = \"Digit8\";\n    Keys[\"Digit9\"] = \"Digit9\";\n    // FUNCTION KEYS\n    Keys[\"F1\"] = \"F1\";\n    Keys[\"F2\"] = \"F2\";\n    Keys[\"F3\"] = \"F3\";\n    Keys[\"F4\"] = \"F4\";\n    Keys[\"F5\"] = \"F5\";\n    Keys[\"F6\"] = \"F6\";\n    Keys[\"F7\"] = \"F7\";\n    Keys[\"F8\"] = \"F8\";\n    Keys[\"F9\"] = \"F9\";\n    Keys[\"F10\"] = \"F10\";\n    Keys[\"F11\"] = \"F11\";\n    Keys[\"F12\"] = \"F12\";\n    // LETTERS\n    Keys[\"A\"] = \"KeyA\";\n    Keys[\"B\"] = \"KeyB\";\n    Keys[\"C\"] = \"KeyC\";\n    Keys[\"D\"] = \"KeyD\";\n    Keys[\"E\"] = \"KeyE\";\n    Keys[\"F\"] = \"KeyF\";\n    Keys[\"G\"] = \"KeyG\";\n    Keys[\"H\"] = \"KeyH\";\n    Keys[\"I\"] = \"KeyI\";\n    Keys[\"J\"] = \"KeyJ\";\n    Keys[\"K\"] = \"KeyK\";\n    Keys[\"L\"] = \"KeyL\";\n    Keys[\"M\"] = \"KeyM\";\n    Keys[\"N\"] = \"KeyN\";\n    Keys[\"O\"] = \"KeyO\";\n    Keys[\"P\"] = \"KeyP\";\n    Keys[\"Q\"] = \"KeyQ\";\n    Keys[\"R\"] = \"KeyR\";\n    Keys[\"S\"] = \"KeyS\";\n    Keys[\"T\"] = \"KeyT\";\n    Keys[\"U\"] = \"KeyU\";\n    Keys[\"V\"] = \"KeyV\";\n    Keys[\"W\"] = \"KeyW\";\n    Keys[\"X\"] = \"KeyX\";\n    Keys[\"Y\"] = \"KeyY\";\n    Keys[\"Z\"] = \"KeyZ\";\n    Keys[\"KeyA\"] = \"KeyA\";\n    Keys[\"KeyB\"] = \"KeyB\";\n    Keys[\"KeyC\"] = \"KeyC\";\n    Keys[\"KeyD\"] = \"KeyD\";\n    Keys[\"KeyE\"] = \"KeyE\";\n    Keys[\"KeyF\"] = \"KeyF\";\n    Keys[\"KeyG\"] = \"KeyG\";\n    Keys[\"KeyH\"] = \"KeyH\";\n    Keys[\"KeyI\"] = \"KeyI\";\n    Keys[\"KeyJ\"] = \"KeyJ\";\n    Keys[\"KeyK\"] = \"KeyK\";\n    Keys[\"KeyL\"] = \"KeyL\";\n    Keys[\"KeyM\"] = \"KeyM\";\n    Keys[\"KeyN\"] = \"KeyN\";\n    Keys[\"KeyO\"] = \"KeyO\";\n    Keys[\"KeyP\"] = \"KeyP\";\n    Keys[\"KeyQ\"] = \"KeyQ\";\n    Keys[\"KeyR\"] = \"KeyR\";\n    Keys[\"KeyS\"] = \"KeyS\";\n    Keys[\"KeyT\"] = \"KeyT\";\n    Keys[\"KeyU\"] = \"KeyU\";\n    Keys[\"KeyV\"] = \"KeyV\";\n    Keys[\"KeyW\"] = \"KeyW\";\n    Keys[\"KeyX\"] = \"KeyX\";\n    Keys[\"KeyY\"] = \"KeyY\";\n    Keys[\"KeyZ\"] = \"KeyZ\";\n    // SYMBOLS\n    Keys[\"Semicolon\"] = \"Semicolon\";\n    Keys[\"Quote\"] = \"Quote\";\n    Keys[\"Comma\"] = \"Comma\";\n    Keys[\"Minus\"] = \"Minus\";\n    Keys[\"Period\"] = \"Period\";\n    Keys[\"Slash\"] = \"Slash\";\n    Keys[\"Equal\"] = \"Equal\";\n    Keys[\"BracketLeft\"] = \"BracketLeft\";\n    Keys[\"Backslash\"] = \"Backslash\";\n    Keys[\"BracketRight\"] = \"BracketRight\";\n    Keys[\"Backquote\"] = \"Backquote\";\n    // DIRECTIONS\n    Keys[\"Up\"] = \"ArrowUp\";\n    Keys[\"Down\"] = \"ArrowDown\";\n    Keys[\"Left\"] = \"ArrowLeft\";\n    Keys[\"Right\"] = \"ArrowRight\";\n    Keys[\"ArrowUp\"] = \"ArrowUp\";\n    Keys[\"ArrowDown\"] = \"ArrowDown\";\n    Keys[\"ArrowLeft\"] = \"ArrowLeft\";\n    Keys[\"ArrowRight\"] = \"ArrowRight\";\n    // OTHER\n    Keys[\"Space\"] = \"Space\";\n    Keys[\"Backspace\"] = \"Backspace\";\n    Keys[\"Delete\"] = \"Delete\";\n    Keys[\"Esc\"] = \"Escape\";\n    Keys[\"Escape\"] = \"Escape\";\n    Keys[\"Enter\"] = \"Enter\";\n    Keys[\"NumpadEnter\"] = \"NumpadEnter\";\n    Keys[\"ContextMenu\"] = \"ContextMenu\";\n})(Keys || (Keys = {}));\n/**\n * Event thrown on a game object for a key event\n */\nclass KeyEvent extends GameEvent {\n    /**\n     * @param key  The key responsible for throwing the event\n     * @param value The key's typed value the browser detected\n     * @param originalEvent The original keyboard event that Excalibur handled\n     */\n    constructor(key, value, originalEvent) {\n        super();\n        this.key = key;\n        this.value = value;\n        this.originalEvent = originalEvent;\n    }\n}\nconst KeyEvents = {\n    Press: 'press',\n    Hold: 'hold',\n    Release: 'release'\n};\n/**\n * Provides keyboard support for Excalibur.\n */\nclass Keyboard {\n    constructor() {\n        this.events = new EventEmitter();\n        this._enabled = true;\n        /**\n         * Keys that are currently held down\n         */\n        this._keys = [];\n        /**\n         * Keys up in the current frame\n         */\n        this._keysUp = [];\n        /**\n         * Keys down in the current frame\n         */\n        this._keysDown = [];\n        this._releaseAllKeys = (ev) => {\n            for (const code of this._keys) {\n                const keyEvent = new KeyEvent(code, ev.key, ev);\n                this.events.emit('up', keyEvent);\n                this.events.emit('release', keyEvent);\n            }\n            this._keysUp = Array.from((new Set(this._keys.concat(this._keysUp))));\n            this._keys.length = 0;\n        };\n        this._handleKeyDown = (ev) => {\n            if (!this._enabled) {\n                return;\n            }\n            // handle macos meta key issue\n            // https://github.com/excaliburjs/Excalibur/issues/2608\n            if (!ev.metaKey && (this._keys.includes(Keys.MetaLeft) || this._keys.includes(Keys.MetaRight))) {\n                this._releaseAllKeys(ev);\n            }\n            const code = ev.code;\n            if (this._keys.indexOf(code) === -1) {\n                this._keys.push(code);\n                this._keysDown.push(code);\n                const keyEvent = new KeyEvent(code, ev.key, ev);\n                this.events.emit('down', keyEvent);\n                this.events.emit('press', keyEvent);\n            }\n        };\n        this._handleKeyUp = (ev) => {\n            if (!this._enabled) {\n                return;\n            }\n            const code = ev.code;\n            const key = this._keys.indexOf(code);\n            this._keys.splice(key, 1);\n            this._keysUp.push(code);\n            const keyEvent = new KeyEvent(code, ev.key, ev);\n            // alias the old api, we may want to deprecate this in the future\n            this.events.emit('up', keyEvent);\n            this.events.emit('release', keyEvent);\n            // handle macos meta key issue\n            // https://github.com/excaliburjs/Excalibur/issues/2608\n            if (ev.key === 'Meta') {\n                this._releaseAllKeys(ev);\n            }\n        };\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n    /**\n     * Initialize Keyboard event listeners\n     */\n    init(keyboardOptions) {\n        let { global } = keyboardOptions;\n        const { grabWindowFocus } = keyboardOptions;\n        if (!global) {\n            if (isCrossOriginIframe()) {\n                global = window;\n                // Workaround for iframes like for itch.io or codesandbox\n                // https://www.reddit.com/r/gamemaker/comments/kfs5cs/keyboard_inputs_no_longer_working_in_html5_game/\n                // https://forum.gamemaker.io/index.php?threads/solved-keyboard-issue-on-itch-io.87336/\n                if (grabWindowFocus) {\n                    window.focus();\n                }\n                Logger.getInstance().warn('Excalibur might be in a cross-origin iframe, in order to receive keyboard events it must be in focus');\n            }\n            else {\n                global = window.top;\n            }\n        }\n        global.addEventListener('blur', () => {\n            this._keys.length = 0; // empties array efficiently\n        });\n        // key up is on window because canvas cannot have focus\n        global.addEventListener('keyup', this._handleKeyUp);\n        // key down is on window because canvas cannot have focus\n        global.addEventListener('keydown', this._handleKeyDown);\n    }\n    toggleEnabled(enabled) {\n        this._enabled = enabled;\n    }\n    update() {\n        // Reset keysDown and keysUp after update is complete\n        this._keysDown.length = 0;\n        this._keysUp.length = 0;\n        // Emit synthetic \"hold\" event\n        for (let i = 0; i < this._keys.length; i++) {\n            this.events.emit('hold', new KeyEvent(this._keys[i]));\n        }\n    }\n    /**\n     * Gets list of keys being pressed down\n     */\n    getKeys() {\n        return this._keys;\n    }\n    /**\n     * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.\n     * @param key Test whether a key was just pressed\n     */\n    wasPressed(key) {\n        return this._keysDown.indexOf(key) > -1;\n    }\n    /**\n     * Tests if a certain key is held down. This is persisted between frames.\n     * @param key  Test whether a key is held down\n     */\n    isHeld(key) {\n        return this._keys.indexOf(key) > -1;\n    }\n    /**\n     * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.\n     * @param key  Test whether a key was just released\n     */\n    wasReleased(key) {\n        return this._keysUp.indexOf(key) > -1;\n    }\n    /**\n     * Trigger a manual key event\n     * @param type\n     * @param key\n     * @param character\n     */\n    triggerEvent(type, key, character) {\n        if (type === 'down') {\n            this._handleKeyDown(new KeyboardEvent('keydown', {\n                code: key,\n                key: character !== null && character !== void 0 ? character : null\n            }));\n        }\n        if (type === 'up') {\n            this._handleKeyUp(new KeyboardEvent('keyup', {\n                code: key,\n                key: character !== null && character !== void 0 ? character : null\n            }));\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Math/global-coordinates.ts\n\nclass GlobalCoordinates {\n    static fromPagePosition(xOrPos, yOrEngine, engineOrUndefined) {\n        let pageX;\n        let pageY;\n        let pagePos;\n        let engine;\n        if (arguments.length === 3) {\n            pageX = xOrPos;\n            pageY = yOrEngine;\n            pagePos = new Vector(pageX, pageY);\n            engine = engineOrUndefined;\n        }\n        else {\n            pagePos = xOrPos;\n            pageX = pagePos.x;\n            pageY = pagePos.y;\n            engine = yOrEngine;\n        }\n        const screenPos = engine.screen.pageToScreenCoordinates(pagePos);\n        const worldPos = engine.screen.screenToWorldCoordinates(screenPos);\n        return new GlobalCoordinates(worldPos, pagePos, screenPos);\n    }\n    constructor(worldPos, pagePos, screenPos) {\n        this.worldPos = worldPos;\n        this.pagePos = pagePos;\n        this.screenPos = screenPos;\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/PointerEvent.ts\nclass PointerEvent {\n    cancel() {\n        this.active = false;\n    }\n    get pagePos() {\n        return this.coordinates.pagePos;\n    }\n    get screenPos() {\n        return this.coordinates.screenPos;\n    }\n    get worldPos() {\n        return this.coordinates.worldPos;\n    }\n    constructor(type, pointerId, button, pointerType, coordinates, nativeEvent) {\n        this.type = type;\n        this.pointerId = pointerId;\n        this.button = button;\n        this.pointerType = pointerType;\n        this.coordinates = coordinates;\n        this.nativeEvent = nativeEvent;\n        this.active = true;\n    }\n    ;\n}\n\n;// CONCATENATED MODULE: ./Input/WheelEvent.ts\nclass WheelEvent {\n    cancel() {\n        this.active = false;\n    }\n    constructor(x, y, pageX, pageY, screenX, screenY, index, deltaX, deltaY, deltaZ, deltaMode, ev) {\n        this.x = x;\n        this.y = y;\n        this.pageX = pageX;\n        this.pageY = pageY;\n        this.screenX = screenX;\n        this.screenY = screenY;\n        this.index = index;\n        this.deltaX = deltaX;\n        this.deltaY = deltaY;\n        this.deltaZ = deltaZ;\n        this.deltaMode = deltaMode;\n        this.ev = ev;\n        this.active = true;\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/PointerAbstraction.ts\n\n\nclass PointerAbstraction {\n    constructor() {\n        this.events = new EventEmitter();\n        /**\n         * The last position on the document this pointer was at. Can be `null` if pointer was never active.\n         */\n        this.lastPagePos = Vector.Zero;\n        /**\n         * The last position on the screen this pointer was at. Can be `null` if pointer was never active.\n         */\n        this.lastScreenPos = Vector.Zero;\n        /**\n         * The last position in the game world coordinates this pointer was at. Can be `null` if pointer was never active.\n         */\n        this.lastWorldPos = Vector.Zero;\n        this._onPointerMove = (ev) => {\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\n        };\n        this._onPointerDown = (ev) => {\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\n        };\n        this.on('move', this._onPointerMove);\n        this.on('down', this._onPointerDown);\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/WheelDeltaMode.ts\nvar WheelDeltaMode;\n(function (WheelDeltaMode) {\n    WheelDeltaMode[\"Pixel\"] = \"Pixel\";\n    WheelDeltaMode[\"Line\"] = \"Line\";\n    WheelDeltaMode[\"Page\"] = \"Page\";\n})(WheelDeltaMode || (WheelDeltaMode = {}));\n\n;// CONCATENATED MODULE: ./Input/NativePointerButton.ts\n/**\n * Native browser button enumeration\n */\nvar NativePointerButton;\n(function (NativePointerButton) {\n    NativePointerButton[NativePointerButton[\"NoButton\"] = -1] = \"NoButton\";\n    NativePointerButton[NativePointerButton[\"Left\"] = 0] = \"Left\";\n    NativePointerButton[NativePointerButton[\"Middle\"] = 1] = \"Middle\";\n    NativePointerButton[NativePointerButton[\"Right\"] = 2] = \"Right\";\n    NativePointerButton[NativePointerButton[\"Unknown\"] = 3] = \"Unknown\";\n})(NativePointerButton || (NativePointerButton = {}));\n\n;// CONCATENATED MODULE: ./Input/PointerButton.ts\n/**\n * The mouse button being pressed.\n */\nvar PointerButton;\n(function (PointerButton) {\n    PointerButton[\"Left\"] = \"Left\";\n    PointerButton[\"Middle\"] = \"Middle\";\n    PointerButton[\"Right\"] = \"Right\";\n    PointerButton[\"Unknown\"] = \"Unknown\";\n    PointerButton[\"NoButton\"] = \"NoButton\";\n})(PointerButton || (PointerButton = {}));\n\n;// CONCATENATED MODULE: ./Input/PointerType.ts\n/**\n * The type of pointer for a [[PointerEvent]].\n */\nvar PointerType;\n(function (PointerType) {\n    PointerType[\"Touch\"] = \"Touch\";\n    PointerType[\"Mouse\"] = \"Mouse\";\n    PointerType[\"Pen\"] = \"Pen\";\n    PointerType[\"Unknown\"] = \"Unknown\";\n})(PointerType || (PointerType = {}));\n\n;// CONCATENATED MODULE: ./Input/PointerEventReceiver.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst PointerEvents = {\n    Move: 'move',\n    Down: 'down',\n    Up: 'up',\n    Wheel: 'wheel'\n};\n/**\n * Is this event a native touch event?\n */\nfunction isTouchEvent(value) {\n    // Guard for Safari <= 13.1\n    return globalThis.TouchEvent && value instanceof globalThis.TouchEvent;\n}\n/**\n * Is this event a native pointer event\n */\nfunction isPointerEvent(value) {\n    // Guard for Safari <= 13.1\n    return globalThis.PointerEvent && value instanceof globalThis.PointerEvent;\n}\n/**\n * The PointerEventProcessor is responsible for collecting all the events from the canvas and transforming them into GlobalCoordinates\n */\nclass PointerEventReceiver {\n    constructor(target, engine) {\n        this.target = target;\n        this.engine = engine;\n        this.events = new EventEmitter();\n        this.primary = new PointerAbstraction();\n        this._activeNativePointerIdsToNormalized = new Map();\n        this.lastFramePointerCoords = new Map();\n        this.currentFramePointerCoords = new Map();\n        this.currentFramePointerDown = new Map();\n        this.lastFramePointerDown = new Map();\n        this.currentFrameDown = [];\n        this.currentFrameUp = [];\n        this.currentFrameMove = [];\n        this.currentFrameCancel = [];\n        this.currentFrameWheel = [];\n        this._enabled = true;\n        this._pointers = [this.primary];\n        this._boundHandle = this._handle.bind(this);\n        this._boundWheel = this._handleWheel.bind(this);\n    }\n    toggleEnabled(enabled) {\n        this._enabled = enabled;\n    }\n    /**\n     * Creates a new PointerEventReceiver with a new target and engine while preserving existing pointer event\n     * handlers.\n     * @param target\n     * @param engine\n     */\n    recreate(target, engine) {\n        const eventReceiver = new PointerEventReceiver(target, engine);\n        eventReceiver.primary = this.primary;\n        eventReceiver._pointers = this._pointers;\n        return eventReceiver;\n    }\n    /**\n     * Locates a specific pointer by id, creates it if it doesn't exist\n     * @param index\n     */\n    at(index) {\n        if (index >= this._pointers.length) {\n            // Ensure there is a pointer to retrieve\n            for (let i = this._pointers.length - 1, max = index; i < max; i++) {\n                this._pointers.push(new PointerAbstraction());\n            }\n        }\n        return this._pointers[index];\n    }\n    /**\n     * The number of pointers currently being tracked by excalibur\n     */\n    count() {\n        return this._pointers.length;\n    }\n    /**\n     * Is the specified pointer id down this frame\n     * @param pointerId\n     */\n    isDown(pointerId) {\n        var _a;\n        return (_a = this.currentFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\n    }\n    /**\n     * Was the specified pointer id down last frame\n     * @param pointerId\n     */\n    wasDown(pointerId) {\n        var _a;\n        return (_a = this.lastFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\n    }\n    /**\n     * Whether the Pointer is currently dragging.\n     */\n    isDragging(pointerId) {\n        return this.isDown(pointerId);\n    }\n    /**\n     * Whether the Pointer just started dragging.\n     */\n    isDragStart(pointerId) {\n        return this.isDown(pointerId) && !this.wasDown(pointerId);\n    }\n    /**\n     * Whether the Pointer just ended dragging.\n     */\n    isDragEnd(pointerId) {\n        return !this.isDown(pointerId) && this.wasDown(pointerId);\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n    /**\n     * Called internally by excalibur\n     *\n     * Updates the current frame pointer info and emits raw pointer events\n     *\n     * This does not emit events to entities, see PointerSystem\n     */\n    update() {\n        this.lastFramePointerDown = new Map(this.currentFramePointerDown);\n        this.lastFramePointerCoords = new Map(this.currentFramePointerCoords);\n        for (const event of this.currentFrameDown) {\n            this.emit('down', event);\n            const pointer = this.at(event.pointerId);\n            pointer.emit('down', event);\n            this.primary.emit('pointerdown', event);\n        }\n        for (const event of this.currentFrameUp) {\n            this.emit('up', event);\n            const pointer = this.at(event.pointerId);\n            pointer.emit('up', event);\n        }\n        for (const event of this.currentFrameMove) {\n            this.emit('move', event);\n            const pointer = this.at(event.pointerId);\n            pointer.emit('move', event);\n        }\n        for (const event of this.currentFrameCancel) {\n            this.emit('cancel', event);\n            const pointer = this.at(event.pointerId);\n            pointer.emit('cancel', event);\n        }\n        for (const event of this.currentFrameWheel) {\n            this.emit('wheel', event);\n            this.primary.emit('pointerwheel', event);\n            this.primary.emit('wheel', event);\n        }\n    }\n    /**\n     * Clears the current frame event and pointer data\n     */\n    clear() {\n        for (const event of this.currentFrameUp) {\n            this.currentFramePointerCoords.delete(event.pointerId);\n            const ids = this._activeNativePointerIdsToNormalized.entries();\n            for (const [native, normalized] of ids) {\n                if (normalized === event.pointerId) {\n                    this._activeNativePointerIdsToNormalized.delete(native);\n                }\n            }\n        }\n        this.currentFrameDown.length = 0;\n        this.currentFrameUp.length = 0;\n        this.currentFrameMove.length = 0;\n        this.currentFrameCancel.length = 0;\n        this.currentFrameWheel.length = 0;\n    }\n    /**\n     * Initializes the pointer event receiver so that it can start listening to native\n     * browser events.\n     */\n    init(options) {\n        var _a;\n        if (this.engine.isDisposed()) {\n            return;\n        }\n        // Disabling the touch action avoids browser/platform gestures from firing on the canvas\n        // It is important on mobile to have touch action 'none'\n        // https://stackoverflow.com/questions/48124372/pointermove-event-not-working-with-touch-why-not\n        if (this.target === this.engine.canvas) {\n            this.engine.canvas.style.touchAction = 'none';\n        }\n        else {\n            document.body.style.touchAction = 'none';\n        }\n        // Preferred pointer events\n        if (window.PointerEvent) {\n            this.target.addEventListener('pointerdown', this._boundHandle);\n            this.target.addEventListener('pointerup', this._boundHandle);\n            this.target.addEventListener('pointermove', this._boundHandle);\n            this.target.addEventListener('pointercancel', this._boundHandle);\n        }\n        else {\n            // Touch Events\n            this.target.addEventListener('touchstart', this._boundHandle);\n            this.target.addEventListener('touchend', this._boundHandle);\n            this.target.addEventListener('touchmove', this._boundHandle);\n            this.target.addEventListener('touchcancel', this._boundHandle);\n            // Mouse Events\n            this.target.addEventListener('mousedown', this._boundHandle);\n            this.target.addEventListener('mouseup', this._boundHandle);\n            this.target.addEventListener('mousemove', this._boundHandle);\n        }\n        // MDN MouseWheelEvent\n        const wheelOptions = {\n            passive: !(this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\n                this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas)\n        };\n        if ('onwheel' in document.createElement('div')) {\n            // Modern Browsers\n            this.target.addEventListener('wheel', this._boundWheel, wheelOptions);\n        }\n        else if (document.onmousewheel !== undefined) {\n            // Webkit and IE\n            this.target.addEventListener('mousewheel', this._boundWheel, wheelOptions);\n        }\n        else {\n            // Remaining browser and older Firefox\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel, wheelOptions);\n        }\n        const grabWindowFocus = (_a = options === null || options === void 0 ? void 0 : options.grabWindowFocus) !== null && _a !== void 0 ? _a : true;\n        // Handle cross origin iframe\n        if (grabWindowFocus && isCrossOriginIframe()) {\n            const grabFocus = () => {\n                window.focus();\n            };\n            // Preferred pointer events\n            if (window.PointerEvent) {\n                this.target.addEventListener('pointerdown', grabFocus);\n            }\n            else {\n                // Touch Events\n                this.target.addEventListener('touchstart', grabFocus);\n                // Mouse Events\n                this.target.addEventListener('mousedown', grabFocus);\n            }\n        }\n    }\n    detach() {\n        // Preferred pointer events\n        if (window.PointerEvent) {\n            this.target.removeEventListener('pointerdown', this._boundHandle);\n            this.target.removeEventListener('pointerup', this._boundHandle);\n            this.target.removeEventListener('pointermove', this._boundHandle);\n            this.target.removeEventListener('pointercancel', this._boundHandle);\n        }\n        else {\n            // Touch Events\n            this.target.removeEventListener('touchstart', this._boundHandle);\n            this.target.removeEventListener('touchend', this._boundHandle);\n            this.target.removeEventListener('touchmove', this._boundHandle);\n            this.target.removeEventListener('touchcancel', this._boundHandle);\n            // Mouse Events\n            this.target.removeEventListener('mousedown', this._boundHandle);\n            this.target.removeEventListener('mouseup', this._boundHandle);\n            this.target.removeEventListener('mousemove', this._boundHandle);\n        }\n        if ('onwheel' in document.createElement('div')) {\n            // Modern Browsers\n            this.target.removeEventListener('wheel', this._boundWheel);\n        }\n        else if (document.onmousewheel !== undefined) {\n            // Webkit and IE\n            this.target.addEventListener('mousewheel', this._boundWheel);\n        }\n        else {\n            // Remaining browser and older Firefox\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel);\n        }\n    }\n    /**\n     * Take native pointer id and map it to index in active pointers\n     * @param nativePointerId\n     */\n    _normalizePointerId(nativePointerId) {\n        // Add to the the native pointer set id\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, -1);\n        // Native pointer ids in ascending order\n        const currentPointerIds = Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((a, b) => a - b);\n        // The index into sorted ids will be the new id, will always have an id\n        const id = currentPointerIds.findIndex(p => p === nativePointerId);\n        // Save the mapping so we can reverse it later\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, id);\n        // ignore pointer because game isn't watching\n        return id;\n    }\n    /**\n     * Responsible for handling and parsing pointer events\n     */\n    _handle(ev) {\n        if (!this._enabled) {\n            return;\n        }\n        ev.preventDefault();\n        const eventCoords = new Map();\n        let button;\n        let pointerType;\n        if (isTouchEvent(ev)) {\n            button = PointerButton.Unknown;\n            pointerType = PointerType.Touch;\n            // https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent\n            for (let i = 0; i < ev.changedTouches.length; i++) {\n                const touch = ev.changedTouches[i];\n                const coordinates = GlobalCoordinates.fromPagePosition(touch.pageX, touch.pageY, this.engine);\n                const nativePointerId = i + 1;\n                const pointerId = this._normalizePointerId(nativePointerId);\n                this.currentFramePointerCoords.set(pointerId, coordinates);\n                eventCoords.set(pointerId, coordinates);\n            }\n        }\n        else {\n            button = this._nativeButtonToPointerButton(ev.button);\n            pointerType = PointerType.Mouse;\n            const coordinates = GlobalCoordinates.fromPagePosition(ev.pageX, ev.pageY, this.engine);\n            let nativePointerId = 1;\n            if (isPointerEvent(ev)) {\n                nativePointerId = ev.pointerId;\n                pointerType = this._stringToPointerType(ev.pointerType);\n            }\n            const pointerId = this._normalizePointerId(nativePointerId);\n            this.currentFramePointerCoords.set(pointerId, coordinates);\n            eventCoords.set(pointerId, coordinates);\n        }\n        for (const [pointerId, coord] of eventCoords.entries()) {\n            switch (ev.type) {\n                case 'mousedown':\n                case 'pointerdown':\n                case 'touchstart':\n                    this.currentFrameDown.push(new PointerEvent('down', pointerId, button, pointerType, coord, ev));\n                    this.currentFramePointerDown.set(pointerId, true);\n                    break;\n                case 'mouseup':\n                case 'pointerup':\n                case 'touchend':\n                    this.currentFrameUp.push(new PointerEvent('up', pointerId, button, pointerType, coord, ev));\n                    this.currentFramePointerDown.set(pointerId, false);\n                    break;\n                case 'mousemove':\n                case 'pointermove':\n                case 'touchmove':\n                    this.currentFrameMove.push(new PointerEvent('move', pointerId, button, pointerType, coord, ev));\n                    break;\n                case 'touchcancel':\n                case 'pointercancel':\n                    this.currentFrameCancel.push(new PointerEvent('cancel', pointerId, button, pointerType, coord, ev));\n                    break;\n            }\n        }\n    }\n    _handleWheel(ev) {\n        if (!this._enabled) {\n            return;\n        }\n        // Should we prevent page scroll because of this event\n        if (this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\n            (this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas && ev.target === this.engine.canvas)) {\n            ev.preventDefault();\n        }\n        const screen = this.engine.screen.pageToScreenCoordinates(vec(ev.pageX, ev.pageY));\n        const world = this.engine.screen.screenToWorldCoordinates(screen);\n        /**\n         * A constant used to normalize wheel events across different browsers\n         *\n         * This normalization factor is pulled from\n         * https://developer.mozilla.org/en-US/docs/Web/Events/wheel#Listening_to_this_event_across_browser\n         */\n        const ScrollWheelNormalizationFactor = -1 / 40;\n        const deltaX = ev.deltaX || ev.wheelDeltaX * ScrollWheelNormalizationFactor || 0;\n        const deltaY = ev.deltaY || ev.wheelDeltaY * ScrollWheelNormalizationFactor || ev.wheelDelta * ScrollWheelNormalizationFactor || ev.detail || 0;\n        const deltaZ = ev.deltaZ || 0;\n        let deltaMode = WheelDeltaMode.Pixel;\n        if (ev.deltaMode) {\n            if (ev.deltaMode === 1) {\n                deltaMode = WheelDeltaMode.Line;\n            }\n            else if (ev.deltaMode === 2) {\n                deltaMode = WheelDeltaMode.Page;\n            }\n        }\n        const we = new WheelEvent(world.x, world.y, ev.pageX, ev.pageY, screen.x, screen.y, 0, deltaX, deltaY, deltaZ, deltaMode, ev);\n        this.currentFrameWheel.push(we);\n    }\n    /**\n     * Triggers an excalibur pointer event in a world space pos\n     *\n     * Useful for testing pointers in excalibur\n     * @param type\n     * @param pos\n     */\n    triggerEvent(type, pos) {\n        const page = this.engine.screen.worldToPageCoordinates(pos);\n        // Send an event to the event receiver\n        if (window.PointerEvent) {\n            this._handle(new window.PointerEvent('pointer' + type, {\n                pointerId: 0,\n                clientX: page.x,\n                clientY: page.y\n            }));\n        }\n        else {\n            // Safari hack\n            this._handle(new window.MouseEvent('mouse' + type, {\n                clientX: page.x,\n                clientY: page.y\n            }));\n        }\n        // Force update pointer system\n        const pointerSystem = this.engine.currentScene.world.get(PointerSystem);\n        pointerSystem.preupdate(this.engine.currentScene, 1);\n        pointerSystem.update(1);\n    }\n    _nativeButtonToPointerButton(s) {\n        switch (s) {\n            case NativePointerButton.NoButton:\n                return PointerButton.NoButton;\n            case NativePointerButton.Left:\n                return PointerButton.Left;\n            case NativePointerButton.Middle:\n                return PointerButton.Middle;\n            case NativePointerButton.Right:\n                return PointerButton.Right;\n            case NativePointerButton.Unknown:\n                return PointerButton.Unknown;\n            default:\n                return fail(s);\n        }\n    }\n    _stringToPointerType(s) {\n        switch (s) {\n            case 'touch':\n                return PointerType.Touch;\n            case 'mouse':\n                return PointerType.Mouse;\n            case 'pen':\n                return PointerType.Pen;\n            default:\n                return PointerType.Unknown;\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Input/InputHost.ts\n\n\n\n\nclass InputHost {\n    constructor(options) {\n        this._enabled = true;\n        const { pointerTarget, grabWindowFocus, engine } = options;\n        this.keyboard = new Keyboard();\n        this.pointers = new PointerEventReceiver(pointerTarget, engine);\n        this.gamepads = new Gamepads();\n        this.keyboard.init({ grabWindowFocus });\n        this.pointers.init({ grabWindowFocus });\n        this.gamepads.init();\n        this.inputMapper = new InputMapper({\n            keyboard: this.keyboard,\n            pointers: this.pointers,\n            gamepads: this.gamepads\n        });\n    }\n    get enabled() {\n        return this._enabled;\n    }\n    toggleEnabled(enabled) {\n        this._enabled = enabled;\n        this.keyboard.toggleEnabled(this._enabled);\n        this.pointers.toggleEnabled(this._enabled);\n        this.gamepads.toggleEnabled(this._enabled);\n    }\n    update() {\n        if (this._enabled) {\n            this.inputMapper.execute();\n            this.keyboard.update();\n            this.gamepads.update();\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Scene.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass PreLoadEvent {\n}\nconst SceneEvents = {\n    Initialize: 'initialize',\n    Activate: 'activate',\n    Deactivate: 'deactivate',\n    PreUpdate: 'preupdate',\n    PostUpdate: 'postupdate',\n    PreDraw: 'predraw',\n    PostDraw: 'postdraw',\n    PreDebugDraw: 'predebugdraw',\n    PostDebugDraw: 'postdebugdraw',\n    PreLoad: 'preload'\n};\n/**\n *\n */\nfunction isSceneConstructor(x) {\n    var _a, _b;\n    return !!(x === null || x === void 0 ? void 0 : x.prototype) && !!((_b = (_a = x === null || x === void 0 ? void 0 : x.prototype) === null || _a === void 0 ? void 0 : _a.constructor) === null || _b === void 0 ? void 0 : _b.name);\n}\n/**\n * [[Actor|Actors]] are composed together into groupings called Scenes in\n * Excalibur. The metaphor models the same idea behind real world\n * actors in a scene. Only actors in scenes will be updated and drawn.\n *\n * Typical usages of a scene include: levels, menus, loading screens, etc.\n */\nclass Scene {\n    /**\n     * The actors in the current scene\n     */\n    get actors() {\n        return this.world.entityManager.entities.filter((e) => {\n            return e instanceof Actor;\n        });\n    }\n    /**\n     * The entities in the current scene\n     */\n    get entities() {\n        return this.world.entityManager.entities;\n    }\n    /**\n     * The triggers in the current scene\n     */\n    get triggers() {\n        return this.world.entityManager.entities.filter((e) => {\n            return e instanceof Trigger;\n        });\n    }\n    /**\n     * The [[TileMap]]s in the scene, if any\n     */\n    get tileMaps() {\n        return this.world.entityManager.entities.filter((e) => {\n            return e instanceof TileMap;\n        });\n    }\n    get timers() {\n        return this._timers;\n    }\n    constructor() {\n        // Initialize systems\n        this._logger = Logger.getInstance();\n        this.events = new EventEmitter();\n        /**\n         * Gets or sets the current camera for the scene\n         */\n        this.camera = new Camera();\n        /**\n         * The ECS world for the scene\n         */\n        this.world = new World(this);\n        /**\n         * The Excalibur physics world for the scene. Used to interact\n         * with colliders included in the scene.\n         *\n         * Can be used to perform scene ray casts, track colliders, broadphase, and narrowphase.\n         */\n        this.physics = new PhysicsWorld(DefaultPhysicsConfig);\n        this._isInitialized = false;\n        this._timers = [];\n        this._cancelQueue = [];\n        // Update\n        this.world.add(ActionsSystem);\n        this.world.add(new MotionSystem(this.world, this.physics));\n        this.world.add(new CollisionSystem(this.world, this.physics));\n        this.world.add(PointerSystem);\n        this.world.add(IsometricEntitySystem);\n        // Draw\n        this.world.add(OffscreenSystem);\n        this.world.add(GraphicsSystem);\n        this.world.add(DebugSystem);\n    }\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n    /**\n     * Event hook to provide Scenes a way of loading scene specific resources.\n     *\n     * This is called before the Scene.onInitialize during scene transition. It will only ever fire once for a scene.\n     * @param loader\n     */\n    onPreLoad(loader) {\n        // will be overridden\n    }\n    /**\n     * Event hook fired directly before transition, either \"in\" or \"out\" of the scene\n     *\n     * This overrides the Engine scene definition. However transitions specified in goToScene take highest precedence\n     *\n     * ```typescript\n     * // Overrides all\n     * Engine.goToScene('scene', { destinationIn: ..., sourceOut: ... });\n     * ```\n     *\n     * This can be used to configure custom transitions for a scene dynamically\n     */\n    onTransition(direction) {\n        // will be overridden\n        return undefined;\n    }\n    /**\n     * This is called before the first update of the [[Scene]]. Initializes scene members like the camera. This method is meant to be\n     * overridden. This is where initialization of child actors should take place.\n     */\n    onInitialize(engine) {\n        // will be overridden\n    }\n    /**\n     * This is called when the scene is made active and started. It is meant to be overridden,\n     * this is where you should setup any DOM UI or event handlers needed for the scene.\n     */\n    onActivate(context) {\n        // will be overridden\n    }\n    /**\n     * This is called when the scene is made transitioned away from and stopped. It is meant to be overridden,\n     * this is where you should cleanup any DOM UI or event handlers needed for the scene.\n     */\n    onDeactivate(context) {\n        // will be overridden\n    }\n    /**\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPreUpdate` is called directly before a scene is updated.\n     */\n    onPreUpdate(engine, delta) {\n        // will be overridden\n    }\n    /**\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPostUpdate` is called directly after a scene is updated.\n     */\n    onPostUpdate(engine, delta) {\n        // will be overridden\n    }\n    /**\n     * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPreDraw` is called directly before a scene is drawn.\n     *\n     */\n    onPreDraw(ctx, delta) {\n        // will be overridden\n    }\n    /**\n     * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n     *\n     * `onPostDraw` is called directly after a scene is drawn.\n     *\n     */\n    onPostDraw(ctx, delta) {\n        // will be overridden\n    }\n    /**\n     * Initializes actors in the scene\n     */\n    _initializeChildren() {\n        for (const child of this.entities) {\n            child._initialize(this.engine);\n        }\n    }\n    /**\n     * Gets whether or not the [[Scene]] has been initialized\n     */\n    get isInitialized() {\n        return this._isInitialized;\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Initializes the scene before the first update, meant to be called by engine not by users of\n     * Excalibur\n     * @internal\n     */\n    async _initialize(engine) {\n        var _a;\n        if (!this.isInitialized) {\n            try {\n                this.engine = engine;\n                // PhysicsWorld config is watched so things will automagically update\n                this.physics.config = this.engine.physics;\n                this.input = new InputHost({\n                    pointerTarget: engine.pointerScope === PointerScope.Canvas ? engine.canvas : document,\n                    grabWindowFocus: engine.grabWindowFocus,\n                    engine\n                });\n                // Initialize camera first\n                this.camera._initialize(engine);\n                this.world.systemManager.initialize();\n                // This order is important! we want to be sure any custom init that add actors\n                // fire before the actor init\n                await this.onInitialize(engine);\n                this._initializeChildren();\n                this._logger.debug('Scene.onInitialize', this, engine);\n                this.events.emit('initialize', new InitializeEvent(engine, this));\n            }\n            catch (e) {\n                this._logger.error(`Error during scene initialization for scene ${(_a = engine.director) === null || _a === void 0 ? void 0 : _a.getSceneName(this)}!`);\n                throw e;\n            }\n            this._isInitialized = true;\n        }\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Activates the scene with the base behavior, then calls the overridable `onActivate` implementation.\n     * @internal\n     */\n    async _activate(context) {\n        var _a, _b;\n        try {\n            this._logger.debug('Scene.onActivate', this);\n            this.input.toggleEnabled(true);\n            await this.onActivate(context);\n        }\n        catch (e) {\n            this._logger.error(`Error during scene activation for scene ${(_b = (_a = this.engine) === null || _a === void 0 ? void 0 : _a.director) === null || _b === void 0 ? void 0 : _b.getSceneName(this)}!`);\n            throw e;\n        }\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Deactivates the scene with the base behavior, then calls the overridable `onDeactivate` implementation.\n     * @internal\n     */\n    async _deactivate(context) {\n        this._logger.debug('Scene.onDeactivate', this);\n        this.input.toggleEnabled(false);\n        await this.onDeactivate(context);\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n     * @internal\n     */\n    _preupdate(engine, delta) {\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n        this.onPreUpdate(engine, delta);\n    }\n    /**\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n     * @internal\n     */\n    _postupdate(engine, delta) {\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n        this.onPostUpdate(engine, delta);\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _predraw handler for [[onPreDraw]] lifecycle event\n     * @internal\n     */\n    _predraw(ctx, delta) {\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this));\n        this.onPreDraw(ctx, delta);\n    }\n    /**\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\n     *\n     * Internal _postdraw handler for [[onPostDraw]] lifecycle event\n     * @internal\n     */\n    _postdraw(ctx, delta) {\n        this.emit('postdraw', new PostDrawEvent(ctx, delta, this));\n        this.onPostDraw(ctx, delta);\n    }\n    /**\n     * Updates all the actors and timers in the scene. Called by the [[Engine]].\n     * @param engine  Reference to the current Engine\n     * @param delta   The number of milliseconds since the last update\n     */\n    update(engine, delta) {\n        var _a;\n        if (!this.isInitialized) {\n            this._logger.warnOnce(`Scene update called before initialize for scene ${(_a = engine.director) === null || _a === void 0 ? void 0 : _a.getSceneName(this)}!`);\n            return;\n        }\n        this._preupdate(engine, delta);\n        // TODO differed entity removal for timers\n        let i, len;\n        // Remove timers in the cancel queue before updating them\n        for (i = 0, len = this._cancelQueue.length; i < len; i++) {\n            this.removeTimer(this._cancelQueue[i]);\n        }\n        this._cancelQueue.length = 0;\n        // Cycle through timers updating timers\n        for (const timer of this._timers) {\n            timer.update(delta);\n        }\n        this.world.update(SystemType.Update, delta);\n        // Camera last keeps renders smooth that are based on entity/actor\n        if (this.camera) {\n            this.camera.update(engine, delta);\n        }\n        this._collectActorStats(engine);\n        this._postupdate(engine, delta);\n        this.input.update();\n    }\n    /**\n     * Draws all the actors in the Scene. Called by the [[Engine]].\n     * @param ctx    The current rendering context\n     * @param delta  The number of milliseconds since the last draw\n     */\n    draw(ctx, delta) {\n        var _a;\n        if (!this.isInitialized) {\n            this._logger.warnOnce(`Scene draw called before initialize!`);\n            return;\n        }\n        this._predraw(ctx, delta);\n        this.world.update(SystemType.Draw, delta);\n        if ((_a = this.engine) === null || _a === void 0 ? void 0 : _a.isDebug) {\n            this.debugDraw(ctx);\n        }\n        this._postdraw(ctx, delta);\n    }\n    /**\n     * Draws all the actors' debug information in the Scene. Called by the [[Engine]].\n     * @param ctx  The current rendering context\n     */\n    /* istanbul ignore next */\n    debugDraw(ctx) {\n        this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\n        // pass\n        this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\n    }\n    /**\n     * Checks whether an actor is contained in this scene or not\n     */\n    contains(actor) {\n        return this.actors.indexOf(actor) > -1;\n    }\n    add(entity) {\n        this.emit('entityadded', { target: entity });\n        this.world.add(entity);\n        entity.scene = this;\n        if (entity instanceof Timer) {\n            if (!contains(this._timers, entity)) {\n                this.addTimer(entity);\n            }\n            return;\n        }\n    }\n    /**\n     * Removes an [[Entity]] (Actor, TileMap, Trigger, etc) or [[Timer]] from it's current scene\n     * and adds it to this scene.\n     *\n     * Useful if you want to have an object be present in only 1 scene at a time.\n     * @param entity\n     */\n    transfer(entity) {\n        let scene;\n        if (entity instanceof Entity && entity.scene && entity.scene !== this) {\n            scene = entity.scene;\n            entity.scene.world.remove(entity, false);\n        }\n        if (entity instanceof Timer && entity.scene) {\n            scene = entity.scene;\n            entity.scene.removeTimer(entity);\n        }\n        scene === null || scene === void 0 ? void 0 : scene.emit('entityremoved', { target: entity });\n        this.add(entity);\n    }\n    remove(entity) {\n        if (entity instanceof Entity) {\n            this.emit('entityremoved', { target: entity });\n            if (entity.active) {\n                entity.kill();\n            }\n            this.world.remove(entity);\n        }\n        if (entity instanceof Timer) {\n            this.removeTimer(entity);\n        }\n    }\n    /**\n     * Removes all entities and timers from the scene, optionally indicate whether deferred should or shouldn't be used.\n     *\n     * By default entities use deferred removal\n     * @param deferred\n     */\n    clear(deferred = true) {\n        for (let i = this.entities.length - 1; i >= 0; i--) {\n            this.world.remove(this.entities[i], deferred);\n        }\n        for (let i = this.timers.length - 1; i >= 0; i--) {\n            this.removeTimer(this.timers[i]);\n        }\n    }\n    /**\n     * Adds a [[Timer]] to the scene\n     * @param timer  The timer to add\n     */\n    addTimer(timer) {\n        this._timers.push(timer);\n        timer.scene = this;\n        return timer;\n    }\n    /**\n     * Removes a [[Timer]] from the scene.\n     * @warning Can be dangerous, use [[cancelTimer]] instead\n     * @param timer  The timer to remove\n     */\n    removeTimer(timer) {\n        const i = this._timers.indexOf(timer);\n        if (i !== -1) {\n            this._timers.splice(i, 1);\n        }\n        return timer;\n    }\n    /**\n     * Cancels a [[Timer]], removing it from the scene nicely\n     * @param timer  The timer to cancel\n     */\n    cancelTimer(timer) {\n        this._cancelQueue.push(timer);\n        return timer;\n    }\n    /**\n     * Tests whether a [[Timer]] is active in the scene\n     */\n    isTimerActive(timer) {\n        return this._timers.indexOf(timer) > -1 && !timer.complete;\n    }\n    isCurrentScene() {\n        if (this.engine) {\n            return this.engine.currentScene === this;\n        }\n        return false;\n    }\n    _collectActorStats(engine) {\n        const screenElements = this.actors.filter((a) => a instanceof ScreenElement);\n        for (const _ui of screenElements) {\n            engine.stats.currFrame.actors.ui++;\n        }\n        for (const actor of this.actors) {\n            engine.stats.currFrame.actors.alive++;\n            for (const child of actor.children) {\n                if (isScreenElement(child)) {\n                    // TODO not true\n                    engine.stats.currFrame.actors.ui++;\n                }\n                else {\n                    engine.stats.currFrame.actors.alive++;\n                }\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessMode.ts\nvar ColorBlindnessMode;\n(function (ColorBlindnessMode) {\n    ColorBlindnessMode[\"Protanope\"] = \"Protanope\";\n    ColorBlindnessMode[\"Deuteranope\"] = \"Deuteranope\";\n    ColorBlindnessMode[\"Tritanope\"] = \"Tritanope\";\n})(ColorBlindnessMode || (ColorBlindnessMode = {}));\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/color-blind-fragment.glsl\n/* harmony default export */ const color_blind_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n// our texture\\r\\nuniform sampler2D u_image;\\r\\n// the texCoords passed in from the vertex shader.\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// color blind type\\r\\nuniform int u_type;\\r\\n\\r\\n// simulation?\\r\\nuniform bool u_simulate;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  vec4 o =  texture(u_image, v_texcoord);\\r\\n  // RGB to LMS matrix conversion\\r\\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\\r\\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\\r\\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\\r\\n  // Simulate color blindness\\r\\n  float l;\\r\\n  float m;\\r\\n  float s;\\r\\n  //MODE CODE//\\r\\n  if (u_type == 0) {\\r\\n    // Protanope\\r\\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\\r\\n  } else if (u_type == 1) {\\r\\n    // Deuteranope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\\r\\n  } else if (u_type == 2) {\\r\\n    // Tritanope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\\r\\n  }\\r\\n\\r\\n  // LMS to RGB matrix conversion\\r\\n  vec4 error; // simulate the colors\\r\\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\\r\\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\\r\\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\\r\\n  error.a = 1.0;\\r\\n  vec4 diff = o - error;\\r\\n  vec4 correction; // correct the colors\\r\\n  correction.r = 0.0;\\r\\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\\r\\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\\r\\n  correction = o + correction;\\r\\n  correction.a = o.a;\\r\\n  //SIMULATE//\\r\\n\\r\\n  // sim \\r\\n  if (u_simulate) {\\r\\n    fragColor = error.rgba;\\r\\n  } else {\\r\\n    fragColor = correction.rgba;\\r\\n  }\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ScreenShader.ts\n\n\n\n/**\n * Helper that defines a whole screen renderer, just provide a fragment source!\n *\n * Currently supports 1 varying\n * - vec2 a_texcoord between 0-1 which corresponds to screen position\n */\nclass ScreenShader {\n    constructor(gl, fragmentSource) {\n        this._shader = new Shader({\n            gl,\n            vertexSource: `#version 300 es\r\n      in vec2 a_position;\r\n      in vec2 a_texcoord;\r\n      out vec2 v_texcoord;\r\n\r\n      void main() {\r\n        gl_Position = vec4(a_position, 0.0, 1.0);\r\n        // Pass the texcoord to the fragment shader.\r\n        v_texcoord = a_texcoord;\r\n      }`,\n            fragmentSource: fragmentSource\n        });\n        this._shader.compile();\n        // Setup memory layout\n        this._buffer = new VertexBuffer({\n            gl,\n            type: 'static',\n            // clip space quad + uv since we don't need a camera\n            data: new Float32Array([\n                -1, -1, 0, 0,\n                -1, 1, 0, 1,\n                1, -1, 1, 0,\n                1, -1, 1, 0,\n                -1, 1, 0, 1,\n                1, 1, 1, 1\n            ])\n        });\n        this._layout = new VertexLayout({\n            gl,\n            shader: this._shader,\n            vertexBuffer: this._buffer,\n            attributes: [\n                ['a_position', 2],\n                ['a_texcoord', 2]\n            ]\n        });\n        this._buffer.upload();\n    }\n    getShader() {\n        return this._shader;\n    }\n    getLayout() {\n        return this._layout;\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessPostProcessor.ts\n\n\n\nclass ColorBlindnessPostProcessor {\n    constructor(_colorBlindnessMode, simulate = false) {\n        this._colorBlindnessMode = _colorBlindnessMode;\n        this._simulate = false;\n        this._simulate = simulate;\n    }\n    initialize(gl) {\n        this._shader = new ScreenShader(gl, color_blind_fragment);\n        this.simulate = this._simulate;\n        this.colorBlindnessMode = this._colorBlindnessMode;\n    }\n    getShader() {\n        return this._shader.getShader();\n    }\n    getLayout() {\n        return this._shader.getLayout();\n    }\n    set colorBlindnessMode(colorBlindMode) {\n        this._colorBlindnessMode = colorBlindMode;\n        if (this._shader) {\n            const shader = this._shader.getShader();\n            shader.use();\n            if (this._colorBlindnessMode === ColorBlindnessMode.Protanope) {\n                shader.setUniformInt('u_type', 0);\n            }\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Deuteranope) {\n                shader.setUniformInt('u_type', 1);\n            }\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Tritanope) {\n                shader.setUniformInt('u_type', 2);\n            }\n        }\n    }\n    get colorBlindnessMode() {\n        return this._colorBlindnessMode;\n    }\n    set simulate(value) {\n        this._simulate = value;\n        if (this._shader) {\n            const shader = this._shader.getShader();\n            shader.use();\n            shader.setUniformBoolean('u_simulate', value);\n        }\n    }\n    get simulate() {\n        return this._simulate;\n    }\n}\n\n;// CONCATENATED MODULE: ./Debug/DebugFlags.ts\n\n\n\nclass ColorBlindFlags {\n    constructor(engine) {\n        this._engine = engine;\n        this._colorBlindPostProcessor = new ColorBlindnessPostProcessor(ColorBlindnessMode.Protanope);\n    }\n    /**\n     * Correct colors for a specified color blindness\n     * @param colorBlindness\n     */\n    correct(colorBlindness) {\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\n            this.clear();\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\n            this._colorBlindPostProcessor.simulate = false;\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\n        }\n    }\n    /**\n     * Simulate colors for a specified color blindness\n     * @param colorBlindness\n     */\n    simulate(colorBlindness) {\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\n            this.clear();\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\n            this._colorBlindPostProcessor.simulate = true;\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\n        }\n    }\n    /**\n     * Remove color blindness post processor\n     */\n    clear() {\n        this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor);\n    }\n}\n\n;// CONCATENATED MODULE: ./Debug/DebugConfig.ts\n\n\n/**\n * Debug statistics and flags for Excalibur. If polling these values, it would be\n * best to do so on the `postupdate` event for [[Engine]], after all values have been\n * updated during a frame.\n */\nclass DebugConfig {\n    constructor(engine) {\n        /**\n         * Performance statistics\n         */\n        this.stats = {\n            /**\n             * Current frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\n             * Best accessed on [[postframe]] event. See [[FrameStats]]\n             */\n            currFrame: new FrameStats(),\n            /**\n             * Previous frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\n             * Best accessed on [[preframe]] event. Best inspected on engine event `preframe`. See [[FrameStats]]\n             */\n            prevFrame: new FrameStats()\n        };\n        /**\n         * Filter debug context to named entities or entity ids\n         */\n        this.filter = {\n            /**\n             * Toggle filter on or off (default off) must be on for DebugDraw to use filters\n             */\n            useFilter: false,\n            /**\n             * Query for entities by name, if the entity name contains `nameQuery` it will be included\n             */\n            nameQuery: '',\n            /**\n             * Query for Entity ids, if the id matches it will be included\n             */\n            ids: []\n        };\n        /**\n         * Entity debug settings\n         */\n        this.entity = {\n            showAll: false,\n            showId: false,\n            showName: false\n        };\n        /**\n         * Transform component debug settings\n         */\n        this.transform = {\n            showAll: false,\n            debugZIndex: 10000000,\n            showPosition: false,\n            showPositionLabel: false,\n            positionColor: Color.Yellow,\n            showZIndex: false,\n            showScale: false,\n            scaleColor: Color.Green,\n            showRotation: false,\n            rotationColor: Color.Blue\n        };\n        /**\n         * Graphics component debug settings\n         */\n        this.graphics = {\n            showAll: false,\n            showBounds: false,\n            boundsColor: Color.Yellow\n        };\n        /**\n         * Collider component debug settings\n         */\n        this.collider = {\n            showAll: false,\n            showBounds: false,\n            boundsColor: Color.Blue,\n            showOwner: false,\n            showGeometry: true,\n            geometryColor: Color.Green,\n            geometryLineWidth: 1,\n            geometryPointSize: .5\n        };\n        /**\n         * Physics simulation debug settings\n         */\n        this.physics = {\n            showAll: false,\n            showBroadphaseSpacePartitionDebug: false,\n            showCollisionNormals: false,\n            collisionNormalColor: Color.Cyan,\n            showCollisionContacts: true,\n            contactSize: 2,\n            collisionContactColor: Color.Red\n        };\n        /**\n         * Motion component debug settings\n         */\n        this.motion = {\n            showAll: false,\n            showVelocity: false,\n            velocityColor: Color.Yellow,\n            showAcceleration: false,\n            accelerationColor: Color.Red\n        };\n        /**\n         * Body component debug settings\n         */\n        this.body = {\n            showAll: false,\n            showCollisionGroup: false,\n            showCollisionType: false,\n            showSleeping: false,\n            showMotion: false,\n            showMass: false\n        };\n        /**\n         * Camera debug settings\n         */\n        this.camera = {\n            showAll: false,\n            showFocus: false,\n            focusColor: Color.Red,\n            showZoom: false\n        };\n        this.tilemap = {\n            showAll: false,\n            showGrid: false,\n            gridColor: Color.Red,\n            gridWidth: .5,\n            showSolidBounds: false,\n            solidBoundsColor: Color.fromHex('#8080807F'), // grayish\n            showColliderGeometry: true\n        };\n        this.isometric = {\n            showAll: false,\n            showPosition: false,\n            positionColor: Color.Yellow,\n            positionSize: 1,\n            showGrid: false,\n            gridColor: Color.Red,\n            gridWidth: 1,\n            showColliderGeometry: true\n        };\n        this._engine = engine;\n        this.colorBlindMode = new ColorBlindFlags(this._engine);\n    }\n    /**\n     * Switch the current excalibur clock with the [[TestClock]] and return\n     * it in the same running state.\n     *\n     * This is useful when you need to debug frame by frame.\n     */\n    useTestClock() {\n        const clock = this._engine.clock;\n        const wasRunning = clock.isRunning();\n        clock.stop();\n        const testClock = clock.toTestClock();\n        if (wasRunning) {\n            testClock.start();\n        }\n        this._engine.clock = testClock;\n        return testClock;\n    }\n    /**\n     * Switch the current excalibur clock with the [[StandardClock]] and\n     * return it in the same running state.\n     *\n     * This is useful when you need to switch back to normal mode after\n     * debugging.\n     */\n    useStandardClock() {\n        const currentClock = this._engine.clock;\n        const wasRunning = currentClock.isRunning();\n        currentClock.stop();\n        const standardClock = currentClock.toStandardClock();\n        if (wasRunning) {\n            standardClock.start();\n        }\n        this._engine.clock = standardClock;\n        return standardClock;\n    }\n}\n/**\n * Implementation of a frame's stats. Meant to have values copied via [[FrameStats.reset]], avoid\n * creating instances of this every frame.\n */\nclass FrameStats {\n    constructor() {\n        this._id = 0;\n        this._delta = 0;\n        this._fps = 0;\n        this._actorStats = {\n            alive: 0,\n            killed: 0,\n            ui: 0,\n            get remaining() {\n                return this.alive - this.killed;\n            },\n            get total() {\n                return this.remaining + this.ui;\n            }\n        };\n        this._durationStats = {\n            update: 0,\n            draw: 0,\n            get total() {\n                return this.update + this.draw;\n            }\n        };\n        this._physicsStats = new PhysicsStats();\n        this._graphicsStats = {\n            drawCalls: 0,\n            drawnImages: 0\n        };\n    }\n    /**\n     * Zero out values or clone other IFrameStat stats. Allows instance reuse.\n     * @param [otherStats] Optional stats to clone\n     */\n    reset(otherStats) {\n        if (otherStats) {\n            this.id = otherStats.id;\n            this.delta = otherStats.delta;\n            this.fps = otherStats.fps;\n            this.actors.alive = otherStats.actors.alive;\n            this.actors.killed = otherStats.actors.killed;\n            this.actors.ui = otherStats.actors.ui;\n            this.duration.update = otherStats.duration.update;\n            this.duration.draw = otherStats.duration.draw;\n            this._physicsStats.reset(otherStats.physics);\n            this.graphics.drawCalls = otherStats.graphics.drawCalls;\n            this.graphics.drawnImages = otherStats.graphics.drawnImages;\n        }\n        else {\n            this.id = this.delta = this.fps = 0;\n            this.actors.alive = this.actors.killed = this.actors.ui = 0;\n            this.duration.update = this.duration.draw = 0;\n            this._physicsStats.reset();\n            this.graphics.drawnImages = this.graphics.drawCalls = 0;\n        }\n    }\n    /**\n     * Provides a clone of this instance.\n     */\n    clone() {\n        const fs = new FrameStats();\n        fs.reset(this);\n        return fs;\n    }\n    /**\n     * Gets the frame's id\n     */\n    get id() {\n        return this._id;\n    }\n    /**\n     * Sets the frame's id\n     */\n    set id(value) {\n        this._id = value;\n    }\n    /**\n     * Gets the frame's delta (time since last frame)\n     */\n    get delta() {\n        return this._delta;\n    }\n    /**\n     * Sets the frame's delta (time since last frame). Internal use only.\n     * @internal\n     */\n    set delta(value) {\n        this._delta = value;\n    }\n    /**\n     * Gets the frame's frames-per-second (FPS)\n     */\n    get fps() {\n        return this._fps;\n    }\n    /**\n     * Sets the frame's frames-per-second (FPS). Internal use only.\n     * @internal\n     */\n    set fps(value) {\n        this._fps = value;\n    }\n    /**\n     * Gets the frame's actor statistics\n     */\n    get actors() {\n        return this._actorStats;\n    }\n    /**\n     * Gets the frame's duration statistics\n     */\n    get duration() {\n        return this._durationStats;\n    }\n    /**\n     * Gets the frame's physics statistics\n     */\n    get physics() {\n        return this._physicsStats;\n    }\n    /**\n     * Gets the frame's graphics statistics\n     */\n    get graphics() {\n        return this._graphicsStats;\n    }\n}\nclass PhysicsStats {\n    constructor() {\n        this._pairs = 0;\n        this._collisions = 0;\n        this._contacts = new Map();\n        this._fastBodies = 0;\n        this._fastBodyCollisions = 0;\n        this._broadphase = 0;\n        this._narrowphase = 0;\n    }\n    /**\n     * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.\n     * @param [otherStats] Optional stats to clone\n     */\n    reset(otherStats) {\n        if (otherStats) {\n            this.pairs = otherStats.pairs;\n            this.collisions = otherStats.collisions;\n            this.contacts = otherStats.contacts;\n            this.fastBodies = otherStats.fastBodies;\n            this.fastBodyCollisions = otherStats.fastBodyCollisions;\n            this.broadphase = otherStats.broadphase;\n            this.narrowphase = otherStats.narrowphase;\n        }\n        else {\n            this.pairs = this.collisions = this.fastBodies = 0;\n            this.fastBodyCollisions = this.broadphase = this.narrowphase = 0;\n            this.contacts.clear();\n        }\n    }\n    /**\n     * Provides a clone of this instance.\n     */\n    clone() {\n        const ps = new PhysicsStats();\n        ps.reset(this);\n        return ps;\n    }\n    get pairs() {\n        return this._pairs;\n    }\n    set pairs(value) {\n        this._pairs = value;\n    }\n    get collisions() {\n        return this._collisions;\n    }\n    set collisions(value) {\n        this._collisions = value;\n    }\n    get contacts() {\n        return this._contacts;\n    }\n    set contacts(contacts) {\n        this._contacts = contacts;\n    }\n    get fastBodies() {\n        return this._fastBodies;\n    }\n    set fastBodies(value) {\n        this._fastBodies = value;\n    }\n    get fastBodyCollisions() {\n        return this._fastBodyCollisions;\n    }\n    set fastBodyCollisions(value) {\n        this._fastBodyCollisions = value;\n    }\n    get broadphase() {\n        return this._broadphase;\n    }\n    set broadphase(value) {\n        this._broadphase = value;\n    }\n    get narrowphase() {\n        return this._narrowphase;\n    }\n    set narrowphase(value) {\n        this._narrowphase = value;\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Browser.ts\nclass BrowserComponent {\n    on(eventName, handler) {\n        if (this._nativeHandlers[eventName]) {\n            this.off(eventName, this._nativeHandlers[eventName]);\n        }\n        this._nativeHandlers[eventName] = this._decorate(handler);\n        this.nativeComponent.addEventListener(eventName, this._nativeHandlers[eventName]);\n    }\n    off(eventName, handler) {\n        if (!handler) {\n            handler = this._nativeHandlers[eventName];\n        }\n        this.nativeComponent.removeEventListener(eventName, handler);\n        this._nativeHandlers[eventName] = null;\n    }\n    _decorate(handler) {\n        return (evt) => {\n            if (!this._paused) {\n                handler(evt);\n            }\n        };\n    }\n    pause() {\n        this._paused = true;\n    }\n    resume() {\n        this._paused = false;\n    }\n    clear() {\n        for (const event in this._nativeHandlers) {\n            this.off(event);\n        }\n    }\n    constructor(nativeComponent) {\n        this.nativeComponent = nativeComponent;\n        this._paused = false;\n        this._nativeHandlers = {};\n    }\n}\nclass BrowserEvents {\n    constructor(_windowGlobal, _documentGlobal) {\n        this._windowGlobal = _windowGlobal;\n        this._documentGlobal = _documentGlobal;\n        this._windowComponent = new BrowserComponent(this._windowGlobal);\n        this._documentComponent = new BrowserComponent(this._documentGlobal);\n    }\n    get window() {\n        return this._windowComponent;\n    }\n    get document() {\n        return this._documentComponent;\n    }\n    pause() {\n        this.window.pause();\n        this.document.pause();\n    }\n    resume() {\n        this.window.resume();\n        this.document.resume();\n    }\n    clear() {\n        this.window.clear();\n        this.document.clear();\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContext.ts\n\nconst DefaultAntialiasOptions = {\n    pixelArtSampler: false,\n    nativeContextAntialiasing: false,\n    multiSampleAntialiasing: true,\n    filtering: ImageFiltering.Blended,\n    canvasImageRendering: 'auto'\n};\nconst DefaultPixelArtOptions = {\n    pixelArtSampler: true,\n    nativeContextAntialiasing: false,\n    multiSampleAntialiasing: true,\n    filtering: ImageFiltering.Blended,\n    canvasImageRendering: 'auto'\n};\n\n;// CONCATENATED MODULE: ./Util/Fps.ts\nclass FpsSampler {\n    constructor(options) {\n        var _a;\n        this._samplePeriod = 100;\n        this._currentFrameTime = 0;\n        this._frames = 0;\n        this._previousSampleTime = 0;\n        this._beginFrameTime = 0;\n        this._fps = options.initialFps;\n        this._samplePeriod = (_a = options.samplePeriod) !== null && _a !== void 0 ? _a : this._samplePeriod;\n        this._currentFrameTime = 1000 / options.initialFps;\n        this._nowFn = options.nowFn;\n        this._previousSampleTime = this._nowFn();\n    }\n    /**\n     * Start of code block to sample FPS for\n     */\n    start() {\n        this._beginFrameTime = this._nowFn();\n    }\n    /**\n     * End of code block to sample FPS for\n     */\n    end() {\n        this._frames++;\n        const time = this._nowFn();\n        this._currentFrameTime = time - this._beginFrameTime;\n        if (time >= this._previousSampleTime + this._samplePeriod) {\n            this._fps = (this._frames * 1000) / (time - this._previousSampleTime);\n            this._previousSampleTime = time;\n            this._frames = 0;\n        }\n    }\n    /**\n     * Return the currently sampled fps over the last sample period, by default every 100ms\n     */\n    get fps() {\n        return this._fps;\n    }\n    /**\n     * Return the instantaneous fps, this can be less useful because it will fluctuate given the current frames time\n     */\n    get instant() {\n        return 1000 / this._currentFrameTime;\n    }\n}\n\n;// CONCATENATED MODULE: ./Util/Clock.ts\n\n\n/**\n * Abstract Clock is the base type of all Clocks\n *\n * It has a few opinions\n * 1. It manages the calculation of what \"elapsed\" time means and thus maximum fps\n * 2. The default timing api is implemented in now()\n *\n * To implement your own clock, extend Clock and override start/stop to start and stop the clock, then call update() with whatever\n * method is unique to your clock implementation.\n */\nclass Clock {\n    constructor(options) {\n        var _a, _b, _c;\n        this._onFatalException = () => { };\n        this._maxFps = Infinity;\n        this._lastTime = 0;\n        this._elapsed = 1;\n        this._scheduledCbs = [];\n        this._totalElapsed = 0;\n        this._options = options;\n        this.tick = options.tick;\n        this._lastTime = (_a = this.now()) !== null && _a !== void 0 ? _a : 0;\n        this._maxFps = (_b = options.maxFps) !== null && _b !== void 0 ? _b : this._maxFps;\n        this._onFatalException = (_c = options.onFatalException) !== null && _c !== void 0 ? _c : this._onFatalException;\n        this.fpsSampler = new FpsSampler({\n            initialFps: 60,\n            nowFn: () => this.now()\n        });\n    }\n    /**\n     * Get the elapsed time for the last completed frame\n     */\n    elapsed() {\n        return this._elapsed;\n    }\n    /**\n     * Get the current time in milliseconds\n     */\n    now() {\n        return performance.now();\n    }\n    toTestClock() {\n        const testClock = new TestClock({\n            ...this._options,\n            defaultUpdateMs: 16.6\n        });\n        return testClock;\n    }\n    toStandardClock() {\n        const clock = new StandardClock({\n            ...this._options\n        });\n        return clock;\n    }\n    setFatalExceptionHandler(handler) {\n        this._onFatalException = handler;\n    }\n    /**\n     * Schedule a callback to fire given a timeout in milliseconds using the excalibur [[Clock]]\n     *\n     * This is useful to use over the built in browser `setTimeout` because callbacks will be tied to the\n     * excalibur update clock, instead of browser time, this means that callbacks wont fire if the game is\n     * stopped or paused.\n     * @param cb callback to fire\n     * @param timeoutMs Optionally specify a timeout in milliseconds from now, default is 0ms which means the next possible tick\n     * @param timing Optionally specify a timeout in milliseconds from now, default is 0ms which means the next possible tick\n     */\n    schedule(cb, timeoutMs = 0, timing = 'preframe') {\n        // Scheduled based on internal elapsed time\n        const scheduledTime = this._totalElapsed + timeoutMs;\n        this._scheduledCbs.push([cb, scheduledTime, timing]);\n    }\n    /**\n     * Called internally to trigger scheduled callbacks in the clock\n     * @param timing\n     * @internal\n     */\n    __runScheduledCbs(timing = 'preframe') {\n        // walk backwards to delete items as we loop\n        for (let i = this._scheduledCbs.length - 1; i > -1; i--) {\n            if (timing === this._scheduledCbs[i][2] && this._scheduledCbs[i][1] <= this._totalElapsed) {\n                this._scheduledCbs[i][0](this._elapsed);\n                this._scheduledCbs.splice(i, 1);\n            }\n        }\n    }\n    update(overrideUpdateMs) {\n        try {\n            this.fpsSampler.start();\n            // Get the time to calculate time-elapsed\n            const now = this.now();\n            let elapsed = now - this._lastTime || 1; // first frame\n            // Constrain fps\n            const fpsInterval = (1000 / this._maxFps);\n            // only run frame if enough time has elapsed\n            if (elapsed >= fpsInterval) {\n                let leftover = 0;\n                if (fpsInterval !== 0) {\n                    leftover = (elapsed % fpsInterval);\n                    elapsed = elapsed - leftover; // shift elapsed to be \"in phase\" with the current loop fps\n                }\n                // Resolves issue #138 if the game has been paused, or blurred for\n                // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\n                // and provides more expected behavior when the engine comes back\n                // into focus\n                if (elapsed > 200) {\n                    elapsed = 1;\n                }\n                // tick the mainloop and run scheduled callbacks\n                this._elapsed = overrideUpdateMs || elapsed;\n                this._totalElapsed += this._elapsed;\n                this.__runScheduledCbs('preframe');\n                this.tick(overrideUpdateMs || elapsed);\n                this.__runScheduledCbs('postframe');\n                if (fpsInterval !== 0) {\n                    this._lastTime = now - leftover;\n                }\n                else {\n                    this._lastTime = now;\n                }\n                this.fpsSampler.end();\n            }\n        }\n        catch (e) {\n            this._onFatalException(e);\n            this.stop();\n        }\n    }\n}\n/**\n * The [[StandardClock]] implements the requestAnimationFrame browser api to run the tick()\n */\nclass StandardClock extends Clock {\n    constructor(options) {\n        super(options);\n        this._running = false;\n    }\n    isRunning() {\n        return this._running;\n    }\n    start() {\n        if (this._running) {\n            return;\n        }\n        this._running = true;\n        const mainloop = () => {\n            // stop the loop\n            if (!this._running) {\n                return;\n            }\n            try {\n                // request next loop\n                this._requestId = window.requestAnimationFrame(mainloop);\n                this.update();\n            }\n            catch (e) {\n                window.cancelAnimationFrame(this._requestId);\n                throw e;\n            }\n        };\n        // begin the first frame\n        mainloop();\n    }\n    stop() {\n        window.cancelAnimationFrame(this._requestId);\n        this._running = false;\n    }\n}\n/**\n * The TestClock is meant for debugging interactions in excalibur that require precise timing to replicate or test\n */\nclass TestClock extends Clock {\n    constructor(options) {\n        super({\n            ...options\n        });\n        this._logger = Logger.getInstance();\n        this._running = false;\n        this._currentTime = 0;\n        this._updateMs = options.defaultUpdateMs;\n    }\n    /**\n     * Get the current time in milliseconds\n     */\n    now() {\n        var _a;\n        return (_a = this._currentTime) !== null && _a !== void 0 ? _a : 0;\n    }\n    isRunning() {\n        return this._running;\n    }\n    start() {\n        this._running = true;\n    }\n    stop() {\n        this._running = false;\n    }\n    /**\n     * Manually step the clock forward 1 tick, optionally specify an elapsed time in milliseconds\n     * @param overrideUpdateMs\n     */\n    step(overrideUpdateMs) {\n        const time = overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs;\n        if (this._running) {\n            // to be comparable to RAF this needs to be a full blown Task\n            // For example, images cannot decode synchronously in a single step\n            this.update(time);\n            this._currentTime += time;\n        }\n        else {\n            this._logger.warn('The clock is not running, no step will be performed');\n        }\n    }\n    /**\n     * Run a number of steps that tick the clock, optionally specify an elapsed time in milliseconds\n     * @param numberOfSteps\n     * @param overrideUpdateMs\n     */\n    run(numberOfSteps, overrideUpdateMs) {\n        for (let i = 0; i < numberOfSteps; i++) {\n            this.step(overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs);\n        }\n    }\n}\n\n// EXTERNAL MODULE: ./Util/Toaster.css\nvar Util_Toaster = __webpack_require__(4296);\n;// CONCATENATED MODULE: ./Util/Toaster.ts\n\n/**\n * The Toaster is only meant to be called from inside Excalibur to display messages to players\n */\nclass Toaster {\n    constructor() {\n        this._toasterCss = Util_Toaster/* default */.A.toString();\n        this._isInitialized = false;\n    }\n    _initialize() {\n        if (!this._isInitialized) {\n            this._container = document.createElement('div');\n            this._container.id = 'ex-toast-container';\n            document.body.appendChild(this._container);\n            this._isInitialized = true;\n            this._styleBlock = document.createElement('style');\n            this._styleBlock.textContent = this._toasterCss;\n            document.head.appendChild(this._styleBlock);\n        }\n    }\n    dispose() {\n        this._container.parentElement.removeChild(this._container);\n        this._styleBlock.parentElement.removeChild(this._styleBlock);\n        this._isInitialized = false;\n    }\n    _createFragment(message) {\n        const toastMessage = document.createElement('span');\n        toastMessage.innerText = message;\n        return toastMessage;\n    }\n    /**\n     * Display a toast message to a player\n     * @param message Text of the message, messages may have a single \"[LINK]\" to influence placement\n     * @param linkTarget Optionally specify a link location\n     * @param linkName Optionally specify a name for that link location\n     */\n    toast(message, linkTarget, linkName) {\n        this._initialize();\n        const toast = document.createElement('div');\n        toast.className = 'ex-toast-message';\n        const messageFragments = message.split('[LINK]').map(message => this._createFragment(message));\n        if (linkTarget) {\n            const link = document.createElement('a');\n            link.href = linkTarget;\n            if (linkName) {\n                link.innerText = linkName;\n            }\n            else {\n                link.innerText = linkTarget;\n            }\n            messageFragments.splice(1, 0, link);\n        }\n        // Assembly message\n        const finalMessage = document.createElement('div');\n        messageFragments.forEach(message => {\n            finalMessage.appendChild(message);\n        });\n        toast.appendChild(finalMessage);\n        // Dismiss button\n        const dismissBtn = document.createElement('button');\n        dismissBtn.innerText = 'x';\n        dismissBtn.addEventListener('click', () => {\n            this._container.removeChild(toast);\n        });\n        toast.appendChild(dismissBtn);\n        // Escape to dismiss\n        const keydownHandler = (evt) => {\n            if (evt.key === 'Escape') {\n                try {\n                    this._container.removeChild(toast);\n                }\n                catch (_a) {\n                    // pass\n                }\n            }\n            document.removeEventListener('keydown', keydownHandler);\n        };\n        document.addEventListener('keydown', keydownHandler);\n        // Insert into container\n        const first = this._container.firstChild;\n        this._container.insertBefore(toast, first);\n    }\n}\n\n;// CONCATENATED MODULE: ./Director/Director.ts\n\n\n\n\n\n\nconst DirectorEvents = {\n    NavigationStart: 'navigationstart',\n    Navigation: 'navigation',\n    NavigationEnd: 'navigationend'\n};\n/**\n * The Director is responsible for managing scenes and changing scenes in Excalibur.\n *\n * It deals with transitions, scene loaders, switching scenes\n *\n * This is used internally by Excalibur, generally not mean to\n * be instantiated end users directly.\n */\nclass Director {\n    /**\n     * Gets whether the director currently transitioning between scenes\n     *\n     * Useful if you need to block behavior during transition\n     */\n    get isTransitioning() {\n        return this._isTransitioning;\n    }\n    constructor(_engine, scenes) {\n        this._engine = _engine;\n        this.events = new EventEmitter();\n        this._logger = Logger.getInstance();\n        this._initialized = false;\n        /**\n         * All registered scenes in Excalibur\n         */\n        this.scenes = {};\n        /**\n         * Holds all instantiated scenes\n         */\n        this._sceneToInstance = new Map();\n        this._sceneToLoader = new Map();\n        this._sceneToTransition = new Map();\n        /**\n         * Used to keep track of scenes that have already been loaded so we don't load multiple times\n         */\n        this._loadedScenes = new Set();\n        this._isTransitioning = false;\n        this.rootScene = this.currentScene = new Scene();\n        this.add('root', this.rootScene);\n        this.currentScene = this.rootScene;\n        this.currentSceneName = 'root';\n        for (const sceneKey in scenes) {\n            const sceneOrOptions = scenes[sceneKey];\n            this.add(sceneKey, sceneOrOptions);\n            if (sceneKey === 'root') {\n                this.rootScene = this.getSceneInstance('root');\n                this.currentScene = this.rootScene;\n            }\n        }\n    }\n    /**\n     * Initialize the director's internal state\n     */\n    async onInitialize() {\n        if (!this._initialized) {\n            this._initialized = true;\n            if (this._deferredGoto) {\n                const deferredScene = this._deferredGoto;\n                const deferredTransition = this._deferredTransition;\n                this._deferredGoto = null;\n                this._deferredTransition = null;\n                await this.swapScene(deferredScene);\n                if (deferredTransition) {\n                    await this.playTransition(deferredTransition);\n                }\n            }\n            else {\n                await this.swapScene('root');\n            }\n        }\n    }\n    get isInitialized() {\n        return this._initialized;\n    }\n    /**\n     * Configures the start scene, and optionally the transition & loader for the director\n     *\n     * Typically this is called at the beginning of the game to the start scene and transition and never again.\n     * @param startScene\n     * @param options\n     */\n    configureStart(startScene, options) {\n        const maybeLoaderOrCtor = options === null || options === void 0 ? void 0 : options.loader;\n        if (maybeLoaderOrCtor instanceof DefaultLoader) {\n            this.mainLoader = maybeLoaderOrCtor;\n        }\n        else if (isLoaderConstructor(maybeLoaderOrCtor)) {\n            this.mainLoader = new maybeLoaderOrCtor();\n        }\n        else {\n            this.mainLoader = new Loader();\n        }\n        let maybeStartTransition;\n        if (options) {\n            const { inTransition } = options;\n            maybeStartTransition = inTransition;\n        }\n        this.startScene = startScene;\n        // Fire and forget promise for the initial scene\n        if (maybeStartTransition) {\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this.swapScene(this.startScene).then(() => {\n                // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                this.playTransition(maybeStartTransition);\n            });\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this.swapScene(this.startScene);\n        }\n        this.currentSceneName = this.startScene;\n    }\n    _getLoader(sceneName) {\n        return this._sceneToLoader.get(sceneName);\n    }\n    _getInTransition(sceneName) {\n        var _a;\n        const sceneOrRoute = this.scenes[sceneName];\n        if (sceneOrRoute instanceof Scene || isSceneConstructor(sceneOrRoute)) {\n            return null;\n        }\n        return (_a = sceneOrRoute === null || sceneOrRoute === void 0 ? void 0 : sceneOrRoute.transitions) === null || _a === void 0 ? void 0 : _a.in;\n    }\n    _getOutTransition(sceneName) {\n        var _a;\n        const sceneOrRoute = this.scenes[sceneName];\n        if (sceneOrRoute instanceof Scene || isSceneConstructor(sceneOrRoute)) {\n            return null;\n        }\n        return (_a = sceneOrRoute === null || sceneOrRoute === void 0 ? void 0 : sceneOrRoute.transitions) === null || _a === void 0 ? void 0 : _a.out;\n    }\n    getDeferredScene() {\n        const maybeDeferred = this.getSceneDefinition(this._deferredGoto);\n        if (this._deferredGoto && maybeDeferred) {\n            return maybeDeferred;\n        }\n        return null;\n    }\n    /**\n     * Returns a scene by name if it exists, might be the constructor and not the instance of a scene\n     * @param name\n     */\n    getSceneDefinition(name) {\n        const maybeScene = this.scenes[name];\n        if (maybeScene instanceof Scene || isSceneConstructor(maybeScene)) {\n            return maybeScene;\n        }\n        else if (maybeScene) {\n            return maybeScene.scene;\n        }\n        return undefined;\n    }\n    /**\n     * Returns the name of the registered scene, null if none can be found\n     * @param scene\n     */\n    getSceneName(scene) {\n        for (const [name, maybeScene] of Object.entries(this.scenes)) {\n            if (maybeScene instanceof Scene) {\n                if (scene === maybeScene) {\n                    return name;\n                }\n            }\n            else if (!isSceneConstructor(maybeScene)) {\n                if (scene === maybeScene.scene) {\n                    return name;\n                }\n            }\n        }\n        for (const [name, maybeScene] of Object.entries(this.scenes)) {\n            if (isSceneConstructor(maybeScene)) {\n                if (scene.constructor === maybeScene) {\n                    return name;\n                }\n            }\n            else if (!(maybeScene instanceof Scene)) {\n                if (scene.constructor === maybeScene.scene) {\n                    return name;\n                }\n            }\n        }\n        return null;\n    }\n    /**\n     * Returns the same Director, but asserts a scene DOES exist to the type system\n     * @param name\n     */\n    assertAdded(name) {\n        return this;\n    }\n    /**\n     * Returns the same Director, but asserts a scene DOES NOT exist to the type system\n     * @param name\n     */\n    assertRemoved(name) {\n        return this;\n    }\n    /**\n     * Adds additional Scenes to the game!\n     * @param name\n     * @param sceneOrRoute\n     */\n    add(name, sceneOrRoute) {\n        if (!(sceneOrRoute instanceof Scene) && !(isSceneConstructor(sceneOrRoute))) {\n            const { loader, transitions } = sceneOrRoute;\n            const { in: inTransition, out: outTransition } = transitions !== null && transitions !== void 0 ? transitions : {};\n            this._sceneToTransition.set(name, { in: inTransition, out: outTransition });\n            if (isLoaderConstructor(loader)) {\n                this._sceneToLoader.set(name, new loader());\n            }\n            else {\n                this._sceneToLoader.set(name, loader);\n            }\n        }\n        if (this.scenes[name]) {\n            this._logger.warn('Scene', name, 'already exists overwriting');\n        }\n        this.scenes[name] = sceneOrRoute;\n        return this.assertAdded(name);\n    }\n    remove(nameOrScene) {\n        if (nameOrScene instanceof Scene || isSceneConstructor(nameOrScene)) {\n            const sceneOrCtor = nameOrScene;\n            // remove scene\n            for (const key in this.scenes) {\n                if (this.scenes.hasOwnProperty(key)) {\n                    const potentialSceneOrOptions = this.scenes[key];\n                    let scene;\n                    if (potentialSceneOrOptions instanceof Scene || isSceneConstructor(potentialSceneOrOptions)) {\n                        scene = potentialSceneOrOptions;\n                    }\n                    else {\n                        scene = potentialSceneOrOptions.scene;\n                    }\n                    if (scene === sceneOrCtor) {\n                        if (key === this.currentSceneName) {\n                            throw new Error(`Cannot remove a currently active scene: ${key}`);\n                        }\n                        this._sceneToInstance.delete(key);\n                        this._sceneToTransition.delete(key);\n                        this._sceneToLoader.delete(key);\n                        delete this.scenes[key];\n                    }\n                }\n            }\n        }\n        if (typeof nameOrScene === 'string') {\n            if (nameOrScene === this.currentSceneName) {\n                throw new Error(`Cannot remove a currently active scene: ${nameOrScene}`);\n            }\n            // remove scene\n            this._sceneToInstance.delete(nameOrScene);\n            this._sceneToTransition.delete(nameOrScene);\n            this._sceneToLoader.delete(nameOrScene);\n            delete this.scenes[nameOrScene];\n        }\n    }\n    /**\n     * Go to a specific scene, and optionally override loaders and transitions\n     * @param destinationScene\n     * @param options\n     */\n    async goto(destinationScene, options) {\n        var _a, _b, _c, _d, _e, _f;\n        const maybeDest = this.getSceneInstance(destinationScene);\n        if (!maybeDest) {\n            this._logger.warn(`Scene ${destinationScene} does not exist! Check the name, are you sure you added it?`);\n            return;\n        }\n        const sourceScene = this.currentSceneName;\n        const engineInputEnabled = (_b = (_a = this._engine.input) === null || _a === void 0 ? void 0 : _a.enabled) !== null && _b !== void 0 ? _b : true;\n        this._isTransitioning = true;\n        const maybeSourceOut = (_c = this.getSceneInstance(sourceScene)) === null || _c === void 0 ? void 0 : _c.onTransition('out');\n        const maybeDestinationIn = maybeDest === null || maybeDest === void 0 ? void 0 : maybeDest.onTransition('in');\n        options = {\n            // Engine configuration then dynamic scene transitions\n            ...{ sourceOut: (_d = this._getOutTransition(this.currentSceneName)) !== null && _d !== void 0 ? _d : maybeSourceOut },\n            ...{ destinationIn: (_e = this._getInTransition(destinationScene)) !== null && _e !== void 0 ? _e : maybeDestinationIn },\n            // Goto options\n            ...options\n        };\n        const { sourceOut, destinationIn, sceneActivationData } = options;\n        const outTransition = sourceOut !== null && sourceOut !== void 0 ? sourceOut : this._getOutTransition(this.currentSceneName);\n        const inTransition = destinationIn !== null && destinationIn !== void 0 ? destinationIn : this._getInTransition(destinationScene);\n        const hideLoader = (outTransition === null || outTransition === void 0 ? void 0 : outTransition.hideLoader) || (inTransition === null || inTransition === void 0 ? void 0 : inTransition.hideLoader);\n        if (hideLoader) {\n            // Start hidden loader early and take advantage of the transition\n            // Don't await and block on a hidden loader\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this.maybeLoadScene(destinationScene, hideLoader);\n        }\n        this._emitEvent('navigationstart', sourceScene, destinationScene);\n        // Run the out transition on the current scene if present\n        await this.playTransition(outTransition);\n        // Run the loader if present\n        await this.maybeLoadScene(destinationScene, hideLoader);\n        // Give incoming transition a chance to grab info from previous\n        await (inTransition === null || inTransition === void 0 ? void 0 : inTransition.onPreviousSceneDeactivate(this.currentScene));\n        // Swap to the new scene\n        await this.swapScene(destinationScene, sceneActivationData);\n        this._emitEvent('navigation', sourceScene, destinationScene);\n        // Run the in transition on the new scene if present\n        await this.playTransition(inTransition);\n        this._emitEvent('navigationend', sourceScene, destinationScene);\n        (_f = this._engine.input) === null || _f === void 0 ? void 0 : _f.toggleEnabled(engineInputEnabled);\n        this._isTransitioning = false;\n    }\n    /**\n     * Retrieves a scene instance by key if it's registered.\n     *\n     * This will call any constructors that were given as a definition\n     * @param scene\n     */\n    getSceneInstance(scene) {\n        const sceneDefinition = this.getSceneDefinition(scene);\n        if (!sceneDefinition) {\n            return undefined;\n        }\n        if (this._sceneToInstance.has(scene)) {\n            return this._sceneToInstance.get(scene);\n        }\n        if (sceneDefinition instanceof Scene) {\n            this._sceneToInstance.set(scene, sceneDefinition);\n            return sceneDefinition;\n        }\n        const newScene = new sceneDefinition();\n        this._sceneToInstance.set(scene, newScene);\n        return newScene;\n    }\n    /**\n     * Triggers scene loading if has not already been loaded\n     * @param scene\n     * @param hideLoader\n     */\n    async maybeLoadScene(scene, hideLoader = false) {\n        var _a;\n        const loader = (_a = this._getLoader(scene)) !== null && _a !== void 0 ? _a : new DefaultLoader();\n        const sceneToLoad = this.getSceneDefinition(scene);\n        const sceneToLoadInstance = this.getSceneInstance(scene);\n        if (sceneToLoad && sceneToLoadInstance && !this._loadedScenes.has(sceneToLoadInstance)) {\n            sceneToLoadInstance.onPreLoad(loader);\n            sceneToLoadInstance.events.emit('preload', { loader });\n            if (hideLoader) {\n                // Don't await a hidden loader\n                // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                this._engine.load(loader, hideLoader);\n            }\n            else {\n                await this._engine.load(loader);\n            }\n            this._loadedScenes.add(sceneToLoadInstance);\n        }\n    }\n    /**\n     * Plays a transition in the current scene\n     * @param transition\n     */\n    async playTransition(transition) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        if (!this.isInitialized) {\n            this._deferredTransition = transition;\n            return;\n        }\n        if (transition) {\n            this.currentTransition = transition;\n            const currentScene = this._engine.currentScene;\n            const sceneInputEnabled = (_b = (_a = currentScene.input) === null || _a === void 0 ? void 0 : _a.enabled) !== null && _b !== void 0 ? _b : true;\n            (_c = currentScene.input) === null || _c === void 0 ? void 0 : _c.toggleEnabled(!transition.blockInput);\n            (_d = this._engine.input) === null || _d === void 0 ? void 0 : _d.toggleEnabled(!transition.blockInput);\n            await this.currentTransition.play(this._engine);\n            (_e = currentScene.input) === null || _e === void 0 ? void 0 : _e.toggleEnabled(sceneInputEnabled);\n        }\n        (_f = this.currentTransition) === null || _f === void 0 ? void 0 : _f.kill();\n        (_g = this.currentTransition) === null || _g === void 0 ? void 0 : _g.reset();\n        this.currentTransition = null;\n    }\n    /**\n     * Swaps the current and destination scene after performing required lifecycle events\n     * @param destinationScene\n     * @param data\n     */\n    async swapScene(destinationScene, data) {\n        const engine = this._engine;\n        // if not yet initialized defer goToScene\n        if (!this.isInitialized) {\n            this._deferredGoto = destinationScene;\n            return;\n        }\n        const maybeDest = this.getSceneInstance(destinationScene);\n        if (maybeDest) {\n            const previousScene = this.currentScene;\n            const nextScene = maybeDest;\n            this._logger.debug('Going to scene:', destinationScene);\n            // only deactivate when initialized\n            if (this.currentScene.isInitialized) {\n                const context = { engine, previousScene, nextScene };\n                await this.currentScene._deactivate(context);\n                this.currentScene.events.emit('deactivate', new DeactivateEvent(context, this.currentScene));\n            }\n            // wait for the scene to be loaded if needed\n            const destLoader = this._sceneToLoader.get(destinationScene);\n            await (destLoader === null || destLoader === void 0 ? void 0 : destLoader.areResourcesLoaded());\n            // set current scene to new one\n            this.currentScene = nextScene;\n            this.currentSceneName = destinationScene;\n            engine.screen.setCurrentCamera(nextScene.camera);\n            // initialize the current scene if has not been already\n            await this.currentScene._initialize(engine);\n            const context = { engine, previousScene, nextScene, data };\n            await this.currentScene._activate(context);\n            this.currentScene.events.emit('activate', new ActivateEvent(context, this.currentScene));\n        }\n        else {\n            this._logger.error('Scene', destinationScene, 'does not exist!');\n        }\n    }\n    _emitEvent(eventName, sourceScene, destinationScene) {\n        const source = this.getSceneDefinition(sourceScene);\n        const dest = this.getSceneDefinition(destinationScene);\n        this.events.emit(eventName, {\n            sourceScene: source,\n            sourceName: sourceScene,\n            destinationScene: dest,\n            destinationName: destinationScene\n        });\n    }\n}\n\n;// CONCATENATED MODULE: ./Context.ts\n/**\n * Creates a injectable context that can be retrieved later with `useContext(context)`\n *\n * Example\n * ```typescript\n *\n * const AppContext = createContext({some: 'value'});\n * context.scope(val, () => {\n *    const value = useContext(AppContext);\n * })\n *\n * ```\n */\nfunction createContext() {\n    const ctx = {\n        scope: (value, cb) => {\n            ctx.value = value;\n            return cb();\n        },\n        value: undefined\n    };\n    return ctx;\n}\n/**\n * Retrieves the value from the current context\n */\nfunction useContext(context) {\n    return context.value;\n}\n\n;// CONCATENATED MODULE: ./Engine.ts\n\n\n\n\n\n\npolyfill();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst EngineEvents = {\n    FallbackGraphicsContext: 'fallbackgraphicscontext',\n    Initialize: 'initialize',\n    Visible: 'visible',\n    Hidden: 'hidden',\n    Start: 'start',\n    Stop: 'stop',\n    PreUpdate: 'preupdate',\n    PostUpdate: 'postupdate',\n    PreFrame: 'preframe',\n    PostFrame: 'postframe',\n    PreDraw: 'predraw',\n    PostDraw: 'postdraw'\n};\n/**\n * Enum representing the different mousewheel event bubble prevention\n */\nvar ScrollPreventionMode;\n(function (ScrollPreventionMode) {\n    /**\n     * Do not prevent any page scrolling\n     */\n    ScrollPreventionMode[ScrollPreventionMode[\"None\"] = 0] = \"None\";\n    /**\n     * Prevent page scroll if mouse is over the game canvas\n     */\n    ScrollPreventionMode[ScrollPreventionMode[\"Canvas\"] = 1] = \"Canvas\";\n    /**\n     * Prevent all page scrolling via mouse wheel\n     */\n    ScrollPreventionMode[ScrollPreventionMode[\"All\"] = 2] = \"All\";\n})(ScrollPreventionMode || (ScrollPreventionMode = {}));\n/**\n * The Excalibur Engine\n *\n * The [[Engine]] is the main driver for a game. It is responsible for\n * starting/stopping the game, maintaining state, transmitting events,\n * loading resources, and managing the scene.\n */\nclass Engine {\n    static useEngine() {\n        const value = useContext(Engine.Context);\n        if (!value) {\n            throw new Error('Cannot inject engine with `useEngine()`, `useEngine()` was called outside of Engine lifecycle scope.');\n        }\n        return value;\n    }\n    /**\n     * The width of the game canvas in pixels (physical width component of the\n     * resolution of the canvas element)\n     */\n    get canvasWidth() {\n        return this.screen.canvasWidth;\n    }\n    /**\n     * Returns half width of the game canvas in pixels (half physical width component)\n     */\n    get halfCanvasWidth() {\n        return this.screen.halfCanvasWidth;\n    }\n    /**\n     * The height of the game canvas in pixels, (physical height component of\n     * the resolution of the canvas element)\n     */\n    get canvasHeight() {\n        return this.screen.canvasHeight;\n    }\n    /**\n     * Returns half height of the game canvas in pixels (half physical height component)\n     */\n    get halfCanvasHeight() {\n        return this.screen.halfCanvasHeight;\n    }\n    /**\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get drawWidth() {\n        return this.screen.drawWidth;\n    }\n    /**\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get halfDrawWidth() {\n        return this.screen.halfDrawWidth;\n    }\n    /**\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get drawHeight() {\n        return this.screen.drawHeight;\n    }\n    /**\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n     */\n    get halfDrawHeight() {\n        return this.screen.halfDrawHeight;\n    }\n    /**\n     * Returns whether excalibur detects the current screen to be HiDPI\n     */\n    get isHiDpi() {\n        return this.screen.isHiDpi;\n    }\n    /**\n     * Access [[stats]] that holds frame statistics.\n     */\n    get stats() {\n        return this.debug.stats;\n    }\n    /**\n     * The current [[Scene]] being drawn and updated on screen\n     */\n    get currentScene() {\n        return this.director.currentScene;\n    }\n    /**\n     * The current [[Scene]] being drawn and updated on screen\n     */\n    get currentSceneName() {\n        return this.director.currentSceneName;\n    }\n    /**\n     * The default [[Scene]] of the game, use [[Engine.goToScene]] to transition to different scenes.\n     */\n    get rootScene() {\n        return this.director.rootScene;\n    }\n    /**\n     * Contains all the scenes currently registered with Excalibur\n     */\n    get scenes() {\n        return this.director.scenes;\n    }\n    ;\n    /**\n     * Indicates whether the engine is set to fullscreen or not\n     */\n    get isFullscreen() {\n        return this.screen.isFullScreen;\n    }\n    /**\n     * Indicates the current [[DisplayMode]] of the engine.\n     */\n    get displayMode() {\n        return this.screen.displayMode;\n    }\n    /**\n     * Returns the calculated pixel ration for use in rendering\n     */\n    get pixelRatio() {\n        return this.screen.pixelRatio;\n    }\n    get isDebug() {\n        return this._isDebug;\n    }\n    /**\n     * Hints the graphics context to truncate fractional world space coordinates\n     */\n    get snapToPixel() {\n        return this.graphicsContext.snapToPixel;\n    }\n    ;\n    set snapToPixel(shouldSnapToPixel) {\n        this.graphicsContext.snapToPixel = shouldSnapToPixel;\n    }\n    ;\n    emit(eventName, event) {\n        this.events.emit(eventName, event);\n    }\n    on(eventName, handler) {\n        return this.events.on(eventName, handler);\n    }\n    once(eventName, handler) {\n        return this.events.once(eventName, handler);\n    }\n    off(eventName, handler) {\n        this.events.off(eventName, handler);\n    }\n    /**\n     * Creates a new game using the given [[EngineOptions]]. By default, if no options are provided,\n     * the game will be rendered full screen (taking up all available browser window space).\n     * You can customize the game rendering through [[EngineOptions]].\n     *\n     * Example:\n     *\n     * ```js\n     * var game = new ex.Engine({\n     *   width: 0, // the width of the canvas\n     *   height: 0, // the height of the canvas\n     *   enableCanvasTransparency: true, // the transparencySection of the canvas\n     *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own\n     *   displayMode: ex.DisplayMode.FullScreen, // the display mode\n     *   pointerScope: ex.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events\n     *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine\n     * });\n     *\n     * // call game.start, which is a Promise\n     * game.start().then(function () {\n     *   // ready, set, go!\n     * });\n     * ```\n     */\n    constructor(options) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        /**\n         * Anything run under scope can use `useEngine()` to inject the current engine\n         * @param cb\n         */\n        this.scope = (cb) => Engine.Context.scope(this, cb);\n        /**\n         * Current Excalibur version string\n         *\n         * Useful for plugins or other tools that need to know what features are available\n         */\n        this.version = EX_VERSION;\n        /**\n         * Listen to and emit events on the Engine\n         */\n        this.events = new EventEmitter();\n        /**\n         * Optionally set the maximum fps if not set Excalibur will go as fast as the device allows.\n         *\n         * You may want to constrain max fps if your game cannot maintain fps consistently, it can look and feel better to have a 30fps game than\n         * one that bounces between 30fps and 60fps\n         */\n        this.maxFps = Number.POSITIVE_INFINITY;\n        this._inputEnabled = true;\n        this._suppressPlayButton = false;\n        /**\n         * Indicates whether audio should be paused when the game is no longer visible.\n         */\n        this.pauseAudioWhenHidden = true;\n        /**\n         * Indicates whether the engine should draw with debug information\n         */\n        this._isDebug = false;\n        /**\n         * Sets the Transparency for the engine.\n         */\n        this.enableCanvasTransparency = true;\n        /**\n         * The action to take when a fatal exception is thrown\n         */\n        this.onFatalException = (e) => {\n            Logger.getInstance().fatal(e, e.stack);\n        };\n        this._toaster = new Toaster();\n        this._timescale = 1.0;\n        this._isInitialized = false;\n        this._originalOptions = {};\n        this._handleWebGLContextLost = (e) => {\n            var _a;\n            e.preventDefault();\n            this.clock.stop();\n            this._logger.fatalOnce('WebGL Graphics Lost', e);\n            const container = document.createElement('div');\n            container.id = 'ex-webgl-graphics-context-lost';\n            container.style.position = 'absolute';\n            container.style.zIndex = '99';\n            container.style.left = '50%';\n            container.style.top = '50%';\n            container.style.display = 'flex';\n            container.style.flexDirection = 'column';\n            container.style.transform = 'translate(-50%, -50%)';\n            container.style.backgroundColor = 'white';\n            container.style.padding = '10px';\n            container.style.borderStyle = 'solid 1px';\n            const div = document.createElement('div');\n            div.innerHTML = `\r\n      <h1>There was an issue rendering, please refresh the page.</h1>\r\n      <div>\r\n        <p>WebGL Graphics Context Lost</p>\r\n\r\n        <button id=\"ex-webgl-graphics-reload\">Refresh Page</button>\r\n\r\n        <p>There are a few reasons this might happen:</p>\r\n        <ul>\r\n          <li>Two or more pages are placing a high demand on the GPU</li>\r\n          <li>Another page or operation has stalled the GPU and the browser has decided to reset the GPU</li>\r\n          <li>The computer has multiple GPUs and the user has switched between them</li>\r\n          <li>Graphics driver has crashed or restarted</li>\r\n          <li>Graphics driver was updated</li>\r\n        </ul>\r\n      </div>\r\n    `;\n            container.appendChild(div);\n            if ((_a = this.canvas) === null || _a === void 0 ? void 0 : _a.parentElement) {\n                this.canvas.parentElement.appendChild(container);\n                const button = div.querySelector('#ex-webgl-graphics-reload');\n                button === null || button === void 0 ? void 0 : button.addEventListener('click', () => location.reload());\n            }\n        };\n        this._performanceThresholdTriggered = false;\n        this._fpsSamples = [];\n        this._disposed = false;\n        this._isLoading = false;\n        this._hideLoader = false;\n        this._isReadyFuture = new Future();\n        /**\n         * Returns the current frames elapsed milliseconds\n         */\n        this.currentFrameElapsedMs = 0;\n        /**\n         * Returns the current frame lag when in fixed update mode\n         */\n        this.currentFrameLagMs = 0;\n        this._lagMs = 0;\n        this._screenShotRequests = [];\n        options = { ...Engine._DEFAULT_ENGINE_OPTIONS, ...options };\n        this._originalOptions = options;\n        Flags.freeze();\n        // Initialize browser events facade\n        this.browser = new BrowserEvents(window, document);\n        // Check compatibility\n        const detector = new Detector();\n        if (!options.suppressMinimumBrowserFeatureDetection && !(this._compatible = detector.test())) {\n            const message = document.createElement('div');\n            message.innerText = 'Sorry, your browser does not support all the features needed for Excalibur';\n            document.body.appendChild(message);\n            detector.failedTests.forEach(function (test) {\n                const testMessage = document.createElement('div');\n                testMessage.innerText = 'Browser feature missing ' + test;\n                document.body.appendChild(testMessage);\n            });\n            if (options.canvasElementId) {\n                const canvas = document.getElementById(options.canvasElementId);\n                if (canvas) {\n                    canvas.parentElement.removeChild(canvas);\n                }\n            }\n            return;\n        }\n        else {\n            this._compatible = true;\n        }\n        // Use native console API for color fun\n        // eslint-disable-next-line no-console\n        if (console.log && !options.suppressConsoleBootMessage) {\n            // eslint-disable-next-line no-console\n            console.log(`%cPowered by Excalibur.js (v${EX_VERSION})`, 'background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;');\n            // eslint-disable-next-line no-console\n            console.log('\\n\\\r\n      /| ________________\\n\\\r\nO|===|* >________________>\\n\\\r\n      \\\\|');\n            // eslint-disable-next-line no-console\n            console.log('Visit', 'http://excaliburjs.com', 'for more information');\n        }\n        // Suppress play button\n        if (options.suppressPlayButton) {\n            this._suppressPlayButton = true;\n        }\n        this._logger = Logger.getInstance();\n        // If debug is enabled, let's log browser features to the console.\n        if (this._logger.defaultLevel === LogLevel.Debug) {\n            detector.logBrowserFeatures();\n        }\n        this._logger.debug('Building engine...');\n        this.canvasElementId = options.canvasElementId;\n        if (options.canvasElementId) {\n            this._logger.debug('Using Canvas element specified: ' + options.canvasElementId);\n            //test for existence of element\n            if (document.getElementById(options.canvasElementId) === null) {\n                throw new Error('Cannot find existing element in the DOM, please ensure element is created prior to engine creation.');\n            }\n            this.canvas = document.getElementById(options.canvasElementId);\n        }\n        else if (options.canvasElement) {\n            this._logger.debug('Using Canvas element specified:', options.canvasElement);\n            this.canvas = options.canvasElement;\n        }\n        else {\n            this._logger.debug('Using generated canvas element');\n            this.canvas = document.createElement('canvas');\n        }\n        let displayMode = (_a = options.displayMode) !== null && _a !== void 0 ? _a : DisplayMode.Fixed;\n        if ((options.width && options.height) || options.viewport) {\n            if (options.displayMode === undefined) {\n                displayMode = DisplayMode.Fixed;\n            }\n            this._logger.debug('Engine viewport is size ' + options.width + ' x ' + options.height);\n        }\n        else if (!options.displayMode) {\n            this._logger.debug('Engine viewport is fit');\n            displayMode = DisplayMode.FitScreen;\n        }\n        this._originalDisplayMode = displayMode;\n        let pixelArtSampler;\n        let uvPadding;\n        let nativeContextAntialiasing;\n        let canvasImageRendering;\n        let filtering;\n        let multiSampleAntialiasing;\n        if (typeof options.antialiasing === 'object') {\n            ({\n                pixelArtSampler,\n                nativeContextAntialiasing,\n                multiSampleAntialiasing,\n                filtering,\n                canvasImageRendering\n            } = {\n                ...(options.pixelArt ? DefaultPixelArtOptions : DefaultAntialiasOptions),\n                ...options.antialiasing\n            });\n        }\n        else {\n            pixelArtSampler = !!options.pixelArt;\n            nativeContextAntialiasing = false;\n            multiSampleAntialiasing = options.antialiasing;\n            canvasImageRendering = options.antialiasing ? 'auto' : 'pixelated';\n            filtering = options.antialiasing ? ImageFiltering.Blended : ImageFiltering.Pixel;\n        }\n        if (nativeContextAntialiasing && multiSampleAntialiasing) {\n            this._logger.warnOnce(`Cannot use antialias setting nativeContextAntialiasing and multiSampleAntialiasing` +\n                ` at the same time, they are incompatible settings. If you aren\\'t sure use multiSampleAntialiasing`);\n        }\n        if (options.pixelArt) {\n            uvPadding = .25;\n        }\n        if (!options.antialiasing || filtering === ImageFiltering.Pixel) {\n            uvPadding = 0;\n        }\n        // Override with any user option, if non default to .25 for pixel art, 0.01 for everything else\n        uvPadding = (_c = (_b = options.uvPadding) !== null && _b !== void 0 ? _b : uvPadding) !== null && _c !== void 0 ? _c : 0.01;\n        // Canvas 2D fallback can be flagged on\n        let useCanvasGraphicsContext = Flags.isEnabled('use-canvas-context');\n        if (!useCanvasGraphicsContext) {\n            // Attempt webgl first\n            try {\n                this.graphicsContext = new ExcaliburGraphicsContextWebGL({\n                    canvasElement: this.canvas,\n                    enableTransparency: this.enableCanvasTransparency,\n                    pixelArtSampler: pixelArtSampler,\n                    antialiasing: nativeContextAntialiasing,\n                    multiSampleAntialiasing: multiSampleAntialiasing,\n                    uvPadding: uvPadding,\n                    powerPreference: options.powerPreference,\n                    backgroundColor: options.backgroundColor,\n                    snapToPixel: options.snapToPixel,\n                    useDrawSorting: options.useDrawSorting,\n                    handleContextLost: (_d = options.handleContextLost) !== null && _d !== void 0 ? _d : this._handleWebGLContextLost,\n                    handleContextRestored: options.handleContextRestored\n                });\n            }\n            catch (e) {\n                this._logger.warn(`Excalibur could not load webgl for some reason (${e.message}) and loaded a Canvas 2D fallback. ` +\n                    `Some features of Excalibur will not work in this mode. \\n\\n` +\n                    'Read more about this issue at https://excaliburjs.com/docs/performance');\n                // fallback to canvas in case of failure\n                useCanvasGraphicsContext = true;\n            }\n        }\n        if (useCanvasGraphicsContext) {\n            this.graphicsContext = new ExcaliburGraphicsContext2DCanvas({\n                canvasElement: this.canvas,\n                enableTransparency: this.enableCanvasTransparency,\n                antialiasing: nativeContextAntialiasing,\n                backgroundColor: options.backgroundColor,\n                snapToPixel: options.snapToPixel,\n                useDrawSorting: options.useDrawSorting\n            });\n        }\n        this.screen = new Screen({\n            canvas: this.canvas,\n            context: this.graphicsContext,\n            antialiasing: nativeContextAntialiasing,\n            canvasImageRendering: canvasImageRendering,\n            browser: this.browser,\n            viewport: (_e = options.viewport) !== null && _e !== void 0 ? _e : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\n            resolution: options.resolution,\n            displayMode,\n            pixelRatio: options.suppressHiDPIScaling ? 1 : ((_f = options.pixelRatio) !== null && _f !== void 0 ? _f : null)\n        });\n        // TODO REMOVE STATIC!!!\n        // Set default filtering based on antialiasing\n        TextureLoader.filtering = filtering;\n        if (options.backgroundColor) {\n            this.backgroundColor = options.backgroundColor.clone();\n        }\n        this.grabWindowFocus = options.grabWindowFocus;\n        this.pointerScope = options.pointerScope;\n        this.maxFps = (_g = options.maxFps) !== null && _g !== void 0 ? _g : this.maxFps;\n        this.fixedUpdateFps = (_h = options.fixedUpdateFps) !== null && _h !== void 0 ? _h : this.fixedUpdateFps;\n        this.clock = new StandardClock({\n            maxFps: this.maxFps,\n            tick: this._mainloop.bind(this),\n            onFatalException: (e) => this.onFatalException(e)\n        });\n        this.enableCanvasTransparency = options.enableCanvasTransparency;\n        if (typeof options.physics === 'boolean') {\n            this.physics = {\n                ...DefaultPhysicsConfig,\n                ...DeprecatedStaticToConfig(),\n                enabled: options.physics\n            };\n        }\n        else {\n            this.physics = {\n                ...DefaultPhysicsConfig,\n                ...DeprecatedStaticToConfig(),\n                ...options.physics\n            };\n        }\n        this.debug = new DebugConfig(this);\n        this.director = new Director(this, options.scenes);\n        this._initialize(options);\n        window.___EXCALIBUR_DEVTOOL = this;\n        Engine.InstanceCount++;\n    }\n    _monitorPerformanceThresholdAndTriggerFallback() {\n        const { allow } = this._originalOptions.configurePerformanceCanvas2DFallback;\n        let { threshold, showPlayerMessage } = this._originalOptions.configurePerformanceCanvas2DFallback;\n        if (threshold === undefined) {\n            threshold = Engine._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold;\n        }\n        if (showPlayerMessage === undefined) {\n            showPlayerMessage = Engine._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage;\n        }\n        if (!Flags.isEnabled('use-canvas-context') && allow && this.ready && !this._performanceThresholdTriggered) {\n            // Calculate Average fps for last X number of frames after start\n            if (this._fpsSamples.length === threshold.numberOfFrames) {\n                this._fpsSamples.splice(0, 1);\n            }\n            this._fpsSamples.push(this.clock.fpsSampler.fps);\n            let total = 0;\n            for (let i = 0; i < this._fpsSamples.length; i++) {\n                total += this._fpsSamples[i];\n            }\n            const average = total / this._fpsSamples.length;\n            if (this._fpsSamples.length === threshold.numberOfFrames) {\n                if (average <= threshold.fps) {\n                    this._performanceThresholdTriggered = true;\n                    this._logger.warn(`Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.\\n` +\n                        'this might mean your browser doesn\\'t have webgl enabled or hardware acceleration is unavailable.\\n\\n' +\n                        'If in Chrome:\\n' +\n                        '  * Visit Settings > Advanced > System, and ensure \"Use Hardware Acceleration\" is checked.\\n' +\n                        '  * Visit chrome://flags/#ignore-gpu-blocklist and ensure \"Override software rendering list\" is \"enabled\"\\n' +\n                        'If in Firefox, visit about:config\\n' +\n                        '  * Ensure webgl.disabled = false\\n' +\n                        '  * Ensure webgl.force-enabled = true\\n' +\n                        '  * Ensure layers.acceleration.force-enabled = true\\n\\n' +\n                        'Read more about this issue at https://excaliburjs.com/docs/performance');\n                    if (showPlayerMessage) {\n                        this._toaster.toast('Excalibur is encountering performance issues. ' +\n                            'It\\'s possible that your browser doesn\\'t have hardware acceleration enabled. ' +\n                            'Visit [LINK] for more information and potential solutions.', 'https://excaliburjs.com/docs/performance');\n                    }\n                    this.useCanvas2DFallback();\n                    this.emit('fallbackgraphicscontext', this.graphicsContext);\n                }\n            }\n        }\n    }\n    /**\n     * Switches the engine's graphics context to the 2D Canvas.\n     * @warning Some features of Excalibur will not work in this mode.\n     */\n    useCanvas2DFallback() {\n        var _a, _b, _c;\n        // Swap out the canvas\n        const newCanvas = this.canvas.cloneNode(false);\n        this.canvas.parentNode.replaceChild(newCanvas, this.canvas);\n        this.canvas = newCanvas;\n        const options = { ...this._originalOptions, antialiasing: this.getAntialiasing() };\n        const displayMode = this._originalDisplayMode;\n        // New graphics context\n        this.graphicsContext = new ExcaliburGraphicsContext2DCanvas({\n            canvasElement: this.canvas,\n            enableTransparency: this.enableCanvasTransparency,\n            antialiasing: options.antialiasing,\n            backgroundColor: options.backgroundColor,\n            snapToPixel: options.snapToPixel,\n            useDrawSorting: options.useDrawSorting\n        });\n        // Reset screen\n        if (this.screen) {\n            this.screen.dispose();\n        }\n        this.screen = new Screen({\n            canvas: this.canvas,\n            context: this.graphicsContext,\n            antialiasing: (_a = options.antialiasing) !== null && _a !== void 0 ? _a : true,\n            browser: this.browser,\n            viewport: (_b = options.viewport) !== null && _b !== void 0 ? _b : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\n            resolution: options.resolution,\n            displayMode,\n            pixelRatio: options.suppressHiDPIScaling ? 1 : ((_c = options.pixelRatio) !== null && _c !== void 0 ? _c : null)\n        });\n        this.screen.setCurrentCamera(this.currentScene.camera);\n        // Reset pointers\n        this.input.pointers.detach();\n        const pointerTarget = options && options.pointerScope === PointerScope.Document ? document : this.canvas;\n        this.input.pointers = this.input.pointers.recreate(pointerTarget, this);\n        this.input.pointers.init();\n    }\n    /**\n     * Attempts to completely clean up excalibur resources, including removing the canvas from the dom.\n     *\n     * To start again you will need to new up an Engine.\n     */\n    dispose() {\n        if (!this._disposed) {\n            this._disposed = true;\n            this.stop();\n            this.input.toggleEnabled(false);\n            this.canvas.parentNode.removeChild(this.canvas);\n            this.canvas = null;\n            this.screen.dispose();\n            this.graphicsContext.dispose();\n            this.graphicsContext = null;\n            Engine.InstanceCount--;\n        }\n    }\n    isDisposed() {\n        return this._disposed;\n    }\n    /**\n     * Returns a BoundingBox of the top left corner of the screen\n     * and the bottom right corner of the screen.\n     */\n    getWorldBounds() {\n        return this.screen.getWorldBounds();\n    }\n    /**\n     * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)\n     */\n    get timescale() {\n        return this._timescale;\n    }\n    /**\n     * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects\n     * when using time-based movement.\n     */\n    set timescale(value) {\n        if (value <= 0) {\n            Logger.getInstance().error('Cannot set engine.timescale to a value of 0 or less than 0.');\n            return;\n        }\n        this._timescale = value;\n    }\n    /**\n     * Adds a [[Timer]] to the [[currentScene]].\n     * @param timer  The timer to add to the [[currentScene]].\n     */\n    addTimer(timer) {\n        return this.currentScene.addTimer(timer);\n    }\n    /**\n     * Removes a [[Timer]] from the [[currentScene]].\n     * @param timer  The timer to remove to the [[currentScene]].\n     */\n    removeTimer(timer) {\n        return this.currentScene.removeTimer(timer);\n    }\n    /**\n     * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\n     * would levels or menus.\n     * @param key  The name of the scene, must be unique\n     * @param scene The scene to add to the engine\n     */\n    addScene(key, scene) {\n        this.director.add(key, scene);\n        return this;\n    }\n    /**\n     * @internal\n     */\n    removeScene(entity) {\n        this.director.remove(entity);\n    }\n    add(entity) {\n        if (arguments.length === 2) {\n            this.director.add(arguments[0], arguments[1]);\n            return;\n        }\n        const maybeDeferred = this.director.getDeferredScene();\n        if (maybeDeferred instanceof Scene) {\n            maybeDeferred.add(entity);\n        }\n        else {\n            this.currentScene.add(entity);\n        }\n    }\n    remove(entity) {\n        if (entity instanceof Entity) {\n            this.currentScene.remove(entity);\n        }\n        if (entity instanceof Scene || isSceneConstructor(entity)) {\n            this.removeScene(entity);\n        }\n        if (typeof entity === 'string') {\n            this.removeScene(entity);\n        }\n    }\n    /**\n     * Changes the current scene with optionally supplied:\n     * * Activation data\n     * * Transitions\n     * * Loaders\n     *\n     * Example:\n     * ```typescript\n     * game.goToScene('myScene', {\n     *   sceneActivationData: {any: 'thing at all'},\n     *   destinationIn: new FadeInOut({duration: 1000, direction: 'in'}),\n     *   sourceOut: new FadeInOut({duration: 1000, direction: 'out'}),\n     *   loader: MyLoader\n     * });\n     * ```\n     *\n     * Scenes are defined in the Engine constructor\n     * ```typescript\n     * const engine = new ex.Engine({\n        scenes: {...}\n      });\n     * ```\n     * Or by adding dynamically\n     *\n     * ```typescript\n     * engine.addScene('myScene', new ex.Scene());\n     * ```\n     * @param destinationScene\n     * @param options\n     * @deprecated use goToScene, it now behaves the same as goto\n     */\n    async goto(destinationScene, options) {\n        await this.scope(async () => {\n            await this.director.goto(destinationScene, options);\n        });\n    }\n    /**\n     * Changes the current scene with optionally supplied:\n     * * Activation data\n     * * Transitions\n     * * Loaders\n     *\n     * Example:\n     * ```typescript\n     * game.goToScene('myScene', {\n     *   sceneActivationData: {any: 'thing at all'},\n     *   destinationIn: new FadeInOut({duration: 1000, direction: 'in'}),\n     *   sourceOut: new FadeInOut({duration: 1000, direction: 'out'}),\n     *   loader: MyLoader\n     * });\n     * ```\n     *\n     * Scenes are defined in the Engine constructor\n     * ```typescript\n     * const engine = new ex.Engine({\n        scenes: {...}\n      });\n     * ```\n     * Or by adding dynamically\n     *\n     * ```typescript\n     * engine.addScene('myScene', new ex.Scene());\n     * ```\n     * @param destinationScene\n     * @param options\n     */\n    async goToScene(destinationScene, options) {\n        await this.scope(async () => {\n            await this.director.goto(destinationScene, options);\n        });\n    }\n    /**\n     * Transforms the current x, y from screen coordinates to world coordinates\n     * @param point  Screen coordinate to convert\n     */\n    screenToWorldCoordinates(point) {\n        return this.screen.screenToWorldCoordinates(point);\n    }\n    /**\n     * Transforms a world coordinate, to a screen coordinate\n     * @param point  World coordinate to convert\n     */\n    worldToScreenCoordinates(point) {\n        return this.screen.worldToScreenCoordinates(point);\n    }\n    /**\n     * Initializes the internal canvas, rendering context, display mode, and native event listeners\n     */\n    _initialize(options) {\n        var _a, _b;\n        this.pageScrollPreventionMode = options.scrollPreventionMode;\n        // initialize inputs\n        const pointerTarget = options && options.pointerScope === PointerScope.Document ? document : this.canvas;\n        const grabWindowFocus = (_b = (_a = this._originalOptions) === null || _a === void 0 ? void 0 : _a.grabWindowFocus) !== null && _b !== void 0 ? _b : true;\n        this.input = new InputHost({\n            pointerTarget,\n            grabWindowFocus,\n            engine: this\n        });\n        this.inputMapper = this.input.inputMapper;\n        // Issue #385 make use of the visibility api\n        // https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\n        this.browser.document.on('visibilitychange', () => {\n            if (document.visibilityState === 'hidden') {\n                this.events.emit('hidden', new HiddenEvent(this));\n                this._logger.debug('Window hidden');\n            }\n            else if (document.visibilityState === 'visible') {\n                this.events.emit('visible', new VisibleEvent(this));\n                this._logger.debug('Window visible');\n            }\n        });\n        if (!this.canvasElementId && !options.canvasElement) {\n            document.body.appendChild(this.canvas);\n        }\n    }\n    toggleInputEnabled(enabled) {\n        this._inputEnabled = enabled;\n        this.input.toggleEnabled(this._inputEnabled);\n    }\n    onInitialize(engine) {\n        // Override me\n    }\n    /**\n     * If supported by the browser, this will set the antialiasing flag on the\n     * canvas. Set this to `false` if you want a 'jagged' pixel art look to your\n     * image resources.\n     * @param isSmooth  Set smoothing to true or false\n     * @deprecated Set in engine constructor, will be removed in v0.30\n     */\n    setAntialiasing(isSmooth) {\n        this.screen.antialiasing = isSmooth;\n    }\n    /**\n     * Return the current smoothing status of the canvas\n     * @deprecated Set in engine constructor, will be removed in v0.30\n     */\n    getAntialiasing() {\n        return this.screen.antialiasing;\n    }\n    /**\n     * Gets whether the actor is Initialized\n     */\n    get isInitialized() {\n        return this._isInitialized;\n    }\n    async _overrideInitialize(engine) {\n        if (!this.isInitialized) {\n            await this.director.onInitialize();\n            await this.onInitialize(engine);\n            this.events.emit('initialize', new InitializeEvent(engine, this));\n            this._isInitialized = true;\n        }\n    }\n    /**\n     * Updates the entire state of the game\n     * @param delta  Number of milliseconds elapsed since the last update.\n     */\n    _update(delta) {\n        var _a;\n        if (this._isLoading) {\n            // suspend updates until loading is finished\n            (_a = this._loader) === null || _a === void 0 ? void 0 : _a.onUpdate(this, delta);\n            // Update input listeners\n            this.input.update();\n            return;\n        }\n        // Publish preupdate events\n        this.clock.__runScheduledCbs('preupdate');\n        this._preupdate(delta);\n        // process engine level events\n        this.currentScene.update(this, delta);\n        // Update graphics postprocessors\n        this.graphicsContext.updatePostProcessors(delta);\n        // Publish update event\n        this.clock.__runScheduledCbs('postupdate');\n        this._postupdate(delta);\n        // Update input listeners\n        this.input.update();\n    }\n    /**\n     * @internal\n     */\n    _preupdate(delta) {\n        this.emit('preupdate', new PreUpdateEvent(this, delta, this));\n        this.onPreUpdate(this, delta);\n    }\n    onPreUpdate(engine, delta) {\n        // Override me\n    }\n    /**\n     * @internal\n     */\n    _postupdate(delta) {\n        this.emit('postupdate', new PostUpdateEvent(this, delta, this));\n        this.onPostUpdate(this, delta);\n    }\n    onPostUpdate(engine, delta) {\n        // Override me\n    }\n    /**\n     * Draws the entire game\n     * @param delta  Number of milliseconds elapsed since the last draw.\n     */\n    _draw(delta) {\n        var _a, _b;\n        this.graphicsContext.beginDrawLifecycle();\n        this.graphicsContext.clear();\n        this.clock.__runScheduledCbs('predraw');\n        this._predraw(this.graphicsContext, delta);\n        // Drawing nothing else while loading\n        if (this._isLoading) {\n            if (!this._hideLoader) {\n                (_a = this._loader) === null || _a === void 0 ? void 0 : _a.canvas.draw(this.graphicsContext, 0, 0);\n                this.clock.__runScheduledCbs('postdraw');\n                this.graphicsContext.flush();\n                this.graphicsContext.endDrawLifecycle();\n            }\n            return;\n        }\n        // Use scene background color if present, fallback to engine\n        this.graphicsContext.backgroundColor = (_b = this.currentScene.backgroundColor) !== null && _b !== void 0 ? _b : this.backgroundColor;\n        this.currentScene.draw(this.graphicsContext, delta);\n        this.clock.__runScheduledCbs('postdraw');\n        this._postdraw(this.graphicsContext, delta);\n        // Flush any pending drawings\n        this.graphicsContext.flush();\n        this.graphicsContext.endDrawLifecycle();\n        this._checkForScreenShots();\n    }\n    /**\n     * @internal\n     */\n    _predraw(ctx, delta) {\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this));\n        this.onPreDraw(ctx, delta);\n    }\n    onPreDraw(ctx, delta) {\n        // Override me\n    }\n    /**\n     * @internal\n     */\n    _postdraw(ctx, delta) {\n        this.emit('postdraw', new PostDrawEvent(ctx, delta, this));\n        this.onPostDraw(ctx, delta);\n    }\n    onPostDraw(ctx, delta) {\n        // Override me\n    }\n    /**\n     * Enable or disable Excalibur debugging functionality.\n     * @param toggle a value that debug drawing will be changed to\n     */\n    showDebug(toggle) {\n        this._isDebug = toggle;\n    }\n    /**\n     * Toggle Excalibur debugging functionality.\n     */\n    toggleDebug() {\n        this._isDebug = !this._isDebug;\n        return this._isDebug;\n    }\n    /**\n     * Returns true when loading is totally complete and the player has clicked start\n     */\n    get loadingComplete() {\n        return !this._isLoading;\n    }\n    get ready() {\n        return this._isReadyFuture.isCompleted;\n    }\n    isReady() {\n        return this._isReadyFuture.promise;\n    }\n    async start(sceneNameOrLoader, options) {\n        await this.scope(async () => {\n            if (!this._compatible) {\n                throw new Error('Excalibur is incompatible with your browser');\n            }\n            this._isLoading = true;\n            let loader;\n            if (sceneNameOrLoader instanceof DefaultLoader) {\n                loader = sceneNameOrLoader;\n            }\n            else if (typeof sceneNameOrLoader === 'string') {\n                this.director.configureStart(sceneNameOrLoader, options);\n                loader = this.director.mainLoader;\n            }\n            // Start the excalibur clock which drives the mainloop\n            this._logger.debug('Starting game clock...');\n            this.browser.resume();\n            this.clock.start();\n            this._logger.debug('Game clock started');\n            await this.load(loader !== null && loader !== void 0 ? loader : new Loader());\n            // Initialize before ready\n            await this._overrideInitialize(this);\n            this._isReadyFuture.resolve();\n            this.emit('start', new GameStartEvent(this));\n            return this._isReadyFuture.promise;\n        });\n    }\n    _mainloop(elapsed) {\n        this.scope(() => {\n            this.emit('preframe', new PreFrameEvent(this, this.stats.prevFrame));\n            const delta = elapsed * this.timescale;\n            this.currentFrameElapsedMs = delta;\n            // reset frame stats (reuse existing instances)\n            const frameId = this.stats.prevFrame.id + 1;\n            this.stats.currFrame.reset();\n            this.stats.currFrame.id = frameId;\n            this.stats.currFrame.delta = delta;\n            this.stats.currFrame.fps = this.clock.fpsSampler.fps;\n            GraphicsDiagnostics.clear();\n            const beforeUpdate = this.clock.now();\n            const fixedTimestepMs = 1000 / this.fixedUpdateFps;\n            if (this.fixedUpdateFps) {\n                this._lagMs += delta;\n                while (this._lagMs >= fixedTimestepMs) {\n                    this._update(fixedTimestepMs);\n                    this._lagMs -= fixedTimestepMs;\n                }\n            }\n            else {\n                this._update(delta);\n            }\n            const afterUpdate = this.clock.now();\n            this.currentFrameLagMs = this._lagMs;\n            this._draw(delta);\n            const afterDraw = this.clock.now();\n            this.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\n            this.stats.currFrame.duration.draw = afterDraw - afterUpdate;\n            this.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\n            this.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\n            this.emit('postframe', new PostFrameEvent(this, this.stats.currFrame));\n            this.stats.prevFrame.reset(this.stats.currFrame);\n            this._monitorPerformanceThresholdAndTriggerFallback();\n        });\n    }\n    /**\n     * Stops Excalibur's main loop, useful for pausing the game.\n     */\n    stop() {\n        if (this.clock.isRunning()) {\n            this.emit('stop', new GameStopEvent(this));\n            this.browser.pause();\n            this.clock.stop();\n            this._logger.debug('Game stopped');\n        }\n    }\n    /**\n     * Returns the Engine's running status, Useful for checking whether engine is running or paused.\n     */\n    isRunning() {\n        return this.clock.isRunning();\n    }\n    /**\n     * Takes a screen shot of the current viewport and returns it as an\n     * HTML Image Element.\n     * @param preserveHiDPIResolution in the case of HiDPI return the full scaled backing image, by default false\n     */\n    screenshot(preserveHiDPIResolution = false) {\n        const screenShotPromise = new Promise((resolve) => {\n            this._screenShotRequests.push({ preserveHiDPIResolution, resolve });\n        });\n        return screenShotPromise;\n    }\n    _checkForScreenShots() {\n        // We must grab the draw buffer before we yield to the browser\n        // the draw buffer is cleared after compositing\n        // the reason for the asynchrony is setting `preserveDrawingBuffer: true`\n        // forces the browser to copy buffers which can have a mass perf impact on mobile\n        for (const request of this._screenShotRequests) {\n            const finalWidth = request.preserveHiDPIResolution ? this.canvas.width : this.screen.resolution.width;\n            const finalHeight = request.preserveHiDPIResolution ? this.canvas.height : this.screen.resolution.height;\n            const screenshot = document.createElement('canvas');\n            screenshot.width = finalWidth;\n            screenshot.height = finalHeight;\n            const ctx = screenshot.getContext('2d');\n            ctx.imageSmoothingEnabled = this.screen.antialiasing;\n            ctx.drawImage(this.canvas, 0, 0, finalWidth, finalHeight);\n            const result = new Image();\n            const raw = screenshot.toDataURL('image/png');\n            result.src = raw;\n            request.resolve(result);\n        }\n        // Reset state\n        this._screenShotRequests.length = 0;\n    }\n    /**\n     * Another option available to you to load resources into the game.\n     * Immediately after calling this the game will pause and the loading screen\n     * will appear.\n     * @param loader  Some [[Loadable]] such as a [[Loader]] collection, [[Sound]], or [[Texture]].\n     */\n    async load(loader, hideLoader = false) {\n        await this.scope(async () => {\n            try {\n                // early exit if loaded\n                if (loader.isLoaded()) {\n                    return;\n                }\n                this._loader = loader;\n                this._isLoading = true;\n                this._hideLoader = hideLoader;\n                if (loader instanceof Loader) {\n                    loader.suppressPlayButton = loader.suppressPlayButton || this._suppressPlayButton;\n                }\n                this._loader.onInitialize(this);\n                await loader.load();\n            }\n            catch (e) {\n                this._logger.error('Error loading resources, things may not behave properly', e);\n                await Promise.resolve();\n            }\n            finally {\n                this._isLoading = false;\n                this._hideLoader = false;\n                this._loader = null;\n            }\n        });\n    }\n}\nEngine.Context = createContext();\nEngine.InstanceCount = 0;\n/**\n * Default [[EngineOptions]]\n */\nEngine._DEFAULT_ENGINE_OPTIONS = {\n    width: 0,\n    height: 0,\n    enableCanvasTransparency: true,\n    useDrawSorting: true,\n    configurePerformanceCanvas2DFallback: {\n        allow: false,\n        showPlayerMessage: false,\n        threshold: { fps: 20, numberOfFrames: 100 }\n    },\n    canvasElementId: '',\n    canvasElement: undefined,\n    snapToPixel: false,\n    antialiasing: true,\n    pixelArt: false,\n    powerPreference: 'high-performance',\n    pointerScope: PointerScope.Canvas,\n    suppressConsoleBootMessage: null,\n    suppressMinimumBrowserFeatureDetection: null,\n    suppressHiDPIScaling: null,\n    suppressPlayButton: null,\n    grabWindowFocus: true,\n    scrollPreventionMode: ScrollPreventionMode.Canvas,\n    backgroundColor: Color.fromHex('#2185d0') // Excalibur blue\n};\n\n;// CONCATENATED MODULE: ./Math/Index.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./Debug/index.ts\n\n\n\n\n;// CONCATENATED MODULE: ./EventDispatcher.ts\n\n/**\n * @deprecated Use [[EventEmitter]] will be removed in v0.29.0\n */\nclass EventDispatcher {\n    constructor() {\n        this._handlers = {};\n        this._wiredEventDispatchers = [];\n        this._deferedHandlerRemovals = [];\n    }\n    /**\n     * Clears any existing handlers or wired event dispatchers on this event dispatcher\n     */\n    clear() {\n        this._handlers = {};\n        this._wiredEventDispatchers = [];\n    }\n    _processDeferredHandlerRemovals() {\n        for (const eventHandler of this._deferedHandlerRemovals) {\n            this._removeHandler(eventHandler.name, eventHandler.handler);\n        }\n        this._deferedHandlerRemovals.length = 0;\n    }\n    /**\n     * Emits an event for target\n     * @param eventName  The name of the event to publish\n     * @param event      Optionally pass an event data object to the handler\n     */\n    emit(eventName, event) {\n        this._processDeferredHandlerRemovals();\n        if (!eventName) {\n            // key not mapped\n            return;\n        }\n        eventName = eventName.toLowerCase();\n        if (typeof event === 'undefined' || event === null) {\n            event = new GameEvent();\n        }\n        let i, len;\n        if (this._handlers[eventName]) {\n            i = 0;\n            len = this._handlers[eventName].length;\n            for (i; i < len; i++) {\n                this._handlers[eventName][i](event);\n            }\n        }\n        i = 0;\n        len = this._wiredEventDispatchers.length;\n        for (i; i < len; i++) {\n            this._wiredEventDispatchers[i].emit(eventName, event);\n        }\n    }\n    /**\n     * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.\n     * @param eventName  The name of the event to subscribe to\n     * @param handler    The handler callback to fire on this event\n     */\n    on(eventName, handler) {\n        this._processDeferredHandlerRemovals();\n        eventName = eventName.toLowerCase();\n        if (!this._handlers[eventName]) {\n            this._handlers[eventName] = [];\n        }\n        this._handlers[eventName].push(handler);\n    }\n    /**\n     * Unsubscribe an event handler(s) from an event. If a specific handler\n     * is specified for an event, only that handler will be unsubscribed.\n     * Otherwise all handlers will be unsubscribed for that event.\n     * @param eventName  The name of the event to unsubscribe\n     * @param handler    Optionally the specific handler to unsubscribe\n     */\n    off(eventName, handler) {\n        this._deferedHandlerRemovals.push({ name: eventName, handler });\n    }\n    _removeHandler(eventName, handler) {\n        eventName = eventName.toLowerCase();\n        const eventHandlers = this._handlers[eventName];\n        if (eventHandlers) {\n            // if no explicit handler is give with the event name clear all handlers\n            if (!handler) {\n                this._handlers[eventName].length = 0;\n            }\n            else {\n                const index = eventHandlers.indexOf(handler);\n                if (index > -1) {\n                    this._handlers[eventName].splice(index, 1);\n                }\n            }\n        }\n    }\n    /**\n     * Once listens to an event one time, then unsubscribes from that event\n     * @param eventName The name of the event to subscribe to once\n     * @param handler   The handler of the event that will be auto unsubscribed\n     */\n    once(eventName, handler) {\n        this._processDeferredHandlerRemovals();\n        const metaHandler = (event) => {\n            const ev = event || new GameEvent();\n            this.off(eventName, metaHandler);\n            handler(ev);\n        };\n        this.on(eventName, metaHandler);\n    }\n    /**\n     * Wires this event dispatcher to also receive events from another\n     */\n    wire(eventDispatcher) {\n        eventDispatcher._wiredEventDispatchers.push(this);\n    }\n    /**\n     * Unwires this event dispatcher from another\n     */\n    unwire(eventDispatcher) {\n        const index = eventDispatcher._wiredEventDispatchers.indexOf(this);\n        if (index > -1) {\n            eventDispatcher._wiredEventDispatchers.splice(index, 1);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Label.ts\n\n\n\n\n\n/**\n * Labels are the way to draw small amounts of text to the screen. They are\n * actors and inherit all of the benefits and capabilities.\n */\nclass Label extends Actor {\n    get font() {\n        return this._font;\n    }\n    set font(newFont) {\n        this._font = newFont;\n        this._text.font = newFont;\n    }\n    /**\n     * The text to draw.\n     */\n    get text() {\n        return this._text.text;\n    }\n    set text(text) {\n        this._text.text = text;\n    }\n    get color() {\n        return this._text.color;\n    }\n    set color(color) {\n        if (this._text) {\n            this._text.color = color;\n        }\n    }\n    get opacity() {\n        return this._text.opacity;\n    }\n    set opacity(opacity) {\n        this._text.opacity = opacity;\n    }\n    /**\n     * The [[SpriteFont]] to use, if any. Overrides [[Font|font]] if present.\n     */\n    get spriteFont() {\n        return this._spriteFont;\n    }\n    set spriteFont(sf) {\n        if (sf) {\n            this._spriteFont = sf;\n            this._text.font = this._spriteFont;\n        }\n    }\n    /**\n     * Build a new label\n     * @param options\n     */\n    constructor(options) {\n        super(options);\n        this._font = new Font();\n        this._text = new Text({ text: '', font: this._font });\n        const { text, pos, x, y, spriteFont, font, color } = { text: '', ...options };\n        this.pos = pos !== null && pos !== void 0 ? pos : (x && y ? vec(x, y) : this.pos);\n        this.text = text !== null && text !== void 0 ? text : this.text;\n        this.font = font !== null && font !== void 0 ? font : this.font;\n        this.spriteFont = spriteFont !== null && spriteFont !== void 0 ? spriteFont : this.spriteFont;\n        this._text.color = color !== null && color !== void 0 ? color : this.color;\n        const gfx = this.get(GraphicsComponent);\n        gfx.anchor = Vector.Zero;\n        gfx.use(this._text);\n    }\n    _initialize(engine) {\n        super._initialize(engine);\n    }\n    /**\n     * Returns the width of the text in the label (in pixels);\n     */\n    getTextWidth() {\n        return this._text.width;\n    }\n}\n\n;// CONCATENATED MODULE: ./TileMap/IsometricMap.ts\n\n\n\n\n\n\n\n\n\n\n\n\nclass IsometricTile extends Entity {\n    getGraphics() {\n        return this._graphics;\n    }\n    /**\n     * Tile graphics\n     */\n    addGraphic(graphic, options) {\n        this._graphics.push(graphic);\n        this._gfx.visible = this.map.visible;\n        this._gfx.opacity = this.map.opacity;\n        if (options === null || options === void 0 ? void 0 : options.offset) {\n            this._gfx.offset = options.offset;\n        }\n        // TODO detect when this changes on the map and apply to all tiles\n        this._gfx.localBounds = this._recalculateBounds();\n    }\n    _recalculateBounds() {\n        let bounds = this._tileBounds.clone();\n        for (const graphic of this._graphics) {\n            const offset = vec(this.map.graphicsOffset.x - this.map.tileWidth / 2, this.map.graphicsOffset.y - (this.map.renderFromTopOfGraphic ? 0 : (graphic.height - this.map.tileHeight)));\n            bounds = bounds.combine(graphic.localBounds.translate(offset));\n        }\n        return bounds;\n    }\n    removeGraphic(graphic) {\n        const index = this._graphics.indexOf(graphic);\n        if (index > -1) {\n            this._graphics.splice(index, 1);\n        }\n        this._gfx.localBounds = this._recalculateBounds();\n    }\n    clearGraphics() {\n        this._graphics.length = 0;\n        this._gfx.visible = false;\n        this._gfx.localBounds = this._recalculateBounds();\n    }\n    getColliders() {\n        return this._colliders;\n    }\n    /**\n     * Adds a collider to the IsometricTile\n     *\n     * **Note!** the [[Tile.solid]] must be set to true for it to act as a \"fixed\" collider\n     * @param collider\n     */\n    addCollider(collider) {\n        this._colliders.push(collider);\n        this.map.flagCollidersDirty();\n    }\n    /**\n     * Removes a collider from the IsometricTile\n     * @param collider\n     */\n    removeCollider(collider) {\n        const index = this._colliders.indexOf(collider);\n        if (index > -1) {\n            this._colliders.splice(index, 1);\n        }\n        this.map.flagCollidersDirty();\n    }\n    /**\n     * Clears all colliders from the IsometricTile\n     */\n    clearColliders() {\n        this._colliders.length = 0;\n        this.map.flagCollidersDirty();\n    }\n    /**\n     * Returns the top left corner of the [[IsometricTile]] in world space\n     */\n    get pos() {\n        return this.map.tileToWorld(vec(this.x, this.y));\n    }\n    /**\n     * Returns the center of the [[IsometricTile]]\n     */\n    get center() {\n        return this.pos.add(vec(0, this.map.tileHeight / 2));\n    }\n    /**\n     * Construct a new IsometricTile\n     * @param x tile coordinate in x (not world position)\n     * @param y tile coordinate in y (not world position)\n     * @param graphicsOffset offset that tile should be shifted by (default (0, 0))\n     * @param map reference to owning IsometricMap\n     */\n    constructor(x, y, graphicsOffset, map) {\n        super([\n            new TransformComponent(),\n            new GraphicsComponent({\n                offset: graphicsOffset !== null && graphicsOffset !== void 0 ? graphicsOffset : Vector.Zero,\n                onPostDraw: (gfx, elapsed) => this.draw(gfx, elapsed)\n            }),\n            new IsometricEntityComponent(map)\n        ]);\n        /**\n         * Indicates whether this tile is solid\n         */\n        this.solid = false;\n        this.events = new EventEmitter();\n        this._tileBounds = new BoundingBox();\n        this._graphics = [];\n        /**\n         * Tile colliders\n         */\n        this._colliders = [];\n        /**\n         * Arbitrary data storage per tile, useful for any game specific data\n         */\n        this.data = new Map();\n        this.x = x;\n        this.y = y;\n        this.map = map;\n        this._transform = this.get(TransformComponent);\n        this._isometricEntityComponent = this.get(IsometricEntityComponent);\n        const halfTileWidth = this.map.tileWidth / 2;\n        const halfTileHeight = this.map.tileHeight / 2;\n        // See https://clintbellanger.net/articles/isometric_math/ for formula\n        // The x position shifts left with every y step\n        const xPos = (this.x - this.y) * halfTileWidth;\n        // The y position needs to go down with every x step\n        const yPos = (this.x + this.y) * halfTileHeight;\n        this._transform.pos = vec(xPos, yPos);\n        this._isometricEntityComponent.elevation = map.elevation;\n        this._gfx = this.get(GraphicsComponent);\n        this._gfx.visible = false; // start not visible\n        const totalWidth = this.map.tileWidth;\n        const totalHeight = this.map.tileHeight;\n        // initial guess at gfx bounds based on the tile\n        const offset = vec(0, (this.map.renderFromTopOfGraphic ? totalHeight : 0));\n        this._gfx.localBounds = this._tileBounds = new BoundingBox({\n            left: -totalWidth / 2,\n            top: -totalHeight,\n            right: totalWidth / 2,\n            bottom: totalHeight\n        }).translate(offset);\n    }\n    draw(gfx, _elapsed) {\n        const halfTileWidth = this.map.tileWidth / 2;\n        gfx.save();\n        // shift left origin to corner of map, not the left corner of the first sprite\n        gfx.translate(-halfTileWidth, 0);\n        for (const graphic of this._graphics) {\n            graphic.draw(gfx, this.map.graphicsOffset.x, this.map.graphicsOffset.y - (this.map.renderFromTopOfGraphic ? 0 : (graphic.height - this.map.tileHeight)));\n        }\n        gfx.restore();\n    }\n}\n/**\n * The IsometricMap is a special tile map that provides isometric rendering support to Excalibur\n *\n * The tileWidth and tileHeight should be the height and width in pixels of the parallelogram of the base of the tile art asset.\n * The tileWidth and tileHeight is not necessarily the same as your graphic pixel width and height.\n *\n * Please refer to the docs https://excaliburjs.com for more details calculating what your tile width and height should be given\n * your art assets.\n */\nclass IsometricMap extends Entity {\n    constructor(options) {\n        super([\n            new TransformComponent(),\n            new BodyComponent({\n                type: CollisionType.Fixed\n            }),\n            new ColliderComponent(),\n            new PointerComponent(),\n            new DebugGraphicsComponent((ctx, debugFlags) => this.debug(ctx, debugFlags), false)\n        ], options.name);\n        this.elevation = 0;\n        /**\n         * Whether tiles should be visible\n         */\n        this.visible = true;\n        /**\n         * Opacity of tiles\n         */\n        this.opacity = 1.0;\n        /**\n         * Render the tile graphic from the top instead of the bottom\n         *\n         * default is `false` meaning rendering from the bottom\n         */\n        this.renderFromTopOfGraphic = false;\n        this.graphicsOffset = vec(0, 0);\n        this._forwardPointerEventToTile = (eventType) => (evt) => {\n            const tile = this.getTileByPoint(evt.worldPos);\n            if (tile) {\n                tile.events.emit(eventType, evt);\n            }\n        };\n        this._collidersDirty = false;\n        this._originalOffsets = new WeakMap();\n        const { pos, tileWidth, tileHeight, columns: width, rows: height, renderFromTopOfGraphic, graphicsOffset, elevation } = options;\n        this.transform = this.get(TransformComponent);\n        if (pos) {\n            this.transform.pos = pos;\n        }\n        this.collider = this.get(ColliderComponent);\n        if (this.collider) {\n            this.collider.set(this._composite = new CompositeCollider([]));\n        }\n        this.pointer = this.get(PointerComponent);\n        this.renderFromTopOfGraphic = renderFromTopOfGraphic !== null && renderFromTopOfGraphic !== void 0 ? renderFromTopOfGraphic : this.renderFromTopOfGraphic;\n        this.graphicsOffset = graphicsOffset !== null && graphicsOffset !== void 0 ? graphicsOffset : this.graphicsOffset;\n        this.elevation = elevation !== null && elevation !== void 0 ? elevation : this.elevation;\n        this.tileWidth = tileWidth;\n        this.tileHeight = tileHeight;\n        this.columns = width;\n        this.rows = height;\n        this.tiles = new Array(width * height);\n        // build up tile representation\n        for (let y = 0; y < height; y++) {\n            for (let x = 0; x < width; x++) {\n                const tile = new IsometricTile(x, y, this.graphicsOffset, this);\n                this.tiles[x + y * width] = tile;\n                this.addChild(tile);\n            }\n        }\n        this.pointer.localBounds = BoundingBox.fromDimension(tileWidth * width * this.transform.scale.x, tileHeight * height * this.transform.scale.y, vec(.5, 0));\n        this._setupPointerToTile();\n    }\n    _setupPointerToTile() {\n        this.events.on('pointerup', this._forwardPointerEventToTile('pointerup'));\n        this.events.on('pointerdown', this._forwardPointerEventToTile('pointerdown'));\n        this.events.on('pointermove', this._forwardPointerEventToTile('pointermove'));\n        this.events.on('pointercancel', this._forwardPointerEventToTile('pointercancel'));\n    }\n    update() {\n        if (this._collidersDirty) {\n            this.updateColliders();\n            this._collidersDirty = false;\n        }\n    }\n    flagCollidersDirty() {\n        this._collidersDirty = true;\n    }\n    _getOrSetColliderOriginalOffset(collider) {\n        if (!this._originalOffsets.has(collider)) {\n            const originalOffset = collider.offset;\n            this._originalOffsets.set(collider, originalOffset);\n            return originalOffset;\n        }\n        else {\n            return this._originalOffsets.get(collider);\n        }\n    }\n    updateColliders() {\n        this._composite.clearColliders();\n        const pos = this.get(TransformComponent).pos;\n        for (const tile of this.tiles) {\n            if (tile.solid) {\n                for (const collider of tile.getColliders()) {\n                    const originalOffset = this._getOrSetColliderOriginalOffset(collider);\n                    collider.offset = this.tileToWorld(vec(tile.x, tile.y))\n                        .sub(pos)\n                        .add(originalOffset)\n                        .sub(vec(this.tileWidth / 2, this.tileHeight)); // We need to unshift height based on drawing\n                    collider.owner = this;\n                    this._composite.addCollider(collider);\n                }\n            }\n        }\n        this.collider.update();\n    }\n    /**\n     * Convert world space coordinates to the tile x, y coordinate\n     * @param worldCoordinate\n     */\n    worldToTile(worldCoordinate) {\n        // TODO I don't think this handles parent transform see TileMap\n        worldCoordinate = worldCoordinate.sub(this.transform.globalPos);\n        const halfTileWidth = this.tileWidth / 2;\n        const halfTileHeight = this.tileHeight / 2;\n        // See https://clintbellanger.net/articles/isometric_math/ for formula\n        return vec(~~((worldCoordinate.x / halfTileWidth + (worldCoordinate.y / halfTileHeight)) / 2), ~~((worldCoordinate.y / halfTileHeight - (worldCoordinate.x / halfTileWidth)) / 2));\n    }\n    /**\n     * Given a tile coordinate, return the top left corner in world space\n     * @param tileCoordinate\n     */\n    tileToWorld(tileCoordinate) {\n        const halfTileWidth = this.tileWidth / 2;\n        const halfTileHeight = this.tileHeight / 2;\n        // The x position shifts left with every y step\n        const xPos = (tileCoordinate.x - tileCoordinate.y) * halfTileWidth;\n        // The y position needs to go down with every x step\n        const yPos = (tileCoordinate.x + tileCoordinate.y) * halfTileHeight;\n        return vec(xPos, yPos).add(this.transform.pos);\n    }\n    /**\n     * Returns the [[IsometricTile]] by its x and y coordinates\n     */\n    getTile(x, y) {\n        if (x < 0 || y < 0 || x >= this.columns || y >= this.rows) {\n            return null;\n        }\n        return this.tiles[x + y * this.columns];\n    }\n    /**\n     * Returns the [[IsometricTile]] by testing a point in world coordinates,\n     * returns `null` if no Tile was found.\n     */\n    getTileByPoint(point) {\n        const tileCoord = this.worldToTile(point);\n        const tile = this.getTile(tileCoord.x, tileCoord.y);\n        return tile;\n    }\n    _getMaxZIndex() {\n        let maxZ = Number.NEGATIVE_INFINITY;\n        for (const tile of this.tiles) {\n            const currentZ = tile.get(TransformComponent).z;\n            if (currentZ > maxZ) {\n                maxZ = currentZ;\n            }\n        }\n        return maxZ;\n    }\n    /**\n     * Debug draw for IsometricMap, called internally by excalibur when debug mode is toggled on\n     * @param gfx\n     */\n    debug(gfx, debugFlags) {\n        const { showAll, showPosition, positionColor, positionSize, showGrid, gridColor, gridWidth, showColliderGeometry } = debugFlags.isometric;\n        const { geometryColor, geometryLineWidth, geometryPointSize } = debugFlags.collider;\n        gfx.save();\n        gfx.z = this._getMaxZIndex() + 0.5;\n        if (showAll || showGrid) {\n            for (let y = 0; y < this.rows + 1; y++) {\n                const left = this.tileToWorld(vec(0, y));\n                const right = this.tileToWorld(vec(this.columns, y));\n                gfx.drawLine(left, right, gridColor, gridWidth);\n            }\n            for (let x = 0; x < this.columns + 1; x++) {\n                const top = this.tileToWorld(vec(x, 0));\n                const bottom = this.tileToWorld(vec(x, this.rows));\n                gfx.drawLine(top, bottom, gridColor, gridWidth);\n            }\n        }\n        if (showAll || showPosition) {\n            for (const tile of this.tiles) {\n                gfx.drawCircle(this.tileToWorld(vec(tile.x, tile.y)), positionSize, positionColor);\n            }\n        }\n        if (showAll || showColliderGeometry) {\n            for (const tile of this.tiles) {\n                if (tile.solid) { // only draw solid tiles\n                    for (const collider of tile.getColliders()) {\n                        collider.debug(gfx, geometryColor, { lineWidth: geometryLineWidth, pointSize: geometryPointSize });\n                    }\n                }\n            }\n        }\n        gfx.restore();\n    }\n}\n\n;// CONCATENATED MODULE: ./TileMap/index.ts\n\n\n\n\n\n;// CONCATENATED MODULE: ./Actions/Action/ActionSequence.ts\n\n/**\n * Action that can represent a sequence of actions, this can be useful in conjunction with\n * [[ParallelActions]] to run multiple sequences in parallel.\n */\nclass ActionSequence {\n    constructor(entity, actionBuilder) {\n        this._stopped = false;\n        this._sequenceBuilder = actionBuilder;\n        this._sequenceContext = new ActionContext(entity);\n        this._actionQueue = this._sequenceContext.getQueue();\n        this._sequenceBuilder(this._sequenceContext);\n    }\n    update(delta) {\n        this._actionQueue.update(delta);\n    }\n    isComplete() {\n        return this._stopped || this._actionQueue.isComplete();\n    }\n    stop() {\n        this._stopped = true;\n    }\n    reset() {\n        this._stopped = false;\n        this._actionQueue.reset();\n    }\n    clone(entity) {\n        return new ActionSequence(entity, this._sequenceBuilder);\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Action/ParallelActions.ts\n/**\n * Action that can run multiple [[Action]]s or [[ActionSequence]]s at the same time\n */\nclass ParallelActions {\n    constructor(parallelActions) {\n        this._actions = parallelActions;\n    }\n    update(delta) {\n        for (let i = 0; i < this._actions.length; i++) {\n            this._actions[i].update(delta);\n        }\n    }\n    isComplete(entity) {\n        return this._actions.every(a => a.isComplete(entity));\n    }\n    reset() {\n        this._actions.forEach(a => a.reset());\n    }\n    stop() {\n        this._actions.forEach(a => a.stop());\n    }\n}\n\n;// CONCATENATED MODULE: ./Actions/Index.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./Collision/Detection/QuadTree.ts\n\n\n/**\n * QuadTree spatial data structure. Useful for quickly retrieving all objects that might\n * be in a specific location.\n */\nclass QuadTree {\n    constructor(bounds, options) {\n        this.bounds = bounds;\n        this.options = options;\n        this._defaultOptions = {\n            maxDepth: 10,\n            capacity: 10,\n            level: 0\n        };\n        this.items = [];\n        this._isDivided = false;\n        this.topLeft = null;\n        this.topRight = null;\n        this.bottomLeft = null;\n        this.bottomRight = null;\n        this.options = { ...this._defaultOptions, ...options };\n        this.halfWidth = bounds.width / 2;\n        this.halfHeight = bounds.height / 2;\n    }\n    /**\n     * Splits the quad tree one level deeper\n     */\n    _split() {\n        this._isDivided = true;\n        const newLevelOptions = {\n            maxDepth: this.options.maxDepth,\n            capacity: this.options.capacity,\n            level: this.options.level + 1\n        };\n        this.topLeft = new QuadTree(new BoundingBox({\n            left: this.bounds.left,\n            top: this.bounds.top,\n            right: this.bounds.left + this.halfWidth,\n            bottom: this.bounds.top + this.halfHeight\n        }), newLevelOptions);\n        this.topRight = new QuadTree(new BoundingBox({\n            left: this.bounds.left + this.halfWidth,\n            top: this.bounds.top,\n            right: this.bounds.right,\n            bottom: this.bounds.top + this.halfHeight\n        }), newLevelOptions);\n        this.bottomLeft = new QuadTree(new BoundingBox({\n            left: this.bounds.left,\n            top: this.bounds.top + this.halfHeight,\n            right: this.bounds.left + this.halfWidth,\n            bottom: this.bounds.bottom\n        }), newLevelOptions);\n        this.bottomRight = new QuadTree(new BoundingBox({\n            left: this.bounds.left + this.halfWidth,\n            top: this.bounds.top + this.halfHeight,\n            right: this.bounds.right,\n            bottom: this.bounds.bottom\n        }), newLevelOptions);\n    }\n    _insertIntoSubNodes(item) {\n        var _a, _b, _c, _d;\n        if ((_a = this.topLeft) === null || _a === void 0 ? void 0 : _a.bounds.overlaps(item.bounds)) {\n            this.topLeft.insert(item);\n        }\n        if ((_b = this.topRight) === null || _b === void 0 ? void 0 : _b.bounds.overlaps(item.bounds)) {\n            this.topRight.insert(item);\n        }\n        if ((_c = this.bottomLeft) === null || _c === void 0 ? void 0 : _c.bounds.overlaps(item.bounds)) {\n            this.bottomLeft.insert(item);\n        }\n        if ((_d = this.bottomRight) === null || _d === void 0 ? void 0 : _d.bounds.overlaps(item.bounds)) {\n            this.bottomRight.insert(item);\n        }\n    }\n    /**\n     * Insert an item to be tracked in the QuadTree\n     * @param item\n     */\n    insert(item) {\n        // add to subnodes if it matches\n        if (this._isDivided) {\n            this._insertIntoSubNodes(item);\n            return;\n        }\n        // leaf case\n        this.items.push(item);\n        // capacity\n        if (this.items.length > this.options.capacity && this.options.level < this.options.maxDepth) {\n            if (!this._isDivided) {\n                this._split();\n            }\n            // divide this level's items into it's subnodes\n            for (const item of this.items) {\n                this._insertIntoSubNodes(item);\n            }\n            // clear this level\n            this.items.length = 0;\n        }\n    }\n    /**\n     * Remove a tracked item in the QuadTree\n     * @param item\n     */\n    remove(item) {\n        var _a, _b, _c, _d;\n        if (!this.bounds.overlaps(item.bounds)) {\n            return;\n        }\n        if (!this._isDivided) {\n            const index = this.items.indexOf(item);\n            if (index > -1) {\n                this.items.splice(index, 1);\n            }\n            return;\n        }\n        if ((_a = this.topLeft) === null || _a === void 0 ? void 0 : _a.bounds.overlaps(item.bounds)) {\n            this.topLeft.remove(item);\n        }\n        if ((_b = this.topRight) === null || _b === void 0 ? void 0 : _b.bounds.overlaps(item.bounds)) {\n            this.topRight.remove(item);\n        }\n        if ((_c = this.bottomLeft) === null || _c === void 0 ? void 0 : _c.bounds.overlaps(item.bounds)) {\n            this.bottomLeft.remove(item);\n        }\n        if ((_d = this.bottomRight) === null || _d === void 0 ? void 0 : _d.bounds.overlaps(item.bounds)) {\n            this.bottomRight.remove(item);\n        }\n    }\n    /**\n     * Query the structure for all objects that intersect the bounding box\n     * @param boundingBox\n     * @returns items\n     */\n    query(boundingBox) {\n        let results = this.items;\n        if (this._isDivided) {\n            if (this.topLeft.bounds.overlaps(boundingBox)) {\n                results = results.concat(this.topLeft.query(boundingBox));\n            }\n            if (this.topRight.bounds.overlaps(boundingBox)) {\n                results = results.concat(this.topRight.query(boundingBox));\n            }\n            if (this.bottomLeft.bounds.overlaps(boundingBox)) {\n                results = results.concat(this.bottomLeft.query(boundingBox));\n            }\n            if (this.bottomRight.bounds.overlaps(boundingBox)) {\n                results = results.concat(this.bottomRight.query(boundingBox));\n            }\n        }\n        results = results.filter((item, index) => {\n            return results.indexOf(item) >= index;\n        });\n        return results;\n    }\n    clear() {\n        this.items = [];\n        this._isDivided = false;\n        this.topLeft = null;\n        this.topRight = null;\n        this.bottomLeft = null;\n        this.bottomRight = null;\n    }\n    getAllItems() {\n        let results = this.items;\n        if (this._isDivided) {\n            results = results.concat(this.topLeft.getAllItems());\n            results = results.concat(this.topRight.getAllItems());\n            results = results.concat(this.bottomLeft.getAllItems());\n            results = results.concat(this.bottomRight.getAllItems());\n        }\n        results = results.filter((item, index) => {\n            return results.indexOf(item) >= index;\n        });\n        return results;\n    }\n    getTreeDepth() {\n        if (!this._isDivided) {\n            return 0;\n        }\n        return 1 + Math.max(this.topLeft.getTreeDepth(), this.topRight.getTreeDepth(), this.bottomLeft.getTreeDepth(), this.bottomRight.getTreeDepth());\n    }\n    debug(ctx) {\n        this.bounds.draw(ctx, Color.Yellow);\n        if (this._isDivided) {\n            this.topLeft.bounds.draw(ctx, Color.Yellow);\n            this.topRight.bounds.draw(ctx, Color.Yellow);\n            this.bottomLeft.bounds.draw(ctx, Color.Yellow);\n            this.bottomRight.bounds.draw(ctx, Color.Yellow);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Collision/Index.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./Interfaces/LifecycleEvents.ts\n/**\n * Type guard checking for internal initialize method\n * @internal\n * @param a\n */\nfunction has_initialize(a) {\n    return !!a._initialize;\n}\n/**\n *\n */\nfunction hasOnInitialize(a) {\n    return !!a.onInitialize;\n}\n/**\n *\n */\nfunction has_preupdate(a) {\n    return !!a._preupdate;\n}\n/**\n *\n */\nfunction hasOnPreUpdate(a) {\n    return !!a.onPreUpdate;\n}\n/**\n *\n */\nfunction has_postupdate(a) {\n    return !!a.onPostUpdate;\n}\n/**\n *\n */\nfunction hasOnPostUpdate(a) {\n    return !!a.onPostUpdate;\n}\n/**\n *\n */\nfunction hasPreDraw(a) {\n    return !!a.onPreDraw;\n}\n/**\n *\n */\nfunction hasPostDraw(a) {\n    return !!a.onPostDraw;\n}\n\n;// CONCATENATED MODULE: ./Interfaces/Index.ts\n\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./Resources/Sound/Index.ts\n\n\n\n\n;// CONCATENATED MODULE: ./Resources/Gif.ts\n\n\n\n\n\n\n/**\n * The [[Texture]] object allows games built in Excalibur to load image resources.\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\n * to pre-load before starting a level or game.\n */\nclass Gif {\n    /**\n     * @param path       Path to the image resource\n     * @param color      Optionally set the color to treat as transparent the gif, by default [[Color.Magenta]]\n     * @param bustCache  Optionally load texture with cache busting\n     */\n    constructor(path, color = Color.Magenta, bustCache = false) {\n        this.path = path;\n        this.color = color;\n        this._stream = null;\n        this._gif = null;\n        this._textures = [];\n        this._animation = null;\n        this._transparentColor = null;\n        this._resource = new Resource(path, 'arraybuffer', bustCache);\n        this._transparentColor = color;\n    }\n    /**\n     * Should excalibur add a cache busting querystring? By default false.\n     * Must be set before loading\n     */\n    get bustCache() {\n        return this._resource.bustCache;\n    }\n    set bustCache(val) {\n        this._resource.bustCache = val;\n    }\n    /**\n     * Begins loading the texture and returns a promise to be resolved on completion\n     */\n    async load() {\n        const arraybuffer = await this._resource.load();\n        this._stream = new Stream(arraybuffer);\n        this._gif = new ParseGif(this._stream, this._transparentColor);\n        const images = this._gif.images.map(i => new ImageSource(i.src, false));\n        // Load all textures\n        await Promise.all(images.map(t => t.load()));\n        return this.data = this._textures = images;\n    }\n    isLoaded() {\n        return !!this.data;\n    }\n    /**\n     * Return a frame of the gif as a sprite by id\n     * @param id\n     */\n    toSprite(id = 0) {\n        const sprite = this._textures[id].toSprite();\n        return sprite;\n    }\n    /**\n     * Return the gif as a spritesheet\n     */\n    toSpriteSheet() {\n        const sprites = this._textures.map((image) => {\n            return image.toSprite();\n        });\n        return new SpriteSheet({ sprites });\n    }\n    /**\n     * Transform the GIF into an animation with duration per frame\n     */\n    toAnimation(durationPerFrameMs) {\n        const spriteSheet = this.toSpriteSheet();\n        const length = spriteSheet.sprites.length;\n        this._animation = Animation.fromSpriteSheet(spriteSheet, range(0, length), durationPerFrameMs);\n        return this._animation;\n    }\n    get readCheckBytes() {\n        return this._gif.checkBytes;\n    }\n}\nconst bitsToNum = (ba) => {\n    return ba.reduce(function (s, n) {\n        return s * 2 + n;\n    }, 0);\n};\nconst byteToBitArr = (bite) => {\n    const a = [];\n    for (let i = 7; i >= 0; i--) {\n        a.push(!!(bite & (1 << i)));\n    }\n    return a;\n};\nclass Stream {\n    constructor(dataArray) {\n        this.data = null;\n        this.len = 0;\n        this.position = 0;\n        this.readByte = () => {\n            if (this.position >= this.data.byteLength) {\n                throw new Error('Attempted to read past end of stream.');\n            }\n            return this.data[this.position++];\n        };\n        this.readBytes = (n) => {\n            const bytes = [];\n            for (let i = 0; i < n; i++) {\n                bytes.push(this.readByte());\n            }\n            return bytes;\n        };\n        this.read = (n) => {\n            let s = '';\n            for (let i = 0; i < n; i++) {\n                s += String.fromCharCode(this.readByte());\n            }\n            return s;\n        };\n        this.readUnsigned = () => {\n            // Little-endian.\n            const a = this.readBytes(2);\n            return (a[1] << 8) + a[0];\n        };\n        this.data = new Uint8Array(dataArray);\n        this.len = this.data.byteLength;\n        if (this.len === 0) {\n            throw new Error('No data loaded from file');\n        }\n    }\n}\nconst lzwDecode = function (minCodeSize, data) {\n    // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\n    let pos = 0; // Maybe this streaming thing should be merged with the Stream?\n    const readCode = function (size) {\n        let code = 0;\n        for (let i = 0; i < size; i++) {\n            if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\n                code |= 1 << i;\n            }\n            pos++;\n        }\n        return code;\n    };\n    const output = [];\n    const clearCode = 1 << minCodeSize;\n    const eoiCode = clearCode + 1;\n    let codeSize = minCodeSize + 1;\n    let dict = [];\n    const clear = function () {\n        dict = [];\n        codeSize = minCodeSize + 1;\n        for (let i = 0; i < clearCode; i++) {\n            dict[i] = [i];\n        }\n        dict[clearCode] = [];\n        dict[eoiCode] = null;\n    };\n    let code;\n    let last;\n    while (true) {\n        last = code;\n        code = readCode(codeSize);\n        if (code === clearCode) {\n            clear();\n            continue;\n        }\n        if (code === eoiCode) {\n            break;\n        }\n        if (code < dict.length) {\n            if (last !== clearCode) {\n                dict.push(dict[last].concat(dict[code][0]));\n            }\n        }\n        else {\n            if (code !== dict.length) {\n                throw new Error('Invalid LZW code.');\n            }\n            dict.push(dict[last].concat(dict[last][0]));\n        }\n        output.push.apply(output, dict[code]);\n        if (dict.length === 1 << codeSize && codeSize < 12) {\n            // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\n            codeSize++;\n        }\n    }\n    // I don't know if this is technically an error, but some GIFs do it.\n    //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\n    return output;\n};\n// The actual parsing; returns an object with properties.\nclass ParseGif {\n    constructor(stream, color = Color.Magenta) {\n        this._st = null;\n        this._handler = {};\n        this._transparentColor = null;\n        this.frames = [];\n        this.images = [];\n        this.globalColorTable = [];\n        this.checkBytes = [];\n        // LZW (GIF-specific)\n        this.parseColorTable = (entries) => {\n            // Each entry is 3 bytes, for RGB.\n            const ct = [];\n            for (let i = 0; i < entries; i++) {\n                const rgb = this._st.readBytes(3);\n                const rgba = '#' +\n                    rgb\n                        .map((x) => {\n                        const hex = x.toString(16);\n                        return hex.length === 1 ? '0' + hex : hex;\n                    })\n                        .join('');\n                ct.push(rgba);\n            }\n            return ct;\n        };\n        this.readSubBlocks = () => {\n            let size, data;\n            data = '';\n            do {\n                size = this._st.readByte();\n                data += this._st.read(size);\n            } while (size !== 0);\n            return data;\n        };\n        this.parseHeader = () => {\n            const hdr = {\n                sig: null,\n                ver: null,\n                width: null,\n                height: null,\n                colorRes: null,\n                globalColorTableSize: null,\n                gctFlag: null,\n                sorted: null,\n                globalColorTable: [],\n                bgColor: null,\n                pixelAspectRatio: null // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\n            };\n            hdr.sig = this._st.read(3);\n            hdr.ver = this._st.read(3);\n            if (hdr.sig !== 'GIF') {\n                throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\n            }\n            hdr.width = this._st.readUnsigned();\n            hdr.height = this._st.readUnsigned();\n            const bits = byteToBitArr(this._st.readByte());\n            hdr.gctFlag = bits.shift();\n            hdr.colorRes = bitsToNum(bits.splice(0, 3));\n            hdr.sorted = bits.shift();\n            hdr.globalColorTableSize = bitsToNum(bits.splice(0, 3));\n            hdr.bgColor = this._st.readByte();\n            hdr.pixelAspectRatio = this._st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\n            if (hdr.gctFlag) {\n                hdr.globalColorTable = this.parseColorTable(1 << (hdr.globalColorTableSize + 1));\n                this.globalColorTable = hdr.globalColorTable;\n            }\n            if (this._handler.hdr && this._handler.hdr(hdr)) {\n                this.checkBytes.push(this._handler.hdr);\n            }\n        };\n        this.parseExt = (block) => {\n            const parseGCExt = (block) => {\n                this.checkBytes.push(this._st.readByte()); // Always 4\n                const bits = byteToBitArr(this._st.readByte());\n                block.reserved = bits.splice(0, 3); // Reserved; should be 000.\n                block.disposalMethod = bitsToNum(bits.splice(0, 3));\n                block.userInput = bits.shift();\n                block.transparencyGiven = bits.shift();\n                block.delayTime = this._st.readUnsigned();\n                block.transparencyIndex = this._st.readByte();\n                block.terminator = this._st.readByte();\n                if (this._handler.gce && this._handler.gce(block)) {\n                    this.checkBytes.push(this._handler.gce);\n                }\n            };\n            const parseComExt = (block) => {\n                block.comment = this.readSubBlocks();\n                if (this._handler.com && this._handler.com(block)) {\n                    this.checkBytes.push(this._handler.com);\n                }\n            };\n            const parsePTExt = (block) => {\n                this.checkBytes.push(this._st.readByte()); // Always 12\n                block.ptHeader = this._st.readBytes(12);\n                block.ptData = this.readSubBlocks();\n                if (this._handler.pte && this._handler.pte(block)) {\n                    this.checkBytes.push(this._handler.pte);\n                }\n            };\n            const parseAppExt = (block) => {\n                const parseNetscapeExt = (block) => {\n                    this.checkBytes.push(this._st.readByte()); // Always 3\n                    block.unknown = this._st.readByte(); // Q: Always 1? What is this?\n                    block.iterations = this._st.readUnsigned();\n                    block.terminator = this._st.readByte();\n                    if (this._handler.app && this._handler.app.NETSCAPE && this._handler.app.NETSCAPE(block)) {\n                        this.checkBytes.push(this._handler.app);\n                    }\n                };\n                const parseUnknownAppExt = (block) => {\n                    block.appData = this.readSubBlocks();\n                    // FIXME: This won't work if a handler wants to match on any identifier.\n                    if (this._handler.app && this._handler.app[block.identifier] && this._handler.app[block.identifier](block)) {\n                        this.checkBytes.push(this._handler.app[block.identifier]);\n                    }\n                };\n                this.checkBytes.push(this._st.readByte()); // Always 11\n                block.identifier = this._st.read(8);\n                block.authCode = this._st.read(3);\n                switch (block.identifier) {\n                    case 'NETSCAPE':\n                        parseNetscapeExt(block);\n                        break;\n                    default:\n                        parseUnknownAppExt(block);\n                        break;\n                }\n            };\n            const parseUnknownExt = (block) => {\n                block.data = this.readSubBlocks();\n                if (this._handler.unknown && this._handler.unknown(block)) {\n                    this.checkBytes.push(this._handler.unknown);\n                }\n            };\n            block.label = this._st.readByte();\n            switch (block.label) {\n                case 0xf9:\n                    block.extType = 'gce';\n                    parseGCExt(block);\n                    break;\n                case 0xfe:\n                    block.extType = 'com';\n                    parseComExt(block);\n                    break;\n                case 0x01:\n                    block.extType = 'pte';\n                    parsePTExt(block);\n                    break;\n                case 0xff:\n                    block.extType = 'app';\n                    parseAppExt(block);\n                    break;\n                default:\n                    block.extType = 'unknown';\n                    parseUnknownExt(block);\n                    break;\n            }\n        };\n        this.parseImg = (img) => {\n            const deinterlace = (pixels, width) => {\n                // Of course this defeats the purpose of interlacing. And it's *probably*\n                // the least efficient way it's ever been implemented. But nevertheless...\n                const newPixels = new Array(pixels.length);\n                const rows = pixels.length / width;\n                const cpRow = (toRow, fromRow) => {\n                    const fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\n                    newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\n                };\n                const offsets = [0, 4, 2, 1];\n                const steps = [8, 8, 4, 2];\n                let fromRow = 0;\n                for (let pass = 0; pass < 4; pass++) {\n                    for (let toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\n                        cpRow(toRow, fromRow);\n                        fromRow++;\n                    }\n                }\n                return newPixels;\n            };\n            img.leftPos = this._st.readUnsigned();\n            img.topPos = this._st.readUnsigned();\n            img.width = this._st.readUnsigned();\n            img.height = this._st.readUnsigned();\n            const bits = byteToBitArr(this._st.readByte());\n            img.lctFlag = bits.shift();\n            img.interlaced = bits.shift();\n            img.sorted = bits.shift();\n            img.reserved = bits.splice(0, 2);\n            img.lctSize = bitsToNum(bits.splice(0, 3));\n            if (img.lctFlag) {\n                img.lct = this.parseColorTable(1 << (img.lctSize + 1));\n            }\n            img.lzwMinCodeSize = this._st.readByte();\n            const lzwData = this.readSubBlocks();\n            img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\n            if (img.interlaced) {\n                // Move\n                img.pixels = deinterlace(img.pixels, img.width);\n            }\n            this.frames.push(img);\n            this.arrayToImage(img);\n            if (this._handler.img && this._handler.img(img)) {\n                this.checkBytes.push(this._handler);\n            }\n        };\n        this.parseBlock = () => {\n            const block = {\n                sentinel: this._st.readByte(),\n                type: ''\n            };\n            const blockChar = String.fromCharCode(block.sentinel);\n            switch (blockChar) {\n                case '!':\n                    block.type = 'ext';\n                    this.parseExt(block);\n                    break;\n                case ',':\n                    block.type = 'img';\n                    this.parseImg(block);\n                    break;\n                case ';':\n                    block.type = 'eof';\n                    if (this._handler.eof && this._handler.eof(block)) {\n                        this.checkBytes.push(this._handler.eof);\n                    }\n                    break;\n                default:\n                    throw new Error('Unknown block: 0x' + block.sentinel.toString(16));\n            }\n            if (block.type !== 'eof') {\n                this.parseBlock();\n            }\n        };\n        this.arrayToImage = (frame) => {\n            let count = 0;\n            const c = document.createElement('canvas');\n            c.id = count.toString();\n            c.width = frame.width;\n            c.height = frame.height;\n            count++;\n            const context = c.getContext('2d');\n            const pixSize = 1;\n            let y = 0;\n            let x = 0;\n            for (let i = 0; i < frame.pixels.length; i++) {\n                if (x % frame.width === 0) {\n                    y++;\n                    x = 0;\n                }\n                if (this.globalColorTable[frame.pixels[i]] === this._transparentColor.toHex()) {\n                    context.fillStyle = `rgba(0, 0, 0, 0)`;\n                }\n                else {\n                    context.fillStyle = this.globalColorTable[frame.pixels[i]];\n                }\n                context.fillRect(x, y, pixSize, pixSize);\n                x++;\n            }\n            const img = new Image();\n            img.src = c.toDataURL();\n            this.images.push(img);\n        };\n        this._st = stream;\n        this._handler = {};\n        this._transparentColor = color;\n        this.parseHeader();\n        this.parseBlock();\n    }\n}\n\n;// CONCATENATED MODULE: ./Resources/Font.ts\n\n\nclass FontSource {\n    constructor(\n    /**\n     * Path to the font resource relative from the HTML document hosting the game, or absolute\n     */\n    path, \n    /**\n     * The font family name\n     */\n    family, { bustCache, ...options } = {}) {\n        this.path = path;\n        this.family = family;\n        this._isLoaded = false;\n        this._resource = new Resource(path, 'blob', bustCache);\n        this._options = options;\n    }\n    async load() {\n        if (this.isLoaded()) {\n            return this.data;\n        }\n        try {\n            const blob = await this._resource.load();\n            const url = URL.createObjectURL(blob);\n            if (!this.data) {\n                this.data = new FontFace(this.family, `url(${url})`);\n                document.fonts.add(this.data);\n            }\n            await this.data.load();\n            this._isLoaded = true;\n        }\n        catch (error) {\n            throw `Error loading FontSource from path '${this.path}' with error [${error.message}]`;\n        }\n        return this.data;\n    }\n    isLoaded() {\n        return this._isLoaded;\n    }\n    /**\n     * Build a font from this FontSource.\n     * @param options {FontOptions} Override the font options\n     */\n    toFont(options) {\n        return new Font({ family: this.family, ...this._options, ...options });\n    }\n}\n\n;// CONCATENATED MODULE: ./Resources/Index.ts\n\n\n\n\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/index.ts\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./Util/Coroutine.ts\n\nconst generatorFunctionDeclaration = /^\\s*(?:function)?\\*/;\n/**\n *\n */\nfunction isCoroutineGenerator(x) {\n    if (typeof x !== 'function') {\n        return false;\n    }\n    if (generatorFunctionDeclaration.test(Function.prototype.toString.call(x))) {\n        return true;\n    }\n    if (!Object.getPrototypeOf) {\n        return false;\n    }\n    return Object.getPrototypeOf(x) === Object.getPrototypeOf(new Function('return function * () {}')());\n}\n/**\n *\n */\nfunction coroutine(...args) {\n    let coroutineGenerator;\n    let thisArg;\n    let options;\n    let passedEngine;\n    // coroutine(coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): Promise<void>;\n    if (isCoroutineGenerator(args[0])) {\n        thisArg = globalThis;\n        coroutineGenerator = args[0];\n        options = args[1];\n    }\n    // coroutine(thisArg: any, coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): Promise<void>;\n    if (isCoroutineGenerator(args[1])) {\n        thisArg = args[0];\n        coroutineGenerator = args[1];\n        options = args[2];\n    }\n    // coroutine(thisArg: any, engine: Engine, coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): Promise<void>;\n    if (args[1] instanceof Engine) {\n        thisArg = args[0];\n        passedEngine = args[1];\n        coroutineGenerator = args[2];\n        options = args[3];\n    }\n    // coroutine(engine: Engine, coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): Promise<void>;\n    if (args[0] instanceof Engine) {\n        thisArg = globalThis;\n        passedEngine = args[0];\n        coroutineGenerator = args[1];\n        options = args[2];\n    }\n    const schedule = options === null || options === void 0 ? void 0 : options.timing;\n    let engine;\n    try {\n        engine = passedEngine !== null && passedEngine !== void 0 ? passedEngine : Engine.useEngine();\n    }\n    catch (_) {\n        throw Error('Cannot run coroutine without engine parameter outside of an excalibur lifecycle method.\\n' +\n            'Pass an engine parameter to ex.coroutine(engine, function * {...})');\n    }\n    const generatorFcn = coroutineGenerator.bind(thisArg);\n    return new Promise((resolve, reject) => {\n        const generator = generatorFcn();\n        const loop = (elapsedMs) => {\n            try {\n                const { done, value } = generator.next(elapsedMs);\n                if (done) {\n                    resolve();\n                }\n                if (value instanceof Promise) {\n                    value.then(() => {\n                        // schedule next loop\n                        engine.clock.schedule(loop, 0, schedule);\n                    });\n                }\n                else if (value === undefined || value === (void 0)) {\n                    // schedule next frame\n                    engine.clock.schedule(loop, 0, schedule);\n                }\n                else {\n                    // schedule value milliseconds from now\n                    engine.clock.schedule(loop, value || 0, schedule);\n                }\n            }\n            catch (e) {\n                reject(e);\n            }\n        };\n        loop(engine.clock.elapsed()); // run first frame immediately\n    });\n}\n\n;// CONCATENATED MODULE: ./Director/Transition.ts\n\n\n\n\n\n\n\n\n\n/**\n * Base Transition that can be extended to provide custom scene transitions in Excalibur.\n */\nclass Transition extends Entity {\n    /**\n     * Returns a number between [0, 1] indicating what state the transition is in.\n     *\n     * * For 'out' direction transitions start at 0 and end at 1\n     * * For 'in' direction transitions start at 1 and end at 0\n     */\n    get progress() {\n        return this._currentProgress;\n    }\n    get complete() {\n        if (this.direction === 'out') {\n            return this.progress >= 1;\n        }\n        else {\n            return this.progress <= 0;\n        }\n    }\n    constructor(options) {\n        var _a, _b, _c, _d;\n        super();\n        this._logger = Logger.getInstance();\n        this.transform = new TransformComponent();\n        this.graphics = new GraphicsComponent();\n        this._completeFuture = new Future();\n        // State needs to be reset between uses\n        this.started = false;\n        this._currentDistance = 0;\n        this._currentProgress = 0;\n        this.done = this._completeFuture.promise;\n        this.name = `Transition#${this.id}`;\n        this.duration = options.duration;\n        this.easing = (_a = options.easing) !== null && _a !== void 0 ? _a : EasingFunctions.Linear;\n        this.direction = (_b = options.direction) !== null && _b !== void 0 ? _b : 'out';\n        this.hideLoader = (_c = options.hideLoader) !== null && _c !== void 0 ? _c : false;\n        this.blockInput = (_d = options.blockInput) !== null && _d !== void 0 ? _d : false;\n        this.transform.coordPlane = CoordPlane.Screen;\n        this.transform.pos = Vector.Zero;\n        this.transform.z = Infinity; // Transitions sit on top of everything\n        this.graphics.anchor = Vector.Zero;\n        this.addComponent(this.transform);\n        this.addComponent(this.graphics);\n        if (this.direction === 'out') {\n            this._currentProgress = 0;\n        }\n        else {\n            this._currentProgress = 1;\n        }\n    }\n    /**\n     * Overridable lifecycle method, called before each update.\n     *\n     * **WARNING BE SURE** to call `super.updateTransition()` if overriding in your own custom implementation\n     * @param engine\n     * @param delta\n     */\n    updateTransition(engine, delta) {\n        if (this.complete) {\n            return;\n        }\n        this._currentDistance += clamp(delta / this.duration, 0, 1);\n        if (this._currentDistance >= 1) {\n            this._currentDistance = 1;\n        }\n        if (this.direction === 'out') {\n            this._currentProgress = clamp(this.easing(this._currentDistance, 0, 1, 1), 0, 1);\n        }\n        else {\n            this._currentProgress = clamp(this.easing(this._currentDistance, 1, 0, 1), 0, 1);\n        }\n    }\n    /**\n     * Overridable lifecycle method, called right before the previous scene has deactivated.\n     *\n     * This gives incoming transition a chance to grab info from previous scene if desired\n     * @param scene\n     */\n    async onPreviousSceneDeactivate(scene) {\n        // override me\n    }\n    /**\n     * Overridable lifecycle method, called once at the beginning of the transition\n     *\n     * `progress` is given between 0 and 1\n     * @param progress\n     */\n    onStart(progress) {\n        // override me\n    }\n    /**\n     * Overridable lifecycle method, called every frame of the transition\n     *\n     * `progress` is given between 0 and 1\n     * @param progress\n     */\n    onUpdate(progress) {\n        // override me\n    }\n    /**\n     * Overridable lifecycle method, called at the end of the transition,\n     *\n     * `progress` is given between 0 and 1\n     * @param progress\n     */\n    onEnd(progress) {\n        // override me\n    }\n    /**\n     * Overridable lifecycle method, called when the transition is reset\n     *\n     * Use this to override and provide your own reset logic for internal state in custom transition implementations\n     */\n    onReset() {\n        // override me\n    }\n    /**\n     * reset() is called by the engine to reset transitions\n     */\n    reset() {\n        this.started = false;\n        this._completeFuture = new Future();\n        this.done = this._completeFuture.promise;\n        this._currentDistance = 0;\n        if (this.direction === 'out') {\n            this._currentProgress = 0;\n        }\n        else {\n            this._currentProgress = 1;\n        }\n        this.onReset();\n    }\n    play(engine, targetScene) {\n        if (this.started) {\n            this.reset();\n            this._logger.warn(`Attempted to play a transition ${this.name} that is already playing, reset transition.`);\n        }\n        const currentScene = targetScene !== null && targetScene !== void 0 ? targetScene : engine.currentScene;\n        currentScene.add(this);\n        const self = this;\n        return coroutine(engine, function* () {\n            while (!self.complete) {\n                const elapsed = yield; // per frame\n                self.updateTransition(engine, elapsed);\n                self.execute();\n            }\n        });\n    }\n    /**\n     * execute() is called by the engine every frame to update the Transition lifecycle onStart/onUpdate/onEnd\n     */\n    execute() {\n        if (!this.isInitialized) {\n            return;\n        }\n        if (!this.started) {\n            this.started = true;\n            this.onStart(this.progress);\n        }\n        this.onUpdate(this.progress);\n        if (this.complete && !this._completeFuture.isCompleted) {\n            this.onEnd(this.progress);\n            this._completeFuture.resolve();\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Director/FadeInOut.ts\n\n\n\nclass FadeInOut extends Transition {\n    constructor(options) {\n        var _a, _b;\n        super({\n            ...options,\n            duration: (_a = options.duration) !== null && _a !== void 0 ? _a : 2000\n        });\n        this.name = `FadeInOut#${this.id}`;\n        this.color = (_b = options.color) !== null && _b !== void 0 ? _b : Color.Black;\n    }\n    onInitialize(engine) {\n        this.transform.pos = engine.screen.unsafeArea.topLeft;\n        this.screenCover = new Rectangle({\n            width: engine.screen.resolution.width,\n            height: engine.screen.resolution.height,\n            color: this.color\n        });\n        this.graphics.add(this.screenCover);\n        this.graphics.opacity = this.progress;\n    }\n    onReset() {\n        this.graphics.opacity = this.progress;\n    }\n    onStart(progress) {\n        this.graphics.opacity = progress;\n    }\n    onEnd(progress) {\n        this.graphics.opacity = progress;\n    }\n    onUpdate(progress) {\n        this.graphics.opacity = progress;\n    }\n}\n\n;// CONCATENATED MODULE: ./Director/CrossFade.ts\n\n\n\n/**\n * CrossFades between the previous scene and the destination scene\n *\n * Note: CrossFade only works as an \"in\" transition\n */\nclass CrossFade extends Transition {\n    constructor(options) {\n        super({ direction: 'in', ...options }); // default the correct direction\n        this.name = `CrossFade#${this.id}`;\n    }\n    async onPreviousSceneDeactivate(scene) {\n        this.image = await scene.engine.screenshot(true);\n        // Firefox is particularly slow\n        // needed in case the image isn't ready yet\n        await this.image.decode();\n    }\n    onInitialize(engine) {\n        this.engine = engine;\n        this.transform.pos = engine.screen.unsafeArea.topLeft;\n        this.screenCover = ImageSource.fromHtmlImageElement(this.image).toSprite();\n        this.graphics.add(this.screenCover);\n        this.transform.scale = vec(1 / engine.screen.pixelRatio, 1 / engine.screen.pixelRatio);\n        this.graphics.opacity = this.progress;\n    }\n    onStart(_progress) {\n        this.graphics.opacity = this.progress;\n    }\n    onReset() {\n        this.graphics.opacity = this.progress;\n    }\n    onEnd(progress) {\n        this.graphics.opacity = progress;\n    }\n    onUpdate(progress) {\n        this.graphics.opacity = progress;\n    }\n}\n\n;// CONCATENATED MODULE: ./Director/index.ts\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./Graphics/Line.ts\n\n\n\nclass Line extends Graphic {\n    constructor(options) {\n        super();\n        this.color = Color.Black;\n        this.thickness = 1;\n        const { start, end, color, thickness } = options;\n        this.start = start;\n        this.end = end;\n        this.color = color !== null && color !== void 0 ? color : this.color;\n        this.thickness = thickness !== null && thickness !== void 0 ? thickness : this.thickness;\n        this._localBounds = this._calculateBounds();\n        const { width, height } = this._localBounds;\n        this.width = width;\n        this.height = height;\n    }\n    get localBounds() {\n        return this._localBounds;\n    }\n    _calculateBounds() {\n        const lineNormal = this.end.sub(this.start).normal();\n        const halfThickness = this.thickness / 2;\n        const points = [\n            this.start.add(lineNormal.scale(halfThickness)),\n            this.end.add(lineNormal.scale(halfThickness)),\n            this.end.add(lineNormal.scale(-halfThickness)),\n            this.start.add(lineNormal.scale(-halfThickness))\n        ];\n        return BoundingBox.fromPoints(points);\n    }\n    _drawImage(ctx, _x, _y) {\n        ctx.drawLine(this.start, this.end, this.color, this.thickness);\n    }\n    clone() {\n        return new Line({\n            start: this.start,\n            end: this.end,\n            color: this.color,\n            thickness: this.thickness\n        });\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/Polygon.ts\n\n\n\n/**\n * A polygon [[Graphic]] for drawing arbitrary polygons to the [[ExcaliburGraphicsContext]]\n *\n * Polygons default to [[ImageFiltering.Blended]]\n */\nclass Polygon extends Raster {\n    get points() {\n        return this._points;\n    }\n    set points(points) {\n        this._points = points;\n        const min = this.minPoint;\n        this.width = this._points.reduce((max, p) => Math.max(p.x, max), 0) - min.x;\n        this.height = this._points.reduce((max, p) => Math.max(p.y, max), 0) - min.y;\n        this.flagDirty();\n    }\n    get minPoint() {\n        const minX = this._points.reduce((min, p) => Math.min(p.x, min), Infinity);\n        const minY = this._points.reduce((min, p) => Math.min(p.y, min), Infinity);\n        return vec(minX, minY);\n    }\n    constructor(options) {\n        super(options);\n        this.points = options.points;\n        this.filtering = ImageFiltering.Blended;\n        this.rasterize();\n    }\n    clone() {\n        return new Polygon({\n            points: this.points.map((p) => p.clone()),\n            ...this.cloneGraphicOptions(),\n            ...this.cloneRasterOptions()\n        });\n    }\n    execute(ctx) {\n        if (this.points && this.points.length) {\n            ctx.beginPath();\n            // Iterate through the supplied points and construct a 'polygon'\n            const min = this.minPoint.negate();\n            const firstPoint = this.points[0].add(min);\n            ctx.moveTo(firstPoint.x, firstPoint.y);\n            this.points.forEach((point) => {\n                ctx.lineTo(point.x + min.x, point.y + min.y);\n            });\n            ctx.lineTo(firstPoint.x, firstPoint.y);\n            ctx.closePath();\n            if (this.color) {\n                ctx.fill();\n            }\n            if (this.strokeColor) {\n                ctx.stroke();\n            }\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./Graphics/index.ts\n// Graphics\n\n\n\n\n\n\n\n// Graphics ECS\n\n\n\n\n\n// Raster graphics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Post Processor\n\n\n\n\n\n\n\n// Rendering\n\n\n\n\n\n// Debug\n\n// Util\n\n\n\n;// CONCATENATED MODULE: ./Input/Index.ts\n// This import site is deprecated\n// TODO remove deprecated exports in v0.29.0\n\n\n\n\n\n\n\n\n\n\n\n// Re-export hack to deprecate import site gently\n\n\n;// CONCATENATED MODULE: ./Util/Index.ts\n\n\n\n\n\n\n\n;// CONCATENATED MODULE: ./Util/Decorators.ts\n\n\nconst maxMessages = 5;\nconst obsoleteMessage = {};\nconst resetObsoleteCounter = () => {\n    for (const message in obsoleteMessage) {\n        obsoleteMessage[message] = 0;\n    }\n};\nconst logMessage = (message, options) => {\n    const suppressObsoleteMessages = Flags.isEnabled('suppress-obsolete-message');\n    if (obsoleteMessage[message] < maxMessages && !suppressObsoleteMessages) {\n        Logger.getInstance().warn(message);\n        // tslint:disable-next-line: no-console\n        if (console.trace && options.showStackTrace) {\n            // tslint:disable-next-line: no-console\n            console.trace();\n        }\n    }\n    obsoleteMessage[message]++;\n};\n/**\n * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement\n * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js\n */\nfunction obsolete(options) {\n    options = {\n        message: 'This feature will be removed in future versions of Excalibur.',\n        alternateMethod: null,\n        showStackTrace: false,\n        ...options\n    };\n    return function (target, property, descriptor) {\n        if (descriptor &&\n            !(typeof descriptor.value === 'function' || typeof descriptor.get === 'function' || typeof descriptor.set === 'function')) {\n            throw new SyntaxError('Only classes/functions/getters/setters can be marked as obsolete');\n        }\n        const methodSignature = `${target.name || ''}${target.name && property ? '.' : ''}${property ? property : ''}`;\n        const message = `${methodSignature} is marked obsolete: ${options.message}` +\n            (options.alternateMethod ? ` Use ${options.alternateMethod} instead` : '');\n        if (!obsoleteMessage[message]) {\n            obsoleteMessage[message] = 0;\n        }\n        // If descriptor is null it is a class\n        const method = descriptor ? { ...descriptor } : target;\n        if (!descriptor) {\n            // with es2015 classes we need to change our decoration tactic\n            class DecoratedClass extends method {\n                constructor(...args) {\n                    logMessage(message, options);\n                    super(...args);\n                }\n            }\n            return DecoratedClass;\n        }\n        if (descriptor && descriptor.value) {\n            method.value = function () {\n                logMessage(message, options);\n                return descriptor.value.apply(this, arguments);\n            };\n            return method;\n        }\n        if (descriptor && descriptor.get) {\n            method.get = function () {\n                logMessage(message, options);\n                return descriptor.get.apply(this, arguments);\n            };\n        }\n        if (descriptor && descriptor.set) {\n            method.set = function () {\n                logMessage(message, options);\n                return descriptor.set.apply(this, arguments);\n            };\n        }\n        return method;\n    };\n}\n\n;// CONCATENATED MODULE: ./Util/Semaphore.ts\n\nclass AsyncWaitQueue {\n    constructor() {\n        // Code from StephenCleary https://gist.github.com/StephenCleary/ba50b2da419c03b9cba1d20cb4654d5e\n        this._queue = [];\n    }\n    get length() {\n        return this._queue.length;\n    }\n    enqueue() {\n        const future = new Future();\n        this._queue.push(future);\n        return future.promise;\n    }\n    dequeue(value) {\n        const future = this._queue.shift();\n        future.resolve(value);\n    }\n}\n/**\n * Semaphore allows you to limit the amount of async calls happening between `enter()` and `exit()`\n *\n * This can be useful when limiting the number of http calls, browser api calls, etc either for performance or to work\n * around browser limitations like max Image.decode() calls in chromium being 256.\n */\nclass Semaphore {\n    constructor(_count) {\n        this._count = _count;\n        this._waitQueue = new AsyncWaitQueue();\n    }\n    get count() {\n        return this._count;\n    }\n    get waiting() {\n        return this._waitQueue.length;\n    }\n    // eslint-disable-next-line require-await\n    async enter() {\n        if (this._count !== 0) {\n            this._count--;\n            return Promise.resolve();\n        }\n        return this._waitQueue.enqueue();\n    }\n    exit(count = 1) {\n        if (count === 0) {\n            return;\n        }\n        while (count !== 0 && this._waitQueue.length !== 0) {\n            this._waitQueue.dequeue(null);\n            count--;\n        }\n        this._count += count;\n    }\n}\n\n;// CONCATENATED MODULE: ./index.ts\n/**\n * The current Excalibur version string\n * @description `process.env.__EX_VERSION` gets replaced by Webpack on build\n */\nconst EX_VERSION = \"0.29.3\";\n\npolyfill();\n// This file is used as the bundle entry point and exports everything\n// that will be exposed as the `ex` global variable.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// ex.Events namespace\n\n\n// ex.Input namespace\n// TODO deprecated import site remove in v0.29.0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// ex.Util namespaces\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// ex.Deprecated\n// import * as deprecated from './Deprecated';\n// export { deprecated as Deprecated };\n// export * from './Deprecated';\n\n})();\n\nvar __webpack_exports__ActionCompleteEvent = __webpack_exports__.eKr;\nvar __webpack_exports__ActionContext = __webpack_exports__.yVm;\nvar __webpack_exports__ActionQueue = __webpack_exports__.a7j;\nvar __webpack_exports__ActionSequence = __webpack_exports__.U_w;\nvar __webpack_exports__ActionStartEvent = __webpack_exports__.JF2;\nvar __webpack_exports__ActionsComponent = __webpack_exports__.htg;\nvar __webpack_exports__ActionsSystem = __webpack_exports__.HXL;\nvar __webpack_exports__ActivateEvent = __webpack_exports__.mcg;\nvar __webpack_exports__Actor = __webpack_exports__.Agj;\nvar __webpack_exports__AddedComponent = __webpack_exports__.u6S;\nvar __webpack_exports__AffineMatrix = __webpack_exports__.x7M;\nvar __webpack_exports__Animation = __webpack_exports__.X55;\nvar __webpack_exports__AnimationDirection = __webpack_exports__.m3M;\nvar __webpack_exports__AnimationEvents = __webpack_exports__.aE5;\nvar __webpack_exports__AnimationStrategy = __webpack_exports__.YJU;\nvar __webpack_exports__ArcadeSolver = __webpack_exports__.eZi;\nvar __webpack_exports__AudioContextFactory = __webpack_exports__.GNv;\nvar __webpack_exports__Axes = __webpack_exports__.Y56;\nvar __webpack_exports__Axis = __webpack_exports__._0v;\nvar __webpack_exports__BaseAlign = __webpack_exports__.vhs;\nvar __webpack_exports__Blink = __webpack_exports__.Z8b;\nvar __webpack_exports__BodyComponent = __webpack_exports__.Yfw;\nvar __webpack_exports__BoundingBox = __webpack_exports__.IcQ;\nvar __webpack_exports__BroadphaseStrategy = __webpack_exports__.Rl2;\nvar __webpack_exports__BrowserComponent = __webpack_exports__.kgJ;\nvar __webpack_exports__BrowserEvents = __webpack_exports__.GTT;\nvar __webpack_exports__Buttons = __webpack_exports__.ypY;\nvar __webpack_exports__Camera = __webpack_exports__.i7d;\nvar __webpack_exports__CameraEvents = __webpack_exports__.fQ3;\nvar __webpack_exports__Canvas = __webpack_exports__.HlI;\nvar __webpack_exports__Circle = __webpack_exports__.jlt;\nvar __webpack_exports__CircleCollider = __webpack_exports__.VQc;\nvar __webpack_exports__Clock = __webpack_exports__.zD7;\nvar __webpack_exports__ClosestLine = __webpack_exports__.I0I;\nvar __webpack_exports__ClosestLineJumpTable = __webpack_exports__.AUF;\nvar __webpack_exports__Collider = __webpack_exports__.JoF;\nvar __webpack_exports__ColliderComponent = __webpack_exports__.MlA;\nvar __webpack_exports__CollisionContact = __webpack_exports__.PZh;\nvar __webpack_exports__CollisionEndEvent = __webpack_exports__.qA;\nvar __webpack_exports__CollisionGroup = __webpack_exports__.CrD;\nvar __webpack_exports__CollisionGroupManager = __webpack_exports__.dQK;\nvar __webpack_exports__CollisionJumpTable = __webpack_exports__.D3r;\nvar __webpack_exports__CollisionPostSolveEvent = __webpack_exports__.Qpo;\nvar __webpack_exports__CollisionPreSolveEvent = __webpack_exports__.D9n;\nvar __webpack_exports__CollisionStartEvent = __webpack_exports__.b6v;\nvar __webpack_exports__CollisionSystem = __webpack_exports__.mvh;\nvar __webpack_exports__CollisionType = __webpack_exports__.Bpo;\nvar __webpack_exports__Color = __webpack_exports__.Q1f;\nvar __webpack_exports__ColorBlindFlags = __webpack_exports__.IKv;\nvar __webpack_exports__ColorBlindnessMode = __webpack_exports__.fcV;\nvar __webpack_exports__ColorBlindnessPostProcessor = __webpack_exports__.Glf;\nvar __webpack_exports__Component = __webpack_exports__.uAl;\nvar __webpack_exports__CompositeCollider = __webpack_exports__.ElT;\nvar __webpack_exports__Configurable = __webpack_exports__.MPu;\nvar __webpack_exports__ConsoleAppender = __webpack_exports__.Z8r;\nvar __webpack_exports__ContactConstraintPoint = __webpack_exports__.QSL;\nvar __webpack_exports__ContactEndEvent = __webpack_exports__.sPV;\nvar __webpack_exports__ContactSolveBias = __webpack_exports__.nAn;\nvar __webpack_exports__ContactStartEvent = __webpack_exports__.zCU;\nvar __webpack_exports__CoordPlane = __webpack_exports__.QrV;\nvar __webpack_exports__CrossFade = __webpack_exports__.fF9;\nvar __webpack_exports__DeactivateEvent = __webpack_exports__.xI8;\nvar __webpack_exports__Debug = __webpack_exports__.yar;\nvar __webpack_exports__DebugConfig = __webpack_exports__.SP7;\nvar __webpack_exports__DebugGraphicsComponent = __webpack_exports__.oRy;\nvar __webpack_exports__DebugSystem = __webpack_exports__.f5X;\nvar __webpack_exports__DebugText = __webpack_exports__.V1c;\nvar __webpack_exports__DefaultAntialiasOptions = __webpack_exports__.Mlx;\nvar __webpack_exports__DefaultLoader = __webpack_exports__.ZCo;\nvar __webpack_exports__DefaultPhysicsConfig = __webpack_exports__.Vy3;\nvar __webpack_exports__DefaultPixelArtOptions = __webpack_exports__.J5p;\nvar __webpack_exports__DegreeOfFreedom = __webpack_exports__.mL_;\nvar __webpack_exports__Delay = __webpack_exports__.Guw;\nvar __webpack_exports__DeprecatedStaticToConfig = __webpack_exports__.VKx;\nvar __webpack_exports__Detector = __webpack_exports__.N5j;\nvar __webpack_exports__Die = __webpack_exports__.pgY;\nvar __webpack_exports__Direction = __webpack_exports__.OP3;\nvar __webpack_exports__Director = __webpack_exports__.rl5;\nvar __webpack_exports__DirectorEvents = __webpack_exports__.eod;\nvar __webpack_exports__DisplayMode = __webpack_exports__.q5Z;\nvar __webpack_exports__DynamicTree = __webpack_exports__.YUC;\nvar __webpack_exports__DynamicTreeCollisionProcessor = __webpack_exports__.saR;\nvar __webpack_exports__EX_VERSION = __webpack_exports__.hvr;\nvar __webpack_exports__EaseBy = __webpack_exports__.Qol;\nvar __webpack_exports__EaseTo = __webpack_exports__.Wf4;\nvar __webpack_exports__EasingFunctions = __webpack_exports__.JCs;\nvar __webpack_exports__EdgeCollider = __webpack_exports__.gJV;\nvar __webpack_exports__ElasticToActorStrategy = __webpack_exports__.fWD;\nvar __webpack_exports__EmitterType = __webpack_exports__.Va_;\nvar __webpack_exports__Engine = __webpack_exports__.N$8;\nvar __webpack_exports__EngineEvents = __webpack_exports__._jQ;\nvar __webpack_exports__EnterTriggerEvent = __webpack_exports__.rxj;\nvar __webpack_exports__EnterViewPortEvent = __webpack_exports__.rhv;\nvar __webpack_exports__Entity = __webpack_exports__.wCu;\nvar __webpack_exports__EntityEvents = __webpack_exports__.HAp;\nvar __webpack_exports__EntityManager = __webpack_exports__.Zy1;\nvar __webpack_exports__EventDispatcher = __webpack_exports__.Qev;\nvar __webpack_exports__EventEmitter = __webpack_exports__.bkB;\nvar __webpack_exports__EventTypes = __webpack_exports__.wfL;\nvar __webpack_exports__Events = __webpack_exports__.sVA;\nvar __webpack_exports__ExResponse = __webpack_exports__.$Gs;\nvar __webpack_exports__ExcaliburGraphicsContext2DCanvas = __webpack_exports__.CJ0;\nvar __webpack_exports__ExcaliburGraphicsContextWebGL = __webpack_exports__.NWh;\nvar __webpack_exports__ExitTriggerEvent = __webpack_exports__.tWi;\nvar __webpack_exports__ExitViewPortEvent = __webpack_exports__.xAj;\nvar __webpack_exports__Fade = __webpack_exports__.zWh;\nvar __webpack_exports__FadeInOut = __webpack_exports__.i_4;\nvar __webpack_exports__Flags = __webpack_exports__.iIx;\nvar __webpack_exports__Follow = __webpack_exports__.c9e;\nvar __webpack_exports__Font = __webpack_exports__.KQV;\nvar __webpack_exports__FontCache = __webpack_exports__.weH;\nvar __webpack_exports__FontSource = __webpack_exports__.jXp;\nvar __webpack_exports__FontStyle = __webpack_exports__.zzY;\nvar __webpack_exports__FontUnit = __webpack_exports__.yRQ;\nvar __webpack_exports__FpsSampler = __webpack_exports__.MtE;\nvar __webpack_exports__FrameStats = __webpack_exports__.rPj;\nvar __webpack_exports__Future = __webpack_exports__.KLc;\nvar __webpack_exports__GameEvent = __webpack_exports__.Fir;\nvar __webpack_exports__GameStartEvent = __webpack_exports__.V5f;\nvar __webpack_exports__GameStopEvent = __webpack_exports__.Xj7;\nvar __webpack_exports__Gamepad = __webpack_exports__.Wud;\nvar __webpack_exports__GamepadAxisEvent = __webpack_exports__.FVg;\nvar __webpack_exports__GamepadButtonEvent = __webpack_exports__.g5Y;\nvar __webpack_exports__GamepadConnectEvent = __webpack_exports__.YQB;\nvar __webpack_exports__GamepadDisconnectEvent = __webpack_exports__.KPb;\nvar __webpack_exports__Gamepads = __webpack_exports__.nHK;\nvar __webpack_exports__Gif = __webpack_exports__.TX_;\nvar __webpack_exports__GlobalCoordinates = __webpack_exports__.r3n;\nvar __webpack_exports__Graphic = __webpack_exports__.vYh;\nvar __webpack_exports__GraphicsComponent = __webpack_exports__.hnk;\nvar __webpack_exports__GraphicsGroup = __webpack_exports__.D2R;\nvar __webpack_exports__GraphicsSystem = __webpack_exports__.n1o;\nvar __webpack_exports__HiddenEvent = __webpack_exports__.RLG;\nvar __webpack_exports__HorizontalFirst = __webpack_exports__.fBU;\nvar __webpack_exports__ImageFiltering = __webpack_exports__.Adb;\nvar __webpack_exports__ImageSource = __webpack_exports__.bEs;\nvar __webpack_exports__ImageSourceAttributeConstants = __webpack_exports__.wCy;\nvar __webpack_exports__ImageWrapping = __webpack_exports__.CbD;\nvar __webpack_exports__InitializeEvent = __webpack_exports__.x_C;\nvar __webpack_exports__Input = __webpack_exports__.pde;\nvar __webpack_exports__InputHost = __webpack_exports__.pGf;\nvar __webpack_exports__InputMapper = __webpack_exports__.ibQ;\nvar __webpack_exports__Integrator = __webpack_exports__.QlN;\nvar __webpack_exports__IsometricEntityComponent = __webpack_exports__.shR;\nvar __webpack_exports__IsometricEntitySystem = __webpack_exports__.Yjk;\nvar __webpack_exports__IsometricMap = __webpack_exports__._u1;\nvar __webpack_exports__IsometricTile = __webpack_exports__.OBI;\nvar __webpack_exports__KeyEvent = __webpack_exports__.klh;\nvar __webpack_exports__Keyboard = __webpack_exports__.s3S;\nvar __webpack_exports__Keys = __webpack_exports__.D$R;\nvar __webpack_exports__KillEvent = __webpack_exports__.xth;\nvar __webpack_exports__Label = __webpack_exports__.JU7;\nvar __webpack_exports__LimitCameraBoundsStrategy = __webpack_exports__.h9x;\nvar __webpack_exports__Line = __webpack_exports__.N1A;\nvar __webpack_exports__LineSegment = __webpack_exports__.e_k;\nvar __webpack_exports__Loader = __webpack_exports__.aHM;\nvar __webpack_exports__LoaderEvents = __webpack_exports__.tlv;\nvar __webpack_exports__LockCameraToActorAxisStrategy = __webpack_exports__.Vi9;\nvar __webpack_exports__LockCameraToActorStrategy = __webpack_exports__.ieR;\nvar __webpack_exports__LogLevel = __webpack_exports__.$bb;\nvar __webpack_exports__Logger = __webpack_exports__.VyI;\nvar __webpack_exports__Material = __webpack_exports__.imn;\nvar __webpack_exports__Matrix = __webpack_exports__.uqu;\nvar __webpack_exports__MatrixLocations = __webpack_exports__.QnL;\nvar __webpack_exports__MediaEvent = __webpack_exports__.vnc;\nvar __webpack_exports__Meet = __webpack_exports__.wk_;\nvar __webpack_exports__MotionComponent = __webpack_exports__.GH0;\nvar __webpack_exports__MotionSystem = __webpack_exports__._1r;\nvar __webpack_exports__MoveBy = __webpack_exports__.l0X;\nvar __webpack_exports__MoveTo = __webpack_exports__.HHX;\nvar __webpack_exports__NativePointerButton = __webpack_exports__.tjk;\nvar __webpack_exports__NativeSoundEvent = __webpack_exports__.rWe;\nvar __webpack_exports__NativeSoundProcessedEvent = __webpack_exports__.j9l;\nvar __webpack_exports__None = __webpack_exports__.NVp;\nvar __webpack_exports__Observable = __webpack_exports__.cPK;\nvar __webpack_exports__OffscreenSystem = __webpack_exports__.XoL;\nvar __webpack_exports__Pair = __webpack_exports__.RmF;\nvar __webpack_exports__ParallaxComponent = __webpack_exports__.DXI;\nvar __webpack_exports__ParallelActions = __webpack_exports__.tCD;\nvar __webpack_exports__ParseGif = __webpack_exports__.oGn;\nvar __webpack_exports__Particle = __webpack_exports__.J3D;\nvar __webpack_exports__ParticleEmitter = __webpack_exports__.vCJ;\nvar __webpack_exports__ParticleTransform = __webpack_exports__.f9l;\nvar __webpack_exports__Physics = __webpack_exports__.AQx;\nvar __webpack_exports__PhysicsStats = __webpack_exports__.v9m;\nvar __webpack_exports__PhysicsWorld = __webpack_exports__.yRJ;\nvar __webpack_exports__PointerAbstraction = __webpack_exports__.EU6;\nvar __webpack_exports__PointerButton = __webpack_exports__.m3O;\nvar __webpack_exports__PointerComponent = __webpack_exports__.Ryz;\nvar __webpack_exports__PointerEvent = __webpack_exports__.OxP;\nvar __webpack_exports__PointerEventReceiver = __webpack_exports__.LEs;\nvar __webpack_exports__PointerScope = __webpack_exports__.Ec;\nvar __webpack_exports__PointerSystem = __webpack_exports__.Pi5;\nvar __webpack_exports__PointerType = __webpack_exports__.gmH;\nvar __webpack_exports__Polygon = __webpack_exports__.tS;\nvar __webpack_exports__PolygonCollider = __webpack_exports__.XxX;\nvar __webpack_exports__Pool = __webpack_exports__.bCz;\nvar __webpack_exports__PostCollisionEvent = __webpack_exports__.nYS;\nvar __webpack_exports__PostDebugDrawEvent = __webpack_exports__.yiT;\nvar __webpack_exports__PostDrawEvent = __webpack_exports__.NHl;\nvar __webpack_exports__PostFrameEvent = __webpack_exports__.mO8;\nvar __webpack_exports__PostKillEvent = __webpack_exports__.PXI;\nvar __webpack_exports__PostTransformDrawEvent = __webpack_exports__.bn5;\nvar __webpack_exports__PostUpdateEvent = __webpack_exports__.Ywr;\nvar __webpack_exports__PreCollisionEvent = __webpack_exports__.cMd;\nvar __webpack_exports__PreDebugDrawEvent = __webpack_exports__.Bs6;\nvar __webpack_exports__PreDrawEvent = __webpack_exports__.G0k;\nvar __webpack_exports__PreFrameEvent = __webpack_exports__.pyn;\nvar __webpack_exports__PreKillEvent = __webpack_exports__.QeM;\nvar __webpack_exports__PreLoadEvent = __webpack_exports__.aPX;\nvar __webpack_exports__PreTransformDrawEvent = __webpack_exports__.ITP;\nvar __webpack_exports__PreUpdateEvent = __webpack_exports__.BY0;\nvar __webpack_exports__Projection = __webpack_exports__.MFw;\nvar __webpack_exports__QuadIndexBuffer = __webpack_exports__.sBn;\nvar __webpack_exports__QuadTree = __webpack_exports__.S3L;\nvar __webpack_exports__Query = __webpack_exports__.XKQ;\nvar __webpack_exports__QueryManager = __webpack_exports__.ESI;\nvar __webpack_exports__RadiusAroundActorStrategy = __webpack_exports__.uxz;\nvar __webpack_exports__Random = __webpack_exports__.o8N;\nvar __webpack_exports__Raster = __webpack_exports__.u_r;\nvar __webpack_exports__Ray = __webpack_exports__.RlV;\nvar __webpack_exports__RealisticSolver = __webpack_exports__.gVA;\nvar __webpack_exports__Rectangle = __webpack_exports__.M_G;\nvar __webpack_exports__RemovedComponent = __webpack_exports__.GRB;\nvar __webpack_exports__Repeat = __webpack_exports__.kM6;\nvar __webpack_exports__RepeatForever = __webpack_exports__.dO8;\nvar __webpack_exports__Resolution = __webpack_exports__.jgM;\nvar __webpack_exports__Resource = __webpack_exports__.FWq;\nvar __webpack_exports__ResourceEvents = __webpack_exports__.s3j;\nvar __webpack_exports__RotateBy = __webpack_exports__.hlw;\nvar __webpack_exports__RotateTo = __webpack_exports__.B7e;\nvar __webpack_exports__RotationType = __webpack_exports__.H_X;\nvar __webpack_exports__ScaleBy = __webpack_exports__.S_d;\nvar __webpack_exports__ScaleTo = __webpack_exports__.U7E;\nvar __webpack_exports__Scene = __webpack_exports__.Z58;\nvar __webpack_exports__SceneEvents = __webpack_exports__.yh2;\nvar __webpack_exports__Screen = __webpack_exports__.ff$;\nvar __webpack_exports__ScreenAppender = __webpack_exports__.cWi;\nvar __webpack_exports__ScreenElement = __webpack_exports__.NBt;\nvar __webpack_exports__ScreenEvents = __webpack_exports__.oNz;\nvar __webpack_exports__ScreenShader = __webpack_exports__.QlU;\nvar __webpack_exports__ScrollPreventionMode = __webpack_exports__.Xey;\nvar __webpack_exports__Semaphore = __webpack_exports__.jft;\nvar __webpack_exports__Shader = __webpack_exports__.Mtr;\nvar __webpack_exports__Shape = __webpack_exports__.ypk;\nvar __webpack_exports__Side = __webpack_exports__.mnM;\nvar __webpack_exports__SolverStrategy = __webpack_exports__.bAZ;\nvar __webpack_exports__Sound = __webpack_exports__.ABN;\nvar __webpack_exports__SoundEvents = __webpack_exports__.VK6;\nvar __webpack_exports__Sprite = __webpack_exports__.kxk;\nvar __webpack_exports__SpriteFont = __webpack_exports__.DT1;\nvar __webpack_exports__SpriteSheet = __webpack_exports__.FLG;\nvar __webpack_exports__StandardClock = __webpack_exports__.qN_;\nvar __webpack_exports__StateMachine = __webpack_exports__.Z37;\nvar __webpack_exports__StrategyContainer = __webpack_exports__.FtL;\nvar __webpack_exports__Stream = __webpack_exports__.Z6X;\nvar __webpack_exports__System = __webpack_exports__.iQT;\nvar __webpack_exports__SystemManager = __webpack_exports__.ziO;\nvar __webpack_exports__SystemPriority = __webpack_exports__.OEF;\nvar __webpack_exports__SystemType = __webpack_exports__.uuE;\nvar __webpack_exports__TagQuery = __webpack_exports__.tiv;\nvar __webpack_exports__TestClock = __webpack_exports__.T$Y;\nvar __webpack_exports__Text = __webpack_exports__.EYj;\nvar __webpack_exports__TextAlign = __webpack_exports__.nOB;\nvar __webpack_exports__TextureLoader = __webpack_exports__.Tap;\nvar __webpack_exports__Tile = __webpack_exports__.FAs;\nvar __webpack_exports__TileMap = __webpack_exports__.B_P;\nvar __webpack_exports__TileMapEvents = __webpack_exports__.aA5;\nvar __webpack_exports__Timer = __webpack_exports__.M4G;\nvar __webpack_exports__Toaster = __webpack_exports__.l$l;\nvar __webpack_exports__Transform = __webpack_exports__.dLy;\nvar __webpack_exports__TransformComponent = __webpack_exports__.WZP;\nvar __webpack_exports__Transition = __webpack_exports__.eB6;\nvar __webpack_exports__TreeNode = __webpack_exports__.nFK;\nvar __webpack_exports__Trigger = __webpack_exports__.l9z;\nvar __webpack_exports__TriggerEvents = __webpack_exports__.YOF;\nvar __webpack_exports__TwoPI = __webpack_exports__.yhB;\nvar __webpack_exports__Util = __webpack_exports__.J0N;\nvar __webpack_exports__Vector = __webpack_exports__.Miz;\nvar __webpack_exports__VectorView = __webpack_exports__.Bj4;\nvar __webpack_exports__VertexBuffer = __webpack_exports__.Rcs;\nvar __webpack_exports__VertexLayout = __webpack_exports__.vJ4;\nvar __webpack_exports__VerticalFirst = __webpack_exports__.TqC;\nvar __webpack_exports__VisibleEvent = __webpack_exports__.nM0;\nvar __webpack_exports__WebAudio = __webpack_exports__.X1u;\nvar __webpack_exports__WebAudioInstance = __webpack_exports__.SpZ;\nvar __webpack_exports__WheelDeltaMode = __webpack_exports__.DX8;\nvar __webpack_exports__WheelEvent = __webpack_exports__.Yx$;\nvar __webpack_exports__World = __webpack_exports__.HK4;\nvar __webpack_exports__canonicalizeAngle = __webpack_exports__.SE$;\nvar __webpack_exports__clamp = __webpack_exports__.qE8;\nvar __webpack_exports__coroutine = __webpack_exports__.Pz7;\nvar __webpack_exports__createId = __webpack_exports__.sX_;\nvar __webpack_exports__frac = __webpack_exports__.JuI;\nvar __webpack_exports__hasGraphicsTick = __webpack_exports__.Nl$;\nvar __webpack_exports__hasOnInitialize = __webpack_exports__.OwT;\nvar __webpack_exports__hasOnPostUpdate = __webpack_exports__.P$G;\nvar __webpack_exports__hasOnPreUpdate = __webpack_exports__.mHV;\nvar __webpack_exports__hasPostDraw = __webpack_exports__.Fx_;\nvar __webpack_exports__hasPreDraw = __webpack_exports__.WFC;\nvar __webpack_exports__has_initialize = __webpack_exports__.aDq;\nvar __webpack_exports__has_postupdate = __webpack_exports__.jIg;\nvar __webpack_exports__has_preupdate = __webpack_exports__.UH3;\nvar __webpack_exports__isAddedComponent = __webpack_exports__.K6X;\nvar __webpack_exports__isComponentCtor = __webpack_exports__.C1Y;\nvar __webpack_exports__isLoaderConstructor = __webpack_exports__.Aw1;\nvar __webpack_exports__isRemovedComponent = __webpack_exports__.A8$;\nvar __webpack_exports__isSceneConstructor = __webpack_exports__.hsx;\nvar __webpack_exports__isScreenElement = __webpack_exports__.l9E;\nvar __webpack_exports__isSystemConstructor = __webpack_exports__.aSf;\nvar __webpack_exports__maxMessages = __webpack_exports__.Zex;\nvar __webpack_exports__obsolete = __webpack_exports__.mXP;\nvar __webpack_exports__parseImageFiltering = __webpack_exports__.vt$;\nvar __webpack_exports__parseImageWrapping = __webpack_exports__.hCA;\nvar __webpack_exports__pixelSnapEpsilon = __webpack_exports__.pjR;\nvar __webpack_exports__randomInRange = __webpack_exports__.U43;\nvar __webpack_exports__randomIntInRange = __webpack_exports__.pSZ;\nvar __webpack_exports__range = __webpack_exports__.y17;\nvar __webpack_exports__resetObsoleteCounter = __webpack_exports__.jVr;\nvar __webpack_exports__sign = __webpack_exports__._SZ;\nvar __webpack_exports__toDegrees = __webpack_exports__.xWn;\nvar __webpack_exports__toRadians = __webpack_exports__.ehJ;\nvar __webpack_exports__vec = __webpack_exports__.t6s;\nvar __webpack_exports__webgl = __webpack_exports__.Eyn;\nexport { __webpack_exports__ActionCompleteEvent as ActionCompleteEvent, __webpack_exports__ActionContext as ActionContext, __webpack_exports__ActionQueue as ActionQueue, __webpack_exports__ActionSequence as ActionSequence, __webpack_exports__ActionStartEvent as ActionStartEvent, __webpack_exports__ActionsComponent as ActionsComponent, __webpack_exports__ActionsSystem as ActionsSystem, __webpack_exports__ActivateEvent as ActivateEvent, __webpack_exports__Actor as Actor, __webpack_exports__AddedComponent as AddedComponent, __webpack_exports__AffineMatrix as AffineMatrix, __webpack_exports__Animation as Animation, __webpack_exports__AnimationDirection as AnimationDirection, __webpack_exports__AnimationEvents as AnimationEvents, __webpack_exports__AnimationStrategy as AnimationStrategy, __webpack_exports__ArcadeSolver as ArcadeSolver, __webpack_exports__AudioContextFactory as AudioContextFactory, __webpack_exports__Axes as Axes, __webpack_exports__Axis as Axis, __webpack_exports__BaseAlign as BaseAlign, __webpack_exports__Blink as Blink, __webpack_exports__BodyComponent as BodyComponent, __webpack_exports__BoundingBox as BoundingBox, __webpack_exports__BroadphaseStrategy as BroadphaseStrategy, __webpack_exports__BrowserComponent as BrowserComponent, __webpack_exports__BrowserEvents as BrowserEvents, __webpack_exports__Buttons as Buttons, __webpack_exports__Camera as Camera, __webpack_exports__CameraEvents as CameraEvents, __webpack_exports__Canvas as Canvas, __webpack_exports__Circle as Circle, __webpack_exports__CircleCollider as CircleCollider, __webpack_exports__Clock as Clock, __webpack_exports__ClosestLine as ClosestLine, __webpack_exports__ClosestLineJumpTable as ClosestLineJumpTable, __webpack_exports__Collider as Collider, __webpack_exports__ColliderComponent as ColliderComponent, __webpack_exports__CollisionContact as CollisionContact, __webpack_exports__CollisionEndEvent as CollisionEndEvent, __webpack_exports__CollisionGroup as CollisionGroup, __webpack_exports__CollisionGroupManager as CollisionGroupManager, __webpack_exports__CollisionJumpTable as CollisionJumpTable, __webpack_exports__CollisionPostSolveEvent as CollisionPostSolveEvent, __webpack_exports__CollisionPreSolveEvent as CollisionPreSolveEvent, __webpack_exports__CollisionStartEvent as CollisionStartEvent, __webpack_exports__CollisionSystem as CollisionSystem, __webpack_exports__CollisionType as CollisionType, __webpack_exports__Color as Color, __webpack_exports__ColorBlindFlags as ColorBlindFlags, __webpack_exports__ColorBlindnessMode as ColorBlindnessMode, __webpack_exports__ColorBlindnessPostProcessor as ColorBlindnessPostProcessor, __webpack_exports__Component as Component, __webpack_exports__CompositeCollider as CompositeCollider, __webpack_exports__Configurable as Configurable, __webpack_exports__ConsoleAppender as ConsoleAppender, __webpack_exports__ContactConstraintPoint as ContactConstraintPoint, __webpack_exports__ContactEndEvent as ContactEndEvent, __webpack_exports__ContactSolveBias as ContactSolveBias, __webpack_exports__ContactStartEvent as ContactStartEvent, __webpack_exports__CoordPlane as CoordPlane, __webpack_exports__CrossFade as CrossFade, __webpack_exports__DeactivateEvent as DeactivateEvent, __webpack_exports__Debug as Debug, __webpack_exports__DebugConfig as DebugConfig, __webpack_exports__DebugGraphicsComponent as DebugGraphicsComponent, __webpack_exports__DebugSystem as DebugSystem, __webpack_exports__DebugText as DebugText, __webpack_exports__DefaultAntialiasOptions as DefaultAntialiasOptions, __webpack_exports__DefaultLoader as DefaultLoader, __webpack_exports__DefaultPhysicsConfig as DefaultPhysicsConfig, __webpack_exports__DefaultPixelArtOptions as DefaultPixelArtOptions, __webpack_exports__DegreeOfFreedom as DegreeOfFreedom, __webpack_exports__Delay as Delay, __webpack_exports__DeprecatedStaticToConfig as DeprecatedStaticToConfig, __webpack_exports__Detector as Detector, __webpack_exports__Die as Die, __webpack_exports__Direction as Direction, __webpack_exports__Director as Director, __webpack_exports__DirectorEvents as DirectorEvents, __webpack_exports__DisplayMode as DisplayMode, __webpack_exports__DynamicTree as DynamicTree, __webpack_exports__DynamicTreeCollisionProcessor as DynamicTreeCollisionProcessor, __webpack_exports__EX_VERSION as EX_VERSION, __webpack_exports__EaseBy as EaseBy, __webpack_exports__EaseTo as EaseTo, __webpack_exports__EasingFunctions as EasingFunctions, __webpack_exports__EdgeCollider as EdgeCollider, __webpack_exports__ElasticToActorStrategy as ElasticToActorStrategy, __webpack_exports__EmitterType as EmitterType, __webpack_exports__Engine as Engine, __webpack_exports__EngineEvents as EngineEvents, __webpack_exports__EnterTriggerEvent as EnterTriggerEvent, __webpack_exports__EnterViewPortEvent as EnterViewPortEvent, __webpack_exports__Entity as Entity, __webpack_exports__EntityEvents as EntityEvents, __webpack_exports__EntityManager as EntityManager, __webpack_exports__EventDispatcher as EventDispatcher, __webpack_exports__EventEmitter as EventEmitter, __webpack_exports__EventTypes as EventTypes, __webpack_exports__Events as Events, __webpack_exports__ExResponse as ExResponse, __webpack_exports__ExcaliburGraphicsContext2DCanvas as ExcaliburGraphicsContext2DCanvas, __webpack_exports__ExcaliburGraphicsContextWebGL as ExcaliburGraphicsContextWebGL, __webpack_exports__ExitTriggerEvent as ExitTriggerEvent, __webpack_exports__ExitViewPortEvent as ExitViewPortEvent, __webpack_exports__Fade as Fade, __webpack_exports__FadeInOut as FadeInOut, __webpack_exports__Flags as Flags, __webpack_exports__Follow as Follow, __webpack_exports__Font as Font, __webpack_exports__FontCache as FontCache, __webpack_exports__FontSource as FontSource, __webpack_exports__FontStyle as FontStyle, __webpack_exports__FontUnit as FontUnit, __webpack_exports__FpsSampler as FpsSampler, __webpack_exports__FrameStats as FrameStats, __webpack_exports__Future as Future, __webpack_exports__GameEvent as GameEvent, __webpack_exports__GameStartEvent as GameStartEvent, __webpack_exports__GameStopEvent as GameStopEvent, __webpack_exports__Gamepad as Gamepad, __webpack_exports__GamepadAxisEvent as GamepadAxisEvent, __webpack_exports__GamepadButtonEvent as GamepadButtonEvent, __webpack_exports__GamepadConnectEvent as GamepadConnectEvent, __webpack_exports__GamepadDisconnectEvent as GamepadDisconnectEvent, __webpack_exports__Gamepads as Gamepads, __webpack_exports__Gif as Gif, __webpack_exports__GlobalCoordinates as GlobalCoordinates, __webpack_exports__Graphic as Graphic, __webpack_exports__GraphicsComponent as GraphicsComponent, __webpack_exports__GraphicsGroup as GraphicsGroup, __webpack_exports__GraphicsSystem as GraphicsSystem, __webpack_exports__HiddenEvent as HiddenEvent, __webpack_exports__HorizontalFirst as HorizontalFirst, __webpack_exports__ImageFiltering as ImageFiltering, __webpack_exports__ImageSource as ImageSource, __webpack_exports__ImageSourceAttributeConstants as ImageSourceAttributeConstants, __webpack_exports__ImageWrapping as ImageWrapping, __webpack_exports__InitializeEvent as InitializeEvent, __webpack_exports__Input as Input, __webpack_exports__InputHost as InputHost, __webpack_exports__InputMapper as InputMapper, __webpack_exports__Integrator as Integrator, __webpack_exports__IsometricEntityComponent as IsometricEntityComponent, __webpack_exports__IsometricEntitySystem as IsometricEntitySystem, __webpack_exports__IsometricMap as IsometricMap, __webpack_exports__IsometricTile as IsometricTile, __webpack_exports__KeyEvent as KeyEvent, __webpack_exports__Keyboard as Keyboard, __webpack_exports__Keys as Keys, __webpack_exports__KillEvent as KillEvent, __webpack_exports__Label as Label, __webpack_exports__LimitCameraBoundsStrategy as LimitCameraBoundsStrategy, __webpack_exports__Line as Line, __webpack_exports__LineSegment as LineSegment, __webpack_exports__Loader as Loader, __webpack_exports__LoaderEvents as LoaderEvents, __webpack_exports__LockCameraToActorAxisStrategy as LockCameraToActorAxisStrategy, __webpack_exports__LockCameraToActorStrategy as LockCameraToActorStrategy, __webpack_exports__LogLevel as LogLevel, __webpack_exports__Logger as Logger, __webpack_exports__Material as Material, __webpack_exports__Matrix as Matrix, __webpack_exports__MatrixLocations as MatrixLocations, __webpack_exports__MediaEvent as MediaEvent, __webpack_exports__Meet as Meet, __webpack_exports__MotionComponent as MotionComponent, __webpack_exports__MotionSystem as MotionSystem, __webpack_exports__MoveBy as MoveBy, __webpack_exports__MoveTo as MoveTo, __webpack_exports__NativePointerButton as NativePointerButton, __webpack_exports__NativeSoundEvent as NativeSoundEvent, __webpack_exports__NativeSoundProcessedEvent as NativeSoundProcessedEvent, __webpack_exports__None as None, __webpack_exports__Observable as Observable, __webpack_exports__OffscreenSystem as OffscreenSystem, __webpack_exports__Pair as Pair, __webpack_exports__ParallaxComponent as ParallaxComponent, __webpack_exports__ParallelActions as ParallelActions, __webpack_exports__ParseGif as ParseGif, __webpack_exports__Particle as Particle, __webpack_exports__ParticleEmitter as ParticleEmitter, __webpack_exports__ParticleTransform as ParticleTransform, __webpack_exports__Physics as Physics, __webpack_exports__PhysicsStats as PhysicsStats, __webpack_exports__PhysicsWorld as PhysicsWorld, __webpack_exports__PointerAbstraction as PointerAbstraction, __webpack_exports__PointerButton as PointerButton, __webpack_exports__PointerComponent as PointerComponent, __webpack_exports__PointerEvent as PointerEvent, __webpack_exports__PointerEventReceiver as PointerEventReceiver, __webpack_exports__PointerScope as PointerScope, __webpack_exports__PointerSystem as PointerSystem, __webpack_exports__PointerType as PointerType, __webpack_exports__Polygon as Polygon, __webpack_exports__PolygonCollider as PolygonCollider, __webpack_exports__Pool as Pool, __webpack_exports__PostCollisionEvent as PostCollisionEvent, __webpack_exports__PostDebugDrawEvent as PostDebugDrawEvent, __webpack_exports__PostDrawEvent as PostDrawEvent, __webpack_exports__PostFrameEvent as PostFrameEvent, __webpack_exports__PostKillEvent as PostKillEvent, __webpack_exports__PostTransformDrawEvent as PostTransformDrawEvent, __webpack_exports__PostUpdateEvent as PostUpdateEvent, __webpack_exports__PreCollisionEvent as PreCollisionEvent, __webpack_exports__PreDebugDrawEvent as PreDebugDrawEvent, __webpack_exports__PreDrawEvent as PreDrawEvent, __webpack_exports__PreFrameEvent as PreFrameEvent, __webpack_exports__PreKillEvent as PreKillEvent, __webpack_exports__PreLoadEvent as PreLoadEvent, __webpack_exports__PreTransformDrawEvent as PreTransformDrawEvent, __webpack_exports__PreUpdateEvent as PreUpdateEvent, __webpack_exports__Projection as Projection, __webpack_exports__QuadIndexBuffer as QuadIndexBuffer, __webpack_exports__QuadTree as QuadTree, __webpack_exports__Query as Query, __webpack_exports__QueryManager as QueryManager, __webpack_exports__RadiusAroundActorStrategy as RadiusAroundActorStrategy, __webpack_exports__Random as Random, __webpack_exports__Raster as Raster, __webpack_exports__Ray as Ray, __webpack_exports__RealisticSolver as RealisticSolver, __webpack_exports__Rectangle as Rectangle, __webpack_exports__RemovedComponent as RemovedComponent, __webpack_exports__Repeat as Repeat, __webpack_exports__RepeatForever as RepeatForever, __webpack_exports__Resolution as Resolution, __webpack_exports__Resource as Resource, __webpack_exports__ResourceEvents as ResourceEvents, __webpack_exports__RotateBy as RotateBy, __webpack_exports__RotateTo as RotateTo, __webpack_exports__RotationType as RotationType, __webpack_exports__ScaleBy as ScaleBy, __webpack_exports__ScaleTo as ScaleTo, __webpack_exports__Scene as Scene, __webpack_exports__SceneEvents as SceneEvents, __webpack_exports__Screen as Screen, __webpack_exports__ScreenAppender as ScreenAppender, __webpack_exports__ScreenElement as ScreenElement, __webpack_exports__ScreenEvents as ScreenEvents, __webpack_exports__ScreenShader as ScreenShader, __webpack_exports__ScrollPreventionMode as ScrollPreventionMode, __webpack_exports__Semaphore as Semaphore, __webpack_exports__Shader as Shader, __webpack_exports__Shape as Shape, __webpack_exports__Side as Side, __webpack_exports__SolverStrategy as SolverStrategy, __webpack_exports__Sound as Sound, __webpack_exports__SoundEvents as SoundEvents, __webpack_exports__Sprite as Sprite, __webpack_exports__SpriteFont as SpriteFont, __webpack_exports__SpriteSheet as SpriteSheet, __webpack_exports__StandardClock as StandardClock, __webpack_exports__StateMachine as StateMachine, __webpack_exports__StrategyContainer as StrategyContainer, __webpack_exports__Stream as Stream, __webpack_exports__System as System, __webpack_exports__SystemManager as SystemManager, __webpack_exports__SystemPriority as SystemPriority, __webpack_exports__SystemType as SystemType, __webpack_exports__TagQuery as TagQuery, __webpack_exports__TestClock as TestClock, __webpack_exports__Text as Text, __webpack_exports__TextAlign as TextAlign, __webpack_exports__TextureLoader as TextureLoader, __webpack_exports__Tile as Tile, __webpack_exports__TileMap as TileMap, __webpack_exports__TileMapEvents as TileMapEvents, __webpack_exports__Timer as Timer, __webpack_exports__Toaster as Toaster, __webpack_exports__Transform as Transform, __webpack_exports__TransformComponent as TransformComponent, __webpack_exports__Transition as Transition, __webpack_exports__TreeNode as TreeNode, __webpack_exports__Trigger as Trigger, __webpack_exports__TriggerEvents as TriggerEvents, __webpack_exports__TwoPI as TwoPI, __webpack_exports__Util as Util, __webpack_exports__Vector as Vector, __webpack_exports__VectorView as VectorView, __webpack_exports__VertexBuffer as VertexBuffer, __webpack_exports__VertexLayout as VertexLayout, __webpack_exports__VerticalFirst as VerticalFirst, __webpack_exports__VisibleEvent as VisibleEvent, __webpack_exports__WebAudio as WebAudio, __webpack_exports__WebAudioInstance as WebAudioInstance, __webpack_exports__WheelDeltaMode as WheelDeltaMode, __webpack_exports__WheelEvent as WheelEvent, __webpack_exports__World as World, __webpack_exports__canonicalizeAngle as canonicalizeAngle, __webpack_exports__clamp as clamp, __webpack_exports__coroutine as coroutine, __webpack_exports__createId as createId, __webpack_exports__frac as frac, __webpack_exports__hasGraphicsTick as hasGraphicsTick, __webpack_exports__hasOnInitialize as hasOnInitialize, __webpack_exports__hasOnPostUpdate as hasOnPostUpdate, __webpack_exports__hasOnPreUpdate as hasOnPreUpdate, __webpack_exports__hasPostDraw as hasPostDraw, __webpack_exports__hasPreDraw as hasPreDraw, __webpack_exports__has_initialize as has_initialize, __webpack_exports__has_postupdate as has_postupdate, __webpack_exports__has_preupdate as has_preupdate, __webpack_exports__isAddedComponent as isAddedComponent, __webpack_exports__isComponentCtor as isComponentCtor, __webpack_exports__isLoaderConstructor as isLoaderConstructor, __webpack_exports__isRemovedComponent as isRemovedComponent, __webpack_exports__isSceneConstructor as isSceneConstructor, __webpack_exports__isScreenElement as isScreenElement, __webpack_exports__isSystemConstructor as isSystemConstructor, __webpack_exports__maxMessages as maxMessages, __webpack_exports__obsolete as obsolete, __webpack_exports__parseImageFiltering as parseImageFiltering, __webpack_exports__parseImageWrapping as parseImageWrapping, __webpack_exports__pixelSnapEpsilon as pixelSnapEpsilon, __webpack_exports__randomInRange as randomInRange, __webpack_exports__randomIntInRange as randomIntInRange, __webpack_exports__range as range, __webpack_exports__resetObsoleteCounter as resetObsoleteCounter, __webpack_exports__sign as sign, __webpack_exports__toDegrees as toDegrees, __webpack_exports__toRadians as toRadians, __webpack_exports__vec as vec, __webpack_exports__webgl as webgl };\n\n//# sourceMappingURL=excalibur.js.map"],"names":["__webpack_modules__","module","d","A","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default","n","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__","___CSS_LOADER_EXPORT___","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default","push","id","__WEBPACK_DEFAULT_EXPORT__","exports","cssWithMappingToString","list","toString","this","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","__unused_webpack_exports","entryUnbind","path","Object","keys","isCallable","tryToString","$TypeError","TypeError","argument","isObject","$String","String","toIndexedObject","toAbsoluteIndex","lengthOfArrayLike","createMethod","IS_INCLUDES","$this","el","fromIndex","O","value","index","includes","indexOf","fails","METHOD_NAME","method","call","uncurryThis","slice","arraySlice","floor","Math","sort","array","comparefn","element","j","middle","left","right","llength","rlength","lindex","rindex","stringSlice","it","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","$Object","CORRECT_ARGUMENTS","arguments","tag","result","key","error","tryGet","callee","hasOwn","ownKeys","getOwnPropertyDescriptorModule","definePropertyModule","target","source","exceptions","defineProperty","f","getOwnPropertyDescriptor","DESCRIPTORS","createPropertyDescriptor","object","bitmap","enumerable","configurable","writable","makeBuiltIn","defineGlobalProperty","options","simple","name","global","unsafe","nonConfigurable","nonWritable","P","get","document","EXISTS","createElement","firefox","match","UA","test","navigator","userAgent","version","process","Deno","versions","v8","split","webkit","CONSTRUCTOR","METHOD","prototype","createNonEnumerableProperty","defineBuiltIn","copyConstructorProperties","isForced","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","dontCallGetSet","forced","sham","exec","bind","hasOwnProperty","NATIVE_BIND","Function","apply","FunctionPrototype","getDescriptor","PROPER","CONFIGURABLE","uncurryThisWithBind","fn","namespace","aCallable","isNullOrUndefined","V","func","check","globalThis","window","self","g","toObject","a","classof","propertyIsEnumerable","store","functionToString","inspectSource","set","has","NATIVE_WEAK_MAP","shared","sharedKey","hiddenKeys","OBJECT_ALREADY_INITIALIZED","WeakMap","state","metadata","facade","STATE","enforce","getterFor","TYPE","type","documentAll","all","replacement","feature","detection","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","getBuiltIn","isPrototypeOf","USE_SYMBOL_AS_UID","$Symbol","toLength","obj","CONFIGURABLE_FUNCTION_NAME","InternalStateModule","enforceInternalState","getInternalState","CONFIGURABLE_LENGTH","TEMPLATE","getter","setter","arity","constructor","ceil","trunc","x","__unused_webpack_module","IE8_DOM_DEFINE","V8_PROTOTYPE_DEFINE_BUG","anObject","toPropertyKey","$defineProperty","$getOwnPropertyDescriptor","ENUMERABLE","WRITABLE","Attributes","current","propertyIsEnumerableModule","internalObjectKeys","getOwnPropertyNames","getOwnPropertySymbols","names","enumBugKeys","$propertyIsEnumerable","NASHORN_BUG","input","pref","val","valueOf","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","uid","IS_PURE","SHARED","mode","copyright","license","V8_VERSION","symbol","Symbol","toIntegerOrInfinity","max","min","integer","IndexedObject","requireObjectCoercible","number","len","isSymbol","getMethod","ordinaryToPrimitive","TO_PRIMITIVE","exoticToPrim","toPrimitive","postfix","random","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","createWellKnownSymbol","withoutSetter","$","deletePropertyOrThrow","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","nativeSort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","fromCharCode","v","b","charAt","proto","itemsLength","items","arrayLength","y","getSortCompare","nativeKeys","__webpack_module_cache__","moduleId","cachedModule","__esModule","definition","o","e","prop","r","toStringTag","eKr","yVm","a7j","U_w","JF2","htg","HXL","mcg","Agj","u6S","x7M","X55","m3M","aE5","YJU","eZi","GNv","Y56","_0v","vhs","Z8b","Yfw","IcQ","Rl2","kgJ","GTT","ypY","i7d","fQ3","HlI","jlt","VQc","zD7","I0I","AUF","JoF","MlA","PZh","qA","CrD","dQK","D3r","Qpo","D9n","b6v","mvh","Bpo","Q1f","IKv","fcV","Glf","uAl","ElT","MPu","Z8r","QSL","sPV","nAn","zCU","QrV","fF9","xI8","yar","SP7","oRy","f5X","V1c","Mlx","ZCo","Vy3","J5p","mL_","Guw","VKx","N5j","pgY","OP3","rl5","eod","q5Z","YUC","saR","hvr","Qol","Wf4","JCs","gJV","fWD","Va_","N$8","_jQ","rxj","rhv","wCu","HAp","Zy1","Qev","bkB","wfL","sVA","$Gs","CJ0","NWh","tWi","xAj","zWh","i_4","iIx","c9e","KQV","weH","jXp","zzY","yRQ","MtE","rPj","KLc","Fir","V5f","Xj7","Wud","FVg","g5Y","YQB","KPb","nHK","TX_","r3n","vYh","hnk","D2R","n1o","RLG","fBU","Adb","bEs","wCy","CbD","x_C","pde","pGf","ibQ","QlN","shR","Yjk","_u1","OBI","klh","s3S","D$R","xth","JU7","h9x","N1A","e_k","aHM","tlv","Vi9","ieR","$bb","VyI","imn","uqu","QnL","vnc","wk_","GH0","_1r","l0X","HHX","tjk","rWe","j9l","NVp","cPK","XoL","RmF","DXI","tCD","oGn","J3D","vCJ","f9l","AQx","v9m","yRJ","EU6","m3O","Ryz","OxP","LEs","Ec","Pi5","gmH","tS","XxX","bCz","nYS","yiT","NHl","mO8","PXI","bn5","Ywr","cMd","Bs6","G0k","pyn","QeM","aPX","ITP","BY0","MFw","sBn","S3L","XKQ","ESI","uxz","o8N","u_r","RlV","gVA","M_G","GRB","kM6","dO8","jgM","FWq","s3j","hlw","B7e","H_X","S_d","U7E","Z58","yh2","ff$","cWi","NBt","oNz","QlU","Xey","jft","Mtr","ypk","mnM","bAZ","ABN","VK6","kxk","DT1","FLG","qN_","Z37","FtL","Z6X","iQT","ziO","OEF","uuE","tiv","T$Y","EYj","nOB","Tap","FAs","B_P","aA5","M4G","l$l","dLy","WZP","eB6","nFK","l9z","YOF","yhB","J0N","Miz","Bj4","Rcs","vJ4","TqC","nM0","X1u","SpZ","DX8","Yx$","HK4","SE$","qE8","Pz7","sX_","JuI","Nl$","OwT","P$G","mHV","Fx_","WFC","aDq","jIg","UH3","K6X","C1Y","Aw1","A8$","hsx","l9E","aSf","Zex","mXP","vt$","hCA","pjR","U43","pSZ","y17","jVr","_SZ","xWn","ehJ","t6s","Eyn","webgl_util_namespaceObject","getAttributeComponentSize","getAttributePointerType","getGLTypeFromSource","getGlTypeSizeBytes","isAttributeInSource","Events_namespaceObject","ActionCompleteEvent","ActionStartEvent","ActivateEvent","CollisionEndEvent","CollisionPostSolveEvent","CollisionPreSolveEvent","CollisionStartEvent","ContactEndEvent","ContactStartEvent","DeactivateEvent","EnterTriggerEvent","EnterViewPortEvent","EventTypes","ExitTriggerEvent","ExitViewPortEvent","GameEvent","GameStartEvent","GameStopEvent","GamepadAxisEvent","GamepadButtonEvent","GamepadConnectEvent","GamepadDisconnectEvent","HiddenEvent","InitializeEvent","KillEvent","PostCollisionEvent","PostDebugDrawEvent","PostDrawEvent","PostFrameEvent","PostKillEvent","PostTransformDrawEvent","PostUpdateEvent","PreCollisionEvent","PreDebugDrawEvent","PreDrawEvent","PreFrameEvent","PreKillEvent","PreTransformDrawEvent","PreUpdateEvent","VisibleEvent","DrawUtil_namespaceObject","circle","line","point","roundRect","vector","Input_Index_namespaceObject","Axes","Buttons","Gamepad","Gamepads","KeyEvent","Keyboard","Keys","NativePointerButton","PointerButton","PointerComponent","PointerEvent","PointerEventReceiver","PointerScope","PointerSystem","PointerType","WheelDeltaMode","WheelEvent","Util_Index_namespaceObject","ConsoleAppender","DrawUtil","EasingFunctions","LogLevel","Logger","Observable","ScreenAppender","addItemToArray","contains","delay","fail","getPosition","omit","removeItemFromArray","polyfill","audioContext","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setInterval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","AudioContext","webkitAudioContext","replaceMe","decodeAudioData","arrayBuffer","Promise","resolve","reject","mozAudioContext","msAudioContext","oAudioContext","devicePixelRatio","Flags","useCanvasGraphicsContext","enable","freeze","_FROZEN","_reset","_FLAGS","flagName","Error","disable","isEnabled","show","createId","Future","_isCompleted","promise","_resolver","_rejecter","isCompleted","EventEmitter","_paused","_listeners","_listenersOnce","_pipes","clear","on","eventName","handler","_a","close","off","once","_b","newListeners","filter","h","newOnceListeners","emit","event","forEach","onces","pipe","emitter","splice","unpipe","pause","unpause","BITMASK32","Random","seed","_lowerMask","_upperMask","_w","_n","_m","_u","_s","_t","_c","_l","_f","_mt","Array","Date","now","s","_index","_twist","mag01","nextInt","next","floating","bool","likelihood","pickOne","pickSet","numPicks","allowDuplicates","_pickSetWithDuplicates","_pickSetWithoutDuplicates","currentPick","tempArray","shuffle","swap","randomIndex","range","d4","d6","d8","d10","d12","d20","TwoPI","PI","frac","sign","clamp","canonicalizeAngle","angle","tmpAngle","toDegrees","radians","toRadians","degrees","from","to","_x","randomInRange","randomIntInRange","round","Vector","Zero","One","Half","Up","Down","Left","Right","fromAngle","cos","sin","isValid","vec","isNaN","Infinity","distance","vec1","vec2","sqrt","pow","_y","setTo","equals","tolerance","EQUALS_EPSILON","abs","deltaX","deltaY","squareDistance","clampMagnitude","magnitude","newSize","size","newLength","scale","average","add","sizeOrScale","dest","sub","addEqual","subEqual","scaleEqual","dot","cross","num","perpendicular","normal","negate","toAngle","atan2","rotate","anchor","sinAngle","cosAngle","clone","fixed","toFixed","Color","fromRGB","fromRGBString","parseInt","parseFloat","fromHex","hex","fromHSL","l","HSLColor","toRGBA","lighten","factor","temp","fromRGBA","darken","saturate","desaturate","multiply","color","newR","newG","newB","newA","screen","color1","invert","color2","equal","format","toHSLA","toHex","_componentToHex","c","hexRepresentation","fillStyle","Black","White","Gray","LightGray","DarkGray","Yellow","Orange","Red","Vermilion","Rose","Magenta","Violet","Blue","Azure","Cyan","Viridian","Green","Chartreuse","Transparent","ExcaliburBlue","hue2rgb","p","q","t","Side","MatrixLocations","_appenders","defaultLevel","Info","_logOnceSet","Set","_INSTANCE","addAppender","getInstance","appender","clearAppenders","_log","level","args","log","_logOnce","serialized","debug","Debug","debugOnce","info","infoOnce","warn","Warn","warnOnce","errorOnce","fatal","Fatal","fatalOnce","console","consoleArgs","unshift","_messages","_pos","_color","_options","canvas","_ctx","getContext","style","position","zIndex","body","appendChild","_positionScreenAppenderCanvas","engine","events","_d","width","resolution","height","pagePos","screenToPageCoordinates","top","xPos","message","clearRect","pos","fillText","getOpposite","side","Top","Bottom","None","fromDirection","direction","directions","directionEnum","Number","MAX_VALUE","maxIndex","BoundingBox","leftOrOptions","bottom","_points","getSideFromIntersection","intersection","fromPoints","points","minX","minY","maxX","maxY","fromDimension","hasZeroDimensions","center","topLeft","bottomRight","topRight","bottomLeft","translate","getPoints","shifted","transform","matrix","xa1","xa2","xb1","xb2","ya1","ya2","yb1","yb2","matrixPos","getPerimeter","_left","_right","_top","_bottom","rayCast","ray","farClipDistance","tmin","tmax","xinv","dir","yinv","tx1","tx2","ty1","ty2","rayCastTime","combine","other","dimensions","overlaps","epsilon","totalBoundingBox","intersect","overlapX","overlapY","intersectWithSide","bb","draw","ex","drawRect","rect","getBoundingClientRect","scrollX","scrollY","milliseconds","clock","future","schedule","setTimeout","newObj","Matrix","Float32Array","_scaleX","_scaleSignX","_scaleY","_scaleSignY","ortho","near","far","mat","toDOMMatrix","DOMMatrix","fromFloat32Array","identity","reset","translation","sx","sy","rotation","angleRadians","vectorOrMatrix","resultX","resultY","a11","a21","a31","a41","a12","a22","a32","a42","a13","a23","a33","a43","a14","a24","a34","a44","b11","b21","b31","b41","b12","b22","b32","b42","b13","b23","b33","b43","b14","b24","b34","b44","getScale","setPosition","sine","cosine","setRotation","currentScale","getRotation","getScaleY","getScaleX","xscale","yscale","setScaleX","setScaleY","setScale","getBasisDeterminant","getAffineInverse","inverseDet","m","tx","ty","isIdentity","AffineMatrix","Float64Array","_scale","determinant","inverse","multiplyQuadInPlace","quad","resultTopLeftX","resultTopLeftY","resultTopRightX","resultTopRightY","resultBottomLeftX","resultBottomLeftY","resultBottomRightX","resultBottomRightY","to4x4","TransformStack","_transforms","_currentTransform","save","restore","pop","StateStack","_getDefaultState","_states","opacity","z","tint","material","_cloneState","ResourceEvents","Complete","Load","LoadStart","Progress","Resource","responseType","bustCache","logger","isLoaded","_cacheBust","uri","load","request","XMLHttpRequest","open","addEventListener","status","response","statusText","send","watch","change","__isProxy","Proxy","createHandler","typeType","watchAny","Graphic","isStale","_transformStale","flipHorizontal","_flipHorizontal","flipVertical","_flipVertical","_rotation","origin","_origin","_e","_g","_ID","showDebug","_width","_height","cloneGraphicOptions","localBounds","_preDraw","_drawImage","_postDraw","_rotate","_flip","scaleDirX","scaleDirY","Sprite","image","super","_logger","_dirty","sourceView","destSize","_updateSpriteDimensions","ready","then","newWidth","newHeight","nativeWidth","nativeHeight","drawImage","ImageFiltering","ImageWrapping","parseImageFiltering","Pixel","Blended","parseImageWrapping","Clamp","Repeat","Mirror","TextureLoader","gl","_textureMap","Map","_gl","_MAX_TEXTURE_SIZE","getParameter","MAX_TEXTURE_SIZE","dispose","delete","forceUpdate","filtering","wrapping","wrappingConfig","tex","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","createTexture","checkImageSizeSupportedAndLog","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","xWrap","yWrap","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT","TEXTURE_WRAP_T","filterMode","TEXTURE_MIN_FILTER","NEAREST","LINEAR","TEXTURE_MAG_FILTER","deleteTexture","originalSrc","dataset","_LOGGER","ImageSourceAttributeConstants","Filtering","WrappingX","WrappingY","ImageSource","naturalWidth","naturalHeight","_src","src","bustCacheOrOptions","Image","_readyFuture","_resource","endsWith","fromHtmlImageElement","imageSource","setAttribute","url","blob","URL","createObjectURL","loadedFuture","onload","toSprite","unload","SpriteFont","_text","alphabet","shadow","caseInsensitive","spacing","lineHeight","spriteSheet","_getCharacterSprites","text","results","textToRender","toLocaleLowerCase","letterIndex","letter","spriteIndex","letterSprite","sprites","measureText","maxWidth","lines","_getLinesFromText","maxWidthLine","reduce","sprite","xCursor","yCursor","render","bounds","offset","_cachedText","_cachedRenderWidth","_cachedLines","newLine","SpriteSheet","rows","columns","getSprite","_h","_j","spriteWithOptions","fromImageSourceWithSourceViews","sourceViews","fromImageSource","grid","cols","spriteWidth","spriteHeight","originOffset","margin","offsetDefaults","marginDefaults","DebugText","fontSheet","_imageSource","_spriteSheet","_spriteFont","write","ctx","RenderSource","_texture","use","activeTexture","TEXTURE0","RenderTarget","antialias","samples","transparency","MAX_SAMPLES","drawingBufferFormat","bufferFormat","RGBA8","RGB8","_setupRenderBuffer","_setupFramebuffer","setResolution","_frameTexture","_renderBuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorageMultisample","renderBuffer","renderFrameBuffer","_renderFrameBuffer","frameBuffer","_frameBuffer","frameTexture","createRenderbuffer","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferRenderbuffer","COLOR_ATTACHMENT0","attachmentPoint","framebufferTexture2D","toRenderSource","blitRenderBufferToFrameBuffer","blitToScreen","READ_FRAMEBUFFER","DRAW_FRAMEBUFFER","clearBufferfv","COLOR","blitFramebuffer","COLOR_BUFFER_BIT","copyToTexture","texture","copyTexImage2D","viewport","FLOAT","SHORT","UNSIGNED_SHORT","BYTE","variable","matches","RegExp","groups","INT","UNSIGNED_INT","BOOL","LOW_FLOAT","HIGH_FLOAT","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","Shader","compiled","_compiled","uniforms","attributes","vertexSource","fragmentSource","deleteProgram","program","useProgram","_ACTIVE_SHADER_INSTANCE","isCurrentlyBound","compile","vertexShader","_compileShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","_createProgram","getAttributes","attribute","getUniforms","uniform","uniformCount","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","uniformLocation","getUniformLocation","glType","location","attributeCount","ACTIVE_ATTRIBUTES","getActiveAttrib","attributeLocation","getAttribLocation","normalized","setTexture","slotNumber","setUniformInt","setUniform","trySetUniformInt","trySetUniform","setUniformIntArray","trySetUniformIntArray","setUniformBoolean","trySetUniformBoolean","setUniformFloat","trySetUniformFloat","setUniformFloatArray","trySetUniformFloatArray","setUniformFloatVector","trySetUniformFloatVector","setUniformFloatColor","trySetUniformFloatColor","setUniformMatrix","trySetUniformMatrix","uniformType","createProgram","attachShader","linkProgram","LINK_STATUS","getProgramInfoLog","typeName","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","errorInfo","getShaderInfoLog","_processSourceForError","errorLineStart","search","errorLineEnd","_","error2","VertexBuffer","buffer","createBuffer","bufferData","bindBuffer","ARRAY_BUFFER","STATIC_DRAW","DYNAMIC_DRAW","unbind","upload","count","bufferSubData","deleteBuffer","VertexLayout","vertexBuffer","_vertexBuffer","_attributes","_suppressWarnings","_layout","_vertexTotalSizeBytes","_initialized","suppressWarnings","_shader","initialize","totalVertexSizeBytes","shaderAttributes","attrib","componentsPerVertex","vertAttribute","typeSize","_vao","createVertexArray","bindVertexArray","vert","vertexAttribPointer","enableVertexAttribArray","uploadBuffer","GraphicsDiagnostics","DrawCallCount","DrawnImagesCount","LineRenderer","priority","_maxLines","_vertexIndex","_lineCount","context","_context","start","end","_isFull","flush","getTransform","finalStart","finalEnd","hasPendingDraws","drawArrays","LINES","PointRenderer","_maxPoints","_pointCount","_buffer","snapToPixel","finalPoint","pixelSnapEpsilon","POINTS","ScreenPassPainter","renderWithPostProcessor","postprocessor","getShader","getLayout","TRIANGLES","renderToScreen","QuadIndexBuffer","numberOfQuads","useUint16","ELEMENT_ARRAY_BUFFER","totalVertices","maxUint16","maxUint16Index","bufferGlType","Uint16Array","Uint32Array","currentQuad","ImageRenderer","_maxImages","_maxTextures","_imageCount","_textures","_textureIndex","_textureToIndex","_images","_imageToWidth","_imageToHeight","_view","_dest","_quad","pixelArtSampler","uvPadding","MAX_TEXTURE_IMAGE_UNITS","transformedFrag","_transformFragmentSource","_quads","maxTextures","newSource","texturePickerBuilder","_addImageAsTexture","maybeFiltering","getAttribute","wrapX","wrapY","force","textureLoader","removeAttribute","_bindTextures","_getTextureIdForImage","maybeTexture","_getImageWidth","maybeWidth","_getImageHeight","maybeHeight","swidth","sheight","dx","dy","dwidth","dheight","maybeImageWidth","maybeImageHeight","sw","sh","textureId","imageWidth","imageHeight","uvx0","uvy0","uvx1","uvy1","txWidth","txHeight","drawElements","RectangleRenderer","_maxRectangles","_rectangleCount","drawLine","drawRectangle","thickness","halfThick","startTop","startBottom","endTop","endBottom","stroke","strokeThickness","CircleRenderer","_maxCircles","_circleCount","radius","Pool","builder","recycler","maxObjects","totalAllocations","objects","disableWarnings","preallocate","using","done","borrow","poolIndex","DrawCall","Material","graphicsContext","images","_name","_vertexSource","_fragmentSource","ExcaliburGraphicsContextWebGL","_graphicsContext","_initialize","addImageSource","graphicsContextWebGL","__gl","_maxTextureSlots","isUsingScreenTexture","update","textureUniformName","removeImageSource","textureName","_loadImageSource","imageElement","uploadAndBind","startingTextureSlot","textureSlot","entries","MaterialRenderer","vertexIndex","view","topLeftScreen","bottomRightScreen","screenUVX0","screenUVY0","screenUVX1","screenUVY1","performance","materialScreenTexture","ExcaliburGraphicsContextWebGLDebug","_webglCtx","_debugText","rectOptions","lineOptions","drawPoint","pointOptions","drawText","_state","_ortho","checkIfResolutionSupported","dim","supported","_renderers","_isDrawLifecycle","useDrawSorting","_drawCallPool","instance","renderer","_drawCallIndex","_drawCalls","fill","_postProcessTargets","_postprocessors","_transform","smoothing","backgroundColor","multiSampleAntialiasing","_isContextLost","_disposed","_totalPostProcessorTime","canvasElement","enableTransparency","antialiasing","powerPreference","handleContextLost","handleContextRestored","premultipliedAlpha","alpha","depth","_init","values","clearColor","BLEND","blendEquation","FUNC_ADD","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","blendEquationSeparate","blendFuncSeparate","register","_screenRenderer","_renderTarget","_msaaTarget","rendererName","_isCurrentRenderer","_currentRenderer","beginDrawLifecycle","endDrawLifecycle","drawCall","resetTransform","updateViewport","trace","drawCircle","addPostProcessor","removePostProcessor","clearPostProcessors","updatePostProcessors","delta","find","u","onUpdate","createMaterial","currentTarget","originalSort","firstIndex","originalSortOrder","oldTransform","oldState","currentRendererName","currentRenderer","ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon","ExcaliburGraphicsContext2DCanvasDebug","_ex","__ctx","strokeStyle","strokeRect","beginPath","moveTo","lineTo","lineWidth","closePath","arc","ExcaliburGraphicsContext2DCanvas","imageSmoothingEnabled","_resolution","globalAlpha","fillRect","setTransform","_postprocessor","DisplayMode","Resolution","SVGA","Standard","Atari2600","GameBoy","GameBoyAdvance","NintendoDS","NES","SNES","ScreenEvents","ScreenResize","PixelRatioChange","FullScreenChange","Screen","_antialiasing","_canvasImageRendering","_resolutionStack","_viewportStack","_pixelRatioOverride","_isFullScreen","_isDisposed","_fullscreenChangeHandler","fullscreen","isFullScreen","_pixelRatioChangeHandler","_listenForPixelRatio","_devicePixelRatio","_calculateDevicePixelRatio","applyResolutionAndViewport","pixelRatio","_resizeHandler","parent","_setResolutionAndViewportByDisplayMode","_contentArea","_unsafeArea","_contentResolution","_displayMode","displayMode","Fixed","_canvas","canvasImageRendering","_browser","browser","_applyDisplayMode","_mediaQueryList","removeListener","nativeComponent","matchMedia","addListener","_resizeObserver","disconnect","removeEventListener","pixelRatioOverride","isHiDpi","FillContainer","FitContainer","FitContainerAndFill","FitContainerAndZoom","parentElement","_viewport","aspectRatio","scaledWidth","scaledHeight","setCurrentCamera","camera","_camera","pushResolutionAndViewport","peekViewport","peekResolution","popResolutionAndViewport","currentPixelRatio","newResolutionSupported","imageRendering","widthUnit","heightUnit","isSmooth","goFullScreen","elementId","maybeElement","getElementById","requestFullscreen","exitFullScreen","exitFullscreen","_viewportToPixels","offsetWidth","offsetHeight","pageToScreenCoordinates","newX","newY","innerWidth","innerHeight","screenHeight","screenWidth","contentArea","screenMarginY","screenMarginX","screenToWorldCoordinates","worldToScreenCoordinates","pageToWorldCoordinates","worldToPageCoordinates","getWorldBounds","zoom","drawPos","getScreenBounds","canvasWidth","halfCanvasWidth","canvasHeight","halfCanvasHeight","drawWidth","halfDrawWidth","drawHeight","halfDrawHeight","unsafeArea","_computeFit","overflow","aspect","adjustedWidth","adjustedHeight","_computeFitScreenAndFill","vw","vh","_computeFitAndFill","_computeFitContainerAndFill","clip","_computeFitScreenAndZoom","_computeFitAndZoom","_computeFitContainerAndZoom","scaleX","scaleY","maxScaleFactor","zoomedWidth","zoomedHeight","_computeFitContainer","clientWidth","clientHeight","Window","ResizeObserver","observe","FillScreen","FitScreen","FitScreenAndFill","FitScreenAndZoom","AudioContextFactory","create","WebAudio","unlock","_UNLOCKED","unlockTimeoutTimer","resume","createBufferSource","ended","connect","destination","onended","playbackState","isLegacyWebAudioSource","currentTime","PLAYING_STATE","FINISHED_STATE","clearTimeout","isUnlocked","Raster","lineCap","quality","_smoothing","flagDirty","_lineWidth","_lineDash","_padding","strokeColor","lineDash","padding","_bitmap","bitmapWidth","bitmapHeight","maybeCtx","cloneRasterOptions","dirty","_getTotalWidth","_originalWidth","_getTotalHeight","_originalHeight","_strokeColor","rasterize","_applyRasterProperties","execute","setLineDash","getLineDash","Canvas","cache","ExResponse","any","json","arraybuffer","StateMachine","states","currentState","_currentState","machineDescription","machine","stateName","transitionState","transitions","startState","go","eventData","potentialNewState","onExit","onEnter","onState","elapsedMs","saveKey","localStorage","setItem","parse","getItem","WebAudioInstance","_createNewBufferSource","_instance","_audioContext","loop","playbackRate","_playbackRate","_volumeNode","_handleEnd","_playingFuture","_loop","volume","_volume","_stateMachine","in","gain","setTargetAtTime","duration","_duration","getTotalPlaybackDuration","createGain","PLAYING","pausedAt","startedAt","_playStarted","stop","SEEK","STOPPED","PAUSED","isPlaying","isPaused","isStopped","play","playStarted","seek","getPlaybackPosition","_bubbles","bubbles","stopPropagation","prevStats","stats","gamepad","button","axis","actor","contact","lastContact","action","MediaEvent","_value","_path","_val","propagate","layPath","_actor","NativeSoundEvent","track","NativeSoundProcessedEvent","_processedData","canPlayFile","file","Audio","filetype","canPlayType","SoundEvents","VolumeChange","Processed","Pause","Stop","PlaybackEnd","Resume","PlaybackStart","Sound","_tracks","instances","paths","_isStopped","_wasPlayingOnHidden","audiobuffer","decodeAudio","wireEngine","_engine","pauseAudioWhenHidden","instanceCount","some","_resumePlayback","_startPlayback","trackId","_getTrackInstance","getTrackId","resumed","complete","newTrack","LoaderEvents","BeforeLoad","AfterLoad","UserAction","LoadResourceStart","LoadResourceEnd","isLoaderConstructor","DefaultLoader","resources","_resources","onDraw","_numLoaded","_totalTimeMs","_loadingFuture","loadables","addResources","onInitialize","onUserAction","onBeforeLoad","onAfterLoad","addResource","loadable","markResourceComplete","progress","total","elapsedMilliseconds","seconds","speed","font","textbox","actualBoundingBoxLeft","actualBoundingBoxRight","actualBoundingBoxAscent","actualBoundingBoxDescent","areResourcesLoaded","async","finally","resource","x1","y1","x2","y2","cap","br","tl","tr","bl","defaultRadius","quadraticCurveTo","Director_Loader","Loader","_image","_imageElement","_imageLoaded","logo","playButtonRootElement","_playButtonRootElement","playButtonElement","_playButtonElement","_playButton","existingRoot","_styleBlock","textContent","_playButtonStyles","head","startButtonFactory","loadablesOrOptions","isArray","_originalOptions","_playButtonShown","logoWidth","logoHeight","loadingBarColor","suppressPlayButton","playButtonText","buttonElement","display","_configuredPixelRatio","_DEFAULT_LOADER_OPTIONS","showPlayButton","resizeHandler","_positionPlayButton","evt","click","playButtonClicked","startButtonHandler","hidePlayButton","fullscreenAfterLoad","fullscreenContainer","HTMLElement","removeChild","decode","buttonWidth","buttonHeight","playButtonPosition","logoY","logoX","logoPosition","oldAntialias","getAntialiasing","setAntialiasing","loadingX","loadingY","loadingBarPosition","progressWidth","REPORTED_FEATURES","webgl","webaudio","gamepadapi","Detector","_features","failedTests","_criticalTests","canvasSupport","elem","arrayBufferSupport","xhr","dataUrlSupport","toDataURL","objectUrlSupport","rgbaSupport","cssText","_warningTest","webAudioSupport","webglSupport","_loadBrowserFeatures","getBrowserFeatures","logBrowserFeatures","msg","dataurl","objecturl","rgba","getGamepads","failedCritical","warning","CollisionType","CoordPlane","SolverStrategy","BroadphaseStrategy","Integrator","ContactSolveBias","VectorView","_getX","getX","_getY","getY","_setX","setX","_setY","setY","WatchVector","original","transform_Transform","_parent","_children","_isDirty","_isInverseDirty","_matrix","_inverse","children","globalPos","localPos","canonRotation","globalRotation","inverseRotation","globalScale","inverseScale","globalScaleX","globalScaleY","_calculateMatrix","applyInverse","isComponentCtor","Component","owner","newComponent","observers","subscriptions","observer","subscribe","unregister","unsubscribe","notifyAll","observersLength","notify","subscriptionsLength","TransformComponent","_parentComponent","_addChildTransform","child","childTxComponent","zIndexChanged$","_z","_coordPlane","World","onAdd","childrenAdded$","childrenRemoved$","onRemove","_previousOwner","oldz","coordPlane","component","MotionComponent","vel","acc","scaleFactor","angularVelocity","torque","inertia","CollisionGroupManager","mask","_CURRENT_GROUP","_MAX_GROUPS","_GROUPS","existingGroup","group","CollisionGroup","_CURRENT_BIT","groupByName","_STARTING_BIT","category","_category","_mask","canCollide","overlap1","overlap2","collisionGroups","combinedName","combinedMask","collidesWith","padStart","All","Pair","colliderA","colliderB","calculatePairHash","bodyA","BodyComponent","bodyB","collisionType","PreventCollision","active","collide","hasCollider","collider","idA","idB","Projection","projection","getOverlap","TreeNode","isLeaf","DynamicTree","_config","worldBounds","root","nodes","_insert","leaf","leafAABB","currentRoot","area","combinedArea","cost","inheritanceCost","leftCost","leftCombined","newArea","oldArea","rightCost","rightCombined","oldParent","newParent","currentNode","_balance","_remove","grandParent","sibling","trackCollider","node","updateCollider","untrackCollider","boundsPadding","multdx","velocityMultiplier","multdy","balance","getHeight","query","helper","rayCastQuery","getNodes","Ray","numerator","begin","getSlope","divisor","getLength","intersectPoint","time","getPoint","DynamicTreeCollisionProcessor","_pairs","_collisionPairCache","_colliders","_dynamicCollisionTree","dynamicTree","getColliders","maxDistance","collisionGroup","collisionMask","searchAllColliders","maybeBody","ignoreCollisionGroupAll","hit","CompositeCollider","colliders","untrack","_pairExists","hash","broadphase","targets","potentialColliders","pair","physics","pairs","continuous","checkForFastBodies","Active","updateDistance","minDimension","disableMinimumSpeedForFastBody","fastBodies","updateVec","oldPos","centerPoint","furthestPoint","getFurthestPoint","minCollider","surfaceEpsilon","minTranslate","shift","fastBodyCollisions","narrowphase","contacts","newContacts","collisions","updated","Collider","composite","touching","Physics","gravity","useArcadePhysics","collisionResolutionStrategy","Arcade","useRealisticPhysics","Realistic","enabled","broadphaseStrategy","DynamicAABBTree","defaultMass","integrator","Euler","dynamicTreeVelocityMultiplier","positionIterations","velocityIterations","slop","steeringFactor","warmStart","bodiesCanSleepByDefault","sleepEpsilon","wakeThreshold","sleepBias","VerticalFirst","HorizontalFirst","DefaultPhysicsConfig","solver","compositeStrategy","bodies","canSleepByDefault","arcade","contactSolveBias","realistic","DeprecatedStaticToConfig","_compositeStrategy","_collisionProcessor","_dynamicAABBTree","addCollider","clearColliders","removeCollider","worldPos","axes","furthestPoints","bestPoint","getInertia","mass","totalInertia","otherColliders","potentialCollider","getClosestLineBetween","maybeLine","minLength","minLine","hits","minHit","minDistance","project","projections","proj","newProjection","LineSegment","slope","intercept","_normal","_dir","_slope","getEdge","_length","midpoint","flip","below","sideVector","clipTime","distanceToPoint","signed","x0","y0","findVectorToPoint","aMinusP","findPoint","hasPoint","currPoint","threshold","dxc","dyc","dx1","dy1","ClosestLine","p0","q0","w0","denom","sDenom","tDenom","tClosestParallel","sClosest","tClosest","ClosestLineJumpTable","PolygonPolygonClosestLine","polygonA","polygonB","otherWorldPos","otherDirection","thisDirection","rayTowardsOther","rayTowardsThis","thisPoint","otherPoint","thisFace","getClosestFace","otherFace","face","PolygonEdgeClosestLine","polygon","edge","edgeLine","asLine","PolygonCircleClosestLine","circlex","circley","CircleCircleClosestLine","circleA","circleB","CircleEdgeClosestLine","circleWorldPos","EdgeEdgeClosestLine","edgeA","edgeB","edgeLineA","edgeLineB","CircleCollider","_globalMatrix","_naturalRadius","orig","discriminant","toi","toi1","toi2","positiveToi","minToi","shape","PolygonCollider","EdgeCollider","CollisionJumpTable","CollideCircleCircle","CollideCirclePolygon","CollideCircleEdge","getFurthestLocalPoint","scalars","dotProduct","CollisionContact","mtv","tangent","localPoints","_canceled","colliderAId","colliderBId","matchAwake","sleeping","sleepMotion","setSleeping","isCanceled","cancel","SeparatingAxis","findPolygonPolygonSeparation","polyA","polyB","bestSeparation","bestSide","bestAxis","bestSideIndex","bestOtherPoint","sides","getSides","localSides","getLocalSides","vertB","vertSeparation","separation","localSide","sideId","localPoint","findCirclePolygonSeparation","polyDir","closestPointOnPoly","minOverlap","minAxis","minIndex","proj1","proj2","overlap","circleAPos","circleBPos","combinedRadius","mvt","local","samedir","findSide","findLocalSide","cc","edgeWorld","asLocalLine","da","dda","db","ddb","den","pointOnEdge","dd","CollideEdgeEdge","CollidePolygonEdge","pc","linePoly","CollidePolygonPolygon","separationA","separationB","incident","reference","refDir","clipRight","clipLeft","xf","FindContactSeparation","shapeA","txA","shapeB","txB","worldPoint","circlePoint","dist","_getTransformedBegin","_getTransformedEnd","transformedBegin","transformedEnd","_boundsFromBeginEnd","edgeNormal","registerGraphicsContext","debugDrawCall","drawLines","drawPolygon","firstPoint","drawBounds","boundingBox","drawRay","_localBoundsDirty","_localSidesDirty","_transformedPointsDirty","_sidesDirty","_transformedPoints","_sides","_localSides","_isCounterClockwiseWinding","reverse","isConvex","suppressConvexWarning","_calculateTransformation","sum","oldPoint","newPoint","oldDirection","orientation","angleSum","tessellate","polygons","Shape","Polygon","triangulate","triangles","vertices","vertexCount","getPrevIndex","getNextIndex","prev","va","vb","vc","leftArm","rightArm","convexVertices","isPointInTriangle","ab","bc","ca","ap","bp","cp","cross1","cross2","cross3","findEarTip","isEar","cutEarTip","getTransformedPoints","currentSide","mostDirection","testRay","accum","pts","POSITIVE_INFINITY","faceIndex","_localBounds","_cachedMass","_cachedInertia","denominator","iplusone","crossTerm","contactSide","minContactTime","contactIndex","contactTime","scalar","Box","Circle","Edge","Capsule","ColliderComponent","$colliderAdded","$colliderRemoved","_collidersToRemove","_collider","processColliderRemoval","flipped","entity","precollision","Actor","onPreCollisionResolve","postcollision","onPostCollisionResolve","onCollisionStart","onCollisionEnd","useBoxCollider","usePolygonCollider","poly","useCircleCollider","useEdgeCollider","useCompositeCollider","DegreeOfFreedom","dependencies","__oldTransformCaptured","enableFixedUpdateInterpolate","_sleeping","bounciness","friction","useGravity","limitDegreeOfFreedom","oldVel","oldAcc","_bodyConfig","config","updatePhysicsConfig","_mass","_DEFAULT_CONFIG","canSleep","updateDefaultPhysicsConfig","newMass","_cachedInverseInertia","inverseMass","updateMotion","currentMotion","bias","maybeCollider","inverseInertia","motion","oldRotation","oldScale","applyImpulse","impulse","finalImpulse","X","Y","Rotation","distanceFromCenter","applyLinearImpulse","applyAngularImpulse","captureOldTransform","AddedComponent","isAddedComponent","RemovedComponent","isRemovedComponent","EntityEvents","Initialize","PreUpdate","PostUpdate","Kill","Entity","componentsOrOptions","componentsToAdd","nameToAdd","_tags","componentAdded$","componentRemoved$","tagAdded$","tagRemoved$","components","_componentsToRemove","_instanceOfComponentCacheDirty","_instanceOfComponentCache","scene","_isInitialized","addComponent","kill","unparent","isKilled","tags","hasTag","addTag","removeTag","types","getComponents","hasAll","requiredTypes","hasAllTags","requiredTags","_getCachedInstanceOfType","maybeComponent","addChild","getAncestors","removeAllChildren","getDescendants","queue","curr","newEntity","componentInstance","addTemplate","templateEntity","removeComponent","ctor","typeOrInstance","componentToRemove","clearComponents","processComponentRemoval","isInitialized","_preupdate","onPreUpdate","_postupdate","onPostUpdate","AnimationDirection","AnimationStrategy","AnimationEvents","Frame","Loop","End","Animation","frames","strategy","frameDuration","_idempotencyToken","_firstTick","_currentFrame","_timeLeftInFrame","_pingPongDirection","_done","_playing","_speed","_reversed","totalDuration","goToFrame","maybeFrame","currentFrame","graphic","fromSpriteSheet","frameIndices","durationPerFrameMs","invalidIndices","fromSpriteSheetCoordinates","frameCoordinates","defaultDuration","coord","currentFrameIndex","currentFrameTimeLeft","Backward","Forward","canFinish","Freeze","frameNumber","frameIndex","_nextFrame","PingPong","tick","idempotencyToken","GraphicsGroup","useAnchor","members","_updateDimensions","member","useBounds","_isAnimationOrGroup","hasGraphicsTick","GraphicsComponent","_offset","recalculateBounds","_anchor","_current","_graphics","visible","copyGraphics","graphics","onPreDraw","onPostDraw","onPreTransformDraw","onPostTransformDraw","graphicOrOptions","getGraphic","getOptions","getNames","currentOptions","nameOrGraphic","optionsToSet","graphicToSet","remove","hide","offsetX","offsetY","elapsed","Rectangle","_radius","useColliderShape","useGraphicsBounds","CreateReversibleEasingFunction","easing","CreateVectorEasingFunction","Linear","startValue","endValue","EaseInQuad","EaseOutQuad","EaseInOutQuad","EaseInCubic","EaseOutCubic","EaseInOutCubic","ActionQueue","_actions","_currentAction","_completedActions","_entity","clearActions","getActions","hasNext","isComplete","repeatBuilder","repeat","_stopped","_repeatBuilder","_repeatContext","ActionContext","_actionQueue","getQueue","_repeat","_originalRepeat","RepeatForever","MoveBy","_started","_tx","_motion","_delta","_start","_end","_distance","MoveTo","destx","desty","RotationType","FontUnit","TextAlign","BaseAlign","FontStyle","Direction","RotateTo","rotationType","_rotationType","ShortestPath","_currentNonCannonAngle","distance1","distance2","_shortDistance","_longDistance","_shortestPathIsPositive","_direction","LongestPath","Clockwise","CounterClockwise","distanceTraveled","RotateBy","angleRadiansOffset","ScaleTo","speedX","speedY","_endX","_endY","_speedX","_speedY","_startX","_startY","_distanceX","_distanceY","directionX","directionY","ScaleBy","scaleOffsetX","scaleOffsetY","_startScale","_endScale","_directionX","_directionY","CallMethod","_method","_hasBeenCalled","EaseTo","easingFcn","_currentLerpTime","_lerpDuration","_lerpStart","_lerpEnd","EaseBy","Blink","timeVisible","timeNotVisible","numBlinks","_timeVisible","_timeNotVisible","_elapsedTime","_totalTime","Fade","endOpacity","_multiplier","_endOpacity","_ogspeed","Delay","_delay","Die","ActionsComponent","Follow","entityToFollow","followDistance","_followTx","_followMotion","_maximumDistance","_distanceBetween","actorToFollowSpeed","Meet","actorToMeet","_speedWasSpecified","_meetTx","_meetMotion","actorToMeetSpeed","_queue","runAction","easeTo","easeBy","xOrPos","yOrSpeed","speedOrUndefined","moveBy","xOffsetOrVector","yOffsetOrSpeed","xOffset","yOffset","rotateTo","rotateBy","scaleTo","sizeXOrVector","sizeYOrSpeed","speedXOrUndefined","speedYOrUndefined","sizeX","sizeY","scaleBy","sizeOffsetXOrVector","sizeOffsetYOrSpeed","sizeOffsetX","sizeOffsetY","blink","fade","die","callMethod","times","repeatForever","follow","meet","toPromise","_getCtx","FontTextInstance","_textFragments","disposed","_setDimension","_lastHashCode","getHashCode","_applyFont","metrics","textHeight","lineAdjustedHeight","bottomBounds","textBounds","lineHeightRatio","fontString","textAlign","baseAlign","includeColor","textBaseline","shadowColor","shadowBlur","blur","shadowOffsetX","shadowOffsetY","_drawText","strokeText","_splitTextBitmap","textImages","currentX","currentY","hashCode","frag","FontCache","_MEASURE_CACHE","measurement","measureTextWithoutCache","getTextInstance","textInstance","_TEXT_CACHE","_TEXT_USAGE","checkAndClearCache","deferred","currentHashCodes","FONT_TIMEOUT","newTextMeasurementCache","cacheSize","clearCache","Font","_o","_p","_q","_r","_v","family","Normal","bold","unit","Px","LeftToRight","_textBounds","_textMeasurement","colorOverride","Text","_textWidth","_textHeight","_calculateDimension","_font","thePos","theVel","theAcc","theAngle","_handleAnchorChange","_handleOffsetChange","isOffScreen","draggable","_draggable","isDraggable","_pointerDragStartHandler","_pointerDragEndHandler","_pointerDragMoveHandler","_pointerDragLeaveHandler","currentGraphic","_dragging","pe","defaults","pointer","actions","Passive","builtInComponents","_prekill","onPreKill","_postkill","onPostKill","unkill","newZ","getGlobalPos","localCenter","getGlobalScale","getGlobalRotation","recurse","geom","containment","within","otherCollider","me","isScreenElement","ScreenElement","useWorld","coords","Timer","_complete","fcn","interval","repeats","numberOfRepeats","randomRange","_totalTimeAlive","_running","_numberOfTicks","maxNumberOfRepeats","_baseInterval","_generateRandomInterval","_MAX_ID","_callbacks","newInterval","newNumberOfRepeats","timesRepeated","getTimeRunning","timeToNextAction","timeElapsedTowardNextAction","isRunning","cancelTimer","ParallaxComponent","parallaxFactor","DebugGraphicsComponent","useTransform","TileMapEvents","PreDraw","PostDraw","PointerUp","PointerDown","PointerMove","PointerCancel","TileMap","flagCollidersDirty","_collidersDirty","flagTilesDirty","tiles","_token","_rows","_cols","renderFromTopOfGraphic","meshingLookBehind","_forwardPointerEventToTile","eventType","tile","getTileByPoint","_originalOffsets","debugFlags","_composite","_oldPos","_oldScale","tileWidth","tileHeight","currentCol","Tile","_setupPointerToTile","_getOrSetColliderOriginalOffset","originalOffset","_updateColliders","shareEdges","checkAndCombine","maxLookBack","solid","defaultGeometry","getTileByIndex","getTile","_getTileCoordinates","getRows","getColumns","getOnScreenTiles","maybeParallax","oneMinusFactor","parallaxOffset","currentScene","tileStartX","tileStartY","tileEndX","tileEndY","_oldRotation","graphicsIndex","graphicsLen","offsets","getGraphicsOffsets","getGraphics","gfx","showAll","showGrid","gridColor","gridWidth","showSolidBounds","showColliderBounds","solidBoundsColor","colliderBoundsColor","showColliderGeometry","tilemap","geometryColor","geometryLineWidth","geometryPointSize","pointSize","_posDirty","_recalculate","_solid","_offsets","addGraphic","removeGraphic","clearGraphics","geometryPos","_geometry","_bounds","StrategyContainer","lockToActor","addStrategy","LockCameraToActorStrategy","lockToActorAxis","LockCameraToActorAxisStrategy","elasticToActor","cameraElasticity","cameraFriction","ElasticToActorStrategy","radiusAroundActor","RadiusAroundActorStrategy","limitCameraBounds","box","LimitCameraBoundsStrategy","Axis","cam","_eng","currentFocus","getFocus","focus","cameraVel","stretch","boundSizeChecked","focusX","focusY","CameraEvents","Camera","_cameraStrategies","dz","az","_angularVelocity","_posChanged","_cameraMoving","_isShaking","_shakeMagnitudeX","_shakeMagnitudeY","_shakeDuration","_elapsedShakeTime","_xShake","_yShake","_isZooming","_zoomStart","_zoomEnd","_currentZoomTime","_zoomDuration","_zoomEasing","_easing","_halfWidth","_halfHeight","_snapPos","_follow","ax","ay","move","easingFn","_lerpPromise","_lerpResolve","shake","magnitudeX","magnitudeY","zoomOverTime","_zoomPromise","_zoomResolve","cameraStrategy","removeStrategy","clearAllStrategies","_screen","currentRes","loadingComplete","res","updateTransform","runStrategies","newZoom","zoomEasing","lerpPoint","moveEasing","_isDoneShaking","fixedUpdateFps","blend","currentFrameLagMs","interpolatedPos","snapPos","newCanvasWidth","newCanvasHeight","cameraPos","TriggerEvents","ExitTrigger","EnterTrigger","triggerDefaults","Trigger","opts","_dispatchAction","_target","SystemPriority","Highest","Higher","Average","Lower","Lowest","SystemType","EmitterType","ParticleTransform","System","EntityManager","_world","entities","_entityIndex","_entitiesToRemove","updateEntities","removeEntity","findEntitiesForRemoval","addEntity","queryManager","idOrEntity","currFrame","actors","killed","processEntityRemovals","processComponentRemovals","getById","getByName","Query","requiredComponents","entityAdded$","entityRemoved$","checkAndAdd","getEntities","TagQuery","QueryManager","_queries","_addComponentHandlers","_removeComponentHandlers","_componentToQueriesIndex","_tagQueries","_addTagHandlers","_removeTagHandlers","_tagToQueriesIndex","_createAddComponentHandler","_createRemoveComponentHandler","_createAddTagHandler","_createRemoveTagHandler","createQuery","queries","createTagQuery","maybeAddComponent","maybeRemoveComponent","maybeAddTag","maybeRemoveTag","tagQuery","isSystemConstructor","SystemManager","systems","initialized","systemType","addSystem","systemOrCtor","system","removeSystem","updateSystems","preupdate","postupdate","entityManager","systemManager","queryTags","Update","entityOrSystem","clearEntities","clearSystems","EulerIntegrator","integrate","totalAcc","_ACC","_VEL","_POS","_VEL_ACC","_SCALE_FACTOR","_SCALE","MotionSystem","world","_physicsConfigDirty","$configUpdate","optionalBody","ArcadeSolver","directionMap","distanceMap","solve","preSolve","aDir","bDir","aDist","bDist","solvePosition","solveVelocity","postSolve","opposite","velAdj","ContactConstraintPoint","normalImpulse","tangentImpulse","normalMass","tangentMass","aToContact","bToContact","originalVelocityAndRestitution","aToContactNormal","bToContactNormal","aToContactTangent","bToContactTangent","getRelativeVelocity","velA","RealisticSolver","lastFrameContacts","idToContactConstraint","getContactConstraints","finishedContactIds","contactPoints","pointIndex","restitution","relativeVelocity","constraints","maxCorrection","steeringForce","impulseForce","impulseDelta","maxFriction","newImpulse","normalVelocity","CollisionSystem","_processor","_physics","collisionProcessor","_configDirty","_lastFrameContacts","_currentFrameContacts","_arcadeSolver","_realisticSolver","_trackCollider","_untrackCollider","colliderComponent","colliderComp","compositeColliders","getSolver","compositeId","substring","runContactStartEnd","Configurable","base","assign","props","ParticleImpl","emitterOrConfig","life","beginColor","endColor","velocity","acceleration","startSize","endSize","particleSprite","particleRotationalVelocity","currentRotation","focusAccel","fadeFlag","_rRate","_gRate","_bRate","_aRate","_currentColor","particleSize","sizeRate","elapsedMultiplier","isOffscreen","ParticleEmitter","particleTransform","Global","tmpColor","removeParticle","accel","Particle","_sprite","_particlesToEmit","numParticles","isEmitting","particles","deadParticles","minVel","maxVel","minAngle","maxAngle","emitRate","particleLife","minSize","maxSize","emitterType","randomRotation","particle","emitParticles","particleCount","_createParticle","clearParticles","ranX","ranY","blendTransform","oldTx","newTx","oldTxWithNewParent","oldGlobalPos","oldGlobalScale","oldGlobalRotation","interpolatedScale","interpolatedRotation","GraphicsSystem","sortedTransforms","_sortedTransforms","Draw","_zHasChanged","_zIndexUpdate","_targetInterpolationTransform","parallax","_applyTransform","particleOpacity","_drawGraphicsComponent","graphicsComponent","transformComponent","oldFlipHorizontal","oldFlipVertical","isDebug","showBounds","boundsColor","ancestors","ancestor","DebugSystem","_collisionSystem","filterSettings","entitySettings","txSettings","motionSettings","colliderSettings","physicsSettings","graphicsSettings","debugDraw","bodySettings","cameraSettings","useFilter","ids","nameQuery","cursor","_pushCameraTransform","debugZIndex","showPosition","positionColor","showPositionLabel","showZIndex","showId","showName","showRotation","rotationColor","showScale","scaleColor","showCollisionGroup","showCollisionType","showMass","showMotion","showSleeping","showVelocity","velocityColor","showAcceleration","accelerationColor","showGeometry","showOwner","_popCameraTransform","showBroadphaseSpacePartitionDebug","showCollisionContacts","showCollisionNormals","contactSize","collisionContactColor","collisionNormalColor","showFocus","focusColor","showZoom","overrideUseColliderShape","overrideUseGraphicsBounds","lastFrameEntityToPointers","currentFrameEntityToPointers","_sortedEntities","_scene","_receivers","pointers","_engineReceiver","entityCurrentlyUnderPointer","pointerId","entityWasUnderPointer","entered","addPointerToEntity","_processPointerToEntity","_dispatchEvents","receiver","pointerBounds","currentFramePointerCoords","screenPos","graphicBounds","_processDownAndEmit","lastDownPerPointer","currentFrameDown","isDragStart","_processUpAndEmit","lastUpPerPointer","currentFrameUp","isDragEnd","_processMoveAndEmit","lastMovePerPointer","currentFrameMove","isDragging","_processEnterLeaveAndEmit","lastUpDownMoveEvents","_processCancelAndEmit","currentFrameCancel","_processWheelAndEmit","currentFrameWheel","lastFrameEntities","currentFrameEntities","entitiesWithEvents","ActionsSystem","IsometricEntityComponent","mapOrOptions","elevation","IsometricEntitySystem","iso","OffscreenSystem","_worldBounds","entityOffscreen","_isOffscreen","transformedBounds","PhysicsWorld","newConfig","_gamePadTimeStamps","_oldPads","_pads","_initSuccess","_navigator","_minimumConfiguration","_enabled","init","_clonePads","toggleEnabled","setMinimumGamepadConfiguration","_enableAndUpdate","_isGamepadValid","pad","axesLength","buttonLength","buttons","connected","gamepads","at","timestamp","bi","ai","navigatorGamepad","getButton","pressed","updateButton","getAxes","updateAxes","_clonePad","getValidGamepads","pads","arr","clonedPad","MinAxisMoveThreshold","_axes","_buttons","_buttonsUp","_buttonsDown","isButtonPressed","isButtonHeld","wasButtonPressed","wasButtonReleased","Boolean","buttonIndex","axesIndex","InputMapper","inputs","_handlers","command","inputHandler","commandHandler","isCrossOriginIframe","noop","originalEvent","_keys","_keysUp","_keysDown","_releaseAllKeys","ev","keyEvent","_handleKeyDown","metaKey","MetaLeft","MetaRight","_handleKeyUp","keyboardOptions","grabWindowFocus","getKeys","wasPressed","isHeld","wasReleased","triggerEvent","character","KeyboardEvent","GlobalCoordinates","fromPagePosition","yOrEngine","engineOrUndefined","pageX","pageY","coordinates","pointerType","nativeEvent","screenX","screenY","deltaZ","deltaMode","PointerAbstraction","lastPagePos","lastScreenPos","lastWorldPos","_onPointerMove","_onPointerDown","primary","_activeNativePointerIdsToNormalized","lastFramePointerCoords","currentFramePointerDown","lastFramePointerDown","_pointers","_boundHandle","_handle","_boundWheel","_handleWheel","recreate","eventReceiver","isDown","wasDown","native","isDisposed","touchAction","wheelOptions","passive","pageScrollPreventionMode","ScrollPreventionMode","onmousewheel","grabFocus","detach","_normalizePointerId","nativePointerId","findIndex","preventDefault","eventCoords","TouchEvent","Unknown","Touch","changedTouches","touch","_nativeButtonToPointerButton","Mouse","isPointerEvent","_stringToPointerType","ScrollWheelNormalizationFactor","wheelDeltaX","wheelDeltaY","wheelDelta","detail","Line","Page","we","page","clientX","clientY","MouseEvent","pointerSystem","NoButton","Middle","Pen","InputHost","pointerTarget","keyboard","inputMapper","PreLoadEvent","SceneEvents","Activate","Deactivate","PreDebugDraw","PostDebugDraw","PreLoad","isSceneConstructor","Scene","triggers","tileMaps","timers","_timers","_cancelQueue","onPreLoad","loader","onTransition","onActivate","onDeactivate","_initializeChildren","pointerScope","director","getSceneName","_activate","_deactivate","_predraw","_postdraw","removeTimer","timer","_collectActorStats","addTimer","transfer","isTimerActive","isCurrentScene","screenElements","_ui","ui","alive","ColorBlindnessMode","ScreenShader","ColorBlindnessPostProcessor","_colorBlindnessMode","simulate","_simulate","colorBlindnessMode","colorBlindMode","Protanope","Deuteranope","Tritanope","ColorBlindFlags","_colorBlindPostProcessor","correct","colorBlindness","DebugConfig","FrameStats","prevFrame","isometric","positionSize","useTestClock","wasRunning","testClock","toTestClock","useStandardClock","currentClock","standardClock","toStandardClock","_id","_fps","_actorStats","remaining","_durationStats","_physicsStats","PhysicsStats","_graphicsStats","drawCalls","drawnImages","otherStats","fps","fs","_collisions","_contacts","_fastBodies","_fastBodyCollisions","_broadphase","_narrowphase","ps","BrowserComponent","_nativeHandlers","_decorate","BrowserEvents","_windowGlobal","_documentGlobal","_windowComponent","_documentComponent","DefaultAntialiasOptions","nativeContextAntialiasing","DefaultPixelArtOptions","FpsSampler","_samplePeriod","_currentFrameTime","_frames","_previousSampleTime","_beginFrameTime","initialFps","samplePeriod","_nowFn","nowFn","instant","Clock","_onFatalException","_maxFps","_lastTime","_elapsed","_scheduledCbs","_totalElapsed","maxFps","onFatalException","fpsSampler","TestClock","defaultUpdateMs","StandardClock","setFatalExceptionHandler","cb","timeoutMs","timing","scheduledTime","__runScheduledCbs","overrideUpdateMs","fpsInterval","leftover","mainloop","_requestId","_currentTime","_updateMs","step","run","numberOfSteps","Util_Toaster","Toaster","_toasterCss","_container","_createFragment","toastMessage","innerText","toast","linkTarget","linkName","className","messageFragments","link","href","finalMessage","dismissBtn","keydownHandler","first","firstChild","insertBefore","DirectorEvents","NavigationStart","Navigation","NavigationEnd","Director","isTransitioning","_isTransitioning","scenes","_sceneToInstance","_sceneToLoader","_sceneToTransition","_loadedScenes","rootScene","currentSceneName","sceneKey","sceneOrOptions","getSceneInstance","_deferredGoto","deferredScene","deferredTransition","_deferredTransition","swapScene","playTransition","configureStart","startScene","maybeLoaderOrCtor","maybeStartTransition","mainLoader","inTransition","_getLoader","sceneName","_getInTransition","sceneOrRoute","_getOutTransition","out","getDeferredScene","maybeDeferred","getSceneDefinition","maybeScene","assertAdded","assertRemoved","outTransition","nameOrScene","sceneOrCtor","potentialSceneOrOptions","goto","destinationScene","maybeDest","sourceScene","engineInputEnabled","maybeSourceOut","maybeDestinationIn","sourceOut","destinationIn","sceneActivationData","hideLoader","maybeLoadScene","_emitEvent","onPreviousSceneDeactivate","sceneDefinition","newScene","sceneToLoad","sceneToLoadInstance","transition","currentTransition","sceneInputEnabled","blockInput","previousScene","nextScene","destLoader","sourceName","destinationName","EngineEvents","FallbackGraphicsContext","Visible","Hidden","Start","PreFrame","PostFrame","Engine","useEngine","Context","isFullscreen","_isDebug","shouldSnapToPixel","scope","EX_VERSION","_inputEnabled","_suppressPlayButton","enableCanvasTransparency","stack","_toaster","_timescale","_handleWebGLContextLost","container","flexDirection","borderStyle","div","innerHTML","querySelector","reload","_performanceThresholdTriggered","_fpsSamples","_isLoading","_hideLoader","_isReadyFuture","currentFrameElapsedMs","_lagMs","_screenShotRequests","_DEFAULT_ENGINE_OPTIONS","detector","suppressMinimumBrowserFeatureDetection","_compatible","testMessage","canvasElementId","suppressConsoleBootMessage","_originalDisplayMode","pixelArt","suppressHiDPIScaling","_mainloop","___EXCALIBUR_DEVTOOL","InstanceCount","_monitorPerformanceThresholdAndTriggerFallback","allow","configurePerformanceCanvas2DFallback","showPlayerMessage","numberOfFrames","useCanvas2DFallback","newCanvas","cloneNode","parentNode","replaceChild","Document","timescale","addScene","removeScene","goToScene","scrollPreventionMode","visibilityState","toggleInputEnabled","_overrideInitialize","_update","_loader","_draw","_checkForScreenShots","toggle","toggleDebug","isReady","sceneNameOrLoader","frameId","beforeUpdate","fixedTimestepMs","afterUpdate","afterDraw","screenshot","preserveHiDPIResolution","finalWidth","finalHeight","raw","createContext","EventDispatcher","_wiredEventDispatchers","_deferedHandlerRemovals","_processDeferredHandlerRemovals","eventHandler","_removeHandler","eventHandlers","metaHandler","wire","eventDispatcher","unwire","Label","newFont","spriteFont","sf","getTextWidth","IsometricTile","_gfx","_recalculateBounds","_tileBounds","graphicsOffset","tileToWorld","_isometricEntityComponent","halfTileWidth","halfTileHeight","yPos","totalWidth","totalHeight","IsometricMap","updateColliders","worldToTile","worldCoordinate","tileCoordinate","tileCoord","_getMaxZIndex","maxZ","NEGATIVE_INFINITY","currentZ","ActionSequence","actionBuilder","_sequenceBuilder","_sequenceContext","ParallelActions","parallelActions","every","QuadTree","_defaultOptions","maxDepth","capacity","_isDivided","halfWidth","halfHeight","_split","newLevelOptions","_insertIntoSubNodes","insert","getAllItems","getTreeDepth","has_initialize","hasOnInitialize","has_preupdate","hasOnPreUpdate","has_postupdate","hasOnPostUpdate","hasPreDraw","hasPostDraw","Gif","_stream","_gif","_animation","_transparentColor","Stream","ParseGif","toSpriteSheet","toAnimation","readCheckBytes","checkBytes","bitsToNum","ba","byteToBitArr","bite","dataArray","readByte","byteLength","readBytes","bytes","read","readUnsigned","Uint8Array","stream","_st","_handler","globalColorTable","parseColorTable","ct","readSubBlocks","parseHeader","hdr","sig","ver","colorRes","globalColorTableSize","gctFlag","sorted","bgColor","pixelAspectRatio","bits","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","parseNetscapeExt","unknown","iterations","app","NETSCAPE","parseUnknownAppExt","appData","identifier","authCode","parseUnknownExt","label","extType","parseImg","img","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","pixels","minCodeSize","readCode","charCodeAt","output","clearCode","eoiCode","codeSize","dict","last","lzwDecode","newPixels","cpRow","toRow","fromRow","fromPixels","steps","pass","deinterlace","arrayToImage","parseBlock","sentinel","eof","frame","FontSource","_isLoaded","FontFace","fonts","toFont","generatorFunctionDeclaration","isCoroutineGenerator","getPrototypeOf","coroutine","coroutineGenerator","thisArg","passedEngine","generatorFcn","generator","Transition","_currentProgress","_completeFuture","started","_currentDistance","updateTransition","onStart","onEnd","onReset","targetScene","FadeInOut","screenCover","CrossFade","_progress","_calculateBounds","lineNormal","halfThickness","minPoint","maxMessages","obsoleteMessage","resetObsoleteCounter","logMessage","suppressObsoleteMessages","showStackTrace","obsolete","alternateMethod","property","SyntaxError","DecoratedClass","AsyncWaitQueue","enqueue","dequeue","Semaphore","_count","_waitQueue","waiting","enter","exit","__webpack_exports__Actor","__webpack_exports__Animation","__webpack_exports__BaseAlign","__webpack_exports__BodyComponent","__webpack_exports__CircleCollider","__webpack_exports__CollisionType","__webpack_exports__Color","__webpack_exports__CompositeCollider","__webpack_exports__DisplayMode","__webpack_exports__Engine","__webpack_exports__Font","__webpack_exports__FontUnit","__webpack_exports__ImageSource","__webpack_exports__Input","__webpack_exports__Keys","__webpack_exports__Label","__webpack_exports__Loader","__webpack_exports__Scene","__webpack_exports__Shape","__webpack_exports__Side","__webpack_exports__Sound","__webpack_exports__SpriteSheet","__webpack_exports__Text","__webpack_exports__TextAlign","__webpack_exports__clamp","__webpack_exports__vec"],"sourceRoot":""}